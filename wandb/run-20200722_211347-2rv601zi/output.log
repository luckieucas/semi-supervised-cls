create semi supervised model
create semi supervised model
single label  Total # images:7000, labels:7000
single label  Total # images:1000, labels:1000
single label  Total # images:2015, labels:2015
train_dataset len: 7000
labeled_num: 350

Epoch: 0, iteration: 0/43, ==> train <===, loss: 1.946817, classification loss: 1.946817,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 0.0001
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [49.0, 496.0, 0.0, 26.0, 39.0, 1.0, 5.0]

VAL Student: Epoch: 0, iteration: 42

VAL AUROC: 0.767997, VAL Accus: 0.390513, VAL Senss: 0.348526, VAL Specs: 0.924483
AUROCs: Melanoma:0.747632 Melanocytic nevus:0.839704 Basal cell carcinoma:0.796492 Actinic keratosis:0.930306 Benign keratosis:0.774689 Dermatofibroma:0.457444 Vascular lesion:0.829712
Accus: Melanoma:0.411765 Melanocytic nevus:0.748115 Basal cell carcinoma:0.000000 Actinic keratosis:0.787879 Benign keratosis:0.390000 Dermatofibroma:0.062500 Vascular lesion:0.333333
Senss: Melanoma:0.512605 Melanocytic nevus:0.710407 Basal cell carcinoma:0.000000 Actinic keratosis:0.666667 Benign keratosis:0.350000 Dermatofibroma:0.000000 Vascular lesion:0.200000
Specs: Melanoma:0.835414 Melanocytic nevus:0.816024 Basal cell carcinoma:1.000000 Actinic keratosis:0.943123 Benign keratosis:0.902222 Dermatofibroma:0.979675 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [114.0, 969.0, 0.0, 32.0, 103.0, 0.0, 17.0]

TEST Student: Epoch: 0, iteration: 42

TEST AUROC: 0.807925, TEST Accus: 0.399034, TEST Senss: 0.993506, TEST Specs: 0.024623
AUROCs: Melanoma:0.775811 Melanocytic nevus:0.859381 Basal cell carcinoma:0.824252 Actinic keratosis:0.875328 Benign keratosis:0.818971 Dermatofibroma:0.540688 Vascular lesion:0.961043
Accus: Melanoma:0.493506 Melanocytic nevus:0.718310 Basal cell carcinoma:0.000000 Actinic keratosis:0.551724 Benign keratosis:0.481308 Dermatofibroma:0.000000 Vascular lesion:0.548387
Senss: Melanoma:1.000000 Melanocytic nevus:1.000000 Basal cell carcinoma:1.000000 Actinic keratosis:1.000000 Benign keratosis:1.000000 Dermatofibroma:0.954545 Vascular lesion:1.000000
Specs: Melanoma:0.000000 Melanocytic nevus:0.000000 Basal cell carcinoma:0.017323 Actinic keratosis:0.041390 Benign keratosis:0.000000 Dermatofibroma:0.057702 Vascular lesion:0.055948
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_1.pth

Epoch: 1, iteration: 0/43, ==> train <===, loss: 1.920391, classification loss: 1.920391,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 9e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [57.0, 398.0, 0.0, 24.0, 54.0, 3.0, 11.0]

VAL Student: Epoch: 1, iteration: 42

VAL AUROC: 0.812262, VAL Accus: 0.466771, VAL Senss: 0.541585, VAL Specs: 0.880721
AUROCs: Melanoma:0.778355 Melanocytic nevus:0.878513 Basal cell carcinoma:0.831200 Actinic keratosis:0.904453 Benign keratosis:0.809811 Dermatofibroma:0.564723 Vascular lesion:0.918782
Accus: Melanoma:0.478992 Melanocytic nevus:0.600302 Basal cell carcinoma:0.000000 Actinic keratosis:0.727273 Benign keratosis:0.540000 Dermatofibroma:0.187500 Vascular lesion:0.733333
Senss: Melanoma:0.663866 Melanocytic nevus:0.675716 Basal cell carcinoma:0.000000 Actinic keratosis:0.818182 Benign keratosis:0.650000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Specs: Melanoma:0.741203 Melanocytic nevus:0.875371 Basal cell carcinoma:0.998943 Actinic keratosis:0.870734 Benign keratosis:0.784444 Dermatofibroma:0.938008 Vascular lesion:0.956345
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [121.0, 819.0, 0.0, 40.0, 117.0, 5.0, 31.0]

TEST Student: Epoch: 1, iteration: 42

TEST AUROC: 0.820615, TEST Accus: 0.513512, TEST Senss: 0.966776, TEST Specs: 0.192479
AUROCs: Melanoma:0.767784 Melanocytic nevus:0.891196 Basal cell carcinoma:0.786886 Actinic keratosis:0.857620 Benign keratosis:0.837113 Dermatofibroma:0.611983 Vascular lesion:0.991724
Accus: Melanoma:0.523810 Melanocytic nevus:0.607116 Basal cell carcinoma:0.000000 Actinic keratosis:0.689655 Benign keratosis:0.546729 Dermatofibroma:0.227273 Vascular lesion:1.000000
Senss: Melanoma:0.978355 Melanocytic nevus:0.988139 Basal cell carcinoma:0.954545 Actinic keratosis:0.982759 Benign keratosis:1.000000 Dermatofibroma:0.863636 Vascular lesion:1.000000
Specs: Melanoma:0.053251 Melanocytic nevus:0.234234 Basal cell carcinoma:0.275066 Actinic keratosis:0.157384 Benign keratosis:0.116602 Dermatofibroma:0.282990 Vascular lesion:0.227823
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_2.pth

Epoch: 2, iteration: 0/43, ==> train <===, loss: 1.901892, classification loss: 1.901892,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 8.1e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [51.0, 479.0, 2.0, 26.0, 59.0, 3.0, 10.0]

VAL Student: Epoch: 2, iteration: 42

VAL AUROC: 0.813353, VAL Accus: 0.488590, VAL Senss: 0.622139, VAL Specs: 0.859702
AUROCs: Melanoma:0.756169 Melanocytic nevus:0.893882 Basal cell carcinoma:0.895486 Actinic keratosis:0.876469 Benign keratosis:0.806244 Dermatofibroma:0.598958 Vascular lesion:0.866261
Accus: Melanoma:0.428571 Melanocytic nevus:0.722474 Basal cell carcinoma:0.037037 Actinic keratosis:0.787879 Benign keratosis:0.590000 Dermatofibroma:0.187500 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.822021 Basal cell carcinoma:0.259259 Actinic keratosis:0.787879 Benign keratosis:0.680000 Dermatofibroma:0.375000 Vascular lesion:0.733333
Specs: Melanoma:0.694665 Melanocytic nevus:0.792285 Basal cell carcinoma:0.974630 Actinic keratosis:0.881075 Benign keratosis:0.743333 Dermatofibroma:0.944106 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [113.0, 937.0, 3.0, 39.0, 128.0, 5.0, 23.0]

TEST Student: Epoch: 2, iteration: 42

TEST AUROC: 0.812659, TEST Accus: 0.492970, TEST Senss: 0.896003, TEST Specs: 0.379006
AUROCs: Melanoma:0.744914 Melanocytic nevus:0.900644 Basal cell carcinoma:0.835858 Actinic keratosis:0.846625 Benign keratosis:0.802571 Dermatofibroma:0.591935 Vascular lesion:0.966067
Accus: Melanoma:0.489177 Melanocytic nevus:0.694589 Basal cell carcinoma:0.027273 Actinic keratosis:0.672414 Benign keratosis:0.598131 Dermatofibroma:0.227273 Vascular lesion:0.741935
Senss: Melanoma:0.948052 Melanocytic nevus:0.976279 Basal cell carcinoma:0.881818 Actinic keratosis:0.931034 Benign keratosis:0.943925 Dermatofibroma:0.590909 Vascular lesion:1.000000
Specs: Melanoma:0.131166 Melanocytic nevus:0.400901 Basal cell carcinoma:0.551706 Actinic keratosis:0.394992 Benign keratosis:0.238756 Dermatofibroma:0.436528 Vascular lesion:0.498992
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_3.pth

Epoch: 3, iteration: 0/43, ==> train <===, loss: 1.827696, classification loss: 1.827696,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 7.290000000000001e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [51.0, 448.0, 2.0, 26.0, 57.0, 3.0, 11.0]

VAL Student: Epoch: 3, iteration: 42

VAL AUROC: 0.816494, VAL Accus: 0.488577, VAL Senss: 0.625608, VAL Specs: 0.864274
AUROCs: Melanoma:0.771268 Melanocytic nevus:0.899253 Basal cell carcinoma:0.896523 Actinic keratosis:0.859860 Benign keratosis:0.815978 Dermatofibroma:0.616806 Vascular lesion:0.855770
Accus: Melanoma:0.428571 Melanocytic nevus:0.675716 Basal cell carcinoma:0.037037 Actinic keratosis:0.787879 Benign keratosis:0.570000 Dermatofibroma:0.187500 Vascular lesion:0.733333
Senss: Melanoma:0.655462 Melanocytic nevus:0.775264 Basal cell carcinoma:0.481481 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.724177 Melanocytic nevus:0.830861 Basal cell carcinoma:0.958774 Actinic keratosis:0.837642 Benign keratosis:0.776667 Dermatofibroma:0.968496 Vascular lesion:0.953299
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [117.0, 896.0, 6.0, 41.0, 121.0, 5.0, 30.0]

TEST Student: Epoch: 3, iteration: 42

TEST AUROC: 0.814510, TEST Accus: 0.527509, TEST Senss: 0.865933, TEST Specs: 0.471112
AUROCs: Melanoma:0.760587 Melanocytic nevus:0.902122 Basal cell carcinoma:0.820663 Actinic keratosis:0.835383 Benign keratosis:0.812158 Dermatofibroma:0.592072 Vascular lesion:0.978587
Accus: Melanoma:0.506494 Melanocytic nevus:0.664196 Basal cell carcinoma:0.054545 Actinic keratosis:0.706897 Benign keratosis:0.565421 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.930736 Melanocytic nevus:0.945886 Basal cell carcinoma:0.836364 Actinic keratosis:0.896552 Benign keratosis:0.906542 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.251682 Melanocytic nevus:0.572072 Basal cell carcinoma:0.619423 Actinic keratosis:0.438426 Benign keratosis:0.373681 Dermatofibroma:0.519819 Vascular lesion:0.522681
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_4.pth

Epoch: 4, iteration: 0/43, ==> train <===, loss: 1.860383, classification loss: 1.860383,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 6.561000000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 496.0, 7.0, 25.0, 35.0, 5.0, 10.0]

VAL Student: Epoch: 4, iteration: 42

VAL AUROC: 0.816321, VAL Accus: 0.487124, VAL Senss: 0.634761, VAL Specs: 0.876956
AUROCs: Melanoma:0.785843 Melanocytic nevus:0.899164 Basal cell carcinoma:0.882566 Actinic keratosis:0.904986 Benign keratosis:0.815778 Dermatofibroma:0.629700 Vascular lesion:0.796210
Accus: Melanoma:0.445378 Melanocytic nevus:0.748115 Basal cell carcinoma:0.129630 Actinic keratosis:0.757576 Benign keratosis:0.350000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.829563 Basal cell carcinoma:0.537037 Actinic keratosis:0.848485 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.763905 Melanocytic nevus:0.771513 Basal cell carcinoma:0.941860 Actinic keratosis:0.863495 Benign keratosis:0.894444 Dermatofibroma:0.920732 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 997.0, 28.0, 42.0, 86.0, 8.0, 28.0]

TEST Student: Epoch: 4, iteration: 42

TEST AUROC: 0.813732, TEST Accus: 0.561705, TEST Senss: 0.862264, TEST Specs: 0.499663
AUROCs: Melanoma:0.759369 Melanocytic nevus:0.903352 Basal cell carcinoma:0.787736 Actinic keratosis:0.849012 Benign keratosis:0.806722 Dermatofibroma:0.607718 Vascular lesion:0.982213
Accus: Melanoma:0.545455 Melanocytic nevus:0.739066 Basal cell carcinoma:0.254545 Actinic keratosis:0.724138 Benign keratosis:0.401869 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.913420 Melanocytic nevus:0.952557 Basal cell carcinoma:0.781818 Actinic keratosis:0.896552 Benign keratosis:0.855140 Dermatofibroma:0.636364 Vascular lesion:1.000000
Specs: Melanoma:0.270179 Melanocytic nevus:0.540541 Basal cell carcinoma:0.677165 Actinic keratosis:0.525294 Benign keratosis:0.489173 Dermatofibroma:0.482188 Vascular lesion:0.513105
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_5.pth

Epoch: 5, iteration: 0/43, ==> train <===, loss: 1.909831, classification loss: 1.909831,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.904900000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 509.0, 21.0, 17.0, 64.0, 5.0, 11.0]

VAL Student: Epoch: 5, iteration: 42

VAL AUROC: 0.829908, VAL Accus: 0.543282, VAL Senss: 0.656352, VAL Specs: 0.881601
AUROCs: Melanoma:0.805569 Melanocytic nevus:0.910303 Basal cell carcinoma:0.900438 Actinic keratosis:0.815926 Benign keratosis:0.846533 Dermatofibroma:0.663173 Vascular lesion:0.867411
Accus: Melanoma:0.445378 Melanocytic nevus:0.767722 Basal cell carcinoma:0.388889 Actinic keratosis:0.515152 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.722689 Melanocytic nevus:0.855204 Basal cell carcinoma:0.574074 Actinic keratosis:0.666667 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.740068 Melanocytic nevus:0.780415 Basal cell carcinoma:0.951374 Actinic keratosis:0.930714 Benign keratosis:0.813333 Dermatofibroma:0.974593 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 1044.0, 37.0, 24.0, 136.0, 5.0, 28.0]

TEST Student: Epoch: 5, iteration: 42

TEST AUROC: 0.820274, TEST Accus: 0.543604, TEST Senss: 0.843334, TEST Specs: 0.532625
AUROCs: Melanoma:0.809769 Melanocytic nevus:0.903456 Basal cell carcinoma:0.829788 Actinic keratosis:0.747626 Benign keratosis:0.846850 Dermatofibroma:0.607878 Vascular lesion:0.996553
Accus: Melanoma:0.515152 Melanocytic nevus:0.773907 Basal cell carcinoma:0.336364 Actinic keratosis:0.413793 Benign keratosis:0.635514 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.943723 Melanocytic nevus:0.971090 Basal cell carcinoma:0.800000 Actinic keratosis:0.758621 Benign keratosis:0.929907 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.224215 Melanocytic nevus:0.493994 Basal cell carcinoma:0.702362 Actinic keratosis:0.598876 Benign keratosis:0.466963 Dermatofibroma:0.660813 Vascular lesion:0.581149
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_6.pth

Epoch: 6, iteration: 0/43, ==> train <===, loss: 1.813671, classification loss: 1.813671,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.314410000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [52.0, 503.0, 13.0, 23.0, 57.0, 5.0, 11.0]

VAL Student: Epoch: 6, iteration: 42

VAL AUROC: 0.833268, VAL Accus: 0.535599, VAL Senss: 0.651497, VAL Specs: 0.884514
AUROCs: Melanoma:0.792882 Melanocytic nevus:0.911181 Basal cell carcinoma:0.916823 Actinic keratosis:0.848861 Benign keratosis:0.853511 Dermatofibroma:0.675368 Vascular lesion:0.834247
Accus: Melanoma:0.436975 Melanocytic nevus:0.758673 Basal cell carcinoma:0.240741 Actinic keratosis:0.696970 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.638655 Melanocytic nevus:0.831071 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.791146 Melanocytic nevus:0.801187 Basal cell carcinoma:0.949260 Actinic keratosis:0.890383 Benign keratosis:0.826667 Dermatofibroma:0.960366 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [113.0, 1013.0, 33.0, 38.0, 129.0, 7.0, 29.0]

TEST Student: Epoch: 6, iteration: 42

TEST AUROC: 0.838050, TEST Accus: 0.578821, TEST Senss: 0.867779, TEST Specs: 0.574327
AUROCs: Melanoma:0.785564 Melanocytic nevus:0.910047 Basal cell carcinoma:0.829258 Actinic keratosis:0.853990 Benign keratosis:0.857758 Dermatofibroma:0.638234 Vascular lesion:0.991496
Accus: Melanoma:0.489177 Melanocytic nevus:0.750927 Basal cell carcinoma:0.300000 Actinic keratosis:0.655172 Benign keratosis:0.602804 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.904762 Melanocytic nevus:0.951816 Basal cell carcinoma:0.827273 Actinic keratosis:0.896552 Benign keratosis:0.948598 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.328475 Melanocytic nevus:0.587087 Basal cell carcinoma:0.705512 Actinic keratosis:0.598876 Benign keratosis:0.491394 Dermatofibroma:0.671851 Vascular lesion:0.637097
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_7.pth

Epoch: 7, iteration: 0/43, ==> train <===, loss: 1.837410, classification loss: 1.837410,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.782969000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 532.0, 22.0, 19.0, 54.0, 5.0, 10.0]

VAL Student: Epoch: 7, iteration: 42

VAL AUROC: 0.852237, VAL Accus: 0.535732, VAL Senss: 0.659624, VAL Specs: 0.887238
AUROCs: Melanoma:0.801906 Melanocytic nevus:0.912416 Basal cell carcinoma:0.923910 Actinic keratosis:0.858293 Benign keratosis:0.845156 Dermatofibroma:0.748984 Vascular lesion:0.874992
Accus: Melanoma:0.445378 Melanocytic nevus:0.802413 Basal cell carcinoma:0.407407 Actinic keratosis:0.575758 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.705882 Melanocytic nevus:0.867270 Basal cell carcinoma:0.611111 Actinic keratosis:0.727273 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.794552 Melanocytic nevus:0.777448 Basal cell carcinoma:0.927061 Actinic keratosis:0.917270 Benign keratosis:0.864444 Dermatofibroma:0.943089 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 1057.0, 50.0, 31.0, 126.0, 5.0, 24.0]

TEST Student: Epoch: 7, iteration: 42

TEST AUROC: 0.838983, TEST Accus: 0.554615, TEST Senss: 0.840955, TEST Specs: 0.617592
AUROCs: Melanoma:0.812448 Melanocytic nevus:0.909932 Basal cell carcinoma:0.862777 Actinic keratosis:0.825622 Benign keratosis:0.841243 Dermatofibroma:0.646125 Vascular lesion:0.974733
Accus: Melanoma:0.519481 Melanocytic nevus:0.783543 Basal cell carcinoma:0.454545 Actinic keratosis:0.534483 Benign keratosis:0.588785 Dermatofibroma:0.227273 Vascular lesion:0.774194
Senss: Melanoma:0.926407 Melanocytic nevus:0.955523 Basal cell carcinoma:0.863636 Actinic keratosis:0.827586 Benign keratosis:0.845794 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.318386 Melanocytic nevus:0.566066 Basal cell carcinoma:0.748556 Actinic keratosis:0.726111 Benign keratosis:0.604109 Dermatofibroma:0.658304 Vascular lesion:0.701613
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_8.pth

Epoch: 8, iteration: 0/43, ==> train <===, loss: 1.809396, classification loss: 1.809396,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.304672100000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 566.0, 17.0, 16.0, 49.0, 5.0, 11.0]

VAL Student: Epoch: 8, iteration: 42

VAL AUROC: 0.839407, VAL Accus: 0.526427, VAL Senss: 0.647755, VAL Specs: 0.892587
AUROCs: Melanoma:0.830779 Melanocytic nevus:0.916950 Basal cell carcinoma:0.901574 Actinic keratosis:0.823164 Benign keratosis:0.872033 Dermatofibroma:0.702109 Vascular lesion:0.829239
Accus: Melanoma:0.495798 Melanocytic nevus:0.853695 Basal cell carcinoma:0.314815 Actinic keratosis:0.484848 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.756303 Melanocytic nevus:0.912519 Basal cell carcinoma:0.462963 Actinic keratosis:0.666667 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.788876 Melanocytic nevus:0.738872 Basal cell carcinoma:0.953488 Actinic keratosis:0.932782 Benign keratosis:0.877778 Dermatofibroma:0.967480 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1135.0, 41.0, 31.0, 103.0, 5.0, 25.0]

TEST Student: Epoch: 8, iteration: 42

TEST AUROC: 0.842537, TEST Accus: 0.554046, TEST Senss: 0.825260, TEST Specs: 0.651297
AUROCs: Melanoma:0.841011 Melanocytic nevus:0.911935 Basal cell carcinoma:0.847807 Actinic keratosis:0.818891 Benign keratosis:0.856636 Dermatofibroma:0.627104 Vascular lesion:0.994374
Accus: Melanoma:0.614719 Melanocytic nevus:0.841364 Basal cell carcinoma:0.372727 Actinic keratosis:0.534483 Benign keratosis:0.481308 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.939394 Melanocytic nevus:0.968866 Basal cell carcinoma:0.745455 Actinic keratosis:0.758621 Benign keratosis:0.864486 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.371076 Melanocytic nevus:0.480480 Basal cell carcinoma:0.824672 Actinic keratosis:0.791518 Benign keratosis:0.644087 Dermatofibroma:0.740592 Vascular lesion:0.706653
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_9.pth

Epoch: 9, iteration: 0/43, ==> train <===, loss: 1.898198, classification loss: 1.898198,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.874204890000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [50.0, 513.0, 23.0, 18.0, 61.0, 5.0, 11.0]

VAL Student: Epoch: 9, iteration: 42

VAL AUROC: 0.840215, VAL Accus: 0.545877, VAL Senss: 0.648204, VAL Specs: 0.890754
AUROCs: Melanoma:0.803995 Melanocytic nevus:0.909547 Basal cell carcinoma:0.916510 Actinic keratosis:0.821472 Benign keratosis:0.850233 Dermatofibroma:0.752541 Vascular lesion:0.827208
Accus: Melanoma:0.420168 Melanocytic nevus:0.773756 Basal cell carcinoma:0.425926 Actinic keratosis:0.545455 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.672269 Melanocytic nevus:0.844646 Basal cell carcinoma:0.574074 Actinic keratosis:0.727273 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.816118 Melanocytic nevus:0.807122 Basal cell carcinoma:0.930233 Actinic keratosis:0.917270 Benign keratosis:0.801111 Dermatofibroma:0.975610 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 1035.0, 57.0, 30.0, 134.0, 4.0, 27.0]

TEST Student: Epoch: 9, iteration: 42

TEST AUROC: 0.842804, TEST Accus: 0.570966, TEST Senss: 0.830926, TEST Specs: 0.677386
AUROCs: Melanoma:0.817303 Melanocytic nevus:0.913298 Basal cell carcinoma:0.871611 Actinic keratosis:0.813314 Benign keratosis:0.846703 Dermatofibroma:0.647402 Vascular lesion:0.990001
Accus: Melanoma:0.515152 Melanocytic nevus:0.767235 Basal cell carcinoma:0.518182 Actinic keratosis:0.517241 Benign keratosis:0.626168 Dermatofibroma:0.181818 Vascular lesion:0.870968
Senss: Melanoma:0.913420 Melanocytic nevus:0.932543 Basal cell carcinoma:0.827273 Actinic keratosis:0.741379 Benign keratosis:0.901869 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.380045 Melanocytic nevus:0.644144 Basal cell carcinoma:0.792651 Actinic keratosis:0.789474 Benign keratosis:0.509162 Dermatofibroma:0.840442 Vascular lesion:0.785786
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_10.pth

Epoch: 10, iteration: 0/43, ==> train <===, loss: 1.819537, classification loss: 1.819537,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.4867844010000016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 523.0, 28.0, 18.0, 45.0, 3.0, 11.0]

VAL Student: Epoch: 10, iteration: 42

VAL AUROC: 0.860027, VAL Accus: 0.543354, VAL Senss: 0.667221, VAL Specs: 0.896981
AUROCs: Melanoma:0.823644 Melanocytic nevus:0.919595 Basal cell carcinoma:0.913926 Actinic keratosis:0.923851 Benign keratosis:0.842667 Dermatofibroma:0.754002 Vascular lesion:0.842504
Accus: Melanoma:0.579832 Melanocytic nevus:0.788839 Basal cell carcinoma:0.518519 Actinic keratosis:0.545455 Benign keratosis:0.450000 Dermatofibroma:0.187500 Vascular lesion:0.733333
Senss: Melanoma:0.747899 Melanocytic nevus:0.877828 Basal cell carcinoma:0.611111 Actinic keratosis:0.787879 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.770715 Melanocytic nevus:0.771513 Basal cell carcinoma:0.930233 Actinic keratosis:0.934850 Benign keratosis:0.900000 Dermatofibroma:0.982724 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [155.0, 1059.0, 59.0, 33.0, 98.0, 4.0, 25.0]

TEST Student: Epoch: 10, iteration: 42

TEST AUROC: 0.853578, TEST Accus: 0.572509, TEST Senss: 0.819301, TEST Specs: 0.719866
AUROCs: Melanoma:0.833770 Melanocytic nevus:0.922609 Basal cell carcinoma:0.859914 Actinic keratosis:0.864430 Benign keratosis:0.824119 Dermatofibroma:0.675113 Vascular lesion:0.995090
Accus: Melanoma:0.670996 Melanocytic nevus:0.785026 Basal cell carcinoma:0.536364 Actinic keratosis:0.568966 Benign keratosis:0.457944 Dermatofibroma:0.181818 Vascular lesion:0.806452
Senss: Melanoma:0.935065 Melanocytic nevus:0.957746 Basal cell carcinoma:0.790909 Actinic keratosis:0.793103 Benign keratosis:0.803738 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.410874 Melanocytic nevus:0.578078 Basal cell carcinoma:0.797900 Actinic keratosis:0.844660 Benign keratosis:0.686285 Dermatofibroma:0.889614 Vascular lesion:0.831653
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_11.pth

Epoch: 11, iteration: 0/43, ==> train <===, loss: 1.836558, classification loss: 1.836558,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.138105960900002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 518.0, 22.0, 16.0, 64.0, 4.0, 11.0]

VAL Student: Epoch: 11, iteration: 42

VAL AUROC: 0.839478, VAL Accus: 0.543013, VAL Senss: 0.651596, VAL Specs: 0.895759
AUROCs: Melanoma:0.816299 Melanocytic nevus:0.914421 Basal cell carcinoma:0.911577 Actinic keratosis:0.845414 Benign keratosis:0.867467 Dermatofibroma:0.702553 Vascular lesion:0.818613
Accus: Melanoma:0.504202 Melanocytic nevus:0.781297 Basal cell carcinoma:0.407407 Actinic keratosis:0.484848 Benign keratosis:0.640000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Senss: Melanoma:0.680672 Melanocytic nevus:0.862745 Basal cell carcinoma:0.555556 Actinic keratosis:0.636364 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.812713 Melanocytic nevus:0.789318 Basal cell carcinoma:0.951374 Actinic keratosis:0.954498 Benign keratosis:0.800000 Dermatofibroma:0.973577 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1034.0, 53.0, 20.0, 146.0, 5.0, 26.0]

TEST Student: Epoch: 11, iteration: 42

TEST AUROC: 0.851478, TEST Accus: 0.555878, TEST Senss: 0.824717, TEST Specs: 0.737484
AUROCs: Melanoma:0.821530 Melanocytic nevus:0.923659 Basal cell carcinoma:0.882658 Actinic keratosis:0.797412 Benign keratosis:0.878811 Dermatofibroma:0.659285 Vascular lesion:0.996992
Accus: Melanoma:0.549784 Melanocytic nevus:0.766494 Basal cell carcinoma:0.481818 Actinic keratosis:0.344828 Benign keratosis:0.682243 Dermatofibroma:0.227273 Vascular lesion:0.838710
Senss: Melanoma:0.922078 Melanocytic nevus:0.945145 Basal cell carcinoma:0.836364 Actinic keratosis:0.689655 Benign keratosis:0.925234 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.445067 Melanocytic nevus:0.635135 Basal cell carcinoma:0.829921 Actinic keratosis:0.876341 Benign keratosis:0.616880 Dermatofibroma:0.894631 Vascular lesion:0.864415
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_12.pth

Epoch: 12, iteration: 0/43, ==> train <===, loss: 1.797539, classification loss: 1.797539,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.8242953648100018e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 543.0, 24.0, 22.0, 56.0, 5.0, 10.0]

VAL Student: Epoch: 12, iteration: 42

VAL AUROC: 0.858864, VAL Accus: 0.568841, VAL Senss: 0.643067, VAL Specs: 0.903427
AUROCs: Melanoma:0.850456 Melanocytic nevus:0.919402 Basal cell carcinoma:0.917939 Actinic keratosis:0.927110 Benign keratosis:0.855967 Dermatofibroma:0.734947 Vascular lesion:0.806227
Accus: Melanoma:0.512605 Melanocytic nevus:0.819005 Basal cell carcinoma:0.444444 Actinic keratosis:0.666667 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.897436 Basal cell carcinoma:0.518519 Actinic keratosis:0.727273 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.854711 Melanocytic nevus:0.759644 Basal cell carcinoma:0.942918 Actinic keratosis:0.942089 Benign keratosis:0.862222 Dermatofibroma:0.969512 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1107.0, 54.0, 29.0, 132.0, 5.0, 25.0]

TEST Student: Epoch: 12, iteration: 42

TEST AUROC: 0.865464, TEST Accus: 0.579924, TEST Senss: 0.834720, TEST Specs: 0.738161
AUROCs: Melanoma:0.862508 Melanocytic nevus:0.923203 Basal cell carcinoma:0.882147 Actinic keratosis:0.864051 Benign keratosis:0.862213 Dermatofibroma:0.669981 Vascular lesion:0.994147
Accus: Melanoma:0.597403 Melanocytic nevus:0.820608 Basal cell carcinoma:0.490909 Actinic keratosis:0.500000 Benign keratosis:0.616822 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.939394 Melanocytic nevus:0.959970 Basal cell carcinoma:0.836364 Actinic keratosis:0.724138 Benign keratosis:0.883178 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.535314 Melanocytic nevus:0.561562 Basal cell carcinoma:0.823622 Actinic keratosis:0.869188 Benign keratosis:0.653526 Dermatofibroma:0.860512 Vascular lesion:0.863407
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_13.pth

Epoch: 13, iteration: 0/43, ==> train <===, loss: 1.799245, classification loss: 1.799245,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.5418658283290016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 541.0, 24.0, 20.0, 53.0, 5.0, 10.0]

VAL Student: Epoch: 13, iteration: 42

VAL AUROC: 0.864900, VAL Accus: 0.554266, VAL Senss: 0.639236, VAL Specs: 0.903769
AUROCs: Melanoma:0.817167 Melanocytic nevus:0.922701 Basal cell carcinoma:0.922148 Actinic keratosis:0.913227 Benign keratosis:0.871056 Dermatofibroma:0.794398 Vascular lesion:0.813604
Accus: Melanoma:0.504202 Melanocytic nevus:0.815988 Basal cell carcinoma:0.444444 Actinic keratosis:0.606061 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.894419 Basal cell carcinoma:0.537037 Actinic keratosis:0.696970 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.834279 Melanocytic nevus:0.768546 Basal cell carcinoma:0.945032 Actinic keratosis:0.940021 Benign keratosis:0.870000 Dermatofibroma:0.976626 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 1080.0, 56.0, 28.0, 132.0, 5.0, 26.0]

TEST Student: Epoch: 13, iteration: 42

TEST AUROC: 0.856362, TEST Accus: 0.575623, TEST Senss: 0.831333, TEST Specs: 0.744542
AUROCs: Melanoma:0.825163 Melanocytic nevus:0.923580 Basal cell carcinoma:0.869301 Actinic keratosis:0.837269 Benign keratosis:0.871416 Dermatofibroma:0.671509 Vascular lesion:0.996293
Accus: Melanoma:0.554113 Melanocytic nevus:0.800593 Basal cell carcinoma:0.509091 Actinic keratosis:0.482759 Benign keratosis:0.616822 Dermatofibroma:0.227273 Vascular lesion:0.838710
Senss: Melanoma:0.891775 Melanocytic nevus:0.958488 Basal cell carcinoma:0.827273 Actinic keratosis:0.758621 Benign keratosis:0.883178 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.504484 Melanocytic nevus:0.594595 Basal cell carcinoma:0.825722 Actinic keratosis:0.850281 Benign keratosis:0.685730 Dermatofibroma:0.894631 Vascular lesion:0.856351
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_14.pth

Epoch: 14, iteration: 0/43, ==> train <===, loss: 1.806317, classification loss: 1.806317,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.2876792454961016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 520.0, 20.0, 20.0, 62.0, 5.0, 10.0]

VAL Student: Epoch: 14, iteration: 42

VAL AUROC: 0.848743, VAL Accus: 0.547214, VAL Senss: 0.629635, VAL Specs: 0.901314
AUROCs: Melanoma:0.817797 Melanocytic nevus:0.918360 Basal cell carcinoma:0.907192 Actinic keratosis:0.882736 Benign keratosis:0.849256 Dermatofibroma:0.740346 Vascular lesion:0.825516
Accus: Melanoma:0.470588 Melanocytic nevus:0.784314 Basal cell carcinoma:0.370370 Actinic keratosis:0.606061 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.874811 Basal cell carcinoma:0.481481 Actinic keratosis:0.666667 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.847900 Melanocytic nevus:0.771513 Basal cell carcinoma:0.947146 Actinic keratosis:0.948294 Benign keratosis:0.828889 Dermatofibroma:0.977642 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1067.0, 55.0, 27.0, 133.0, 5.0, 23.0]

TEST Student: Epoch: 14, iteration: 42

TEST AUROC: 0.850586, TEST Accus: 0.554853, TEST Senss: 0.831804, TEST Specs: 0.757622
AUROCs: Melanoma:0.823875 Melanocytic nevus:0.920525 Basal cell carcinoma:0.876335 Actinic keratosis:0.838995 Benign keratosis:0.854476 Dermatofibroma:0.644301 Vascular lesion:0.995594
Accus: Melanoma:0.536797 Melanocytic nevus:0.790956 Basal cell carcinoma:0.500000 Actinic keratosis:0.465517 Benign keratosis:0.621495 Dermatofibroma:0.227273 Vascular lesion:0.741935
Senss: Melanoma:0.896104 Melanocytic nevus:0.948110 Basal cell carcinoma:0.827273 Actinic keratosis:0.758621 Benign keratosis:0.892523 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.536996 Melanocytic nevus:0.620120 Basal cell carcinoma:0.826772 Actinic keratosis:0.866122 Benign keratosis:0.631871 Dermatofibroma:0.911189 Vascular lesion:0.910282
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_15.pth

Epoch: 15, iteration: 0/43, ==> train <===, loss: 1.797306, classification loss: 1.797306,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.0589113209464913e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 549.0, 19.0, 21.0, 49.0, 5.0, 9.0]

VAL Student: Epoch: 15, iteration: 42

VAL AUROC: 0.850083, VAL Accus: 0.539056, VAL Senss: 0.631882, VAL Specs: 0.902958
AUROCs: Melanoma:0.854825 Melanocytic nevus:0.923368 Basal cell carcinoma:0.917469 Actinic keratosis:0.898906 Benign keratosis:0.843467 Dermatofibroma:0.695694 Vascular lesion:0.816853
Accus: Melanoma:0.554622 Melanocytic nevus:0.828054 Basal cell carcinoma:0.351852 Actinic keratosis:0.636364 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.600000
Senss: Melanoma:0.739496 Melanocytic nevus:0.903469 Basal cell carcinoma:0.407407 Actinic keratosis:0.696970 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.796822 Melanocytic nevus:0.744807 Basal cell carcinoma:0.966173 Actinic keratosis:0.954498 Benign keratosis:0.888889 Dermatofibroma:0.976626 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [155.0, 1111.0, 52.0, 27.0, 107.0, 5.0, 23.0]

TEST Student: Epoch: 15, iteration: 42

TEST AUROC: 0.855583, TEST Accus: 0.557432, TEST Senss: 0.820757, TEST Specs: 0.764324
AUROCs: Melanoma:0.861644 Melanocytic nevus:0.923382 Basal cell carcinoma:0.884591 Actinic keratosis:0.839022 Benign keratosis:0.844212 Dermatofibroma:0.641062 Vascular lesion:0.995171
Accus: Melanoma:0.670996 Melanocytic nevus:0.823573 Basal cell carcinoma:0.472727 Actinic keratosis:0.465517 Benign keratosis:0.500000 Dermatofibroma:0.227273 Vascular lesion:0.741935
Senss: Melanoma:0.952381 Melanocytic nevus:0.965901 Basal cell carcinoma:0.772727 Actinic keratosis:0.758621 Benign keratosis:0.841121 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.466928 Melanocytic nevus:0.567568 Basal cell carcinoma:0.890289 Actinic keratosis:0.886050 Benign keratosis:0.712937 Dermatofibroma:0.914701 Vascular lesion:0.911794
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_16.pth

Epoch: 16, iteration: 0/43, ==> train <===, loss: 1.796084, classification loss: 1.796084,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.8530201888518422e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 500.0, 23.0, 19.0, 47.0, 5.0, 8.0]

VAL Student: Epoch: 16, iteration: 42

VAL AUROC: 0.858401, VAL Accus: 0.533647, VAL Senss: 0.623799, VAL Specs: 0.901067
AUROCs: Melanoma:0.845907 Melanocytic nevus:0.915276 Basal cell carcinoma:0.902690 Actinic keratosis:0.897778 Benign keratosis:0.853733 Dermatofibroma:0.746253 Vascular lesion:0.847174
Accus: Melanoma:0.663866 Melanocytic nevus:0.754148 Basal cell carcinoma:0.425926 Actinic keratosis:0.575758 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.533333
Senss: Melanoma:0.773109 Melanocytic nevus:0.852187 Basal cell carcinoma:0.462963 Actinic keratosis:0.666667 Benign keratosis:0.570000 Dermatofibroma:0.375000 Vascular lesion:0.666667
Specs: Melanoma:0.760499 Melanocytic nevus:0.801187 Basal cell carcinoma:0.956660 Actinic keratosis:0.951396 Benign keratosis:0.896667 Dermatofibroma:0.945122 Vascular lesion:0.995939
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [161.0, 1033.0, 54.0, 26.0, 101.0, 6.0, 23.0]

TEST Student: Epoch: 16, iteration: 42

TEST AUROC: 0.850199, TEST Accus: 0.555505, TEST Senss: 0.790223, TEST Specs: 0.783543
AUROCs: Melanoma:0.856133 Melanocytic nevus:0.921773 Basal cell carcinoma:0.878420 Actinic keratosis:0.825630 Benign keratosis:0.842754 Dermatofibroma:0.643365 Vascular lesion:0.983318
Accus: Melanoma:0.696970 Melanocytic nevus:0.765752 Basal cell carcinoma:0.490909 Actinic keratosis:0.448276 Benign keratosis:0.471963 Dermatofibroma:0.272727 Vascular lesion:0.741935
Senss: Melanoma:0.948052 Melanocytic nevus:0.933284 Basal cell carcinoma:0.781818 Actinic keratosis:0.706897 Benign keratosis:0.803738 Dermatofibroma:0.454545 Vascular lesion:0.903226
Specs: Melanoma:0.464686 Melanocytic nevus:0.675676 Basal cell carcinoma:0.875591 Actinic keratosis:0.882984 Benign keratosis:0.756247 Dermatofibroma:0.892624 Vascular lesion:0.936996
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_17.pth

Epoch: 17, iteration: 0/43, ==> train <===, loss: 1.793618, classification loss: 1.793618,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.667718169966658e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 537.0, 24.0, 20.0, 49.0, 4.0, 9.0]

VAL Student: Epoch: 17, iteration: 42

VAL AUROC: 0.856892, VAL Accus: 0.530438, VAL Senss: 0.608352, VAL Specs: 0.905391
AUROCs: Melanoma:0.822442 Melanocytic nevus:0.920163 Basal cell carcinoma:0.919466 Actinic keratosis:0.915327 Benign keratosis:0.857222 Dermatofibroma:0.741489 Vascular lesion:0.822132
Accus: Melanoma:0.512605 Melanocytic nevus:0.809955 Basal cell carcinoma:0.444444 Actinic keratosis:0.606061 Benign keratosis:0.490000 Dermatofibroma:0.250000 Vascular lesion:0.600000
Senss: Melanoma:0.655462 Melanocytic nevus:0.880845 Basal cell carcinoma:0.518519 Actinic keratosis:0.696970 Benign keratosis:0.590000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Specs: Melanoma:0.841090 Melanocytic nevus:0.753709 Basal cell carcinoma:0.949260 Actinic keratosis:0.931748 Benign keratosis:0.894444 Dermatofibroma:0.973577 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 1127.0, 60.0, 29.0, 113.0, 4.0, 24.0]

TEST Student: Epoch: 17, iteration: 42

TEST AUROC: 0.859658, TEST Accus: 0.560483, TEST Senss: 0.809252, TEST Specs: 0.790383
AUROCs: Melanoma:0.836165 Melanocytic nevus:0.926482 Basal cell carcinoma:0.885307 Actinic keratosis:0.863743 Benign keratosis:0.857340 Dermatofibroma:0.652420 Vascular lesion:0.996147
Accus: Melanoma:0.558442 Melanocytic nevus:0.835434 Basal cell carcinoma:0.545455 Actinic keratosis:0.500000 Benign keratosis:0.528037 Dermatofibroma:0.181818 Vascular lesion:0.774194
Senss: Melanoma:0.891775 Melanocytic nevus:0.956264 Basal cell carcinoma:0.800000 Actinic keratosis:0.775862 Benign keratosis:0.831776 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.588004 Melanocytic nevus:0.626126 Basal cell carcinoma:0.854593 Actinic keratosis:0.859479 Benign keratosis:0.752915 Dermatofibroma:0.943803 Vascular lesion:0.907762
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_18.pth

Epoch: 18, iteration: 0/43, ==> train <===, loss: 1.843223, classification loss: 1.843223,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.5009463529699922e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 537.0, 28.0, 16.0, 52.0, 4.0, 9.0]

VAL Student: Epoch: 18, iteration: 42

VAL AUROC: 0.851992, VAL Accus: 0.527990, VAL Senss: 0.609365, VAL Specs: 0.905044
AUROCs: Melanoma:0.819046 Melanocytic nevus:0.920803 Basal cell carcinoma:0.925828 Actinic keratosis:0.867977 Benign keratosis:0.866856 Dermatofibroma:0.742251 Vascular lesion:0.821184
Accus: Melanoma:0.512605 Melanocytic nevus:0.809955 Basal cell carcinoma:0.518519 Actinic keratosis:0.484848 Benign keratosis:0.520000 Dermatofibroma:0.250000 Vascular lesion:0.600000
Senss: Melanoma:0.680672 Melanocytic nevus:0.888386 Basal cell carcinoma:0.574074 Actinic keratosis:0.575758 Benign keratosis:0.630000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Specs: Melanoma:0.828604 Melanocytic nevus:0.750742 Basal cell carcinoma:0.938689 Actinic keratosis:0.967942 Benign keratosis:0.877778 Dermatofibroma:0.976626 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 1110.0, 60.0, 21.0, 125.0, 5.0, 23.0]

TEST Student: Epoch: 18, iteration: 42

TEST AUROC: 0.853676, TEST Accus: 0.548255, TEST Senss: 0.810757, TEST Specs: 0.785345
AUROCs: Melanoma:0.825624 Melanocytic nevus:0.924471 Basal cell carcinoma:0.895042 Actinic keratosis:0.827022 Benign keratosis:0.872384 Dermatofibroma:0.639237 Vascular lesion:0.991952
Accus: Melanoma:0.554113 Melanocytic nevus:0.822832 Basal cell carcinoma:0.545455 Actinic keratosis:0.362069 Benign keratosis:0.584112 Dermatofibroma:0.227273 Vascular lesion:0.741935
Senss: Melanoma:0.904762 Melanocytic nevus:0.957746 Basal cell carcinoma:0.836364 Actinic keratosis:0.689655 Benign keratosis:0.864486 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.526345 Melanocytic nevus:0.614114 Basal cell carcinoma:0.848819 Actinic keratosis:0.914154 Benign keratosis:0.715713 Dermatofibroma:0.945309 Vascular lesion:0.932964
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_19.pth

Epoch: 19, iteration: 0/43, ==> train <===, loss: 1.821809, classification loss: 1.821809,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.350851717672993e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 544.0, 22.0, 19.0, 39.0, 4.0, 11.0]

VAL Student: Epoch: 19, iteration: 42

VAL AUROC: 0.858707, VAL Accus: 0.537892, VAL Senss: 0.601973, VAL Specs: 0.906508
AUROCs: Melanoma:0.834317 Melanocytic nevus:0.923350 Basal cell carcinoma:0.909561 Actinic keratosis:0.914732 Benign keratosis:0.858844 Dermatofibroma:0.748349 Vascular lesion:0.821794
Accus: Melanoma:0.588235 Melanocytic nevus:0.820513 Basal cell carcinoma:0.407407 Actinic keratosis:0.575758 Benign keratosis:0.390000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Senss: Melanoma:0.714286 Melanocytic nevus:0.891403 Basal cell carcinoma:0.425926 Actinic keratosis:0.636364 Benign keratosis:0.500000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.799092 Melanocytic nevus:0.762611 Basal cell carcinoma:0.961945 Actinic keratosis:0.943123 Benign keratosis:0.913333 Dermatofibroma:0.971545 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 1113.0, 52.0, 28.0, 109.0, 6.0, 24.0]

TEST Student: Epoch: 19, iteration: 42

TEST AUROC: 0.862146, TEST Accus: 0.567596, TEST Senss: 0.813852, TEST Specs: 0.782221
AUROCs: Melanoma:0.840914 Melanocytic nevus:0.926498 Basal cell carcinoma:0.879704 Actinic keratosis:0.873822 Benign keratosis:0.861743 Dermatofibroma:0.656001 Vascular lesion:0.996342
Accus: Melanoma:0.636364 Melanocytic nevus:0.825056 Basal cell carcinoma:0.472727 Actinic keratosis:0.482759 Benign keratosis:0.509346 Dermatofibroma:0.272727 Vascular lesion:0.774194
Senss: Melanoma:0.917749 Melanocytic nevus:0.960712 Basal cell carcinoma:0.754545 Actinic keratosis:0.810345 Benign keratosis:0.799065 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.484305 Melanocytic nevus:0.606607 Basal cell carcinoma:0.882940 Actinic keratosis:0.869699 Benign keratosis:0.788451 Dermatofibroma:0.933266 Vascular lesion:0.910282
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_20.pth

Epoch: 20, iteration: 0/43, ==> train <===, loss: 1.795333, classification loss: 1.795333,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.2157665459056937e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 546.0, 26.0, 18.0, 44.0, 4.0, 11.0]

VAL Student: Epoch: 20, iteration: 42

VAL AUROC: 0.859828, VAL Accus: 0.548118, VAL Senss: 0.616189, VAL Specs: 0.914001
AUROCs: Melanoma:0.842931 Melanocytic nevus:0.924863 Basal cell carcinoma:0.921110 Actinic keratosis:0.903732 Benign keratosis:0.861400 Dermatofibroma:0.733359 Vascular lesion:0.831404
Accus: Melanoma:0.563025 Melanocytic nevus:0.823529 Basal cell carcinoma:0.481481 Actinic keratosis:0.545455 Benign keratosis:0.440000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Senss: Melanoma:0.689076 Melanocytic nevus:0.882353 Basal cell carcinoma:0.500000 Actinic keratosis:0.606061 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.838820 Melanocytic nevus:0.774481 Basal cell carcinoma:0.952431 Actinic keratosis:0.961737 Benign keratosis:0.900000 Dermatofibroma:0.978659 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1124.0, 63.0, 24.0, 112.0, 5.0, 25.0]

TEST Student: Epoch: 20, iteration: 42

TEST AUROC: 0.863658, TEST Accus: 0.568983, TEST Senss: 0.806988, TEST Specs: 0.793621
AUROCs: Melanoma:0.844551 Melanocytic nevus:0.930032 Basal cell carcinoma:0.900062 Actinic keratosis:0.847127 Benign keratosis:0.862247 Dermatofibroma:0.663915 Vascular lesion:0.997675
Accus: Melanoma:0.606061 Melanocytic nevus:0.833210 Basal cell carcinoma:0.572727 Actinic keratosis:0.413793 Benign keratosis:0.523364 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.900433 Melanocytic nevus:0.955523 Basal cell carcinoma:0.809091 Actinic keratosis:0.706897 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.575673 Melanocytic nevus:0.623123 Basal cell carcinoma:0.861417 Actinic keratosis:0.904446 Benign keratosis:0.766796 Dermatofibroma:0.932765 Vascular lesion:0.891129
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_21.pth

Epoch: 21, iteration: 0/43, ==> train <===, loss: 3.569670, classification loss: 1.794480,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.131569,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024912,wcp loss: 0.000000,entropy loss: 1.881847,consistency weight: 1.000000, lr: 1.0941898913151244e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 512.0, 24.0, 24.0, 46.0, 4.0, 10.0]

VAL Student: Epoch: 21, iteration: 42

VAL AUROC: 0.837340, VAL Accus: 0.551207, VAL Senss: 0.623523, VAL Specs: 0.905464
AUROCs: Melanoma:0.807724 Melanocytic nevus:0.915876 Basal cell carcinoma:0.920386 Actinic keratosis:0.916079 Benign keratosis:0.841456 Dermatofibroma:0.671367 Vascular lesion:0.788494
Accus: Melanoma:0.537815 Melanocytic nevus:0.772247 Basal cell carcinoma:0.444444 Actinic keratosis:0.727273 Benign keratosis:0.460000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.849170 Basal cell carcinoma:0.592593 Actinic keratosis:0.757576 Benign keratosis:0.610000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Specs: Melanoma:0.839955 Melanocytic nevus:0.804154 Basal cell carcinoma:0.929175 Actinic keratosis:0.901758 Benign keratosis:0.885556 Dermatofibroma:0.987805 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 1066.0, 66.0, 38.0, 119.0, 4.0, 24.0]

TEST Student: Epoch: 21, iteration: 42

TEST AUROC: 0.853070, TEST Accus: 0.587988, TEST Senss: 0.808026, TEST Specs: 0.797222
AUROCs: Melanoma:0.825051 Melanocytic nevus:0.927199 Basal cell carcinoma:0.903045 Actinic keratosis:0.861470 Benign keratosis:0.849717 Dermatofibroma:0.608425 Vascular lesion:0.996586
Accus: Melanoma:0.558442 Melanocytic nevus:0.790215 Basal cell carcinoma:0.600000 Actinic keratosis:0.655172 Benign keratosis:0.556075 Dermatofibroma:0.181818 Vascular lesion:0.774194
Senss: Melanoma:0.844156 Melanocytic nevus:0.930319 Basal cell carcinoma:0.872727 Actinic keratosis:0.827586 Benign keratosis:0.817757 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.612668 Melanocytic nevus:0.699700 Basal cell carcinoma:0.820472 Actinic keratosis:0.826776 Benign keratosis:0.741255 Dermatofibroma:0.968389 Vascular lesion:0.911290
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_22.pth

Epoch: 22, iteration: 0/43, ==> train <===, loss: 3.575992, classification loss: 1.819978,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.132897,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012274,wcp loss: 0.000000,entropy loss: 1.876637,consistency weight: 1.000000, lr: 9.84770902183612e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 519.0, 22.0, 27.0, 44.0, 5.0, 10.0]

VAL Student: Epoch: 22, iteration: 42

VAL AUROC: 0.850005, VAL Accus: 0.560480, VAL Senss: 0.623404, VAL Specs: 0.900394
AUROCs: Melanoma:0.814659 Melanocytic nevus:0.913906 Basal cell carcinoma:0.914298 Actinic keratosis:0.945223 Benign keratosis:0.814600 Dermatofibroma:0.720211 Vascular lesion:0.827140
Accus: Melanoma:0.495798 Melanocytic nevus:0.782805 Basal cell carcinoma:0.407407 Actinic keratosis:0.818182 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.588235 Melanocytic nevus:0.846154 Basal cell carcinoma:0.481481 Actinic keratosis:0.878788 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.870602 Melanocytic nevus:0.798220 Basal cell carcinoma:0.957717 Actinic keratosis:0.877973 Benign keratosis:0.874444 Dermatofibroma:0.944106 Vascular lesion:0.979695
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 1050.0, 50.0, 38.0, 122.0, 8.0, 29.0]

TEST Student: Epoch: 22, iteration: 42

TEST AUROC: 0.867679, TEST Accus: 0.610967, TEST Senss: 0.810521, TEST Specs: 0.803708
AUROCs: Melanoma:0.827793 Melanocytic nevus:0.925496 Basal cell carcinoma:0.889105 Actinic keratosis:0.887715 Benign keratosis:0.850641 Dermatofibroma:0.695685 Vascular lesion:0.997317
Accus: Melanoma:0.519481 Melanocytic nevus:0.778354 Basal cell carcinoma:0.454545 Actinic keratosis:0.655172 Benign keratosis:0.570093 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.800866 Melanocytic nevus:0.921423 Basal cell carcinoma:0.763636 Actinic keratosis:0.879310 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.706278 Melanocytic nevus:0.705706 Basal cell carcinoma:0.887664 Actinic keratosis:0.821666 Benign keratosis:0.749584 Dermatofibroma:0.884596 Vascular lesion:0.870464
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_23.pth

Epoch: 23, iteration: 0/43, ==> train <===, loss: 3.552896, classification loss: 1.792674,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.136289,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023915,wcp loss: 0.000000,entropy loss: 1.872596,consistency weight: 1.000000, lr: 8.862938119652508e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 502.0, 27.0, 25.0, 52.0, 4.0, 10.0]

VAL Student: Epoch: 23, iteration: 42

VAL AUROC: 0.835119, VAL Accus: 0.559085, VAL Senss: 0.640091, VAL Specs: 0.897827
AUROCs: Melanoma:0.796927 Melanocytic nevus:0.908083 Basal cell carcinoma:0.926826 Actinic keratosis:0.918680 Benign keratosis:0.841389 Dermatofibroma:0.662729 Vascular lesion:0.791201
Accus: Melanoma:0.462185 Melanocytic nevus:0.757164 Basal cell carcinoma:0.500000 Actinic keratosis:0.757576 Benign keratosis:0.520000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.596639 Melanocytic nevus:0.832579 Basal cell carcinoma:0.574074 Actinic keratosis:0.818182 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.866061 Melanocytic nevus:0.813056 Basal cell carcinoma:0.921776 Actinic keratosis:0.875905 Benign keratosis:0.857778 Dermatofibroma:0.958333 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [116.0, 1031.0, 66.0, 39.0, 128.0, 6.0, 24.0]

TEST Student: Epoch: 23, iteration: 42

TEST AUROC: 0.858596, TEST Accus: 0.597700, TEST Senss: 0.816125, TEST Specs: 0.799639
AUROCs: Melanoma:0.811555 Melanocytic nevus:0.922885 Basal cell carcinoma:0.910527 Actinic keratosis:0.863840 Benign keratosis:0.866642 Dermatofibroma:0.638416 Vascular lesion:0.996309
Accus: Melanoma:0.502165 Melanocytic nevus:0.764270 Basal cell carcinoma:0.600000 Actinic keratosis:0.672414 Benign keratosis:0.598131 Dermatofibroma:0.272727 Vascular lesion:0.774194
Senss: Melanoma:0.770563 Melanocytic nevus:0.920682 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.850467 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.694507 Melanocytic nevus:0.710210 Basal cell carcinoma:0.811024 Actinic keratosis:0.788963 Benign keratosis:0.733481 Dermatofibroma:0.908179 Vascular lesion:0.951109
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_24.pth

Epoch: 24, iteration: 0/43, ==> train <===, loss: 3.596602, classification loss: 1.832745,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.133454,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021547,wcp loss: 0.000000,entropy loss: 1.875764,consistency weight: 1.000000, lr: 7.976644307687257e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 541.0, 27.0, 23.0, 46.0, 4.0, 10.0]

VAL Student: Epoch: 24, iteration: 42

VAL AUROC: 0.846335, VAL Accus: 0.557461, VAL Senss: 0.646799, VAL Specs: 0.894202
AUROCs: Melanoma:0.827526 Melanocytic nevus:0.916914 Basal cell carcinoma:0.923792 Actinic keratosis:0.909843 Benign keratosis:0.863811 Dermatofibroma:0.658092 Vascular lesion:0.824365
Accus: Melanoma:0.512605 Melanocytic nevus:0.815988 Basal cell carcinoma:0.500000 Actinic keratosis:0.696970 Benign keratosis:0.460000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.722689 Melanocytic nevus:0.892911 Basal cell carcinoma:0.555556 Actinic keratosis:0.727273 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.819523 Melanocytic nevus:0.732938 Basal cell carcinoma:0.938689 Actinic keratosis:0.927611 Benign keratosis:0.883333 Dermatofibroma:0.962398 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1111.0, 62.0, 28.0, 121.0, 5.0, 25.0]

TEST Student: Epoch: 24, iteration: 42

TEST AUROC: 0.871088, TEST Accus: 0.580931, TEST Senss: 0.829953, TEST Specs: 0.798468
AUROCs: Melanoma:0.857524 Melanocytic nevus:0.922693 Basal cell carcinoma:0.904013 Actinic keratosis:0.867963 Benign keratosis:0.875773 Dermatofibroma:0.672673 Vascular lesion:0.996976
Accus: Melanoma:0.597403 Melanocytic nevus:0.823573 Basal cell carcinoma:0.563636 Actinic keratosis:0.482759 Benign keratosis:0.565421 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.904762 Melanocytic nevus:0.954781 Basal cell carcinoma:0.881818 Actinic keratosis:0.758621 Benign keratosis:0.855140 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.619955 Melanocytic nevus:0.594595 Basal cell carcinoma:0.864042 Actinic keratosis:0.879918 Benign keratosis:0.746807 Dermatofibroma:0.914200 Vascular lesion:0.969758
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_25.pth

Epoch: 25, iteration: 0/43, ==> train <===, loss: 3.586485, classification loss: 1.811924,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.132757,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032107,wcp loss: 0.000000,entropy loss: 1.875211,consistency weight: 1.000000, lr: 7.1789798769185315e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 517.0, 20.0, 23.0, 49.0, 4.0, 10.0]

VAL Student: Epoch: 25, iteration: 42

VAL AUROC: 0.838485, VAL Accus: 0.547661, VAL Senss: 0.660971, VAL Specs: 0.895033
AUROCs: Melanoma:0.837255 Melanocytic nevus:0.918883 Basal cell carcinoma:0.904589 Actinic keratosis:0.856131 Benign keratosis:0.867533 Dermatofibroma:0.663618 Vascular lesion:0.821387
Accus: Melanoma:0.579832 Melanocytic nevus:0.779789 Basal cell carcinoma:0.370370 Actinic keratosis:0.696970 Benign keratosis:0.490000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.806723 Melanocytic nevus:0.874811 Basal cell carcinoma:0.518519 Actinic keratosis:0.757576 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.777526 Melanocytic nevus:0.774481 Basal cell carcinoma:0.952431 Actinic keratosis:0.923475 Benign keratosis:0.880000 Dermatofibroma:0.961382 Vascular lesion:0.995939
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1070.0, 52.0, 28.0, 121.0, 4.0, 25.0]

TEST Student: Epoch: 25, iteration: 42

TEST AUROC: 0.867160, TEST Accus: 0.565148, TEST Senss: 0.819083, TEST Specs: 0.793683
AUROCs: Melanoma:0.856738 Melanocytic nevus:0.923215 Basal cell carcinoma:0.897175 Actinic keratosis:0.841709 Benign keratosis:0.886060 Dermatofibroma:0.667746 Vascular lesion:0.997480
Accus: Melanoma:0.653680 Melanocytic nevus:0.793180 Basal cell carcinoma:0.472727 Actinic keratosis:0.482759 Benign keratosis:0.565421 Dermatofibroma:0.181818 Vascular lesion:0.806452
Senss: Melanoma:0.930736 Melanocytic nevus:0.942179 Basal cell carcinoma:0.790909 Actinic keratosis:0.741379 Benign keratosis:0.873832 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.548206 Melanocytic nevus:0.638138 Basal cell carcinoma:0.882940 Actinic keratosis:0.857946 Benign keratosis:0.739589 Dermatofibroma:0.921726 Vascular lesion:0.967238
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_26.pth

Epoch: 26, iteration: 0/43, ==> train <===, loss: 3.586892, classification loss: 1.837696,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141263,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020860,wcp loss: 0.000000,entropy loss: 1.869599,consistency weight: 1.000000, lr: 6.461081889226678e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 479.0, 19.0, 23.0, 58.0, 5.0, 11.0]

VAL Student: Epoch: 26, iteration: 42

VAL AUROC: 0.840240, VAL Accus: 0.570538, VAL Senss: 0.668020, VAL Specs: 0.888352
AUROCs: Melanoma:0.832400 Melanocytic nevus:0.914273 Basal cell carcinoma:0.893724 Actinic keratosis:0.917145 Benign keratosis:0.863833 Dermatofibroma:0.628430 Vascular lesion:0.831878
Accus: Melanoma:0.596639 Melanocytic nevus:0.722474 Basal cell carcinoma:0.351852 Actinic keratosis:0.696970 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.756303 Melanocytic nevus:0.844646 Basal cell carcinoma:0.481481 Actinic keratosis:0.787879 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.776390 Melanocytic nevus:0.818991 Basal cell carcinoma:0.966173 Actinic keratosis:0.892451 Benign keratosis:0.847778 Dermatofibroma:0.929878 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 989.0, 43.0, 34.0, 130.0, 5.0, 29.0]

TEST Student: Epoch: 26, iteration: 42

TEST AUROC: 0.863871, TEST Accus: 0.588740, TEST Senss: 0.806231, TEST Specs: 0.797948
AUROCs: Melanoma:0.842290 Melanocytic nevus:0.924424 Basal cell carcinoma:0.887659 Actinic keratosis:0.877443 Benign keratosis:0.881452 Dermatofibroma:0.636592 Vascular lesion:0.997236
Accus: Melanoma:0.640693 Melanocytic nevus:0.733136 Basal cell carcinoma:0.390909 Actinic keratosis:0.586207 Benign keratosis:0.607477 Dermatofibroma:0.227273 Vascular lesion:0.935484
Senss: Melanoma:0.913420 Melanocytic nevus:0.919941 Basal cell carcinoma:0.663636 Actinic keratosis:0.827586 Benign keratosis:0.864486 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.564462 Melanocytic nevus:0.726727 Basal cell carcinoma:0.914961 Actinic keratosis:0.822688 Benign keratosis:0.725153 Dermatofibroma:0.890115 Vascular lesion:0.941532
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_27.pth

Epoch: 27, iteration: 0/43, ==> train <===, loss: 3.558976, classification loss: 1.797574,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137375,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025907,wcp loss: 0.000000,entropy loss: 1.872869,consistency weight: 1.000000, lr: 5.81497370030401e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 510.0, 27.0, 22.0, 61.0, 4.0, 10.0]

VAL Student: Epoch: 27, iteration: 42

VAL AUROC: 0.843488, VAL Accus: 0.567881, VAL Senss: 0.651451, VAL Specs: 0.891878
AUROCs: Melanoma:0.819905 Melanocytic nevus:0.917178 Basal cell carcinoma:0.925417 Actinic keratosis:0.892796 Benign keratosis:0.858678 Dermatofibroma:0.651931 Vascular lesion:0.838511
Accus: Melanoma:0.512605 Melanocytic nevus:0.769231 Basal cell carcinoma:0.500000 Actinic keratosis:0.666667 Benign keratosis:0.610000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.864253 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.836549 Melanocytic nevus:0.795252 Basal cell carcinoma:0.930233 Actinic keratosis:0.923475 Benign keratosis:0.815556 Dermatofibroma:0.948171 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1044.0, 65.0, 28.0, 141.0, 5.0, 24.0]

TEST Student: Epoch: 27, iteration: 42

TEST AUROC: 0.862003, TEST Accus: 0.577817, TEST Senss: 0.824401, TEST Specs: 0.802821
AUROCs: Melanoma:0.838929 Melanocytic nevus:0.923895 Basal cell carcinoma:0.911506 Actinic keratosis:0.831771 Benign keratosis:0.878811 Dermatofibroma:0.652830 Vascular lesion:0.996277
Accus: Melanoma:0.536797 Melanocytic nevus:0.773907 Basal cell carcinoma:0.590909 Actinic keratosis:0.482759 Benign keratosis:0.658879 Dermatofibroma:0.227273 Vascular lesion:0.774194
Senss: Melanoma:0.865801 Melanocytic nevus:0.938473 Basal cell carcinoma:0.900000 Actinic keratosis:0.724138 Benign keratosis:0.887850 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.663677 Melanocytic nevus:0.666667 Basal cell carcinoma:0.848294 Actinic keratosis:0.877874 Benign keratosis:0.681288 Dermatofibroma:0.913698 Vascular lesion:0.968246
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_28.pth

Epoch: 28, iteration: 0/43, ==> train <===, loss: 3.562409, classification loss: 1.792703,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.136098,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.034947,wcp loss: 0.000000,entropy loss: 1.870857,consistency weight: 1.000000, lr: 5.23347633027361e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 518.0, 22.0, 26.0, 44.0, 5.0, 10.0]

VAL Student: Epoch: 28, iteration: 42

VAL AUROC: 0.853948, VAL Accus: 0.557136, VAL Senss: 0.643392, VAL Specs: 0.890930
AUROCs: Melanoma:0.818217 Melanocytic nevus:0.911861 Basal cell carcinoma:0.920680 Actinic keratosis:0.934411 Benign keratosis:0.818300 Dermatofibroma:0.724149 Vascular lesion:0.850017
Accus: Melanoma:0.504202 Melanocytic nevus:0.781297 Basal cell carcinoma:0.407407 Actinic keratosis:0.787879 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.630252 Melanocytic nevus:0.870287 Basal cell carcinoma:0.555556 Actinic keratosis:0.848485 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.847900 Melanocytic nevus:0.762611 Basal cell carcinoma:0.937632 Actinic keratosis:0.895553 Benign keratosis:0.882222 Dermatofibroma:0.929878 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1054.0, 60.0, 36.0, 122.0, 7.0, 29.0]

TEST Student: Epoch: 28, iteration: 42

TEST AUROC: 0.873075, TEST Accus: 0.615431, TEST Senss: 0.824494, TEST Specs: 0.809410
AUROCs: Melanoma:0.841132 Melanocytic nevus:0.920526 Basal cell carcinoma:0.909258 Actinic keratosis:0.881011 Benign keratosis:0.860319 Dermatofibroma:0.702755 Vascular lesion:0.996521
Accus: Melanoma:0.536797 Melanocytic nevus:0.781319 Basal cell carcinoma:0.545455 Actinic keratosis:0.620690 Benign keratosis:0.570093 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.839827 Melanocytic nevus:0.931060 Basal cell carcinoma:0.836364 Actinic keratosis:0.810345 Benign keratosis:0.808411 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.710762 Melanocytic nevus:0.672673 Basal cell carcinoma:0.869816 Actinic keratosis:0.849259 Benign keratosis:0.768462 Dermatofibroma:0.880582 Vascular lesion:0.914315
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_29.pth

Epoch: 29, iteration: 0/43, ==> train <===, loss: 3.601254, classification loss: 1.842734,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.136192,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022922,wcp loss: 0.000000,entropy loss: 1.871791,consistency weight: 1.000000, lr: 4.710128697246249e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 518.0, 28.0, 20.0, 47.0, 5.0, 10.0]

VAL Student: Epoch: 29, iteration: 42

VAL AUROC: 0.853738, VAL Accus: 0.559724, VAL Senss: 0.656244, VAL Specs: 0.889097
AUROCs: Melanoma:0.830988 Melanocytic nevus:0.918319 Basal cell carcinoma:0.916471 Actinic keratosis:0.883927 Benign keratosis:0.852544 Dermatofibroma:0.709413 Vascular lesion:0.864501
Accus: Melanoma:0.563025 Melanocytic nevus:0.781297 Basal cell carcinoma:0.518519 Actinic keratosis:0.606061 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.731092 Melanocytic nevus:0.885370 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.800227 Melanocytic nevus:0.750742 Basal cell carcinoma:0.935518 Actinic keratosis:0.936918 Benign keratosis:0.874444 Dermatofibroma:0.942073 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1060.0, 64.0, 23.0, 122.0, 6.0, 29.0]

TEST Student: Epoch: 29, iteration: 42

TEST AUROC: 0.867252, TEST Accus: 0.594498, TEST Senss: 0.813806, TEST Specs: 0.796908
AUROCs: Melanoma:0.852341 Melanocytic nevus:0.924367 Basal cell carcinoma:0.908418 Actinic keratosis:0.831595 Benign keratosis:0.872496 Dermatofibroma:0.684783 Vascular lesion:0.996764
Accus: Melanoma:0.619048 Melanocytic nevus:0.785767 Basal cell carcinoma:0.581818 Actinic keratosis:0.396552 Benign keratosis:0.570093 Dermatofibroma:0.272727 Vascular lesion:0.935484
Senss: Melanoma:0.904762 Melanocytic nevus:0.951075 Basal cell carcinoma:0.872727 Actinic keratosis:0.672414 Benign keratosis:0.841121 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.613229 Melanocytic nevus:0.614114 Basal cell carcinoma:0.861417 Actinic keratosis:0.899336 Benign keratosis:0.755136 Dermatofibroma:0.901154 Vascular lesion:0.933972
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_30.pth

Epoch: 30, iteration: 0/43, ==> train <===, loss: 3.570457, classification loss: 1.819119,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140426,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024884,wcp loss: 0.000000,entropy loss: 1.866880,consistency weight: 1.000000, lr: 4.239115827521624e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 527.0, 31.0, 19.0, 42.0, 5.0, 10.0]

VAL Student: Epoch: 30, iteration: 42

VAL AUROC: 0.846299, VAL Accus: 0.554526, VAL Senss: 0.667867, VAL Specs: 0.886003
AUROCs: Melanoma:0.828423 Melanocytic nevus:0.913047 Basal cell carcinoma:0.911851 Actinic keratosis:0.877879 Benign keratosis:0.843322 Dermatofibroma:0.651232 Vascular lesion:0.898342
Accus: Melanoma:0.537815 Melanocytic nevus:0.794872 Basal cell carcinoma:0.574074 Actinic keratosis:0.575758 Benign keratosis:0.420000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.722689 Melanocytic nevus:0.892911 Basal cell carcinoma:0.666667 Actinic keratosis:0.696970 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.803632 Melanocytic nevus:0.718101 Basal cell carcinoma:0.918605 Actinic keratosis:0.950362 Benign keratosis:0.896667 Dermatofibroma:0.936992 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1095.0, 72.0, 23.0, 117.0, 6.0, 29.0]

TEST Student: Epoch: 30, iteration: 42

TEST AUROC: 0.863688, TEST Accus: 0.602783, TEST Senss: 0.801180, TEST Specs: 0.806390
AUROCs: Melanoma:0.855248 Melanocytic nevus:0.920340 Basal cell carcinoma:0.912011 Actinic keratosis:0.798812 Benign keratosis:0.871478 Dermatofibroma:0.690850 Vascular lesion:0.997073
Accus: Melanoma:0.601732 Melanocytic nevus:0.811712 Basal cell carcinoma:0.654545 Actinic keratosis:0.396552 Benign keratosis:0.546729 Dermatofibroma:0.272727 Vascular lesion:0.935484
Senss: Melanoma:0.896104 Melanocytic nevus:0.952557 Basal cell carcinoma:0.872727 Actinic keratosis:0.637931 Benign keratosis:0.794393 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.644058 Melanocytic nevus:0.602102 Basal cell carcinoma:0.842520 Actinic keratosis:0.934594 Benign keratosis:0.782343 Dermatofibroma:0.911189 Vascular lesion:0.927923
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_31.pth

Epoch: 31, iteration: 0/43, ==> train <===, loss: 3.570520, classification loss: 1.818635,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.136132,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019190,wcp loss: 0.000000,entropy loss: 1.868827,consistency weight: 1.000000, lr: 3.815204244769462e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 523.0, 18.0, 22.0, 65.0, 4.0, 11.0]

VAL Student: Epoch: 31, iteration: 42

VAL AUROC: 0.838390, VAL Accus: 0.562111, VAL Senss: 0.654259, VAL Specs: 0.885799
AUROCs: Melanoma:0.822556 Melanocytic nevus:0.918937 Basal cell carcinoma:0.876830 Actinic keratosis:0.871862 Benign keratosis:0.877378 Dermatofibroma:0.650407 Vascular lesion:0.850761
Accus: Melanoma:0.512605 Melanocytic nevus:0.788839 Basal cell carcinoma:0.333333 Actinic keratosis:0.666667 Benign keratosis:0.650000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Senss: Melanoma:0.689076 Melanocytic nevus:0.891403 Basal cell carcinoma:0.425926 Actinic keratosis:0.757576 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.813848 Melanocytic nevus:0.744807 Basal cell carcinoma:0.961945 Actinic keratosis:0.917270 Benign keratosis:0.815556 Dermatofibroma:0.962398 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1076.0, 44.0, 28.0, 149.0, 4.0, 28.0]

TEST Student: Epoch: 31, iteration: 42

TEST AUROC: 0.863819, TEST Accus: 0.576779, TEST Senss: 0.811815, TEST Specs: 0.795555
AUROCs: Melanoma:0.848909 Melanocytic nevus:0.922346 Basal cell carcinoma:0.898831 Actinic keratosis:0.834062 Benign keratosis:0.888307 Dermatofibroma:0.657301 Vascular lesion:0.996976
Accus: Melanoma:0.575758 Melanocytic nevus:0.797628 Basal cell carcinoma:0.400000 Actinic keratosis:0.482759 Benign keratosis:0.696262 Dermatofibroma:0.181818 Vascular lesion:0.903226
Senss: Melanoma:0.900433 Melanocytic nevus:0.956264 Basal cell carcinoma:0.745455 Actinic keratosis:0.724138 Benign keratosis:0.901869 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.623879 Melanocytic nevus:0.597598 Basal cell carcinoma:0.915486 Actinic keratosis:0.865611 Benign keratosis:0.688506 Dermatofibroma:0.936779 Vascular lesion:0.941028
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_32.pth

Epoch: 32, iteration: 0/43, ==> train <===, loss: 3.566977, classification loss: 1.802958,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.133216,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028452,wcp loss: 0.000000,entropy loss: 1.868783,consistency weight: 1.000000, lr: 3.4336838202925156e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 466.0, 24.0, 23.0, 55.0, 5.0, 10.0]

VAL Student: Epoch: 32, iteration: 42

VAL AUROC: 0.846560, VAL Accus: 0.567155, VAL Senss: 0.654072, VAL Specs: 0.887654
AUROCs: Melanoma:0.817969 Melanocytic nevus:0.913947 Basal cell carcinoma:0.906487 Actinic keratosis:0.897810 Benign keratosis:0.852333 Dermatofibroma:0.677274 Vascular lesion:0.860102
Accus: Melanoma:0.596639 Melanocytic nevus:0.702866 Basal cell carcinoma:0.444444 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.838612 Basal cell carcinoma:0.574074 Actinic keratosis:0.757576 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.786606 Melanocytic nevus:0.816024 Basal cell carcinoma:0.934461 Actinic keratosis:0.907963 Benign keratosis:0.847778 Dermatofibroma:0.938008 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [145.0, 953.0, 60.0, 29.0, 127.0, 4.0, 30.0]

TEST Student: Epoch: 32, iteration: 42

TEST AUROC: 0.859720, TEST Accus: 0.588947, TEST Senss: 0.807967, TEST Specs: 0.807362
AUROCs: Melanoma:0.837609 Melanocytic nevus:0.924930 Basal cell carcinoma:0.898621 Actinic keratosis:0.834784 Benign keratosis:0.864092 Dermatofibroma:0.661269 Vascular lesion:0.996732
Accus: Melanoma:0.627706 Melanocytic nevus:0.706449 Basal cell carcinoma:0.545455 Actinic keratosis:0.500000 Benign keratosis:0.593458 Dermatofibroma:0.181818 Vascular lesion:0.967742
Senss: Melanoma:0.891775 Melanocytic nevus:0.908080 Basal cell carcinoma:0.845455 Actinic keratosis:0.724138 Benign keratosis:0.831776 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.608184 Melanocytic nevus:0.737237 Basal cell carcinoma:0.860367 Actinic keratosis:0.859479 Benign keratosis:0.734037 Dermatofibroma:0.908179 Vascular lesion:0.944052
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_33.pth

Epoch: 33, iteration: 0/43, ==> train <===, loss: 3.566278, classification loss: 1.811096,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.133733,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021840,wcp loss: 0.000000,entropy loss: 1.867075,consistency weight: 1.000000, lr: 3.090315438263264e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 513.0, 22.0, 22.0, 46.0, 5.0, 11.0]

VAL Student: Epoch: 33, iteration: 42

VAL AUROC: 0.853707, VAL Accus: 0.561928, VAL Senss: 0.664775, VAL Specs: 0.886546
AUROCs: Melanoma:0.826477 Melanocytic nevus:0.917711 Basal cell carcinoma:0.887558 Actinic keratosis:0.917458 Benign keratosis:0.841056 Dermatofibroma:0.703252 Vascular lesion:0.882437
Accus: Melanoma:0.579832 Melanocytic nevus:0.773756 Basal cell carcinoma:0.407407 Actinic keratosis:0.666667 Benign keratosis:0.460000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.747899 Melanocytic nevus:0.891403 Basal cell carcinoma:0.518519 Actinic keratosis:0.727273 Benign keratosis:0.660000 Dermatofibroma:0.375000 Vascular lesion:0.733333
Specs: Melanoma:0.794552 Melanocytic nevus:0.765579 Basal cell carcinoma:0.955603 Actinic keratosis:0.921406 Benign keratosis:0.873333 Dermatofibroma:0.916667 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [150.0, 1045.0, 54.0, 29.0, 121.0, 8.0, 29.0]

TEST Student: Epoch: 33, iteration: 42

TEST AUROC: 0.871261, TEST Accus: 0.611350, TEST Senss: 0.801085, TEST Specs: 0.788975
AUROCs: Melanoma:0.850732 Melanocytic nevus:0.921847 Basal cell carcinoma:0.905884 Actinic keratosis:0.862122 Benign keratosis:0.870181 Dermatofibroma:0.691055 Vascular lesion:0.997008
Accus: Melanoma:0.649351 Melanocytic nevus:0.774648 Basal cell carcinoma:0.490909 Actinic keratosis:0.500000 Benign keratosis:0.565421 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.900433 Melanocytic nevus:0.954040 Basal cell carcinoma:0.781818 Actinic keratosis:0.689655 Benign keratosis:0.827103 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.608744 Melanocytic nevus:0.597598 Basal cell carcinoma:0.887664 Actinic keratosis:0.888094 Benign keratosis:0.752360 Dermatofibroma:0.875564 Vascular lesion:0.912802
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_34.pth

Epoch: 34, iteration: 0/43, ==> train <===, loss: 3.579172, classification loss: 1.826009,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138205,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025323,wcp loss: 0.000000,entropy loss: 1.866045,consistency weight: 1.000000, lr: 2.7812838944369375e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 489.0, 28.0, 22.0, 54.0, 4.0, 10.0]

VAL Student: Epoch: 34, iteration: 42

VAL AUROC: 0.837619, VAL Accus: 0.560804, VAL Senss: 0.658090, VAL Specs: 0.885780
AUROCs: Melanoma:0.814993 Melanocytic nevus:0.912899 Basal cell carcinoma:0.927414 Actinic keratosis:0.886716 Benign keratosis:0.855222 Dermatofibroma:0.622840 Vascular lesion:0.843249
Accus: Melanoma:0.546218 Melanocytic nevus:0.737557 Basal cell carcinoma:0.518519 Actinic keratosis:0.666667 Benign keratosis:0.540000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.858220 Basal cell carcinoma:0.592593 Actinic keratosis:0.757576 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.772985 Melanocytic nevus:0.792285 Basal cell carcinoma:0.923890 Actinic keratosis:0.914168 Benign keratosis:0.837778 Dermatofibroma:0.966463 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1009.0, 69.0, 27.0, 129.0, 4.0, 24.0]

TEST Student: Epoch: 34, iteration: 42

TEST AUROC: 0.859348, TEST Accus: 0.574088, TEST Senss: 0.813455, TEST Specs: 0.801573
AUROCs: Melanoma:0.839007 Melanocytic nevus:0.922575 Basal cell carcinoma:0.912598 Actinic keratosis:0.835480 Benign keratosis:0.868775 Dermatofibroma:0.640400 Vascular lesion:0.996602
Accus: Melanoma:0.619048 Melanocytic nevus:0.747961 Basal cell carcinoma:0.627273 Actinic keratosis:0.465517 Benign keratosis:0.602804 Dermatofibroma:0.181818 Vascular lesion:0.774194
Senss: Melanoma:0.904762 Melanocytic nevus:0.928836 Basal cell carcinoma:0.890909 Actinic keratosis:0.724138 Benign keratosis:0.836449 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.589686 Melanocytic nevus:0.690691 Basal cell carcinoma:0.833596 Actinic keratosis:0.864078 Benign keratosis:0.722932 Dermatofibroma:0.944807 Vascular lesion:0.965222
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_35.pth

Epoch: 35, iteration: 0/43, ==> train <===, loss: 3.547453, classification loss: 1.805987,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139804,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016627,wcp loss: 0.000000,entropy loss: 1.864642,consistency weight: 1.000000, lr: 2.503155504993244e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 499.0, 21.0, 21.0, 51.0, 5.0, 11.0]

VAL Student: Epoch: 35, iteration: 42

VAL AUROC: 0.852107, VAL Accus: 0.562681, VAL Senss: 0.662115, VAL Specs: 0.884416
AUROCs: Melanoma:0.823701 Melanocytic nevus:0.917370 Basal cell carcinoma:0.876772 Actinic keratosis:0.886936 Benign keratosis:0.859689 Dermatofibroma:0.707762 Vascular lesion:0.892521
Accus: Melanoma:0.605042 Melanocytic nevus:0.752640 Basal cell carcinoma:0.388889 Actinic keratosis:0.636364 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.756303 Melanocytic nevus:0.886878 Basal cell carcinoma:0.518519 Actinic keratosis:0.727273 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.750284 Melanocytic nevus:0.765579 Basal cell carcinoma:0.951374 Actinic keratosis:0.933816 Benign keratosis:0.883333 Dermatofibroma:0.925813 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [155.0, 1040.0, 56.0, 25.0, 123.0, 7.0, 29.0]

TEST Student: Epoch: 35, iteration: 42

TEST AUROC: 0.868919, TEST Accus: 0.601499, TEST Senss: 0.801580, TEST Specs: 0.789491
AUROCs: Melanoma:0.846454 Melanocytic nevus:0.921182 Basal cell carcinoma:0.907927 Actinic keratosis:0.839647 Benign keratosis:0.876118 Dermatofibroma:0.693952 Vascular lesion:0.997155
Accus: Melanoma:0.670996 Melanocytic nevus:0.770941 Basal cell carcinoma:0.509091 Actinic keratosis:0.431034 Benign keratosis:0.574766 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.917749 Melanocytic nevus:0.951816 Basal cell carcinoma:0.800000 Actinic keratosis:0.655172 Benign keratosis:0.831776 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.559417 Melanocytic nevus:0.602102 Basal cell carcinoma:0.877690 Actinic keratosis:0.897803 Benign keratosis:0.761799 Dermatofibroma:0.887607 Vascular lesion:0.940020
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_36.pth

Epoch: 36, iteration: 0/43, ==> train <===, loss: 3.543603, classification loss: 1.788470,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.132396,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020089,wcp loss: 0.000000,entropy loss: 1.867440,consistency weight: 1.000000, lr: 2.2528399544939195e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 517.0, 20.0, 25.0, 48.0, 5.0, 11.0]

VAL Student: Epoch: 36, iteration: 42

VAL AUROC: 0.846156, VAL Accus: 0.557737, VAL Senss: 0.644569, VAL Specs: 0.887947
AUROCs: Melanoma:0.818197 Melanocytic nevus:0.913996 Basal cell carcinoma:0.861659 Actinic keratosis:0.927831 Benign keratosis:0.820644 Dermatofibroma:0.691629 Vascular lesion:0.889137
Accus: Melanoma:0.470588 Melanocytic nevus:0.779789 Basal cell carcinoma:0.370370 Actinic keratosis:0.757576 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.638655 Melanocytic nevus:0.877828 Basal cell carcinoma:0.481481 Actinic keratosis:0.818182 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.837684 Melanocytic nevus:0.762611 Basal cell carcinoma:0.955603 Actinic keratosis:0.902792 Benign keratosis:0.866667 Dermatofibroma:0.914634 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [125.0, 1058.0, 48.0, 35.0, 129.0, 8.0, 29.0]

TEST Student: Epoch: 36, iteration: 42

TEST AUROC: 0.869849, TEST Accus: 0.609592, TEST Senss: 0.804262, TEST Specs: 0.806418
AUROCs: Melanoma:0.840824 Melanocytic nevus:0.922139 Basal cell carcinoma:0.887425 Actinic keratosis:0.879072 Benign keratosis:0.864408 Dermatofibroma:0.697692 Vascular lesion:0.997382
Accus: Melanoma:0.541126 Melanocytic nevus:0.784285 Basal cell carcinoma:0.436364 Actinic keratosis:0.603448 Benign keratosis:0.602804 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.835498 Melanocytic nevus:0.939214 Basal cell carcinoma:0.736364 Actinic keratosis:0.810345 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.688341 Melanocytic nevus:0.662162 Basal cell carcinoma:0.891339 Actinic keratosis:0.864589 Benign keratosis:0.760689 Dermatofibroma:0.870547 Vascular lesion:0.907258
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_37.pth

Epoch: 37, iteration: 0/43, ==> train <===, loss: 3.554103, classification loss: 1.806749,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143586,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026321,wcp loss: 0.000000,entropy loss: 1.864619,consistency weight: 1.000000, lr: 2.0275559590445276e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 447.0, 26.0, 25.0, 62.0, 5.0, 10.0]

VAL Student: Epoch: 37, iteration: 42

VAL AUROC: 0.838950, VAL Accus: 0.571404, VAL Senss: 0.660831, VAL Specs: 0.881735
AUROCs: Melanoma:0.789430 Melanocytic nevus:0.901827 Basal cell carcinoma:0.916236 Actinic keratosis:0.911222 Benign keratosis:0.856811 Dermatofibroma:0.666667 Vascular lesion:0.830457
Accus: Melanoma:0.487395 Melanocytic nevus:0.674208 Basal cell carcinoma:0.481481 Actinic keratosis:0.757576 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.819005 Basal cell carcinoma:0.611111 Actinic keratosis:0.787879 Benign keratosis:0.790000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.813848 Melanocytic nevus:0.827893 Basal cell carcinoma:0.921776 Actinic keratosis:0.894519 Benign keratosis:0.805556 Dermatofibroma:0.922764 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [122.0, 929.0, 63.0, 36.0, 139.0, 5.0, 30.0]

TEST Student: Epoch: 37, iteration: 42

TEST AUROC: 0.853311, TEST Accus: 0.607823, TEST Senss: 0.803267, TEST Specs: 0.800769
AUROCs: Melanoma:0.806838 Melanocytic nevus:0.920627 Basal cell carcinoma:0.898249 Actinic keratosis:0.854624 Benign keratosis:0.865800 Dermatofibroma:0.630616 Vascular lesion:0.996423
Accus: Melanoma:0.528139 Melanocytic nevus:0.688658 Basal cell carcinoma:0.572727 Actinic keratosis:0.620690 Benign keratosis:0.649533 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.805195 Melanocytic nevus:0.896961 Basal cell carcinoma:0.872727 Actinic keratosis:0.793103 Benign keratosis:0.845794 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.649664 Melanocytic nevus:0.761261 Basal cell carcinoma:0.822047 Actinic keratosis:0.841594 Benign keratosis:0.689617 Dermatofibroma:0.896136 Vascular lesion:0.945060
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_38.pth

Epoch: 38, iteration: 0/43, ==> train <===, loss: 3.555228, classification loss: 1.807177,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140603,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018258,wcp loss: 0.000000,entropy loss: 1.870396,consistency weight: 1.000000, lr: 1.824800363140075e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 448.0, 32.0, 22.0, 65.0, 5.0, 10.0]

VAL Student: Epoch: 38, iteration: 42

VAL AUROC: 0.831137, VAL Accus: 0.575190, VAL Senss: 0.664323, VAL Specs: 0.881416
AUROCs: Melanoma:0.794752 Melanocytic nevus:0.903550 Basal cell carcinoma:0.928843 Actinic keratosis:0.876312 Benign keratosis:0.857067 Dermatofibroma:0.634083 Vascular lesion:0.823350
Accus: Melanoma:0.462185 Melanocytic nevus:0.675716 Basal cell carcinoma:0.592593 Actinic keratosis:0.666667 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.811463 Basal cell carcinoma:0.703704 Actinic keratosis:0.727273 Benign keratosis:0.790000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.809308 Melanocytic nevus:0.830861 Basal cell carcinoma:0.901691 Actinic keratosis:0.914168 Benign keratosis:0.791111 Dermatofibroma:0.934959 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [115.0, 934.0, 73.0, 28.0, 142.0, 5.0, 28.0]

TEST Student: Epoch: 38, iteration: 42

TEST AUROC: 0.847838, TEST Accus: 0.590092, TEST Senss: 0.809454, TEST Specs: 0.792248
AUROCs: Melanoma:0.810266 Melanocytic nevus:0.920114 Basal cell carcinoma:0.911024 Actinic keratosis:0.819340 Benign keratosis:0.861852 Dermatofibroma:0.616088 Vascular lesion:0.996179
Accus: Melanoma:0.497835 Melanocytic nevus:0.692365 Basal cell carcinoma:0.663636 Actinic keratosis:0.482759 Benign keratosis:0.663551 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.822511 Melanocytic nevus:0.905856 Basal cell carcinoma:0.918182 Actinic keratosis:0.741379 Benign keratosis:0.869159 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.633408 Melanocytic nevus:0.740240 Basal cell carcinoma:0.793176 Actinic keratosis:0.847215 Benign keratosis:0.672404 Dermatofibroma:0.907175 Vascular lesion:0.952117
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_39.pth

Epoch: 39, iteration: 0/43, ==> train <===, loss: 3.583142, classification loss: 1.822996,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138242,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030269,wcp loss: 0.000000,entropy loss: 1.868119,consistency weight: 1.000000, lr: 1.6423203268260674e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 467.0, 32.0, 21.0, 58.0, 4.0, 11.0]

VAL Student: Epoch: 39, iteration: 42

VAL AUROC: 0.843114, VAL Accus: 0.583557, VAL Senss: 0.676377, VAL Specs: 0.885207
AUROCs: Melanoma:0.818627 Melanocytic nevus:0.912767 Basal cell carcinoma:0.911616 Actinic keratosis:0.896211 Benign keratosis:0.863311 Dermatofibroma:0.620617 Vascular lesion:0.878646
Accus: Melanoma:0.588235 Melanocytic nevus:0.704374 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.580000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Senss: Melanoma:0.697479 Melanocytic nevus:0.849170 Basal cell carcinoma:0.685185 Actinic keratosis:0.696970 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.787741 Melanocytic nevus:0.804154 Basal cell carcinoma:0.915433 Actinic keratosis:0.935884 Benign keratosis:0.823333 Dermatofibroma:0.955285 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 965.0, 67.0, 24.0, 134.0, 4.0, 30.0]

TEST Student: Epoch: 39, iteration: 42

TEST AUROC: 0.857709, TEST Accus: 0.587956, TEST Senss: 0.806118, TEST Specs: 0.803607
AUROCs: Melanoma:0.836330 Melanocytic nevus:0.923830 Basal cell carcinoma:0.910236 Actinic keratosis:0.836370 Benign keratosis:0.870674 Dermatofibroma:0.630069 Vascular lesion:0.996456
Accus: Melanoma:0.601732 Melanocytic nevus:0.715345 Basal cell carcinoma:0.609091 Actinic keratosis:0.413793 Benign keratosis:0.626168 Dermatofibroma:0.181818 Vascular lesion:0.967742
Senss: Melanoma:0.896104 Melanocytic nevus:0.914752 Basal cell carcinoma:0.900000 Actinic keratosis:0.672414 Benign keratosis:0.850467 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.611547 Melanocytic nevus:0.717718 Basal cell carcinoma:0.828871 Actinic keratosis:0.905979 Benign keratosis:0.714048 Dermatofibroma:0.930758 Vascular lesion:0.916331
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_40.pth

Epoch: 40, iteration: 0/43, ==> train <===, loss: 3.531393, classification loss: 1.788978,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143307,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021323,wcp loss: 0.000000,entropy loss: 1.864399,consistency weight: 1.000000, lr: 1.4780882941434607e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 532.0, 25.0, 25.0, 41.0, 5.0, 11.0]

VAL Student: Epoch: 40, iteration: 42

VAL AUROC: 0.846216, VAL Accus: 0.568998, VAL Senss: 0.657588, VAL Specs: 0.884454
AUROCs: Melanoma:0.810805 Melanocytic nevus:0.915468 Basal cell carcinoma:0.890533 Actinic keratosis:0.922566 Benign keratosis:0.826267 Dermatofibroma:0.684705 Vascular lesion:0.873164
Accus: Melanoma:0.504202 Melanocytic nevus:0.802413 Basal cell carcinoma:0.462963 Actinic keratosis:0.757576 Benign keratosis:0.410000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.647059 Melanocytic nevus:0.906486 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.834279 Melanocytic nevus:0.727003 Basal cell carcinoma:0.935518 Actinic keratosis:0.905895 Benign keratosis:0.891111 Dermatofibroma:0.912602 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 1101.0, 63.0, 34.0, 119.0, 7.0, 28.0]

TEST Student: Epoch: 40, iteration: 42

TEST AUROC: 0.867190, TEST Accus: 0.610294, TEST Senss: 0.809388, TEST Specs: 0.794981
AUROCs: Melanoma:0.835432 Melanocytic nevus:0.918803 Basal cell carcinoma:0.905598 Actinic keratosis:0.871276 Benign keratosis:0.856915 Dermatofibroma:0.684601 Vascular lesion:0.997707
Accus: Melanoma:0.519481 Melanocytic nevus:0.816160 Basal cell carcinoma:0.572727 Actinic keratosis:0.586207 Benign keratosis:0.556075 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.848485 Melanocytic nevus:0.957005 Basal cell carcinoma:0.818182 Actinic keratosis:0.793103 Benign keratosis:0.794393 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.669283 Melanocytic nevus:0.575075 Basal cell carcinoma:0.867192 Actinic keratosis:0.866633 Benign keratosis:0.769572 Dermatofibroma:0.872052 Vascular lesion:0.945060
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_41.pth

Epoch: 41, iteration: 0/43, ==> train <===, loss: 3.528811, classification loss: 1.791665,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143736,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018601,wcp loss: 0.000000,entropy loss: 1.862280,consistency weight: 1.000000, lr: 1.3302794647291146e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [48.0, 551.0, 30.0, 27.0, 33.0, 4.0, 10.0]

VAL Student: Epoch: 41, iteration: 42

VAL AUROC: 0.837469, VAL Accus: 0.550691, VAL Senss: 0.640683, VAL Specs: 0.881759
AUROCs: Melanoma:0.805406 Melanocytic nevus:0.913177 Basal cell carcinoma:0.922813 Actinic keratosis:0.932061 Benign keratosis:0.798267 Dermatofibroma:0.623349 Vascular lesion:0.867208
Accus: Melanoma:0.403361 Melanocytic nevus:0.831071 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.330000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.613445 Melanocytic nevus:0.915535 Basal cell carcinoma:0.648148 Actinic keratosis:0.848485 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.846765 Melanocytic nevus:0.667656 Basal cell carcinoma:0.904863 Actinic keratosis:0.905895 Benign keratosis:0.923333 Dermatofibroma:0.943089 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [107.0, 1140.0, 72.0, 32.0, 102.0, 6.0, 29.0]

TEST Student: Epoch: 41, iteration: 42

TEST AUROC: 0.867780, TEST Accus: 0.599913, TEST Senss: 0.816761, TEST Specs: 0.798526
AUROCs: Melanoma:0.836471 Melanocytic nevus:0.916672 Basal cell carcinoma:0.905555 Actinic keratosis:0.897036 Benign keratosis:0.838223 Dermatofibroma:0.682845 Vascular lesion:0.997659
Accus: Melanoma:0.463203 Melanocytic nevus:0.845070 Basal cell carcinoma:0.654545 Actinic keratosis:0.551724 Benign keratosis:0.476636 Dermatofibroma:0.272727 Vascular lesion:0.935484
Senss: Melanoma:0.822511 Melanocytic nevus:0.959229 Basal cell carcinoma:0.918182 Actinic keratosis:0.793103 Benign keratosis:0.724299 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.704036 Melanocytic nevus:0.527027 Basal cell carcinoma:0.810499 Actinic keratosis:0.871742 Benign keratosis:0.820655 Dermatofibroma:0.916708 Vascular lesion:0.939012
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_42.pth

Epoch: 42, iteration: 0/43, ==> train <===, loss: 3.537181, classification loss: 1.789474,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139333,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021746,wcp loss: 0.000000,entropy loss: 1.865294,consistency weight: 1.000000, lr: 1.1972515182562032e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [73.0, 440.0, 27.0, 23.0, 56.0, 4.0, 10.0]

VAL Student: Epoch: 42, iteration: 42

VAL AUROC: 0.831428, VAL Accus: 0.564390, VAL Senss: 0.672676, VAL Specs: 0.881018
AUROCs: Melanoma:0.807982 Melanocytic nevus:0.907220 Basal cell carcinoma:0.908073 Actinic keratosis:0.907023 Benign keratosis:0.855278 Dermatofibroma:0.595910 Vascular lesion:0.838511
Accus: Melanoma:0.613445 Melanocytic nevus:0.663650 Basal cell carcinoma:0.500000 Actinic keratosis:0.696970 Benign keratosis:0.560000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.773109 Melanocytic nevus:0.815988 Basal cell carcinoma:0.592593 Actinic keratosis:0.787879 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.736663 Melanocytic nevus:0.833828 Basal cell carcinoma:0.921776 Actinic keratosis:0.901758 Benign keratosis:0.830000 Dermatofibroma:0.954268 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [149.0, 910.0, 64.0, 30.0, 128.0, 4.0, 26.0]

TEST Student: Epoch: 42, iteration: 42

TEST AUROC: 0.855745, TEST Accus: 0.576759, TEST Senss: 0.807028, TEST Specs: 0.804124
AUROCs: Melanoma:0.830048 Melanocytic nevus:0.923597 Basal cell carcinoma:0.903517 Actinic keratosis:0.862950 Benign keratosis:0.863897 Dermatofibroma:0.609520 Vascular lesion:0.996683
Accus: Melanoma:0.645022 Melanocytic nevus:0.674574 Basal cell carcinoma:0.581818 Actinic keratosis:0.517241 Benign keratosis:0.598131 Dermatofibroma:0.181818 Vascular lesion:0.838710
Senss: Melanoma:0.904762 Melanocytic nevus:0.899926 Basal cell carcinoma:0.854545 Actinic keratosis:0.775862 Benign keratosis:0.850467 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.540919 Melanocytic nevus:0.767267 Basal cell carcinoma:0.844094 Actinic keratosis:0.858968 Benign keratosis:0.720155 Dermatofibroma:0.936277 Vascular lesion:0.961190
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_43.pth

Epoch: 43, iteration: 0/43, ==> train <===, loss: 3.536978, classification loss: 1.788330,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141892,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026075,wcp loss: 0.000000,entropy loss: 1.864465,consistency weight: 1.000000, lr: 1.0775263664305828e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 491.0, 28.0, 28.0, 36.0, 5.0, 10.0]

VAL Student: Epoch: 43, iteration: 42

VAL AUROC: 0.843348, VAL Accus: 0.566822, VAL Senss: 0.634991, VAL Specs: 0.883466
AUROCs: Melanoma:0.798291 Melanocytic nevus:0.908133 Basal cell carcinoma:0.914709 Actinic keratosis:0.928771 Benign keratosis:0.798533 Dermatofibroma:0.679942 Vascular lesion:0.875059
Accus: Melanoma:0.521008 Melanocytic nevus:0.740573 Basal cell carcinoma:0.518519 Actinic keratosis:0.848485 Benign keratosis:0.360000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.864253 Basal cell carcinoma:0.574074 Actinic keratosis:0.878788 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.832009 Melanocytic nevus:0.768546 Basal cell carcinoma:0.916490 Actinic keratosis:0.875905 Benign keratosis:0.912222 Dermatofibroma:0.900407 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 1036.0, 69.0, 36.0, 104.0, 8.0, 30.0]

TEST Student: Epoch: 43, iteration: 42

TEST AUROC: 0.864740, TEST Accus: 0.626773, TEST Senss: 0.814507, TEST Specs: 0.799631
AUROCs: Melanoma:0.825918 Melanocytic nevus:0.917321 Basal cell carcinoma:0.902276 Actinic keratosis:0.889380 Benign keratosis:0.832889 Dermatofibroma:0.688273 Vascular lesion:0.997122
Accus: Melanoma:0.554113 Melanocytic nevus:0.767976 Basal cell carcinoma:0.627273 Actinic keratosis:0.620690 Benign keratosis:0.485981 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.822511 Melanocytic nevus:0.939214 Basal cell carcinoma:0.881818 Actinic keratosis:0.810345 Benign keratosis:0.747664 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.685538 Melanocytic nevus:0.650150 Basal cell carcinoma:0.822572 Actinic keratosis:0.826265 Benign keratosis:0.812882 Dermatofibroma:0.865028 Vascular lesion:0.934980
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_44.pth

Epoch: 44, iteration: 0/43, ==> train <===, loss: 3.542204, classification loss: 1.796878,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142476,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021588,wcp loss: 0.000000,entropy loss: 1.866214,consistency weight: 1.000000, lr: 9.697737297875246e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 457.0, 26.0, 24.0, 46.0, 5.0, 10.0]

VAL Student: Epoch: 44, iteration: 42

VAL AUROC: 0.850166, VAL Accus: 0.567981, VAL Senss: 0.656036, VAL Specs: 0.879347
AUROCs: Melanoma:0.820811 Melanocytic nevus:0.914443 Basal cell carcinoma:0.916099 Actinic keratosis:0.928395 Benign keratosis:0.829244 Dermatofibroma:0.659870 Vascular lesion:0.882301
Accus: Melanoma:0.638655 Melanocytic nevus:0.689291 Basal cell carcinoma:0.481481 Actinic keratosis:0.727273 Benign keratosis:0.460000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.781513 Melanocytic nevus:0.846154 Basal cell carcinoma:0.648148 Actinic keratosis:0.727273 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.745743 Melanocytic nevus:0.801187 Basal cell carcinoma:0.930233 Actinic keratosis:0.908997 Benign keratosis:0.892222 Dermatofibroma:0.894309 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [154.0, 947.0, 64.0, 30.0, 110.0, 8.0, 30.0]

TEST Student: Epoch: 44, iteration: 42

TEST AUROC: 0.865042, TEST Accus: 0.616161, TEST Senss: 0.819280, TEST Specs: 0.794440
AUROCs: Melanoma:0.840875 Melanocytic nevus:0.921658 Basal cell carcinoma:0.911458 Actinic keratosis:0.871002 Benign keratosis:0.857164 Dermatofibroma:0.655932 Vascular lesion:0.997203
Accus: Melanoma:0.666667 Melanocytic nevus:0.702001 Basal cell carcinoma:0.581818 Actinic keratosis:0.517241 Benign keratosis:0.514019 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.917749 Melanocytic nevus:0.922906 Basal cell carcinoma:0.872727 Actinic keratosis:0.758621 Benign keratosis:0.808411 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.558296 Melanocytic nevus:0.702703 Basal cell carcinoma:0.852493 Actinic keratosis:0.864589 Benign keratosis:0.783454 Dermatofibroma:0.855494 Vascular lesion:0.944052
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_45.pth

Epoch: 45, iteration: 0/43, ==> train <===, loss: 3.559148, classification loss: 1.814316,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144692,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023851,wcp loss: 0.000000,entropy loss: 1.865673,consistency weight: 1.000000, lr: 8.727963568087721e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 525.0, 26.0, 21.0, 58.0, 5.0, 10.0]

VAL Student: Epoch: 45, iteration: 42

VAL AUROC: 0.843596, VAL Accus: 0.566381, VAL Senss: 0.658088, VAL Specs: 0.883581
AUROCs: Melanoma:0.821688 Melanocytic nevus:0.915482 Basal cell carcinoma:0.906703 Actinic keratosis:0.907555 Benign keratosis:0.850911 Dermatofibroma:0.612678 Vascular lesion:0.890152
Accus: Melanoma:0.495798 Melanocytic nevus:0.791855 Basal cell carcinoma:0.481481 Actinic keratosis:0.636364 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.883861 Basal cell carcinoma:0.592593 Actinic keratosis:0.727273 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.833144 Melanocytic nevus:0.744807 Basal cell carcinoma:0.938689 Actinic keratosis:0.929679 Benign keratosis:0.832222 Dermatofibroma:0.924797 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1085.0, 64.0, 29.0, 136.0, 7.0, 29.0]

TEST Student: Epoch: 45, iteration: 42

TEST AUROC: 0.867111, TEST Accus: 0.617869, TEST Senss: 0.805212, TEST Specs: 0.803897
AUROCs: Melanoma:0.847910 Melanocytic nevus:0.922009 Basal cell carcinoma:0.912627 Actinic keratosis:0.852563 Benign keratosis:0.879306 Dermatofibroma:0.657688 Vascular lesion:0.997675
Accus: Melanoma:0.549784 Melanocytic nevus:0.804299 Basal cell carcinoma:0.581818 Actinic keratosis:0.500000 Benign keratosis:0.635514 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.857143 Melanocytic nevus:0.947368 Basal cell carcinoma:0.854545 Actinic keratosis:0.672414 Benign keratosis:0.850467 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.679372 Melanocytic nevus:0.639640 Basal cell carcinoma:0.868241 Actinic keratosis:0.892693 Benign keratosis:0.715713 Dermatofibroma:0.895635 Vascular lesion:0.935988
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_46.pth

Epoch: 46, iteration: 0/43, ==> train <===, loss: 3.549104, classification loss: 1.800174,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140244,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022661,wcp loss: 0.000000,entropy loss: 1.866514,consistency weight: 1.000000, lr: 7.855167211278949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 481.0, 25.0, 25.0, 55.0, 5.0, 10.0]

VAL Student: Epoch: 46, iteration: 42

VAL AUROC: 0.834498, VAL Accus: 0.572087, VAL Senss: 0.652697, VAL Specs: 0.881085
AUROCs: Melanoma:0.803251 Melanocytic nevus:0.912546 Basal cell carcinoma:0.911127 Actinic keratosis:0.921124 Benign keratosis:0.841911 Dermatofibroma:0.642658 Vascular lesion:0.808866
Accus: Melanoma:0.529412 Melanocytic nevus:0.725490 Basal cell carcinoma:0.462963 Actinic keratosis:0.757576 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.838612 Basal cell carcinoma:0.555556 Actinic keratosis:0.848485 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.799092 Melanocytic nevus:0.795252 Basal cell carcinoma:0.926004 Actinic keratosis:0.881075 Benign keratosis:0.832222 Dermatofibroma:0.940041 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 985.0, 64.0, 38.0, 126.0, 5.0, 23.0]

TEST Student: Epoch: 46, iteration: 42

TEST AUROC: 0.859882, TEST Accus: 0.585226, TEST Senss: 0.824658, TEST Specs: 0.795596
AUROCs: Melanoma:0.822637 Melanocytic nevus:0.920534 Basal cell carcinoma:0.906481 Actinic keratosis:0.877513 Benign keratosis:0.849090 Dermatofibroma:0.646125 Vascular lesion:0.996797
Accus: Melanoma:0.571429 Melanocytic nevus:0.730170 Basal cell carcinoma:0.581818 Actinic keratosis:0.655172 Benign keratosis:0.588785 Dermatofibroma:0.227273 Vascular lesion:0.741935
Senss: Melanoma:0.870130 Melanocytic nevus:0.925871 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.831776 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.617152 Melanocytic nevus:0.687688 Basal cell carcinoma:0.843045 Actinic keratosis:0.816556 Benign keratosis:0.721266 Dermatofibroma:0.912193 Vascular lesion:0.971270
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_47.pth

Epoch: 47, iteration: 0/43, ==> train <===, loss: 3.563892, classification loss: 1.801868,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137977,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032509,wcp loss: 0.000000,entropy loss: 1.867493,consistency weight: 1.000000, lr: 7.069650490151055e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 475.0, 26.0, 22.0, 52.0, 5.0, 10.0]

VAL Student: Epoch: 47, iteration: 42

VAL AUROC: 0.845967, VAL Accus: 0.565771, VAL Senss: 0.654437, VAL Specs: 0.882073
AUROCs: Melanoma:0.824207 Melanocytic nevus:0.915227 Basal cell carcinoma:0.903179 Actinic keratosis:0.890727 Benign keratosis:0.843289 Dermatofibroma:0.668318 Vascular lesion:0.876819
Accus: Melanoma:0.596639 Melanocytic nevus:0.716440 Basal cell carcinoma:0.481481 Actinic keratosis:0.666667 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.731092 Melanocytic nevus:0.861237 Basal cell carcinoma:0.592593 Actinic keratosis:0.696970 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.767310 Melanocytic nevus:0.801187 Basal cell carcinoma:0.933404 Actinic keratosis:0.924509 Benign keratosis:0.846667 Dermatofibroma:0.915650 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 984.0, 66.0, 24.0, 129.0, 5.0, 28.0]

TEST Student: Epoch: 47, iteration: 42

TEST AUROC: 0.863920, TEST Accus: 0.587555, TEST Senss: 0.805263, TEST Specs: 0.799059
AUROCs: Melanoma:0.844658 Melanocytic nevus:0.921566 Basal cell carcinoma:0.911129 Actinic keratosis:0.846325 Benign keratosis:0.868689 Dermatofibroma:0.658144 Vascular lesion:0.996927
Accus: Melanoma:0.636364 Melanocytic nevus:0.729429 Basal cell carcinoma:0.600000 Actinic keratosis:0.413793 Benign keratosis:0.602804 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.913420 Melanocytic nevus:0.923647 Basal cell carcinoma:0.836364 Actinic keratosis:0.672414 Benign keratosis:0.836449 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.583520 Melanocytic nevus:0.696697 Basal cell carcinoma:0.862992 Actinic keratosis:0.886050 Benign keratosis:0.733481 Dermatofibroma:0.882589 Vascular lesion:0.948085
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_48.pth

Epoch: 48, iteration: 0/43, ==> train <===, loss: 3.567979, classification loss: 1.818957,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139287,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018334,wcp loss: 0.000000,entropy loss: 1.869974,consistency weight: 1.000000, lr: 6.362685441135949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 490.0, 26.0, 21.0, 66.0, 4.0, 10.0]

VAL Student: Epoch: 48, iteration: 42

VAL AUROC: 0.830185, VAL Accus: 0.576946, VAL Senss: 0.689486, VAL Specs: 0.878332
AUROCs: Melanoma:0.824197 Melanocytic nevus:0.918870 Basal cell carcinoma:0.881313 Actinic keratosis:0.856821 Benign keratosis:0.875878 Dermatofibroma:0.601562 Vascular lesion:0.852657
Accus: Melanoma:0.605042 Melanocytic nevus:0.739065 Basal cell carcinoma:0.481481 Actinic keratosis:0.636364 Benign keratosis:0.660000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.747899 Melanocytic nevus:0.879336 Basal cell carcinoma:0.666667 Actinic keratosis:0.666667 Benign keratosis:0.820000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.734393 Melanocytic nevus:0.771513 Basal cell carcinoma:0.937632 Actinic keratosis:0.949328 Benign keratosis:0.790000 Dermatofibroma:0.973577 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [149.0, 1014.0, 55.0, 20.0, 145.0, 3.0, 25.0]

TEST Student: Epoch: 48, iteration: 42

TEST AUROC: 0.856844, TEST Accus: 0.551700, TEST Senss: 0.788255, TEST Specs: 0.792693
AUROCs: Melanoma:0.843886 Melanocytic nevus:0.920209 Basal cell carcinoma:0.908766 Actinic keratosis:0.821155 Benign keratosis:0.883549 Dermatofibroma:0.623500 Vascular lesion:0.996846
Accus: Melanoma:0.645022 Melanocytic nevus:0.751668 Basal cell carcinoma:0.500000 Actinic keratosis:0.344828 Benign keratosis:0.677570 Dermatofibroma:0.136364 Vascular lesion:0.806452
Senss: Melanoma:0.935065 Melanocytic nevus:0.942921 Basal cell carcinoma:0.827273 Actinic keratosis:0.637931 Benign keratosis:0.901869 Dermatofibroma:0.272727 Vascular lesion:1.000000
Specs: Melanoma:0.528587 Melanocytic nevus:0.638138 Basal cell carcinoma:0.873491 Actinic keratosis:0.920286 Benign keratosis:0.666297 Dermatofibroma:0.960361 Vascular lesion:0.961694
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_49.pth

Epoch: 49, iteration: 0/43, ==> train <===, loss: 3.562776, classification loss: 1.800871,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139696,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.034657,wcp loss: 0.000000,entropy loss: 1.866943,consistency weight: 1.000000, lr: 5.726416897022355e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 460.0, 21.0, 22.0, 63.0, 5.0, 11.0]

VAL Student: Epoch: 49, iteration: 42

VAL AUROC: 0.843070, VAL Accus: 0.561344, VAL Senss: 0.665596, VAL Specs: 0.882103
AUROCs: Melanoma:0.820792 Melanocytic nevus:0.909565 Basal cell carcinoma:0.879316 Actinic keratosis:0.916831 Benign keratosis:0.854922 Dermatofibroma:0.651296 Vascular lesion:0.868765
Accus: Melanoma:0.504202 Melanocytic nevus:0.693816 Basal cell carcinoma:0.388889 Actinic keratosis:0.666667 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.672269 Melanocytic nevus:0.846154 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.814983 Melanocytic nevus:0.807122 Basal cell carcinoma:0.950317 Actinic keratosis:0.912099 Benign keratosis:0.811111 Dermatofibroma:0.900407 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 967.0, 49.0, 35.0, 146.0, 5.0, 30.0]

TEST Student: Epoch: 49, iteration: 42

TEST AUROC: 0.862005, TEST Accus: 0.600204, TEST Senss: 0.808392, TEST Specs: 0.809602
AUROCs: Melanoma:0.838305 Melanocytic nevus:0.920921 Basal cell carcinoma:0.905731 Actinic keratosis:0.864307 Benign keratosis:0.871237 Dermatofibroma:0.636364 Vascular lesion:0.997171
Accus: Melanoma:0.558442 Melanocytic nevus:0.716827 Basal cell carcinoma:0.445455 Actinic keratosis:0.603448 Benign keratosis:0.682243 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.865801 Melanocytic nevus:0.908080 Basal cell carcinoma:0.772727 Actinic keratosis:0.793103 Benign keratosis:0.864486 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.659193 Melanocytic nevus:0.735736 Basal cell carcinoma:0.895013 Actinic keratosis:0.878385 Benign keratosis:0.697390 Dermatofibroma:0.870045 Vascular lesion:0.931452
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_50.pth

Epoch: 50, iteration: 0/43, ==> train <===, loss: 3.551530, classification loss: 1.799497,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.135382,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023078,wcp loss: 0.000000,entropy loss: 1.864337,consistency weight: 1.000000, lr: 5.15377520732012e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 520.0, 18.0, 27.0, 36.0, 5.0, 10.0]

VAL Student: Epoch: 50, iteration: 42

VAL AUROC: 0.844247, VAL Accus: 0.539885, VAL Senss: 0.640671, VAL Specs: 0.883382
AUROCs: Melanoma:0.813743 Melanocytic nevus:0.913911 Basal cell carcinoma:0.886070 Actinic keratosis:0.944408 Benign keratosis:0.813467 Dermatofibroma:0.685340 Vascular lesion:0.852792
Accus: Melanoma:0.504202 Melanocytic nevus:0.784314 Basal cell carcinoma:0.333333 Actinic keratosis:0.818182 Benign keratosis:0.360000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.672269 Melanocytic nevus:0.897436 Basal cell carcinoma:0.537037 Actinic keratosis:0.878788 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.808173 Melanocytic nevus:0.738872 Basal cell carcinoma:0.940803 Actinic keratosis:0.867632 Benign keratosis:0.927778 Dermatofibroma:0.909553 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1087.0, 52.0, 39.0, 100.0, 6.0, 27.0]

TEST Student: Epoch: 50, iteration: 42

TEST AUROC: 0.873249, TEST Accus: 0.591095, TEST Senss: 0.823416, TEST Specs: 0.796558
AUROCs: Melanoma:0.837483 Melanocytic nevus:0.919921 Basal cell carcinoma:0.894598 Actinic keratosis:0.918040 Benign keratosis:0.846919 Dermatofibroma:0.697783 Vascular lesion:0.998000
Accus: Melanoma:0.575758 Melanocytic nevus:0.805782 Basal cell carcinoma:0.472727 Actinic keratosis:0.672414 Benign keratosis:0.467290 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.870130 Melanocytic nevus:0.953299 Basal cell carcinoma:0.818182 Actinic keratosis:0.879310 Benign keratosis:0.742991 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.633969 Melanocytic nevus:0.596096 Basal cell carcinoma:0.870341 Actinic keratosis:0.813490 Benign keratosis:0.821210 Dermatofibroma:0.872052 Vascular lesion:0.968750
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_51.pth

Epoch: 51, iteration: 0/43, ==> train <===, loss: 3.536500, classification loss: 1.792748,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139902,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021112,wcp loss: 0.000000,entropy loss: 1.862542,consistency weight: 1.000000, lr: 4.638397686588108e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 495.0, 23.0, 27.0, 38.0, 5.0, 10.0]

VAL Student: Epoch: 51, iteration: 42

VAL AUROC: 0.840291, VAL Accus: 0.555385, VAL Senss: 0.650103, VAL Specs: 0.884683
AUROCs: Melanoma:0.811282 Melanocytic nevus:0.912385 Basal cell carcinoma:0.888674 Actinic keratosis:0.929617 Benign keratosis:0.815978 Dermatofibroma:0.673209 Vascular lesion:0.850897
Accus: Melanoma:0.537815 Melanocytic nevus:0.746606 Basal cell carcinoma:0.425926 Actinic keratosis:0.818182 Benign keratosis:0.380000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.859729 Basal cell carcinoma:0.555556 Actinic keratosis:0.878788 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.793417 Melanocytic nevus:0.789318 Basal cell carcinoma:0.935518 Actinic keratosis:0.877973 Benign keratosis:0.902222 Dermatofibroma:0.916667 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1012.0, 56.0, 40.0, 110.0, 7.0, 29.0]

TEST Student: Epoch: 51, iteration: 42

TEST AUROC: 0.866782, TEST Accus: 0.616907, TEST Senss: 0.809536, TEST Specs: 0.808183
AUROCs: Melanoma:0.836982 Melanocytic nevus:0.919906 Basal cell carcinoma:0.897700 Actinic keratosis:0.889812 Benign keratosis:0.850501 Dermatofibroma:0.675387 Vascular lesion:0.997187
Accus: Melanoma:0.601732 Melanocytic nevus:0.750185 Basal cell carcinoma:0.509091 Actinic keratosis:0.689655 Benign keratosis:0.514019 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.865801 Melanocytic nevus:0.934025 Basal cell carcinoma:0.809091 Actinic keratosis:0.827586 Benign keratosis:0.775701 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.642937 Melanocytic nevus:0.680180 Basal cell carcinoma:0.866667 Actinic keratosis:0.840061 Benign keratosis:0.802332 Dermatofibroma:0.888610 Vascular lesion:0.936492
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_52.pth

Epoch: 52, iteration: 0/43, ==> train <===, loss: 3.538401, classification loss: 1.788899,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142404,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031436,wcp loss: 0.000000,entropy loss: 1.860470,consistency weight: 1.000000, lr: 4.1745579179292974e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 464.0, 29.0, 24.0, 59.0, 5.0, 10.0]

VAL Student: Epoch: 52, iteration: 42

VAL AUROC: 0.840565, VAL Accus: 0.576790, VAL Senss: 0.663468, VAL Specs: 0.884044
AUROCs: Melanoma:0.808153 Melanocytic nevus:0.907036 Basal cell carcinoma:0.926239 Actinic keratosis:0.909122 Benign keratosis:0.836022 Dermatofibroma:0.639990 Vascular lesion:0.857394
Accus: Melanoma:0.504202 Melanocytic nevus:0.699849 Basal cell carcinoma:0.537037 Actinic keratosis:0.727273 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.822021 Basal cell carcinoma:0.648148 Actinic keratosis:0.787879 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.822928 Melanocytic nevus:0.818991 Basal cell carcinoma:0.917548 Actinic keratosis:0.902792 Benign keratosis:0.814444 Dermatofibroma:0.926829 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 954.0, 72.0, 32.0, 133.0, 5.0, 28.0]

TEST Student: Epoch: 52, iteration: 42

TEST AUROC: 0.855597, TEST Accus: 0.601558, TEST Senss: 0.813510, TEST Specs: 0.808582
AUROCs: Melanoma:0.828373 Melanocytic nevus:0.920481 Basal cell carcinoma:0.912589 Actinic keratosis:0.850043 Benign keratosis:0.859087 Dermatofibroma:0.622246 Vascular lesion:0.996358
Accus: Melanoma:0.545455 Melanocytic nevus:0.707191 Basal cell carcinoma:0.654545 Actinic keratosis:0.551724 Benign keratosis:0.621495 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.852814 Melanocytic nevus:0.898443 Basal cell carcinoma:0.900000 Actinic keratosis:0.793103 Benign keratosis:0.841121 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.672646 Melanocytic nevus:0.765766 Basal cell carcinoma:0.827297 Actinic keratosis:0.846704 Benign keratosis:0.702943 Dermatofibroma:0.897642 Vascular lesion:0.947077
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_53.pth

Epoch: 53, iteration: 0/43, ==> train <===, loss: 3.543547, classification loss: 1.791172,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.132895,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021119,wcp loss: 0.000000,entropy loss: 1.864151,consistency weight: 1.000000, lr: 3.7571021261363677e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 450.0, 28.0, 24.0, 62.0, 5.0, 10.0]

VAL Student: Epoch: 53, iteration: 42

VAL AUROC: 0.833223, VAL Accus: 0.577814, VAL Senss: 0.669521, VAL Specs: 0.880778
AUROCs: Melanoma:0.789630 Melanocytic nevus:0.905873 Basal cell carcinoma:0.929058 Actinic keratosis:0.912695 Benign keratosis:0.860789 Dermatofibroma:0.601626 Vascular lesion:0.832893
Accus: Melanoma:0.521008 Melanocytic nevus:0.678733 Basal cell carcinoma:0.518519 Actinic keratosis:0.727273 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.815988 Basal cell carcinoma:0.648148 Actinic keratosis:0.787879 Benign keratosis:0.800000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.776390 Melanocytic nevus:0.836795 Basal cell carcinoma:0.918605 Actinic keratosis:0.905895 Benign keratosis:0.798889 Dermatofibroma:0.938008 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 933.0, 69.0, 31.0, 143.0, 5.0, 25.0]

TEST Student: Epoch: 53, iteration: 42

TEST AUROC: 0.852931, TEST Accus: 0.590155, TEST Senss: 0.811892, TEST Specs: 0.796895
AUROCs: Melanoma:0.816556 Melanocytic nevus:0.922387 Basal cell carcinoma:0.914083 Actinic keratosis:0.850845 Benign keratosis:0.869909 Dermatofibroma:0.599895 Vascular lesion:0.996846
Accus: Melanoma:0.575758 Melanocytic nevus:0.691623 Basal cell carcinoma:0.627273 Actinic keratosis:0.534483 Benign keratosis:0.668224 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.874459 Melanocytic nevus:0.899185 Basal cell carcinoma:0.918182 Actinic keratosis:0.758621 Benign keratosis:0.869159 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.579036 Melanocytic nevus:0.759760 Basal cell carcinoma:0.822572 Actinic keratosis:0.851814 Benign keratosis:0.679622 Dermatofibroma:0.916708 Vascular lesion:0.968750
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_54.pth

Epoch: 54, iteration: 0/43, ==> train <===, loss: 3.588277, classification loss: 1.836482,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137296,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023229,wcp loss: 0.000000,entropy loss: 1.865862,consistency weight: 1.000000, lr: 3.3813919135227313e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 495.0, 25.0, 25.0, 52.0, 5.0, 10.0]

VAL Student: Epoch: 54, iteration: 42

VAL AUROC: 0.834220, VAL Accus: 0.570818, VAL Senss: 0.649900, VAL Specs: 0.885149
AUROCs: Melanoma:0.811292 Melanocytic nevus:0.914448 Basal cell carcinoma:0.911440 Actinic keratosis:0.921375 Benign keratosis:0.842056 Dermatofibroma:0.601499 Vascular lesion:0.837428
Accus: Melanoma:0.529412 Melanocytic nevus:0.746606 Basal cell carcinoma:0.462963 Actinic keratosis:0.757576 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.861237 Basal cell carcinoma:0.555556 Actinic keratosis:0.787879 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.808173 Melanocytic nevus:0.786350 Basal cell carcinoma:0.932347 Actinic keratosis:0.898656 Benign keratosis:0.835556 Dermatofibroma:0.941057 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1023.0, 63.0, 35.0, 129.0, 3.0, 24.0]

TEST Student: Epoch: 54, iteration: 42

TEST AUROC: 0.863787, TEST Accus: 0.575423, TEST Senss: 0.824205, TEST Specs: 0.802116
AUROCs: Melanoma:0.833690 Melanocytic nevus:0.921979 Basal cell carcinoma:0.908957 Actinic keratosis:0.879777 Benign keratosis:0.860415 Dermatofibroma:0.644437 Vascular lesion:0.997252
Accus: Melanoma:0.580087 Melanocytic nevus:0.758340 Basal cell carcinoma:0.572727 Actinic keratosis:0.603448 Benign keratosis:0.602804 Dermatofibroma:0.136364 Vascular lesion:0.774194
Senss: Melanoma:0.883117 Melanocytic nevus:0.936990 Basal cell carcinoma:0.863636 Actinic keratosis:0.844828 Benign keratosis:0.831776 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.623879 Melanocytic nevus:0.672673 Basal cell carcinoma:0.851969 Actinic keratosis:0.848237 Benign keratosis:0.724042 Dermatofibroma:0.919217 Vascular lesion:0.974798
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_55.pth

Epoch: 55, iteration: 0/43, ==> train <===, loss: 3.551936, classification loss: 1.792947,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137582,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026181,wcp loss: 0.000000,entropy loss: 1.870391,consistency weight: 1.000000, lr: 3.043252722170458e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [73.0, 501.0, 28.0, 18.0, 41.0, 5.0, 11.0]

VAL Student: Epoch: 55, iteration: 42

VAL AUROC: 0.856154, VAL Accus: 0.555558, VAL Senss: 0.663553, VAL Specs: 0.884881
AUROCs: Melanoma:0.837064 Melanocytic nevus:0.917057 Basal cell carcinoma:0.915610 Actinic keratosis:0.892263 Benign keratosis:0.850456 Dermatofibroma:0.687500 Vascular lesion:0.893130
Accus: Melanoma:0.613445 Melanocytic nevus:0.755656 Basal cell carcinoma:0.518519 Actinic keratosis:0.545455 Benign keratosis:0.410000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.894419 Basal cell carcinoma:0.629630 Actinic keratosis:0.666667 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.774120 Melanocytic nevus:0.753709 Basal cell carcinoma:0.930233 Actinic keratosis:0.944157 Benign keratosis:0.907778 Dermatofibroma:0.907520 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [164.0, 1033.0, 68.0, 24.0, 110.0, 7.0, 30.0]

TEST Student: Epoch: 55, iteration: 42

TEST AUROC: 0.870046, TEST Accus: 0.615375, TEST Senss: 0.806625, TEST Specs: 0.802423
AUROCs: Melanoma:0.859861 Melanocytic nevus:0.920495 Basal cell carcinoma:0.915781 Actinic keratosis:0.836863 Benign keratosis:0.872817 Dermatofibroma:0.687041 Vascular lesion:0.997464
Accus: Melanoma:0.709957 Melanocytic nevus:0.765752 Basal cell carcinoma:0.618182 Actinic keratosis:0.413793 Benign keratosis:0.514019 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.917749 Melanocytic nevus:0.947368 Basal cell carcinoma:0.881818 Actinic keratosis:0.655172 Benign keratosis:0.789720 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.606502 Melanocytic nevus:0.620120 Basal cell carcinoma:0.865092 Actinic keratosis:0.923352 Benign keratosis:0.803443 Dermatofibroma:0.875063 Vascular lesion:0.923387
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_56.pth

Epoch: 56, iteration: 0/43, ==> train <===, loss: 3.542307, classification loss: 1.791369,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140259,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024543,wcp loss: 0.000000,entropy loss: 1.866654,consistency weight: 1.000000, lr: 2.7389274499534124e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 469.0, 30.0, 27.0, 51.0, 5.0, 10.0]

VAL Student: Epoch: 56, iteration: 42

VAL AUROC: 0.835170, VAL Accus: 0.577269, VAL Senss: 0.664746, VAL Specs: 0.885561
AUROCs: Melanoma:0.797795 Melanocytic nevus:0.907242 Basal cell carcinoma:0.913026 Actinic keratosis:0.925700 Benign keratosis:0.817022 Dermatofibroma:0.648183 Vascular lesion:0.837225
Accus: Melanoma:0.470588 Melanocytic nevus:0.707391 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.605042 Melanocytic nevus:0.825038 Basal cell carcinoma:0.685185 Actinic keratosis:0.878788 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.833144 Melanocytic nevus:0.824926 Basal cell carcinoma:0.904863 Actinic keratosis:0.885212 Benign keratosis:0.842222 Dermatofibroma:0.931911 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 957.0, 74.0, 36.0, 127.0, 8.0, 29.0]

TEST Student: Epoch: 56, iteration: 42

TEST AUROC: 0.857452, TEST Accus: 0.630080, TEST Senss: 0.811877, TEST Specs: 0.801952
AUROCs: Melanoma:0.822795 Melanocytic nevus:0.921722 Basal cell carcinoma:0.903193 Actinic keratosis:0.887645 Benign keratosis:0.839752 Dermatofibroma:0.631027 Vascular lesion:0.996033
Accus: Melanoma:0.515152 Melanocytic nevus:0.709414 Basal cell carcinoma:0.672727 Actinic keratosis:0.620690 Benign keratosis:0.593458 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.831169 Melanocytic nevus:0.902891 Basal cell carcinoma:0.918182 Actinic keratosis:0.844828 Benign keratosis:0.822430 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.694507 Melanocytic nevus:0.737237 Basal cell carcinoma:0.793701 Actinic keratosis:0.834440 Benign keratosis:0.725708 Dermatofibroma:0.900652 Vascular lesion:0.927419
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_57.pth

Epoch: 57, iteration: 0/43, ==> train <===, loss: 3.547266, classification loss: 1.797409,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138600,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023419,wcp loss: 0.000000,entropy loss: 1.865038,consistency weight: 1.000000, lr: 2.465034704958071e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 527.0, 28.0, 21.0, 49.0, 5.0, 11.0]

VAL Student: Epoch: 57, iteration: 42

VAL AUROC: 0.849095, VAL Accus: 0.575972, VAL Senss: 0.667651, VAL Specs: 0.880940
AUROCs: Melanoma:0.825962 Melanocytic nevus:0.917957 Basal cell carcinoma:0.906801 Actinic keratosis:0.926890 Benign keratosis:0.850344 Dermatofibroma:0.628874 Vascular lesion:0.886836
Accus: Melanoma:0.546218 Melanocytic nevus:0.794872 Basal cell carcinoma:0.518519 Actinic keratosis:0.636364 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.672269 Melanocytic nevus:0.918552 Basal cell carcinoma:0.629630 Actinic keratosis:0.727273 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.802497 Melanocytic nevus:0.715134 Basal cell carcinoma:0.939746 Actinic keratosis:0.937952 Benign keratosis:0.867778 Dermatofibroma:0.923780 Vascular lesion:0.979695
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1086.0, 63.0, 26.0, 122.0, 3.0, 29.0]

TEST Student: Epoch: 57, iteration: 42

TEST AUROC: 0.867405, TEST Accus: 0.583243, TEST Senss: 0.803317, TEST Specs: 0.791470
AUROCs: Melanoma:0.850116 Melanocytic nevus:0.920345 Basal cell carcinoma:0.913806 Actinic keratosis:0.863126 Benign keratosis:0.870487 Dermatofibroma:0.656343 Vascular lesion:0.997610
Accus: Melanoma:0.614719 Melanocytic nevus:0.805041 Basal cell carcinoma:0.572727 Actinic keratosis:0.448276 Benign keratosis:0.570093 Dermatofibroma:0.136364 Vascular lesion:0.935484
Senss: Melanoma:0.891775 Melanocytic nevus:0.962936 Basal cell carcinoma:0.836364 Actinic keratosis:0.655172 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.625561 Melanocytic nevus:0.555556 Basal cell carcinoma:0.872441 Actinic keratosis:0.902913 Benign keratosis:0.756247 Dermatofibroma:0.898645 Vascular lesion:0.928931
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_58.pth

Epoch: 58, iteration: 0/43, ==> train <===, loss: 3.553067, classification loss: 1.800024,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141131,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027256,wcp loss: 0.000000,entropy loss: 1.866918,consistency weight: 1.000000, lr: 2.218531234462264e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 481.0, 27.0, 26.0, 53.0, 5.0, 10.0]

VAL Student: Epoch: 58, iteration: 42

VAL AUROC: 0.847394, VAL Accus: 0.577649, VAL Senss: 0.639693, VAL Specs: 0.882192
AUROCs: Melanoma:0.804844 Melanocytic nevus:0.912957 Basal cell carcinoma:0.925515 Actinic keratosis:0.922221 Benign keratosis:0.830411 Dermatofibroma:0.669144 Vascular lesion:0.866667
Accus: Melanoma:0.521008 Melanocytic nevus:0.725490 Basal cell carcinoma:0.500000 Actinic keratosis:0.787879 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.856712 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.826334 Melanocytic nevus:0.792285 Basal cell carcinoma:0.922833 Actinic keratosis:0.891417 Benign keratosis:0.852222 Dermatofibroma:0.902439 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1004.0, 68.0, 34.0, 126.0, 7.0, 26.0]

TEST Student: Epoch: 58, iteration: 42

TEST AUROC: 0.863463, TEST Accus: 0.610630, TEST Senss: 0.819230, TEST Specs: 0.803492
AUROCs: Melanoma:0.827726 Melanocytic nevus:0.919532 Basal cell carcinoma:0.909091 Actinic keratosis:0.881064 Benign keratosis:0.855226 Dermatofibroma:0.654678 Vascular lesion:0.996927
Accus: Melanoma:0.580087 Melanocytic nevus:0.744255 Basal cell carcinoma:0.618182 Actinic keratosis:0.586207 Benign keratosis:0.588785 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.839827 Melanocytic nevus:0.930319 Basal cell carcinoma:0.881818 Actinic keratosis:0.810345 Benign keratosis:0.817757 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.669843 Melanocytic nevus:0.696697 Basal cell carcinoma:0.840420 Actinic keratosis:0.842105 Benign keratosis:0.745142 Dermatofibroma:0.867035 Vascular lesion:0.963206
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_59.pth

Epoch: 59, iteration: 0/43, ==> train <===, loss: 3.559964, classification loss: 1.816583,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143904,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020703,wcp loss: 0.000000,entropy loss: 1.866582,consistency weight: 1.000000, lr: 1.9966781110160376e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 484.0, 31.0, 27.0, 44.0, 5.0, 10.0]

VAL Student: Epoch: 59, iteration: 42

VAL AUROC: 0.844789, VAL Accus: 0.579149, VAL Senss: 0.653379, VAL Specs: 0.883295
AUROCs: Melanoma:0.804643 Melanocytic nevus:0.910200 Basal cell carcinoma:0.923185 Actinic keratosis:0.923913 Benign keratosis:0.816711 Dermatofibroma:0.670033 Vascular lesion:0.864839
Accus: Melanoma:0.512605 Melanocytic nevus:0.730015 Basal cell carcinoma:0.574074 Actinic keratosis:0.818182 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.850679 Basal cell carcinoma:0.666667 Actinic keratosis:0.848485 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.822928 Melanocytic nevus:0.792285 Basal cell carcinoma:0.903805 Actinic keratosis:0.899690 Benign keratosis:0.882222 Dermatofibroma:0.899390 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [130.0, 991.0, 76.0, 32.0, 119.0, 7.0, 28.0]

TEST Student: Epoch: 59, iteration: 42

TEST AUROC: 0.858924, TEST Accus: 0.616786, TEST Senss: 0.817594, TEST Specs: 0.797798
AUROCs: Melanoma:0.827590 Melanocytic nevus:0.918103 Basal cell carcinoma:0.904844 Actinic keratosis:0.863523 Benign keratosis:0.842080 Dermatofibroma:0.659513 Vascular lesion:0.996813
Accus: Melanoma:0.562771 Melanocytic nevus:0.734618 Basal cell carcinoma:0.690909 Actinic keratosis:0.551724 Benign keratosis:0.556075 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.844156 Melanocytic nevus:0.929577 Basal cell carcinoma:0.918182 Actinic keratosis:0.810345 Benign keratosis:0.766355 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.660874 Melanocytic nevus:0.689189 Basal cell carcinoma:0.801575 Actinic keratosis:0.854880 Benign keratosis:0.768462 Dermatofibroma:0.860010 Vascular lesion:0.949597
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_60.pth

Epoch: 60, iteration: 0/43, ==> train <===, loss: 3.535816, classification loss: 1.796028,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139048,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015960,wcp loss: 0.000000,entropy loss: 1.862876,consistency weight: 1.000000, lr: 1.7970102999144338e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 470.0, 21.0, 23.0, 55.0, 5.0, 11.0]

VAL Student: Epoch: 60, iteration: 42

VAL AUROC: 0.841056, VAL Accus: 0.566003, VAL Senss: 0.656628, VAL Specs: 0.877903
AUROCs: Melanoma:0.819094 Melanocytic nevus:0.912474 Basal cell carcinoma:0.877183 Actinic keratosis:0.922315 Benign keratosis:0.850856 Dermatofibroma:0.641514 Vascular lesion:0.863959
Accus: Melanoma:0.571429 Melanocytic nevus:0.708899 Basal cell carcinoma:0.388889 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.697479 Melanocytic nevus:0.855204 Basal cell carcinoma:0.500000 Actinic keratosis:0.787879 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.763905 Melanocytic nevus:0.789318 Basal cell carcinoma:0.954545 Actinic keratosis:0.894519 Benign keratosis:0.846667 Dermatofibroma:0.921748 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 988.0, 47.0, 33.0, 131.0, 5.0, 30.0]

TEST Student: Epoch: 60, iteration: 42

TEST AUROC: 0.861426, TEST Accus: 0.596023, TEST Senss: 0.810996, TEST Specs: 0.801766
AUROCs: Melanoma:0.836294 Melanocytic nevus:0.920416 Basal cell carcinoma:0.893534 Actinic keratosis:0.874650 Benign keratosis:0.866287 Dermatofibroma:0.641906 Vascular lesion:0.996895
Accus: Melanoma:0.636364 Melanocytic nevus:0.732394 Basal cell carcinoma:0.427273 Actinic keratosis:0.568966 Benign keratosis:0.612150 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.904762 Melanocytic nevus:0.926612 Basal cell carcinoma:0.736364 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.580717 Melanocytic nevus:0.695195 Basal cell carcinoma:0.896063 Actinic keratosis:0.857946 Benign keratosis:0.746807 Dermatofibroma:0.900652 Vascular lesion:0.934980
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_61.pth

Epoch: 61, iteration: 0/43, ==> train <===, loss: 3.540888, classification loss: 1.786641,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137673,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023853,wcp loss: 0.000000,entropy loss: 1.868067,consistency weight: 1.000000, lr: 1.6173092699229905e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [75.0, 439.0, 21.0, 23.0, 63.0, 5.0, 10.0]

VAL Student: Epoch: 61, iteration: 42

VAL AUROC: 0.840492, VAL Accus: 0.569631, VAL Senss: 0.668510, VAL Specs: 0.878178
AUROCs: Melanoma:0.813161 Melanocytic nevus:0.908415 Basal cell carcinoma:0.876595 Actinic keratosis:0.899345 Benign keratosis:0.870433 Dermatofibroma:0.647612 Vascular lesion:0.867885
Accus: Melanoma:0.630252 Melanocytic nevus:0.662142 Basal cell carcinoma:0.388889 Actinic keratosis:0.696970 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.789916 Melanocytic nevus:0.834087 Basal cell carcinoma:0.518519 Actinic keratosis:0.787879 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.727582 Melanocytic nevus:0.821958 Basal cell carcinoma:0.949260 Actinic keratosis:0.908997 Benign keratosis:0.816667 Dermatofibroma:0.939024 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [154.0, 933.0, 53.0, 31.0, 138.0, 5.0, 30.0]

TEST Student: Epoch: 61, iteration: 42

TEST AUROC: 0.862219, TEST Accus: 0.602067, TEST Senss: 0.822261, TEST Specs: 0.801062
AUROCs: Melanoma:0.832336 Melanocytic nevus:0.922423 Basal cell carcinoma:0.904820 Actinic keratosis:0.865725 Benign keratosis:0.876227 Dermatofibroma:0.637253 Vascular lesion:0.996748
Accus: Melanoma:0.666667 Melanocytic nevus:0.691623 Basal cell carcinoma:0.481818 Actinic keratosis:0.534483 Benign keratosis:0.644860 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.922078 Melanocytic nevus:0.907339 Basal cell carcinoma:0.790909 Actinic keratosis:0.793103 Benign keratosis:0.887850 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.521861 Melanocytic nevus:0.747748 Basal cell carcinoma:0.892388 Actinic keratosis:0.864589 Benign keratosis:0.708495 Dermatofibroma:0.916207 Vascular lesion:0.956149
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_62.pth

Epoch: 62, iteration: 0/43, ==> train <===, loss: 3.560864, classification loss: 1.815544,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142652,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023510,wcp loss: 0.000000,entropy loss: 1.864462,consistency weight: 1.000000, lr: 1.4555783429306916e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 486.0, 20.0, 23.0, 57.0, 5.0, 10.0]

VAL Student: Epoch: 62, iteration: 42

VAL AUROC: 0.848279, VAL Accus: 0.552935, VAL Senss: 0.661821, VAL Specs: 0.877625
AUROCs: Melanoma:0.813838 Melanocytic nevus:0.912966 Basal cell carcinoma:0.888262 Actinic keratosis:0.917834 Benign keratosis:0.855833 Dermatofibroma:0.675241 Vascular lesion:0.873976
Accus: Melanoma:0.521008 Melanocytic nevus:0.733032 Basal cell carcinoma:0.370370 Actinic keratosis:0.696970 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.672269 Melanocytic nevus:0.859729 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.797957 Melanocytic nevus:0.780415 Basal cell carcinoma:0.939746 Actinic keratosis:0.901758 Benign keratosis:0.832222 Dermatofibroma:0.906504 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1007.0, 56.0, 35.0, 131.0, 5.0, 28.0]

TEST Student: Epoch: 62, iteration: 42

TEST AUROC: 0.864470, TEST Accus: 0.599867, TEST Senss: 0.821279, TEST Specs: 0.791153
AUROCs: Melanoma:0.830899 Melanocytic nevus:0.918096 Basal cell carcinoma:0.905283 Actinic keratosis:0.866571 Benign keratosis:0.870225 Dermatofibroma:0.663094 Vascular lesion:0.997122
Accus: Melanoma:0.597403 Melanocytic nevus:0.746479 Basal cell carcinoma:0.509091 Actinic keratosis:0.603448 Benign keratosis:0.612150 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.874459 Melanocytic nevus:0.937732 Basal cell carcinoma:0.818182 Actinic keratosis:0.827586 Benign keratosis:0.836449 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.617152 Melanocytic nevus:0.656156 Basal cell carcinoma:0.871916 Actinic keratosis:0.849259 Benign keratosis:0.728484 Dermatofibroma:0.871049 Vascular lesion:0.944052
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_63.pth

Epoch: 63, iteration: 0/43, ==> train <===, loss: 3.562442, classification loss: 1.799516,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.135591,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028979,wcp loss: 0.000000,entropy loss: 1.869538,consistency weight: 1.000000, lr: 1.3100205086376224e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 455.0, 28.0, 26.0, 54.0, 5.0, 10.0]

VAL Student: Epoch: 63, iteration: 42

VAL AUROC: 0.848938, VAL Accus: 0.582123, VAL Senss: 0.663580, VAL Specs: 0.881718
AUROCs: Melanoma:0.800837 Melanocytic nevus:0.908692 Basal cell carcinoma:0.932366 Actinic keratosis:0.925136 Benign keratosis:0.841811 Dermatofibroma:0.674162 Vascular lesion:0.859560
Accus: Melanoma:0.563025 Melanocytic nevus:0.686275 Basal cell carcinoma:0.518519 Actinic keratosis:0.787879 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.819005 Basal cell carcinoma:0.629630 Actinic keratosis:0.818182 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.779796 Melanocytic nevus:0.821958 Basal cell carcinoma:0.927061 Actinic keratosis:0.895553 Benign keratosis:0.853333 Dermatofibroma:0.909553 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 938.0, 69.0, 35.0, 126.0, 6.0, 30.0]

TEST Student: Epoch: 63, iteration: 42

TEST AUROC: 0.862495, TEST Accus: 0.621815, TEST Senss: 0.811641, TEST Specs: 0.804546
AUROCs: Melanoma:0.820699 Melanocytic nevus:0.921459 Basal cell carcinoma:0.908094 Actinic keratosis:0.882244 Benign keratosis:0.859247 Dermatofibroma:0.648679 Vascular lesion:0.997041
Accus: Melanoma:0.597403 Melanocytic nevus:0.695330 Basal cell carcinoma:0.627273 Actinic keratosis:0.603448 Benign keratosis:0.588785 Dermatofibroma:0.272727 Vascular lesion:0.967742
Senss: Melanoma:0.870130 Melanocytic nevus:0.905856 Basal cell carcinoma:0.863636 Actinic keratosis:0.810345 Benign keratosis:0.822430 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.603139 Melanocytic nevus:0.759760 Basal cell carcinoma:0.844094 Actinic keratosis:0.842105 Benign keratosis:0.749028 Dermatofibroma:0.883593 Vascular lesion:0.950101
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_64.pth

Epoch: 64, iteration: 0/43, ==> train <===, loss: 3.571494, classification loss: 1.829069,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146807,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025556,wcp loss: 0.000000,entropy loss: 1.863676,consistency weight: 1.000000, lr: 1.1790184577738602e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 448.0, 25.0, 23.0, 69.0, 5.0, 10.0]

VAL Student: Epoch: 64, iteration: 42

VAL AUROC: 0.835728, VAL Accus: 0.572717, VAL Senss: 0.653328, VAL Specs: 0.880688
AUROCs: Melanoma:0.805960 Melanocytic nevus:0.906150 Basal cell carcinoma:0.890788 Actinic keratosis:0.901069 Benign keratosis:0.858178 Dermatofibroma:0.650661 Vascular lesion:0.837293
Accus: Melanoma:0.504202 Melanocytic nevus:0.675716 Basal cell carcinoma:0.462963 Actinic keratosis:0.696970 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.672269 Melanocytic nevus:0.820513 Basal cell carcinoma:0.574074 Actinic keratosis:0.727273 Benign keratosis:0.800000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.799092 Melanocytic nevus:0.824926 Basal cell carcinoma:0.932347 Actinic keratosis:0.915202 Benign keratosis:0.775556 Dermatofibroma:0.928862 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 931.0, 63.0, 26.0, 146.0, 5.0, 28.0]

TEST Student: Epoch: 64, iteration: 42

TEST AUROC: 0.855240, TEST Accus: 0.581953, TEST Senss: 0.812180, TEST Specs: 0.796198
AUROCs: Melanoma:0.826287 Melanocytic nevus:0.921305 Basal cell carcinoma:0.906371 Actinic keratosis:0.847708 Benign keratosis:0.864932 Dermatofibroma:0.623797 Vascular lesion:0.996277
Accus: Melanoma:0.549784 Melanocytic nevus:0.690141 Basal cell carcinoma:0.572727 Actinic keratosis:0.448276 Benign keratosis:0.682243 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.874459 Melanocytic nevus:0.905115 Basal cell carcinoma:0.845455 Actinic keratosis:0.758621 Benign keratosis:0.892523 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.622197 Melanocytic nevus:0.737237 Basal cell carcinoma:0.848294 Actinic keratosis:0.859990 Benign keratosis:0.636313 Dermatofibroma:0.910687 Vascular lesion:0.958669
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_65.pth

Epoch: 65, iteration: 0/43, ==> train <===, loss: 3.544623, classification loss: 1.794899,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140536,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025408,wcp loss: 0.000000,entropy loss: 1.864851,consistency weight: 1.000000, lr: 1.0611166119964742e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 436.0, 22.0, 24.0, 54.0, 5.0, 10.0]

VAL Student: Epoch: 65, iteration: 42

VAL AUROC: 0.841813, VAL Accus: 0.564303, VAL Senss: 0.660315, VAL Specs: 0.877036
AUROCs: Melanoma:0.816128 Melanocytic nevus:0.908486 Basal cell carcinoma:0.891708 Actinic keratosis:0.912131 Benign keratosis:0.859411 Dermatofibroma:0.655488 Vascular lesion:0.849340
Accus: Melanoma:0.638655 Melanocytic nevus:0.657617 Basal cell carcinoma:0.407407 Actinic keratosis:0.727273 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.773109 Melanocytic nevus:0.823529 Basal cell carcinoma:0.518519 Actinic keratosis:0.787879 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.736663 Melanocytic nevus:0.827893 Basal cell carcinoma:0.953488 Actinic keratosis:0.895553 Benign keratosis:0.845556 Dermatofibroma:0.899390 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [155.0, 908.0, 48.0, 34.0, 128.0, 5.0, 30.0]

TEST Student: Epoch: 65, iteration: 42

TEST AUROC: 0.860144, TEST Accus: 0.594258, TEST Senss: 0.815505, TEST Specs: 0.791998
AUROCs: Melanoma:0.831069 Melanocytic nevus:0.919067 Basal cell carcinoma:0.902968 Actinic keratosis:0.855902 Benign keratosis:0.871834 Dermatofibroma:0.643388 Vascular lesion:0.996781
Accus: Melanoma:0.670996 Melanocytic nevus:0.673091 Basal cell carcinoma:0.436364 Actinic keratosis:0.586207 Benign keratosis:0.598131 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.904762 Melanocytic nevus:0.906597 Basal cell carcinoma:0.781818 Actinic keratosis:0.810345 Benign keratosis:0.850467 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.540919 Melanocytic nevus:0.734234 Basal cell carcinoma:0.881890 Actinic keratosis:0.830864 Benign keratosis:0.738479 Dermatofibroma:0.875063 Vascular lesion:0.942540
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_66.pth

Epoch: 66, iteration: 0/43, ==> train <===, loss: 3.586214, classification loss: 1.826441,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.132388,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023846,wcp loss: 0.000000,entropy loss: 1.868315,consistency weight: 1.000000, lr: 9.550049507968268e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 468.0, 23.0, 26.0, 44.0, 5.0, 10.0]

VAL Student: Epoch: 66, iteration: 42

VAL AUROC: 0.844983, VAL Accus: 0.553810, VAL Senss: 0.654918, VAL Specs: 0.880852
AUROCs: Melanoma:0.816109 Melanocytic nevus:0.909735 Basal cell carcinoma:0.899949 Actinic keratosis:0.931466 Benign keratosis:0.818400 Dermatofibroma:0.661458 Vascular lesion:0.877766
Accus: Melanoma:0.537815 Melanocytic nevus:0.705882 Basal cell carcinoma:0.425926 Actinic keratosis:0.787879 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.853695 Basal cell carcinoma:0.537037 Actinic keratosis:0.878788 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.809308 Melanocytic nevus:0.801187 Basal cell carcinoma:0.931290 Actinic keratosis:0.869700 Benign keratosis:0.885556 Dermatofibroma:0.892276 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 987.0, 58.0, 40.0, 116.0, 8.0, 30.0]

TEST Student: Epoch: 66, iteration: 42

TEST AUROC: 0.865652, TEST Accus: 0.628872, TEST Senss: 0.822916, TEST Specs: 0.801988
AUROCs: Melanoma:0.830533 Melanocytic nevus:0.920103 Basal cell carcinoma:0.899146 Actinic keratosis:0.895671 Benign keratosis:0.855252 Dermatofibroma:0.661543 Vascular lesion:0.997317
Accus: Melanoma:0.580087 Melanocytic nevus:0.731653 Basal cell carcinoma:0.527273 Actinic keratosis:0.689655 Benign keratosis:0.542056 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.861472 Melanocytic nevus:0.922165 Basal cell carcinoma:0.845455 Actinic keratosis:0.827586 Benign keratosis:0.803738 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.661435 Melanocytic nevus:0.711712 Basal cell carcinoma:0.863517 Actinic keratosis:0.821666 Benign keratosis:0.781233 Dermatofibroma:0.853487 Vascular lesion:0.920867
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_67.pth

Epoch: 67, iteration: 0/43, ==> train <===, loss: 3.561124, classification loss: 1.801970,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.135481,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028979,wcp loss: 0.000000,entropy loss: 1.865655,consistency weight: 1.000000, lr: 8.595044557171442e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 479.0, 29.0, 24.0, 56.0, 5.0, 10.0]

VAL Student: Epoch: 67, iteration: 42

VAL AUROC: 0.842121, VAL Accus: 0.576936, VAL Senss: 0.670716, VAL Specs: 0.877503
AUROCs: Melanoma:0.801791 Melanocytic nevus:0.914273 Basal cell carcinoma:0.927120 Actinic keratosis:0.920623 Benign keratosis:0.842622 Dermatofibroma:0.620871 Vascular lesion:0.867547
Accus: Melanoma:0.512605 Melanocytic nevus:0.722474 Basal cell carcinoma:0.537037 Actinic keratosis:0.727273 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.672269 Melanocytic nevus:0.865762 Basal cell carcinoma:0.629630 Actinic keratosis:0.818182 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.802497 Melanocytic nevus:0.780415 Basal cell carcinoma:0.909091 Actinic keratosis:0.908997 Benign keratosis:0.841111 Dermatofibroma:0.906504 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [131.0, 1005.0, 71.0, 29.0, 128.0, 5.0, 24.0]

TEST Student: Epoch: 67, iteration: 42

TEST AUROC: 0.863353, TEST Accus: 0.579593, TEST Senss: 0.825888, TEST Specs: 0.792554
AUROCs: Melanoma:0.829201 Melanocytic nevus:0.923100 Basal cell carcinoma:0.910847 Actinic keratosis:0.866042 Benign keratosis:0.865459 Dermatofibroma:0.651508 Vascular lesion:0.997317
Accus: Melanoma:0.567100 Melanocytic nevus:0.744996 Basal cell carcinoma:0.645455 Actinic keratosis:0.500000 Benign keratosis:0.598131 Dermatofibroma:0.227273 Vascular lesion:0.774194
Senss: Melanoma:0.874459 Melanocytic nevus:0.939214 Basal cell carcinoma:0.927273 Actinic keratosis:0.758621 Benign keratosis:0.827103 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.619395 Melanocytic nevus:0.656156 Basal cell carcinoma:0.818373 Actinic keratosis:0.874808 Benign keratosis:0.726263 Dermatofibroma:0.875564 Vascular lesion:0.977319
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_68.pth

Epoch: 68, iteration: 0/43, ==> train <===, loss: 3.547657, classification loss: 1.794664,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138393,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024727,wcp loss: 0.000000,entropy loss: 1.866658,consistency weight: 1.000000, lr: 7.735540101454298e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 454.0, 29.0, 23.0, 61.0, 5.0, 10.0]

VAL Student: Epoch: 68, iteration: 42

VAL AUROC: 0.841424, VAL Accus: 0.568361, VAL Senss: 0.667893, VAL Specs: 0.883809
AUROCs: Melanoma:0.805063 Melanocytic nevus:0.907175 Basal cell carcinoma:0.926983 Actinic keratosis:0.913541 Benign keratosis:0.859533 Dermatofibroma:0.622713 Vascular lesion:0.854958
Accus: Melanoma:0.470588 Melanocytic nevus:0.684766 Basal cell carcinoma:0.537037 Actinic keratosis:0.696970 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.814480 Basal cell carcinoma:0.666667 Actinic keratosis:0.787879 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.812713 Melanocytic nevus:0.824926 Basal cell carcinoma:0.916490 Actinic keratosis:0.910031 Benign keratosis:0.796667 Dermatofibroma:0.950203 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 937.0, 71.0, 31.0, 141.0, 5.0, 30.0]

TEST Student: Epoch: 68, iteration: 42

TEST AUROC: 0.858063, TEST Accus: 0.610553, TEST Senss: 0.810958, TEST Specs: 0.804530
AUROCs: Melanoma:0.824666 Melanocytic nevus:0.922398 Basal cell carcinoma:0.911138 Actinic keratosis:0.859038 Benign keratosis:0.867698 Dermatofibroma:0.625143 Vascular lesion:0.996358
Accus: Melanoma:0.545455 Melanocytic nevus:0.694589 Basal cell carcinoma:0.645455 Actinic keratosis:0.534483 Benign keratosis:0.658879 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.848485 Melanocytic nevus:0.896961 Basal cell carcinoma:0.927273 Actinic keratosis:0.775862 Benign keratosis:0.864486 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.648543 Melanocytic nevus:0.759760 Basal cell carcinoma:0.816273 Actinic keratosis:0.871742 Benign keratosis:0.675180 Dermatofibroma:0.927245 Vascular lesion:0.932964
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_69.pth

Epoch: 69, iteration: 0/43, ==> train <===, loss: 3.548503, classification loss: 1.797664,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.135590,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022651,wcp loss: 0.000000,entropy loss: 1.863778,consistency weight: 1.000000, lr: 6.961986091308869e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 485.0, 26.0, 24.0, 53.0, 5.0, 10.0]

VAL Student: Epoch: 69, iteration: 42

VAL AUROC: 0.839771, VAL Accus: 0.576811, VAL Senss: 0.654976, VAL Specs: 0.883174
AUROCs: Melanoma:0.815603 Melanocytic nevus:0.913472 Basal cell carcinoma:0.897659 Actinic keratosis:0.919401 Benign keratosis:0.849700 Dermatofibroma:0.644118 Vascular lesion:0.838443
Accus: Melanoma:0.588235 Melanocytic nevus:0.731523 Basal cell carcinoma:0.481481 Actinic keratosis:0.727273 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.714286 Melanocytic nevus:0.859729 Basal cell carcinoma:0.574074 Actinic keratosis:0.757576 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.758229 Melanocytic nevus:0.789318 Basal cell carcinoma:0.929175 Actinic keratosis:0.906929 Benign keratosis:0.854444 Dermatofibroma:0.958333 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [152.0, 995.0, 62.0, 35.0, 126.0, 4.0, 28.0]

TEST Student: Epoch: 69, iteration: 42

TEST AUROC: 0.861471, TEST Accus: 0.605215, TEST Senss: 0.808578, TEST Specs: 0.801832
AUROCs: Melanoma:0.839126 Melanocytic nevus:0.920335 Basal cell carcinoma:0.909477 Actinic keratosis:0.864562 Benign keratosis:0.861935 Dermatofibroma:0.638051 Vascular lesion:0.996813
Accus: Melanoma:0.658009 Melanocytic nevus:0.737583 Basal cell carcinoma:0.563636 Actinic keratosis:0.603448 Benign keratosis:0.588785 Dermatofibroma:0.181818 Vascular lesion:0.903226
Senss: Melanoma:0.900433 Melanocytic nevus:0.930319 Basal cell carcinoma:0.845455 Actinic keratosis:0.793103 Benign keratosis:0.827103 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.582960 Melanocytic nevus:0.680180 Basal cell carcinoma:0.862467 Actinic keratosis:0.848748 Benign keratosis:0.749584 Dermatofibroma:0.938786 Vascular lesion:0.950101
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_70.pth

Epoch: 70, iteration: 0/43, ==> train <===, loss: 3.560978, classification loss: 1.813997,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139366,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021262,wcp loss: 0.000000,entropy loss: 1.865085,consistency weight: 1.000000, lr: 6.265787482177982e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 484.0, 25.0, 24.0, 45.0, 5.0, 11.0]

VAL Student: Epoch: 70, iteration: 42

VAL AUROC: 0.850082, VAL Accus: 0.576848, VAL Senss: 0.662602, VAL Specs: 0.878777
AUROCs: Melanoma:0.816233 Melanocytic nevus:0.918557 Basal cell carcinoma:0.889535 Actinic keratosis:0.936918 Benign keratosis:0.839311 Dermatofibroma:0.662983 Vascular lesion:0.887039
Accus: Melanoma:0.621849 Melanocytic nevus:0.730015 Basal cell carcinoma:0.462963 Actinic keratosis:0.727273 Benign keratosis:0.450000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.789916 Melanocytic nevus:0.879336 Basal cell carcinoma:0.555556 Actinic keratosis:0.757576 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.720772 Melanocytic nevus:0.762611 Basal cell carcinoma:0.946089 Actinic keratosis:0.918304 Benign keratosis:0.902222 Dermatofibroma:0.919715 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [159.0, 995.0, 59.0, 32.0, 111.0, 5.0, 30.0]

TEST Student: Epoch: 70, iteration: 42

TEST AUROC: 0.869643, TEST Accus: 0.603956, TEST Senss: 0.809393, TEST Specs: 0.794017
AUROCs: Melanoma:0.835238 Melanocytic nevus:0.923681 Basal cell carcinoma:0.903403 Actinic keratosis:0.891380 Benign keratosis:0.864348 Dermatofibroma:0.671692 Vascular lesion:0.997756
Accus: Melanoma:0.688312 Melanocytic nevus:0.737583 Basal cell carcinoma:0.536364 Actinic keratosis:0.551724 Benign keratosis:0.518692 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.917749 Melanocytic nevus:0.948851 Basal cell carcinoma:0.818182 Actinic keratosis:0.741379 Benign keratosis:0.785047 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.528587 Melanocytic nevus:0.630631 Basal cell carcinoma:0.876115 Actinic keratosis:0.879918 Benign keratosis:0.806219 Dermatofibroma:0.898144 Vascular lesion:0.938508
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_71.pth

Epoch: 71, iteration: 0/43, ==> train <===, loss: 3.533463, classification loss: 1.796237,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145738,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022284,wcp loss: 0.000000,entropy loss: 1.860681,consistency weight: 1.000000, lr: 5.6392087339601844e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 479.0, 26.0, 27.0, 45.0, 5.0, 10.0]

VAL Student: Epoch: 71, iteration: 42

VAL AUROC: 0.837001, VAL Accus: 0.569874, VAL Senss: 0.641636, VAL Specs: 0.881983
AUROCs: Melanoma:0.810901 Melanocytic nevus:0.911861 Basal cell carcinoma:0.913691 Actinic keratosis:0.930714 Benign keratosis:0.803900 Dermatofibroma:0.652884 Vascular lesion:0.835059
Accus: Melanoma:0.537815 Melanocytic nevus:0.722474 Basal cell carcinoma:0.481481 Actinic keratosis:0.818182 Benign keratosis:0.450000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.689076 Melanocytic nevus:0.849170 Basal cell carcinoma:0.555556 Actinic keratosis:0.848485 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.803632 Melanocytic nevus:0.783383 Basal cell carcinoma:0.928118 Actinic keratosis:0.876939 Benign keratosis:0.884444 Dermatofibroma:0.904472 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1001.0, 67.0, 39.0, 115.0, 7.0, 25.0]

TEST Student: Epoch: 71, iteration: 42

TEST AUROC: 0.865442, TEST Accus: 0.611851, TEST Senss: 0.833819, TEST Specs: 0.805392
AUROCs: Melanoma:0.834071 Melanocytic nevus:0.920371 Basal cell carcinoma:0.906414 Actinic keratosis:0.891838 Benign keratosis:0.844025 Dermatofibroma:0.664006 Vascular lesion:0.997366
Accus: Melanoma:0.597403 Melanocytic nevus:0.742031 Basal cell carcinoma:0.609091 Actinic keratosis:0.672414 Benign keratosis:0.537383 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.870130 Melanocytic nevus:0.931801 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.654148 Melanocytic nevus:0.692192 Basal cell carcinoma:0.844619 Actinic keratosis:0.832908 Benign keratosis:0.774570 Dermatofibroma:0.868540 Vascular lesion:0.970766
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_72.pth

Epoch: 72, iteration: 0/43, ==> train <===, loss: 3.565134, classification loss: 1.811661,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141420,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028802,wcp loss: 0.000000,entropy loss: 1.866091,consistency weight: 1.000000, lr: 5.075287860564166e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 498.0, 26.0, 25.0, 41.0, 5.0, 10.0]

VAL Student: Epoch: 72, iteration: 42

VAL AUROC: 0.837819, VAL Accus: 0.563197, VAL Senss: 0.666110, VAL Specs: 0.884852
AUROCs: Melanoma:0.819600 Melanocytic nevus:0.912899 Basal cell carcinoma:0.904275 Actinic keratosis:0.923475 Benign keratosis:0.845856 Dermatofibroma:0.605501 Vascular lesion:0.853130
Accus: Melanoma:0.563025 Melanocytic nevus:0.751131 Basal cell carcinoma:0.481481 Actinic keratosis:0.757576 Benign keratosis:0.410000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.739496 Melanocytic nevus:0.874811 Basal cell carcinoma:0.611111 Actinic keratosis:0.818182 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.759364 Melanocytic nevus:0.768546 Basal cell carcinoma:0.931290 Actinic keratosis:0.904860 Benign keratosis:0.900000 Dermatofibroma:0.953252 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [150.0, 1020.0, 63.0, 32.0, 117.0, 4.0, 29.0]

TEST Student: Epoch: 72, iteration: 42

TEST AUROC: 0.860881, TEST Accus: 0.599136, TEST Senss: 0.806540, TEST Specs: 0.799984
AUROCs: Melanoma:0.839594 Melanocytic nevus:0.917777 Basal cell carcinoma:0.907807 Actinic keratosis:0.866518 Benign keratosis:0.855065 Dermatofibroma:0.642476 Vascular lesion:0.996927
Accus: Melanoma:0.649351 Melanocytic nevus:0.756116 Basal cell carcinoma:0.572727 Actinic keratosis:0.551724 Benign keratosis:0.546729 Dermatofibroma:0.181818 Vascular lesion:0.935484
Senss: Melanoma:0.904762 Melanocytic nevus:0.940697 Basal cell carcinoma:0.827273 Actinic keratosis:0.810345 Benign keratosis:0.799065 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.576794 Melanocytic nevus:0.638138 Basal cell carcinoma:0.862467 Actinic keratosis:0.856413 Benign keratosis:0.791782 Dermatofibroma:0.932765 Vascular lesion:0.941532
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_73.pth

Epoch: 73, iteration: 0/43, ==> train <===, loss: 3.586846, classification loss: 1.828293,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140668,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031158,wcp loss: 0.000000,entropy loss: 1.868064,consistency weight: 1.000000, lr: 4.567759074507749e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 445.0, 23.0, 24.0, 54.0, 5.0, 10.0]

VAL Student: Epoch: 73, iteration: 42

VAL AUROC: 0.835165, VAL Accus: 0.562885, VAL Senss: 0.661142, VAL Specs: 0.882028
AUROCs: Melanoma:0.810137 Melanocytic nevus:0.904758 Basal cell carcinoma:0.905000 Actinic keratosis:0.915672 Benign keratosis:0.854778 Dermatofibroma:0.625762 Vascular lesion:0.830051
Accus: Melanoma:0.596639 Melanocytic nevus:0.671192 Basal cell carcinoma:0.425926 Actinic keratosis:0.727273 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.747899 Melanocytic nevus:0.817496 Basal cell carcinoma:0.555556 Actinic keratosis:0.787879 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.763905 Melanocytic nevus:0.824926 Basal cell carcinoma:0.930233 Actinic keratosis:0.888314 Benign keratosis:0.827778 Dermatofibroma:0.955285 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 928.0, 57.0, 35.0, 132.0, 4.0, 29.0]

TEST Student: Epoch: 73, iteration: 42

TEST AUROC: 0.859681, TEST Accus: 0.595293, TEST Senss: 0.808661, TEST Specs: 0.806142
AUROCs: Melanoma:0.829300 Melanocytic nevus:0.921736 Basal cell carcinoma:0.900220 Actinic keratosis:0.875619 Benign keratosis:0.866014 Dermatofibroma:0.628632 Vascular lesion:0.996244
Accus: Melanoma:0.623377 Melanocytic nevus:0.687917 Basal cell carcinoma:0.518182 Actinic keratosis:0.603448 Benign keratosis:0.616822 Dermatofibroma:0.181818 Vascular lesion:0.935484
Senss: Melanoma:0.904762 Melanocytic nevus:0.900667 Basal cell carcinoma:0.818182 Actinic keratosis:0.827586 Benign keratosis:0.845794 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.584641 Melanocytic nevus:0.758258 Basal cell carcinoma:0.859843 Actinic keratosis:0.836484 Benign keratosis:0.717379 Dermatofibroma:0.933266 Vascular lesion:0.953125
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_74.pth

Epoch: 74, iteration: 0/43, ==> train <===, loss: 3.599495, classification loss: 1.835745,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.136862,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028200,wcp loss: 0.000000,entropy loss: 1.872412,consistency weight: 1.000000, lr: 4.1109831670569744e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 381.0, 30.0, 27.0, 54.0, 5.0, 10.0]

VAL Student: Epoch: 74, iteration: 42

VAL AUROC: 0.828126, VAL Accus: 0.566195, VAL Senss: 0.652738, VAL Specs: 0.876605
AUROCs: Melanoma:0.781570 Melanocytic nevus:0.888511 Basal cell carcinoma:0.911675 Actinic keratosis:0.908119 Benign keratosis:0.833389 Dermatofibroma:0.651550 Vascular lesion:0.822064
Accus: Melanoma:0.495798 Melanocytic nevus:0.574661 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.719457 Basal cell carcinoma:0.703704 Actinic keratosis:0.818182 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.790011 Melanocytic nevus:0.902077 Basal cell carcinoma:0.887949 Actinic keratosis:0.863495 Benign keratosis:0.816667 Dermatofibroma:0.891260 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [122.0, 814.0, 73.0, 35.0, 128.0, 6.0, 27.0]

TEST Student: Epoch: 74, iteration: 42

TEST AUROC: 0.842264, TEST Accus: 0.591494, TEST Senss: 0.794770, TEST Specs: 0.790872
AUROCs: Melanoma:0.792419 Melanocytic nevus:0.916023 Basal cell carcinoma:0.896368 Actinic keratosis:0.853039 Benign keratosis:0.839736 Dermatofibroma:0.603271 Vascular lesion:0.994992
Accus: Melanoma:0.528139 Melanocytic nevus:0.603410 Basal cell carcinoma:0.663636 Actinic keratosis:0.603448 Benign keratosis:0.598131 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.813853 Melanocytic nevus:0.834692 Basal cell carcinoma:0.909091 Actinic keratosis:0.810345 Benign keratosis:0.831776 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.623879 Melanocytic nevus:0.836336 Basal cell carcinoma:0.764304 Actinic keratosis:0.791518 Benign keratosis:0.707940 Dermatofibroma:0.859508 Vascular lesion:0.952621
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_75.pth

Epoch: 75, iteration: 0/43, ==> train <===, loss: 3.581330, classification loss: 1.827730,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139599,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026148,wcp loss: 0.000000,entropy loss: 1.867051,consistency weight: 1.000000, lr: 3.699884850351277e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 491.0, 25.0, 20.0, 59.0, 5.0, 11.0]

VAL Student: Epoch: 75, iteration: 42

VAL AUROC: 0.839157, VAL Accus: 0.575037, VAL Senss: 0.677155, VAL Specs: 0.877871
AUROCs: Melanoma:0.824617 Melanocytic nevus:0.919223 Basal cell carcinoma:0.887577 Actinic keratosis:0.878913 Benign keratosis:0.856900 Dermatofibroma:0.631606 Vascular lesion:0.875262
Accus: Melanoma:0.579832 Melanocytic nevus:0.740573 Basal cell carcinoma:0.462963 Actinic keratosis:0.606061 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.756303 Melanocytic nevus:0.888386 Basal cell carcinoma:0.592593 Actinic keratosis:0.696970 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.744608 Melanocytic nevus:0.762611 Basal cell carcinoma:0.946089 Actinic keratosis:0.946225 Benign keratosis:0.828889 Dermatofibroma:0.926829 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 1038.0, 58.0, 23.0, 140.0, 4.0, 27.0]

TEST Student: Epoch: 75, iteration: 42

TEST AUROC: 0.863802, TEST Accus: 0.576663, TEST Senss: 0.808673, TEST Specs: 0.789740
AUROCs: Melanoma:0.849378 Melanocytic nevus:0.919493 Basal cell carcinoma:0.912336 Actinic keratosis:0.833982 Benign keratosis:0.877729 Dermatofibroma:0.656297 Vascular lesion:0.997399
Accus: Melanoma:0.636364 Melanocytic nevus:0.769459 Basal cell carcinoma:0.527273 Actinic keratosis:0.396552 Benign keratosis:0.654206 Dermatofibroma:0.181818 Vascular lesion:0.870968
Senss: Melanoma:0.939394 Melanocytic nevus:0.950334 Basal cell carcinoma:0.800000 Actinic keratosis:0.637931 Benign keratosis:0.878505 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.547085 Melanocytic nevus:0.606607 Basal cell carcinoma:0.885564 Actinic keratosis:0.921819 Benign keratosis:0.706274 Dermatofibroma:0.901656 Vascular lesion:0.959173
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_76.pth

Epoch: 76, iteration: 0/43, ==> train <===, loss: 3.568824, classification loss: 1.807733,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139332,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032648,wcp loss: 0.000000,entropy loss: 1.867775,consistency weight: 1.000000, lr: 3.3298963653161496e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 462.0, 24.0, 21.0, 64.0, 5.0, 10.0]

VAL Student: Epoch: 76, iteration: 42

VAL AUROC: 0.846818, VAL Accus: 0.564490, VAL Senss: 0.648575, VAL Specs: 0.878563
AUROCs: Melanoma:0.817158 Melanocytic nevus:0.916542 Basal cell carcinoma:0.888458 Actinic keratosis:0.881107 Benign keratosis:0.872600 Dermatofibroma:0.659680 Vascular lesion:0.892183
Accus: Melanoma:0.554622 Melanocytic nevus:0.696833 Basal cell carcinoma:0.444444 Actinic keratosis:0.636364 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.680672 Melanocytic nevus:0.847662 Basal cell carcinoma:0.555556 Actinic keratosis:0.696970 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.776390 Melanocytic nevus:0.804154 Basal cell carcinoma:0.942918 Actinic keratosis:0.932782 Benign keratosis:0.804444 Dermatofibroma:0.910569 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 971.0, 57.0, 25.0, 149.0, 5.0, 30.0]

TEST Student: Epoch: 76, iteration: 42

TEST AUROC: 0.861650, TEST Accus: 0.593337, TEST Senss: 0.804047, TEST Specs: 0.798915
AUROCs: Melanoma:0.835408 Melanocytic nevus:0.922142 Basal cell carcinoma:0.905937 Actinic keratosis:0.835674 Benign keratosis:0.882282 Dermatofibroma:0.653651 Vascular lesion:0.996456
Accus: Melanoma:0.593074 Melanocytic nevus:0.719792 Basal cell carcinoma:0.518182 Actinic keratosis:0.431034 Benign keratosis:0.696262 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.887446 Melanocytic nevus:0.925130 Basal cell carcinoma:0.818182 Actinic keratosis:0.655172 Benign keratosis:0.887850 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.613789 Melanocytic nevus:0.701201 Basal cell carcinoma:0.876115 Actinic keratosis:0.892693 Benign keratosis:0.688506 Dermatofibroma:0.880582 Vascular lesion:0.939516
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_77.pth

Epoch: 77, iteration: 0/43, ==> train <===, loss: 3.584782, classification loss: 1.822253,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138361,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033888,wcp loss: 0.000000,entropy loss: 1.867003,consistency weight: 1.000000, lr: 2.996906728784535e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 501.0, 33.0, 22.0, 51.0, 5.0, 10.0]

VAL Student: Epoch: 77, iteration: 42

VAL AUROC: 0.832780, VAL Accus: 0.580059, VAL Senss: 0.671755, VAL Specs: 0.880167
AUROCs: Melanoma:0.807925 Melanocytic nevus:0.912998 Basal cell carcinoma:0.925241 Actinic keratosis:0.917207 Benign keratosis:0.841467 Dermatofibroma:0.559578 Vascular lesion:0.865042
Accus: Melanoma:0.537815 Melanocytic nevus:0.755656 Basal cell carcinoma:0.611111 Actinic keratosis:0.666667 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.879336 Basal cell carcinoma:0.740741 Actinic keratosis:0.757576 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.818388 Melanocytic nevus:0.750742 Basal cell carcinoma:0.895349 Actinic keratosis:0.921406 Benign keratosis:0.855556 Dermatofibroma:0.933943 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1027.0, 75.0, 27.0, 124.0, 5.0, 28.0]

TEST Student: Epoch: 77, iteration: 42

TEST AUROC: 0.856843, TEST Accus: 0.598572, TEST Senss: 0.814128, TEST Specs: 0.792161
AUROCs: Melanoma:0.830138 Melanocytic nevus:0.918853 Basal cell carcinoma:0.913667 Actinic keratosis:0.847656 Benign keratosis:0.857138 Dermatofibroma:0.633650 Vascular lesion:0.996797
Accus: Melanoma:0.571429 Melanocytic nevus:0.761305 Basal cell carcinoma:0.681818 Actinic keratosis:0.465517 Benign keratosis:0.579439 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.861472 Melanocytic nevus:0.945145 Basal cell carcinoma:0.927273 Actinic keratosis:0.724138 Benign keratosis:0.831776 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.649103 Melanocytic nevus:0.624625 Basal cell carcinoma:0.794751 Actinic keratosis:0.880940 Benign keratosis:0.737923 Dermatofibroma:0.906172 Vascular lesion:0.951613
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_78.pth

Epoch: 78, iteration: 0/43, ==> train <===, loss: 3.539816, classification loss: 1.787454,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.136576,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021755,wcp loss: 0.000000,entropy loss: 1.867183,consistency weight: 1.000000, lr: 2.6972160559060813e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 478.0, 28.0, 20.0, 47.0, 5.0, 10.0]

VAL Student: Epoch: 78, iteration: 42

VAL AUROC: 0.845316, VAL Accus: 0.555907, VAL Senss: 0.663596, VAL Specs: 0.880578
AUROCs: Melanoma:0.819313 Melanocytic nevus:0.915983 Basal cell carcinoma:0.930056 Actinic keratosis:0.929115 Benign keratosis:0.836167 Dermatofibroma:0.616997 Vascular lesion:0.869577
Accus: Melanoma:0.596639 Melanocytic nevus:0.720965 Basal cell carcinoma:0.518519 Actinic keratosis:0.606061 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.756303 Melanocytic nevus:0.865762 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.771850 Melanocytic nevus:0.786350 Basal cell carcinoma:0.915433 Actinic keratosis:0.919338 Benign keratosis:0.877778 Dermatofibroma:0.899390 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [150.0, 990.0, 72.0, 30.0, 110.0, 6.0, 24.0]

TEST Student: Epoch: 78, iteration: 42

TEST AUROC: 0.865460, TEST Accus: 0.587993, TEST Senss: 0.823100, TEST Specs: 0.797302
AUROCs: Melanoma:0.845350 Melanocytic nevus:0.921787 Basal cell carcinoma:0.912121 Actinic keratosis:0.867637 Benign keratosis:0.860021 Dermatofibroma:0.654244 Vascular lesion:0.997057
Accus: Melanoma:0.649351 Melanocytic nevus:0.733877 Basal cell carcinoma:0.654545 Actinic keratosis:0.517241 Benign keratosis:0.514019 Dermatofibroma:0.272727 Vascular lesion:0.774194
Senss: Melanoma:0.909091 Melanocytic nevus:0.937732 Basal cell carcinoma:0.909091 Actinic keratosis:0.724138 Benign keratosis:0.827103 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.592489 Melanocytic nevus:0.651652 Basal cell carcinoma:0.833071 Actinic keratosis:0.890138 Benign keratosis:0.767907 Dermatofibroma:0.868540 Vascular lesion:0.977319
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_79.pth

Epoch: 79, iteration: 0/43, ==> train <===, loss: 3.559066, classification loss: 1.804120,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140955,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030129,wcp loss: 0.000000,entropy loss: 1.865772,consistency weight: 1.000000, lr: 2.4274944503154732e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 541.0, 27.0, 27.0, 30.0, 5.0, 10.0]

VAL Student: Epoch: 79, iteration: 42

VAL AUROC: 0.840773, VAL Accus: 0.558448, VAL Senss: 0.634210, VAL Specs: 0.883979
AUROCs: Melanoma:0.812560 Melanocytic nevus:0.913942 Basal cell carcinoma:0.916216 Actinic keratosis:0.936730 Benign keratosis:0.773733 Dermatofibroma:0.646405 Vascular lesion:0.885821
Accus: Melanoma:0.495798 Melanocytic nevus:0.815988 Basal cell carcinoma:0.500000 Actinic keratosis:0.818182 Benign keratosis:0.300000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.680672 Melanocytic nevus:0.918552 Basal cell carcinoma:0.592593 Actinic keratosis:0.848485 Benign keratosis:0.420000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.818388 Melanocytic nevus:0.700297 Basal cell carcinoma:0.924947 Actinic keratosis:0.889349 Benign keratosis:0.954444 Dermatofibroma:0.923780 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [131.0, 1120.0, 67.0, 36.0, 81.0, 6.0, 29.0]

TEST Student: Epoch: 79, iteration: 42

TEST AUROC: 0.872072, TEST Accus: 0.601977, TEST Senss: 0.811328, TEST Specs: 0.806402
AUROCs: Melanoma:0.842151 Melanocytic nevus:0.917478 Basal cell carcinoma:0.907774 Actinic keratosis:0.914842 Benign keratosis:0.834394 Dermatofibroma:0.690371 Vascular lesion:0.997496
Accus: Melanoma:0.567100 Melanocytic nevus:0.830245 Basal cell carcinoma:0.609091 Actinic keratosis:0.620690 Benign keratosis:0.378505 Dermatofibroma:0.272727 Vascular lesion:0.935484
Senss: Melanoma:0.857143 Melanocytic nevus:0.959229 Basal cell carcinoma:0.854545 Actinic keratosis:0.844828 Benign keratosis:0.663551 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.677130 Melanocytic nevus:0.569069 Basal cell carcinoma:0.846194 Actinic keratosis:0.847215 Benign keratosis:0.875625 Dermatofibroma:0.900652 Vascular lesion:0.928931
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_80.pth

Epoch: 80, iteration: 0/43, ==> train <===, loss: 3.564831, classification loss: 1.804183,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142139,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033126,wcp loss: 0.000000,entropy loss: 1.869661,consistency weight: 1.000000, lr: 2.184745005283926e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 495.0, 25.0, 24.0, 58.0, 5.0, 10.0]

VAL Student: Epoch: 80, iteration: 42

VAL AUROC: 0.836790, VAL Accus: 0.571459, VAL Senss: 0.664958, VAL Specs: 0.882909
AUROCs: Melanoma:0.814029 Melanocytic nevus:0.910760 Basal cell carcinoma:0.911734 Actinic keratosis:0.919181 Benign keratosis:0.847189 Dermatofibroma:0.633384 Vascular lesion:0.821252
Accus: Melanoma:0.504202 Melanocytic nevus:0.746606 Basal cell carcinoma:0.462963 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.672269 Melanocytic nevus:0.865762 Basal cell carcinoma:0.629630 Actinic keratosis:0.787879 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.804767 Melanocytic nevus:0.783383 Basal cell carcinoma:0.928118 Actinic keratosis:0.903826 Benign keratosis:0.834444 Dermatofibroma:0.938008 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1021.0, 65.0, 34.0, 130.0, 4.0, 27.0]

TEST Student: Epoch: 80, iteration: 42

TEST AUROC: 0.860774, TEST Accus: 0.595095, TEST Senss: 0.823041, TEST Specs: 0.794916
AUROCs: Melanoma:0.835939 Melanocytic nevus:0.917450 Basal cell carcinoma:0.911668 Actinic keratosis:0.857338 Benign keratosis:0.859826 Dermatofibroma:0.646057 Vascular lesion:0.997138
Accus: Melanoma:0.571429 Melanocytic nevus:0.756857 Basal cell carcinoma:0.590909 Actinic keratosis:0.586207 Benign keratosis:0.607477 Dermatofibroma:0.181818 Vascular lesion:0.870968
Senss: Melanoma:0.883117 Melanocytic nevus:0.936990 Basal cell carcinoma:0.872727 Actinic keratosis:0.827586 Benign keratosis:0.831776 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.628363 Melanocytic nevus:0.653153 Basal cell carcinoma:0.849344 Actinic keratosis:0.849770 Benign keratosis:0.717934 Dermatofibroma:0.907175 Vascular lesion:0.958669
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_81.pth

Epoch: 81, iteration: 0/43, ==> train <===, loss: 3.545639, classification loss: 1.797735,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.135003,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018377,wcp loss: 0.000000,entropy loss: 1.864530,consistency weight: 1.000000, lr: 1.9662705047555335e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 530.0, 25.0, 23.0, 60.0, 4.0, 9.0]

VAL Student: Epoch: 81, iteration: 42

VAL AUROC: 0.834943, VAL Accus: 0.563878, VAL Senss: 0.666373, VAL Specs: 0.879702
AUROCs: Melanoma:0.825914 Melanocytic nevus:0.918440 Basal cell carcinoma:0.898775 Actinic keratosis:0.892232 Benign keratosis:0.865911 Dermatofibroma:0.578760 Vascular lesion:0.864569
Accus: Melanoma:0.537815 Melanocytic nevus:0.799397 Basal cell carcinoma:0.462963 Actinic keratosis:0.696970 Benign keratosis:0.600000 Dermatofibroma:0.250000 Vascular lesion:0.600000
Senss: Melanoma:0.714286 Melanocytic nevus:0.923077 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.787741 Melanocytic nevus:0.697329 Basal cell carcinoma:0.943975 Actinic keratosis:0.942089 Benign keratosis:0.835556 Dermatofibroma:0.957317 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1093.0, 57.0, 22.0, 141.0, 3.0, 25.0]

TEST Student: Epoch: 81, iteration: 42

TEST AUROC: 0.871535, TEST Accus: 0.558735, TEST Senss: 0.818173, TEST Specs: 0.790098
AUROCs: Melanoma:0.857881 Melanocytic nevus:0.921713 Basal cell carcinoma:0.920568 Actinic keratosis:0.865188 Benign keratosis:0.881953 Dermatofibroma:0.655818 Vascular lesion:0.997626
Accus: Melanoma:0.601732 Melanocytic nevus:0.810230 Basal cell carcinoma:0.518182 Actinic keratosis:0.379310 Benign keratosis:0.658879 Dermatofibroma:0.136364 Vascular lesion:0.806452
Senss: Melanoma:0.926407 Melanocytic nevus:0.967383 Basal cell carcinoma:0.854545 Actinic keratosis:0.655172 Benign keratosis:0.869159 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.605942 Melanocytic nevus:0.525526 Basal cell carcinoma:0.883465 Actinic keratosis:0.907001 Benign keratosis:0.695169 Dermatofibroma:0.938786 Vascular lesion:0.974798
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_82.pth

Epoch: 82, iteration: 0/43, ==> train <===, loss: 3.575945, classification loss: 1.824612,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144768,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029153,wcp loss: 0.000000,entropy loss: 1.866949,consistency weight: 1.000000, lr: 1.7696434542799804e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 467.0, 25.0, 26.0, 42.0, 5.0, 10.0]

VAL Student: Epoch: 82, iteration: 42

VAL AUROC: 0.848267, VAL Accus: 0.562031, VAL Senss: 0.635067, VAL Specs: 0.883541
AUROCs: Melanoma:0.806904 Melanocytic nevus:0.910823 Basal cell carcinoma:0.897463 Actinic keratosis:0.923443 Benign keratosis:0.833533 Dermatofibroma:0.684959 Vascular lesion:0.880745
Accus: Melanoma:0.579832 Melanocytic nevus:0.704374 Basal cell carcinoma:0.462963 Actinic keratosis:0.787879 Benign keratosis:0.420000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.714286 Melanocytic nevus:0.837104 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.772985 Melanocytic nevus:0.804154 Basal cell carcinoma:0.930233 Actinic keratosis:0.885212 Benign keratosis:0.898889 Dermatofibroma:0.916667 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 959.0, 60.0, 33.0, 110.0, 7.0, 30.0]

TEST Student: Epoch: 82, iteration: 42

TEST AUROC: 0.864196, TEST Accus: 0.609422, TEST Senss: 0.808541, TEST Specs: 0.806481
AUROCs: Melanoma:0.829094 Melanocytic nevus:0.920661 Basal cell carcinoma:0.901594 Actinic keratosis:0.878244 Benign keratosis:0.853620 Dermatofibroma:0.669251 Vascular lesion:0.996911
Accus: Melanoma:0.640693 Melanocytic nevus:0.710897 Basal cell carcinoma:0.545455 Actinic keratosis:0.568966 Benign keratosis:0.514019 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.874459 Melanocytic nevus:0.917717 Basal cell carcinoma:0.836364 Actinic keratosis:0.810345 Benign keratosis:0.766355 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.610426 Melanocytic nevus:0.719219 Basal cell carcinoma:0.856168 Actinic keratosis:0.842105 Benign keratosis:0.802887 Dermatofibroma:0.879579 Vascular lesion:0.934980
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_83.pth

Epoch: 83, iteration: 0/43, ==> train <===, loss: 3.593477, classification loss: 1.833686,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143277,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031365,wcp loss: 0.000000,entropy loss: 1.871704,consistency weight: 1.000000, lr: 1.5926791088519824e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 493.0, 23.0, 23.0, 55.0, 5.0, 11.0]

VAL Student: Epoch: 83, iteration: 42

VAL AUROC: 0.849219, VAL Accus: 0.572648, VAL Senss: 0.653500, VAL Specs: 0.883433
AUROCs: Melanoma:0.828585 Melanocytic nevus:0.917227 Basal cell carcinoma:0.891336 Actinic keratosis:0.909279 Benign keratosis:0.861267 Dermatofibroma:0.646214 Vascular lesion:0.890626
Accus: Melanoma:0.546218 Melanocytic nevus:0.743590 Basal cell carcinoma:0.425926 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.705882 Melanocytic nevus:0.868778 Basal cell carcinoma:0.537037 Actinic keratosis:0.696970 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.791146 Melanocytic nevus:0.774481 Basal cell carcinoma:0.947146 Actinic keratosis:0.931748 Benign keratosis:0.841111 Dermatofibroma:0.921748 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1022.0, 56.0, 27.0, 136.0, 4.0, 30.0]

TEST Student: Epoch: 83, iteration: 42

TEST AUROC: 0.868727, TEST Accus: 0.590286, TEST Senss: 0.806554, TEST Specs: 0.803436
AUROCs: Melanoma:0.850101 Melanocytic nevus:0.922832 Basal cell carcinoma:0.909683 Actinic keratosis:0.862377 Benign keratosis:0.881008 Dermatofibroma:0.657985 Vascular lesion:0.997106
Accus: Melanoma:0.614719 Melanocytic nevus:0.757598 Basal cell carcinoma:0.509091 Actinic keratosis:0.465517 Benign keratosis:0.635514 Dermatofibroma:0.181818 Vascular lesion:0.967742
Senss: Melanoma:0.909091 Melanocytic nevus:0.936249 Basal cell carcinoma:0.809091 Actinic keratosis:0.672414 Benign keratosis:0.864486 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.622758 Melanocytic nevus:0.662162 Basal cell carcinoma:0.885564 Actinic keratosis:0.898314 Benign keratosis:0.730705 Dermatofibroma:0.899649 Vascular lesion:0.924899
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_84.pth

Epoch: 84, iteration: 0/43, ==> train <===, loss: 3.547400, classification loss: 1.790552,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137037,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026795,wcp loss: 0.000000,entropy loss: 1.867091,consistency weight: 1.000000, lr: 1.4334111979667841e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 501.0, 25.0, 23.0, 55.0, 5.0, 10.0]

VAL Student: Epoch: 84, iteration: 42

VAL AUROC: 0.840538, VAL Accus: 0.571340, VAL Senss: 0.659091, VAL Specs: 0.878992
AUROCs: Melanoma:0.823262 Melanocytic nevus:0.917133 Basal cell carcinoma:0.900419 Actinic keratosis:0.922879 Benign keratosis:0.842378 Dermatofibroma:0.630653 Vascular lesion:0.847039
Accus: Melanoma:0.554622 Melanocytic nevus:0.755656 Basal cell carcinoma:0.462963 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.883861 Basal cell carcinoma:0.555556 Actinic keratosis:0.757576 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.791146 Melanocytic nevus:0.756677 Basal cell carcinoma:0.939746 Actinic keratosis:0.919338 Benign keratosis:0.834444 Dermatofibroma:0.917683 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1034.0, 60.0, 31.0, 134.0, 4.0, 24.0]

TEST Student: Epoch: 84, iteration: 42

TEST AUROC: 0.866372, TEST Accus: 0.576382, TEST Senss: 0.820183, TEST Specs: 0.795091
AUROCs: Melanoma:0.847837 Melanocytic nevus:0.920399 Basal cell carcinoma:0.912312 Actinic keratosis:0.866650 Benign keratosis:0.868422 Dermatofibroma:0.651827 Vascular lesion:0.997155
Accus: Melanoma:0.606061 Melanocytic nevus:0.766494 Basal cell carcinoma:0.545455 Actinic keratosis:0.534483 Benign keratosis:0.626168 Dermatofibroma:0.181818 Vascular lesion:0.774194
Senss: Melanoma:0.896104 Melanocytic nevus:0.946627 Basal cell carcinoma:0.836364 Actinic keratosis:0.775862 Benign keratosis:0.831776 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.618834 Melanocytic nevus:0.614114 Basal cell carcinoma:0.874016 Actinic keratosis:0.879407 Benign keratosis:0.711827 Dermatofibroma:0.889112 Vascular lesion:0.978327
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_85.pth

Epoch: 85, iteration: 0/43, ==> train <===, loss: 3.623350, classification loss: 1.878647,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145894,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025086,wcp loss: 0.000000,entropy loss: 1.865511,consistency weight: 1.000000, lr: 1.2900700781701057e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 512.0, 22.0, 27.0, 44.0, 5.0, 10.0]

VAL Student: Epoch: 85, iteration: 42

VAL AUROC: 0.845700, VAL Accus: 0.560172, VAL Senss: 0.662901, VAL Specs: 0.882110
AUROCs: Melanoma:0.813857 Melanocytic nevus:0.914099 Basal cell carcinoma:0.905509 Actinic keratosis:0.935602 Benign keratosis:0.841967 Dermatofibroma:0.643483 Vascular lesion:0.865381
Accus: Melanoma:0.504202 Melanocytic nevus:0.772247 Basal cell carcinoma:0.407407 Actinic keratosis:0.818182 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.891403 Basal cell carcinoma:0.518519 Actinic keratosis:0.909091 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.820658 Melanocytic nevus:0.747774 Basal cell carcinoma:0.940803 Actinic keratosis:0.883144 Benign keratosis:0.891111 Dermatofibroma:0.910569 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 1069.0, 53.0, 39.0, 120.0, 6.0, 30.0]

TEST Student: Epoch: 85, iteration: 42

TEST AUROC: 0.869080, TEST Accus: 0.614571, TEST Senss: 0.825492, TEST Specs: 0.796855
AUROCs: Melanoma:0.832693 Melanocytic nevus:0.920499 Basal cell carcinoma:0.898105 Actinic keratosis:0.896561 Benign keratosis:0.860436 Dermatofibroma:0.677622 Vascular lesion:0.997642
Accus: Melanoma:0.554113 Melanocytic nevus:0.792439 Basal cell carcinoma:0.481818 Actinic keratosis:0.672414 Benign keratosis:0.560748 Dermatofibroma:0.272727 Vascular lesion:0.967742
Senss: Melanoma:0.857143 Melanocytic nevus:0.951075 Basal cell carcinoma:0.809091 Actinic keratosis:0.862069 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.642937 Melanocytic nevus:0.611111 Basal cell carcinoma:0.869816 Actinic keratosis:0.840061 Benign keratosis:0.782898 Dermatofibroma:0.886603 Vascular lesion:0.944556
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_86.pth

Epoch: 86, iteration: 0/43, ==> train <===, loss: 3.530408, classification loss: 1.788569,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142211,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022115,wcp loss: 0.000000,entropy loss: 1.861935,consistency weight: 1.000000, lr: 1.1610630703530951e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 504.0, 20.0, 23.0, 41.0, 5.0, 11.0]

VAL Student: Epoch: 86, iteration: 42

VAL AUROC: 0.844606, VAL Accus: 0.549483, VAL Senss: 0.665033, VAL Specs: 0.883655
AUROCs: Melanoma:0.824769 Melanocytic nevus:0.917115 Basal cell carcinoma:0.868354 Actinic keratosis:0.911755 Benign keratosis:0.846111 Dermatofibroma:0.655742 Vascular lesion:0.888393
Accus: Melanoma:0.563025 Melanocytic nevus:0.760181 Basal cell carcinoma:0.370370 Actinic keratosis:0.696970 Benign keratosis:0.410000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.889894 Basal cell carcinoma:0.518519 Actinic keratosis:0.787879 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.777526 Melanocytic nevus:0.762611 Basal cell carcinoma:0.956660 Actinic keratosis:0.903826 Benign keratosis:0.885556 Dermatofibroma:0.917683 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1045.0, 50.0, 32.0, 117.0, 7.0, 30.0]

TEST Student: Epoch: 86, iteration: 42

TEST AUROC: 0.871125, TEST Accus: 0.609607, TEST Senss: 0.805013, TEST Specs: 0.803563
AUROCs: Melanoma:0.851147 Melanocytic nevus:0.919334 Basal cell carcinoma:0.906657 Actinic keratosis:0.866210 Benign keratosis:0.871717 Dermatofibroma:0.685376 Vascular lesion:0.997431
Accus: Melanoma:0.653680 Melanocytic nevus:0.774648 Basal cell carcinoma:0.454545 Actinic keratosis:0.551724 Benign keratosis:0.546729 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.904762 Melanocytic nevus:0.948851 Basal cell carcinoma:0.781818 Actinic keratosis:0.741379 Benign keratosis:0.803738 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.603700 Melanocytic nevus:0.626126 Basal cell carcinoma:0.903937 Actinic keratosis:0.868166 Benign keratosis:0.787340 Dermatofibroma:0.891621 Vascular lesion:0.944052
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_87.pth

Epoch: 87, iteration: 0/43, ==> train <===, loss: 3.534810, classification loss: 1.786201,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138502,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018922,wcp loss: 0.000000,entropy loss: 1.868189,consistency weight: 1.000000, lr: 1.0449567633177856e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 455.0, 28.0, 23.0, 63.0, 5.0, 10.0]

VAL Student: Epoch: 87, iteration: 42

VAL AUROC: 0.844309, VAL Accus: 0.580793, VAL Senss: 0.674426, VAL Specs: 0.880570
AUROCs: Melanoma:0.812160 Melanocytic nevus:0.910312 Basal cell carcinoma:0.926220 Actinic keratosis:0.918147 Benign keratosis:0.857178 Dermatofibroma:0.627668 Vascular lesion:0.858477
Accus: Melanoma:0.554622 Melanocytic nevus:0.686275 Basal cell carcinoma:0.518519 Actinic keratosis:0.696970 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.838612 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.800000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.766175 Melanocytic nevus:0.816024 Basal cell carcinoma:0.922833 Actinic keratosis:0.920372 Benign keratosis:0.806667 Dermatofibroma:0.943089 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 947.0, 67.0, 26.0, 139.0, 4.0, 25.0]

TEST Student: Epoch: 87, iteration: 42

TEST AUROC: 0.860778, TEST Accus: 0.568798, TEST Senss: 0.821941, TEST Specs: 0.799009
AUROCs: Melanoma:0.836837 Melanocytic nevus:0.923874 Basal cell carcinoma:0.910904 Actinic keratosis:0.858686 Benign keratosis:0.873142 Dermatofibroma:0.625257 Vascular lesion:0.996748
Accus: Melanoma:0.584416 Melanocytic nevus:0.702001 Basal cell carcinoma:0.609091 Actinic keratosis:0.448276 Benign keratosis:0.649533 Dermatofibroma:0.181818 Vascular lesion:0.806452
Senss: Melanoma:0.909091 Melanocytic nevus:0.911787 Basal cell carcinoma:0.881818 Actinic keratosis:0.758621 Benign keratosis:0.883178 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.571188 Melanocytic nevus:0.737237 Basal cell carcinoma:0.842520 Actinic keratosis:0.888605 Benign keratosis:0.679622 Dermatofibroma:0.910687 Vascular lesion:0.963206
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_88.pth

Epoch: 88, iteration: 0/43, ==> train <===, loss: 3.544565, classification loss: 1.790013,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.131609,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018756,wcp loss: 0.000000,entropy loss: 1.867404,consistency weight: 1.000000, lr: 9.40461086986007e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 477.0, 24.0, 27.0, 44.0, 5.0, 10.0]

VAL Student: Epoch: 88, iteration: 42

VAL AUROC: 0.848062, VAL Accus: 0.562724, VAL Senss: 0.639129, VAL Specs: 0.882259
AUROCs: Melanoma:0.814172 Melanocytic nevus:0.914269 Basal cell carcinoma:0.906996 Actinic keratosis:0.932061 Benign keratosis:0.818278 Dermatofibroma:0.657393 Vascular lesion:0.893266
Accus: Melanoma:0.537815 Melanocytic nevus:0.719457 Basal cell carcinoma:0.444444 Actinic keratosis:0.818182 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.647059 Melanocytic nevus:0.867270 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.809308 Melanocytic nevus:0.780415 Basal cell carcinoma:0.935518 Actinic keratosis:0.888314 Benign keratosis:0.893333 Dermatofibroma:0.892276 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1001.0, 60.0, 38.0, 118.0, 7.0, 30.0]

TEST Student: Epoch: 88, iteration: 42

TEST AUROC: 0.866024, TEST Accus: 0.622867, TEST Senss: 0.816033, TEST Specs: 0.797888
AUROCs: Melanoma:0.831215 Melanocytic nevus:0.920457 Basal cell carcinoma:0.902787 Actinic keratosis:0.896622 Benign keratosis:0.854398 Dermatofibroma:0.659194 Vascular lesion:0.997496
Accus: Melanoma:0.580087 Melanocytic nevus:0.742031 Basal cell carcinoma:0.545455 Actinic keratosis:0.655172 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.865801 Melanocytic nevus:0.938473 Basal cell carcinoma:0.845455 Actinic keratosis:0.827586 Benign keratosis:0.780374 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.649664 Melanocytic nevus:0.671171 Basal cell carcinoma:0.855118 Actinic keratosis:0.842616 Benign keratosis:0.791782 Dermatofibroma:0.852484 Vascular lesion:0.922379
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_89.pth

Epoch: 89, iteration: 0/43, ==> train <===, loss: 3.553869, classification loss: 1.805365,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141940,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025058,wcp loss: 0.000000,entropy loss: 1.865387,consistency weight: 1.000000, lr: 8.464149782874063e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 477.0, 29.0, 22.0, 51.0, 5.0, 10.0]

VAL Student: Epoch: 89, iteration: 42

VAL AUROC: 0.852913, VAL Accus: 0.563106, VAL Senss: 0.664929, VAL Specs: 0.881113
AUROCs: Melanoma:0.807467 Melanocytic nevus:0.909762 Basal cell carcinoma:0.907721 Actinic keratosis:0.918085 Benign keratosis:0.839756 Dermatofibroma:0.685404 Vascular lesion:0.902200
Accus: Melanoma:0.529412 Melanocytic nevus:0.719457 Basal cell carcinoma:0.537037 Actinic keratosis:0.666667 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.672269 Melanocytic nevus:0.850679 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.810443 Melanocytic nevus:0.786350 Basal cell carcinoma:0.919662 Actinic keratosis:0.920372 Benign keratosis:0.860000 Dermatofibroma:0.897358 Vascular lesion:0.973604
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1012.0, 71.0, 29.0, 126.0, 7.0, 30.0]

TEST Student: Epoch: 89, iteration: 42

TEST AUROC: 0.860276, TEST Accus: 0.621491, TEST Senss: 0.804133, TEST Specs: 0.800181
AUROCs: Melanoma:0.827053 Melanocytic nevus:0.915903 Basal cell carcinoma:0.908308 Actinic keratosis:0.846272 Benign keratosis:0.861352 Dermatofibroma:0.666150 Vascular lesion:0.996895
Accus: Melanoma:0.580087 Melanocytic nevus:0.750185 Basal cell carcinoma:0.645455 Actinic keratosis:0.500000 Benign keratosis:0.588785 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.852814 Melanocytic nevus:0.933284 Basal cell carcinoma:0.863636 Actinic keratosis:0.706897 Benign keratosis:0.817757 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.644619 Melanocytic nevus:0.675676 Basal cell carcinoma:0.845144 Actinic keratosis:0.884006 Benign keratosis:0.762909 Dermatofibroma:0.866533 Vascular lesion:0.922379
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_90.pth

Epoch: 90, iteration: 0/43, ==> train <===, loss: 3.572424, classification loss: 1.816017,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.134342,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020046,wcp loss: 0.000000,entropy loss: 1.870703,consistency weight: 1.000000, lr: 7.617734804586658e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 514.0, 26.0, 23.0, 52.0, 4.0, 10.0]

VAL Student: Epoch: 90, iteration: 42

VAL AUROC: 0.838159, VAL Accus: 0.564772, VAL Senss: 0.651769, VAL Specs: 0.883215
AUROCs: Melanoma:0.822022 Melanocytic nevus:0.917411 Basal cell carcinoma:0.902866 Actinic keratosis:0.925418 Benign keratosis:0.849056 Dermatofibroma:0.596735 Vascular lesion:0.853604
Accus: Melanoma:0.563025 Melanocytic nevus:0.775264 Basal cell carcinoma:0.481481 Actinic keratosis:0.696970 Benign keratosis:0.520000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.892911 Basal cell carcinoma:0.555556 Actinic keratosis:0.727273 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.790011 Melanocytic nevus:0.744807 Basal cell carcinoma:0.941860 Actinic keratosis:0.920372 Benign keratosis:0.855556 Dermatofibroma:0.947154 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1058.0, 58.0, 30.0, 130.0, 4.0, 29.0]

TEST Student: Epoch: 90, iteration: 42

TEST AUROC: 0.870097, TEST Accus: 0.594852, TEST Senss: 0.815452, TEST Specs: 0.807573
AUROCs: Melanoma:0.851485 Melanocytic nevus:0.922838 Basal cell carcinoma:0.908800 Actinic keratosis:0.879011 Benign keratosis:0.872137 Dermatofibroma:0.658669 Vascular lesion:0.997740
Accus: Melanoma:0.610390 Melanocytic nevus:0.784285 Basal cell carcinoma:0.527273 Actinic keratosis:0.517241 Benign keratosis:0.607477 Dermatofibroma:0.181818 Vascular lesion:0.935484
Senss: Melanoma:0.904762 Melanocytic nevus:0.954040 Basal cell carcinoma:0.809091 Actinic keratosis:0.758621 Benign keratosis:0.827103 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.634529 Melanocytic nevus:0.618619 Basal cell carcinoma:0.879265 Actinic keratosis:0.887072 Benign keratosis:0.750139 Dermatofibroma:0.928751 Vascular lesion:0.954637
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_91.pth

Epoch: 91, iteration: 0/43, ==> train <===, loss: 3.558658, classification loss: 1.793517,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.134948,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031681,wcp loss: 0.000000,entropy loss: 1.868409,consistency weight: 1.000000, lr: 6.855961324127992e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 468.0, 22.0, 26.0, 47.0, 5.0, 10.0]

VAL Student: Epoch: 91, iteration: 42

VAL AUROC: 0.845412, VAL Accus: 0.555450, VAL Senss: 0.658996, VAL Specs: 0.880654
AUROCs: Melanoma:0.806236 Melanocytic nevus:0.908370 Basal cell carcinoma:0.903551 Actinic keratosis:0.929491 Benign keratosis:0.837467 Dermatofibroma:0.666984 Vascular lesion:0.865787
Accus: Melanoma:0.537815 Melanocytic nevus:0.705882 Basal cell carcinoma:0.407407 Actinic keratosis:0.787879 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.663866 Melanocytic nevus:0.835596 Basal cell carcinoma:0.555556 Actinic keratosis:0.878788 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.794552 Melanocytic nevus:0.807122 Basal cell carcinoma:0.932347 Actinic keratosis:0.877973 Benign keratosis:0.863333 Dermatofibroma:0.910569 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [136.0, 980.0, 58.0, 40.0, 123.0, 6.0, 30.0]

TEST Student: Epoch: 91, iteration: 42

TEST AUROC: 0.861975, TEST Accus: 0.621053, TEST Senss: 0.816044, TEST Specs: 0.803906
AUROCs: Melanoma:0.821751 Melanocytic nevus:0.921225 Basal cell carcinoma:0.897705 Actinic keratosis:0.888226 Benign keratosis:0.859385 Dermatofibroma:0.648246 Vascular lesion:0.997285
Accus: Melanoma:0.588745 Melanocytic nevus:0.726464 Basal cell carcinoma:0.527273 Actinic keratosis:0.689655 Benign keratosis:0.574766 Dermatofibroma:0.272727 Vascular lesion:0.967742
Senss: Melanoma:0.861472 Melanocytic nevus:0.919941 Basal cell carcinoma:0.809091 Actinic keratosis:0.844828 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.632848 Melanocytic nevus:0.720721 Basal cell carcinoma:0.858793 Actinic keratosis:0.825754 Benign keratosis:0.765130 Dermatofibroma:0.887607 Vascular lesion:0.936492
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_92.pth

Epoch: 92, iteration: 0/43, ==> train <===, loss: 3.566193, classification loss: 1.816690,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142434,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025588,wcp loss: 0.000000,entropy loss: 1.866349,consistency weight: 1.000000, lr: 6.170365191715193e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [75.0, 507.0, 17.0, 20.0, 61.0, 5.0, 11.0]

VAL Student: Epoch: 92, iteration: 42

VAL AUROC: 0.833366, VAL Accus: 0.567381, VAL Senss: 0.659773, VAL Specs: 0.877412
AUROCs: Melanoma:0.837322 Melanocytic nevus:0.921900 Basal cell carcinoma:0.853222 Actinic keratosis:0.861709 Benign keratosis:0.869167 Dermatofibroma:0.606517 Vascular lesion:0.883723
Accus: Melanoma:0.630252 Melanocytic nevus:0.764706 Basal cell carcinoma:0.314815 Actinic keratosis:0.606061 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.823529 Melanocytic nevus:0.904977 Basal cell carcinoma:0.407407 Actinic keratosis:0.666667 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.728717 Melanocytic nevus:0.741840 Basal cell carcinoma:0.969345 Actinic keratosis:0.942089 Benign keratosis:0.830000 Dermatofibroma:0.943089 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [158.0, 1041.0, 43.0, 24.0, 134.0, 3.0, 26.0]

TEST Student: Epoch: 92, iteration: 42

TEST AUROC: 0.866155, TEST Accus: 0.551658, TEST Senss: 0.799035, TEST Specs: 0.790025
AUROCs: Melanoma:0.859865 Melanocytic nevus:0.920871 Basal cell carcinoma:0.906566 Actinic keratosis:0.833374 Benign keratosis:0.887373 Dermatofibroma:0.657780 Vascular lesion:0.997252
Accus: Melanoma:0.683983 Melanocytic nevus:0.771683 Basal cell carcinoma:0.390909 Actinic keratosis:0.413793 Benign keratosis:0.626168 Dermatofibroma:0.136364 Vascular lesion:0.838710
Senss: Melanoma:0.948052 Melanocytic nevus:0.955523 Basal cell carcinoma:0.700000 Actinic keratosis:0.637931 Benign keratosis:0.897196 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.538117 Melanocytic nevus:0.587087 Basal cell carcinoma:0.932283 Actinic keratosis:0.914154 Benign keratosis:0.695725 Dermatofibroma:0.910186 Vascular lesion:0.952621
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_93.pth

Epoch: 93, iteration: 0/43, ==> train <===, loss: 3.567910, classification loss: 1.829120,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138871,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015250,wcp loss: 0.000000,entropy loss: 1.862412,consistency weight: 1.000000, lr: 5.553328672543673e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 515.0, 23.0, 22.0, 54.0, 5.0, 10.0]

VAL Student: Epoch: 93, iteration: 42

VAL AUROC: 0.845311, VAL Accus: 0.553704, VAL Senss: 0.658582, VAL Specs: 0.882612
AUROCs: Melanoma:0.819409 Melanocytic nevus:0.912398 Basal cell carcinoma:0.916706 Actinic keratosis:0.925324 Benign keratosis:0.835900 Dermatofibroma:0.641451 Vascular lesion:0.865990
Accus: Melanoma:0.487395 Melanocytic nevus:0.776772 Basal cell carcinoma:0.425926 Actinic keratosis:0.666667 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.883861 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.835414 Melanocytic nevus:0.753709 Basal cell carcinoma:0.947146 Actinic keratosis:0.914168 Benign keratosis:0.835556 Dermatofibroma:0.908537 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [125.0, 1059.0, 55.0, 36.0, 134.0, 7.0, 29.0]

TEST Student: Epoch: 93, iteration: 42

TEST AUROC: 0.870168, TEST Accus: 0.618096, TEST Senss: 0.810110, TEST Specs: 0.803011
AUROCs: Melanoma:0.849637 Melanocytic nevus:0.920477 Basal cell carcinoma:0.912656 Actinic keratosis:0.875090 Benign keratosis:0.871652 Dermatofibroma:0.664690 Vascular lesion:0.996976
Accus: Melanoma:0.541126 Melanocytic nevus:0.785026 Basal cell carcinoma:0.500000 Actinic keratosis:0.620690 Benign keratosis:0.626168 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.861472 Melanocytic nevus:0.947368 Basal cell carcinoma:0.809091 Actinic keratosis:0.775862 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.687780 Melanocytic nevus:0.623123 Basal cell carcinoma:0.883465 Actinic keratosis:0.877874 Benign keratosis:0.725708 Dermatofibroma:0.879077 Vascular lesion:0.944052
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_94.pth

Epoch: 94, iteration: 0/43, ==> train <===, loss: 3.670566, classification loss: 1.921624,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137361,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022613,wcp loss: 0.000000,entropy loss: 1.863690,consistency weight: 1.000000, lr: 4.997995805289306e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 461.0, 27.0, 22.0, 58.0, 5.0, 10.0]

VAL Student: Epoch: 94, iteration: 42

VAL AUROC: 0.839674, VAL Accus: 0.575171, VAL Senss: 0.666441, VAL Specs: 0.877109
AUROCs: Melanoma:0.811416 Melanocytic nevus:0.910572 Basal cell carcinoma:0.914729 Actinic keratosis:0.890884 Benign keratosis:0.860600 Dermatofibroma:0.643356 Vascular lesion:0.846159
Accus: Melanoma:0.605042 Melanocytic nevus:0.695324 Basal cell carcinoma:0.500000 Actinic keratosis:0.666667 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.705882 Melanocytic nevus:0.843137 Basal cell carcinoma:0.629630 Actinic keratosis:0.727273 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.751419 Melanocytic nevus:0.804154 Basal cell carcinoma:0.927061 Actinic keratosis:0.914168 Benign keratosis:0.822222 Dermatofibroma:0.927846 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [145.0, 957.0, 67.0, 25.0, 136.0, 5.0, 25.0]

TEST Student: Epoch: 94, iteration: 42

TEST AUROC: 0.859858, TEST Accus: 0.578069, TEST Senss: 0.822382, TEST Specs: 0.788653
AUROCs: Melanoma:0.834382 Melanocytic nevus:0.918641 Basal cell carcinoma:0.915777 Actinic keratosis:0.842951 Benign keratosis:0.872501 Dermatofibroma:0.637892 Vascular lesion:0.996862
Accus: Melanoma:0.627706 Melanocytic nevus:0.709414 Basal cell carcinoma:0.609091 Actinic keratosis:0.431034 Benign keratosis:0.635514 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.904762 Melanocytic nevus:0.924388 Basal cell carcinoma:0.900000 Actinic keratosis:0.758621 Benign keratosis:0.859813 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.547646 Melanocytic nevus:0.698198 Basal cell carcinoma:0.844094 Actinic keratosis:0.860501 Benign keratosis:0.700722 Dermatofibroma:0.899649 Vascular lesion:0.969758
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_95.pth

Epoch: 95, iteration: 0/43, ==> train <===, loss: 3.551226, classification loss: 1.790963,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140981,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.035154,wcp loss: 0.000000,entropy loss: 1.866090,consistency weight: 1.000000, lr: 4.498196224760376e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 488.0, 20.0, 24.0, 57.0, 5.0, 10.0]

VAL Student: Epoch: 95, iteration: 42

VAL AUROC: 0.839420, VAL Accus: 0.563698, VAL Senss: 0.667460, VAL Specs: 0.884733
AUROCs: Melanoma:0.825523 Melanocytic nevus:0.913924 Basal cell carcinoma:0.883799 Actinic keratosis:0.915672 Benign keratosis:0.862289 Dermatofibroma:0.627223 Vascular lesion:0.847513
Accus: Melanoma:0.563025 Melanocytic nevus:0.736048 Basal cell carcinoma:0.370370 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.722689 Melanocytic nevus:0.868778 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.774120 Melanocytic nevus:0.786350 Basal cell carcinoma:0.952431 Actinic keratosis:0.899690 Benign keratosis:0.845556 Dermatofibroma:0.956301 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [149.0, 1007.0, 49.0, 33.0, 130.0, 4.0, 30.0]

TEST Student: Epoch: 95, iteration: 42

TEST AUROC: 0.864318, TEST Accus: 0.594708, TEST Senss: 0.803663, TEST Specs: 0.802570
AUROCs: Melanoma:0.843651 Melanocytic nevus:0.920948 Basal cell carcinoma:0.905044 Actinic keratosis:0.871416 Benign keratosis:0.872003 Dermatofibroma:0.640332 Vascular lesion:0.996829
Accus: Melanoma:0.645022 Melanocytic nevus:0.746479 Basal cell carcinoma:0.445455 Actinic keratosis:0.568966 Benign keratosis:0.607477 Dermatofibroma:0.181818 Vascular lesion:0.967742
Senss: Melanoma:0.904762 Melanocytic nevus:0.932543 Basal cell carcinoma:0.754545 Actinic keratosis:0.810345 Benign keratosis:0.859813 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.590247 Melanocytic nevus:0.674174 Basal cell carcinoma:0.896063 Actinic keratosis:0.848237 Benign keratosis:0.733481 Dermatofibroma:0.936779 Vascular lesion:0.939012
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_96.pth

Epoch: 96, iteration: 0/43, ==> train <===, loss: 3.552556, classification loss: 1.795652,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137023,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028859,wcp loss: 0.000000,entropy loss: 1.865069,consistency weight: 1.000000, lr: 4.048376602284338e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 435.0, 28.0, 24.0, 56.0, 5.0, 10.0]

VAL Student: Epoch: 96, iteration: 42

VAL AUROC: 0.839843, VAL Accus: 0.573214, VAL Senss: 0.671623, VAL Specs: 0.877385
AUROCs: Melanoma:0.802316 Melanocytic nevus:0.907130 Basal cell carcinoma:0.904099 Actinic keratosis:0.922785 Benign keratosis:0.841133 Dermatofibroma:0.648374 Vascular lesion:0.853063
Accus: Melanoma:0.571429 Melanocytic nevus:0.656109 Basal cell carcinoma:0.518519 Actinic keratosis:0.727273 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.822021 Basal cell carcinoma:0.648148 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.776390 Melanocytic nevus:0.816024 Basal cell carcinoma:0.921776 Actinic keratosis:0.902792 Benign keratosis:0.834444 Dermatofibroma:0.915650 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 920.0, 65.0, 34.0, 131.0, 5.0, 30.0]

TEST Student: Epoch: 96, iteration: 42

TEST AUROC: 0.855511, TEST Accus: 0.608477, TEST Senss: 0.809935, TEST Specs: 0.800899
AUROCs: Melanoma:0.820611 Melanocytic nevus:0.920799 Basal cell carcinoma:0.904333 Actinic keratosis:0.859977 Benign keratosis:0.855841 Dermatofibroma:0.630479 Vascular lesion:0.996537
Accus: Melanoma:0.593074 Melanocytic nevus:0.681987 Basal cell carcinoma:0.590909 Actinic keratosis:0.586207 Benign keratosis:0.612150 Dermatofibroma:0.227273 Vascular lesion:0.967742
Senss: Melanoma:0.874459 Melanocytic nevus:0.902150 Basal cell carcinoma:0.863636 Actinic keratosis:0.793103 Benign keratosis:0.827103 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.602018 Melanocytic nevus:0.744745 Basal cell carcinoma:0.841995 Actinic keratosis:0.852836 Benign keratosis:0.734592 Dermatofibroma:0.896638 Vascular lesion:0.933468
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_97.pth

Epoch: 97, iteration: 0/43, ==> train <===, loss: 3.570945, classification loss: 1.816955,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137127,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025995,wcp loss: 0.000000,entropy loss: 1.865122,consistency weight: 1.000000, lr: 3.6435389420559043e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 537.0, 28.0, 23.0, 46.0, 4.0, 11.0]

VAL Student: Epoch: 97, iteration: 42

VAL AUROC: 0.844688, VAL Accus: 0.573571, VAL Senss: 0.662357, VAL Specs: 0.891350
AUROCs: Melanoma:0.830120 Melanocytic nevus:0.919174 Basal cell carcinoma:0.909894 Actinic keratosis:0.927956 Benign keratosis:0.849722 Dermatofibroma:0.605564 Vascular lesion:0.870389
Accus: Melanoma:0.546218 Melanocytic nevus:0.809955 Basal cell carcinoma:0.518519 Actinic keratosis:0.696970 Benign keratosis:0.460000 Dermatofibroma:0.250000 Vascular lesion:0.733333
Senss: Melanoma:0.722689 Melanocytic nevus:0.889894 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.791146 Melanocytic nevus:0.741840 Basal cell carcinoma:0.937632 Actinic keratosis:0.931748 Benign keratosis:0.888889 Dermatofibroma:0.969512 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1083.0, 64.0, 27.0, 119.0, 3.0, 29.0]

TEST Student: Epoch: 97, iteration: 42

TEST AUROC: 0.869244, TEST Accus: 0.587158, TEST Senss: 0.806539, TEST Specs: 0.814173
AUROCs: Melanoma:0.858752 Melanocytic nevus:0.921614 Basal cell carcinoma:0.915032 Actinic keratosis:0.869355 Benign keratosis:0.872900 Dermatofibroma:0.649478 Vascular lesion:0.997577
Accus: Melanoma:0.632035 Melanocytic nevus:0.802817 Basal cell carcinoma:0.581818 Actinic keratosis:0.465517 Benign keratosis:0.556075 Dermatofibroma:0.136364 Vascular lesion:0.935484
Senss: Melanoma:0.913420 Melanocytic nevus:0.950334 Basal cell carcinoma:0.854545 Actinic keratosis:0.655172 Benign keratosis:0.817757 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.628924 Melanocytic nevus:0.624625 Basal cell carcinoma:0.869291 Actinic keratosis:0.900358 Benign keratosis:0.785675 Dermatofibroma:0.951831 Vascular lesion:0.938508
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_98.pth

Epoch: 98, iteration: 0/43, ==> train <===, loss: 3.563175, classification loss: 1.818438,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140003,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016537,wcp loss: 0.000000,entropy loss: 1.868204,consistency weight: 1.000000, lr: 3.279185047850314e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 452.0, 27.0, 25.0, 56.0, 5.0, 10.0]

VAL Student: Epoch: 98, iteration: 42

VAL AUROC: 0.844090, VAL Accus: 0.573758, VAL Senss: 0.661180, VAL Specs: 0.881164
AUROCs: Melanoma:0.797718 Melanocytic nevus:0.908840 Basal cell carcinoma:0.910951 Actinic keratosis:0.923506 Benign keratosis:0.842100 Dermatofibroma:0.670287 Vascular lesion:0.855228
Accus: Melanoma:0.537815 Melanocytic nevus:0.681750 Basal cell carcinoma:0.500000 Actinic keratosis:0.757576 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.831071 Basal cell carcinoma:0.574074 Actinic keratosis:0.848485 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.807037 Melanocytic nevus:0.818991 Basal cell carcinoma:0.926004 Actinic keratosis:0.896587 Benign keratosis:0.833333 Dermatofibroma:0.901423 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 953.0, 64.0, 33.0, 133.0, 7.0, 30.0]

TEST Student: Epoch: 98, iteration: 42

TEST AUROC: 0.861235, TEST Accus: 0.616966, TEST Senss: 0.814295, TEST Specs: 0.807019
AUROCs: Melanoma:0.817039 Melanocytic nevus:0.922194 Basal cell carcinoma:0.904376 Actinic keratosis:0.879504 Benign keratosis:0.863778 Dermatofibroma:0.644620 Vascular lesion:0.997138
Accus: Melanoma:0.554113 Melanocytic nevus:0.706449 Basal cell carcinoma:0.581818 Actinic keratosis:0.568966 Benign keratosis:0.621495 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.831169 Melanocytic nevus:0.913269 Basal cell carcinoma:0.863636 Actinic keratosis:0.810345 Benign keratosis:0.827103 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.641816 Melanocytic nevus:0.740240 Basal cell carcinoma:0.851969 Actinic keratosis:0.862034 Benign keratosis:0.732926 Dermatofibroma:0.870045 Vascular lesion:0.950101
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_99.pth

Epoch: 99, iteration: 0/43, ==> train <===, loss: 3.545891, classification loss: 1.799403,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.138576,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025284,wcp loss: 0.000000,entropy loss: 1.859779,consistency weight: 1.000000, lr: 2.951266543065283e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 424.0, 30.0, 23.0, 70.0, 5.0, 10.0]

VAL Student: Epoch: 99, iteration: 42

VAL AUROC: 0.837018, VAL Accus: 0.579801, VAL Senss: 0.656379, VAL Specs: 0.880122
AUROCs: Melanoma:0.787360 Melanocytic nevus:0.899374 Basal cell carcinoma:0.918977 Actinic keratosis:0.878255 Benign keratosis:0.871411 Dermatofibroma:0.662665 Vascular lesion:0.841083
Accus: Melanoma:0.487395 Melanocytic nevus:0.639517 Basal cell carcinoma:0.555556 Actinic keratosis:0.696970 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.630252 Melanocytic nevus:0.781297 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.810000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.792281 Melanocytic nevus:0.860534 Basal cell carcinoma:0.912262 Actinic keratosis:0.920372 Benign keratosis:0.768889 Dermatofibroma:0.920732 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 889.0, 67.0, 27.0, 146.0, 5.0, 29.0]

TEST Student: Epoch: 99, iteration: 42

TEST AUROC: 0.847303, TEST Accus: 0.585442, TEST Senss: 0.806597, TEST Specs: 0.799037
AUROCs: Melanoma:0.805915 Melanocytic nevus:0.919936 Basal cell carcinoma:0.905140 Actinic keratosis:0.814794 Benign keratosis:0.869849 Dermatofibroma:0.619646 Vascular lesion:0.995838
Accus: Melanoma:0.519481 Melanocytic nevus:0.659007 Basal cell carcinoma:0.609091 Actinic keratosis:0.465517 Benign keratosis:0.682243 Dermatofibroma:0.227273 Vascular lesion:0.935484
Senss: Melanoma:0.831169 Melanocytic nevus:0.879911 Basal cell carcinoma:0.900000 Actinic keratosis:0.724138 Benign keratosis:0.901869 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.629484 Melanocytic nevus:0.803303 Basal cell carcinoma:0.811024 Actinic keratosis:0.865611 Benign keratosis:0.639089 Dermatofibroma:0.891119 Vascular lesion:0.953629
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_100.pth
save model to ../model/skin_0722_frac005_BNM_w10_vat_ent_batch32_densenet121/iter_4301.pth
