create semi supervised model
create semi supervised model
single label  Total # images:7000, labels:7000
single label  Total # images:1000, labels:1000
single label  Total # images:2015, labels:2015
train_dataset len: 7000
labeled_num: 1400

Epoch: 0, iteration: 0/175, ==> train <===, loss: 1.950627, classification loss: 1.950627,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 0.0001

Epoch: 0, iteration: 100/175, ==> train <===, loss: 1.898623, classification loss: 1.898623,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 0.0001
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [57.0, 470.0, 25.0, 18.0, 62.0, 0.0, 7.0]

VAL Student: Epoch: 0, iteration: 174

VAL AUROC: 0.810047, VAL Accus: 0.468996, VAL Senss: 0.625287, VAL Specs: 0.844410
AUROCs: Melanoma:0.789773 Melanocytic nevus:0.895167 Basal cell carcinoma:0.902298 Actinic keratosis:0.910940 Benign keratosis:0.841578 Dermatofibroma:0.497205 Vascular lesion:0.833367
Accus: Melanoma:0.478992 Melanocytic nevus:0.708899 Basal cell carcinoma:0.462963 Actinic keratosis:0.545455 Benign keratosis:0.620000 Dermatofibroma:0.000000 Vascular lesion:0.466667
Senss: Melanoma:0.781513 Melanocytic nevus:0.871795 Basal cell carcinoma:0.703704 Actinic keratosis:0.666667 Benign keratosis:0.820000 Dermatofibroma:0.000000 Vascular lesion:0.533333
Specs: Melanoma:0.606129 Melanocytic nevus:0.738872 Basal cell carcinoma:0.948203 Actinic keratosis:0.933816 Benign keratosis:0.701111 Dermatofibroma:1.000000 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [117.0, 921.0, 45.0, 20.0, 142.0, 0.0, 16.0]

TEST Student: Epoch: 0, iteration: 174

TEST AUROC: 0.849047, TEST Accus: 0.446117, TEST Senss: 0.867373, TEST Specs: 0.545658
AUROCs: Melanoma:0.832028 Melanocytic nevus:0.905556 Basal cell carcinoma:0.912326 Actinic keratosis:0.872368 Benign keratosis:0.869099 Dermatofibroma:0.602678 Vascular lesion:0.949272
Accus: Melanoma:0.506494 Melanocytic nevus:0.682728 Basal cell carcinoma:0.409091 Actinic keratosis:0.344828 Benign keratosis:0.663551 Dermatofibroma:0.000000 Vascular lesion:0.516129
Senss: Melanoma:0.991342 Melanocytic nevus:0.971090 Basal cell carcinoma:0.918182 Actinic keratosis:0.896552 Benign keratosis:0.995327 Dermatofibroma:0.363636 Vascular lesion:0.935484
Specs: Melanoma:0.362668 Melanocytic nevus:0.456456 Basal cell carcinoma:0.683465 Actinic keratosis:0.691364 Benign keratosis:0.362021 Dermatofibroma:0.661816 Vascular lesion:0.601815
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_1.pth

Epoch: 1, iteration: 0/175, ==> train <===, loss: 1.866140, classification loss: 1.866140,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 9e-05

Epoch: 1, iteration: 100/175, ==> train <===, loss: 1.880864, classification loss: 1.880864,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 9e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 481.0, 23.0, 22.0, 54.0, 0.0, 13.0]

VAL Student: Epoch: 1, iteration: 174

VAL AUROC: 0.864596, VAL Accus: 0.533908, VAL Senss: 0.659568, VAL Specs: 0.871854
AUROCs: Melanoma:0.822843 Melanocytic nevus:0.892240 Basal cell carcinoma:0.926122 Actinic keratosis:0.955658 Benign keratosis:0.839344 Dermatofibroma:0.625508 Vascular lesion:0.990457
Accus: Melanoma:0.512605 Melanocytic nevus:0.725490 Basal cell carcinoma:0.425926 Actinic keratosis:0.666667 Benign keratosis:0.540000 Dermatofibroma:0.000000 Vascular lesion:0.866667
Senss: Melanoma:0.865546 Melanocytic nevus:0.841629 Basal cell carcinoma:0.555556 Actinic keratosis:0.757576 Benign keratosis:0.730000 Dermatofibroma:0.000000 Vascular lesion:0.866667
Specs: Melanoma:0.642452 Melanocytic nevus:0.780415 Basal cell carcinoma:0.977801 Actinic keratosis:0.931748 Benign keratosis:0.800000 Dermatofibroma:1.000000 Vascular lesion:0.970558
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 929.0, 55.0, 32.0, 142.0, 0.0, 30.0]

TEST Student: Epoch: 1, iteration: 174

TEST AUROC: 0.889373, TEST Accus: 0.566393, TEST Senss: 0.886216, TEST Specs: 0.721579
AUROCs: Melanoma:0.840188 Melanocytic nevus:0.910238 Basal cell carcinoma:0.947535 Actinic keratosis:0.917035 Benign keratosis:0.900395 Dermatofibroma:0.713862 Vascular lesion:0.996358
Accus: Melanoma:0.593074 Melanocytic nevus:0.688658 Basal cell carcinoma:0.500000 Actinic keratosis:0.551724 Benign keratosis:0.663551 Dermatofibroma:0.000000 Vascular lesion:0.967742
Senss: Melanoma:0.987013 Melanocytic nevus:0.933284 Basal cell carcinoma:0.881818 Actinic keratosis:0.879310 Benign keratosis:0.976636 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.385650 Melanocytic nevus:0.651652 Basal cell carcinoma:0.870866 Actinic keratosis:0.831886 Benign keratosis:0.540811 Dermatofibroma:0.883091 Vascular lesion:0.887097
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_2.pth

Epoch: 2, iteration: 0/175, ==> train <===, loss: 1.847576, classification loss: 1.847576,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 8.1e-05

Epoch: 2, iteration: 100/175, ==> train <===, loss: 1.864328, classification loss: 1.864328,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 8.1e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [43.0, 511.0, 29.0, 17.0, 69.0, 1.0, 11.0]

VAL Student: Epoch: 2, iteration: 174

VAL AUROC: 0.858235, VAL Accus: 0.524301, VAL Senss: 0.665529, VAL Specs: 0.872393
AUROCs: Melanoma:0.795133 Melanocytic nevus:0.915531 Basal cell carcinoma:0.893450 Actinic keratosis:0.922785 Benign keratosis:0.859089 Dermatofibroma:0.705920 Vascular lesion:0.915736
Accus: Melanoma:0.361345 Melanocytic nevus:0.770739 Basal cell carcinoma:0.537037 Actinic keratosis:0.515152 Benign keratosis:0.690000 Dermatofibroma:0.062500 Vascular lesion:0.733333
Senss: Melanoma:0.689076 Melanocytic nevus:0.898944 Basal cell carcinoma:0.666667 Actinic keratosis:0.818182 Benign keratosis:0.790000 Dermatofibroma:0.062500 Vascular lesion:0.733333
Specs: Melanoma:0.740068 Melanocytic nevus:0.747774 Basal cell carcinoma:0.934461 Actinic keratosis:0.941055 Benign keratosis:0.791111 Dermatofibroma:1.000000 Vascular lesion:0.952284
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [90.0, 1066.0, 62.0, 23.0, 165.0, 0.0, 29.0]

TEST Student: Epoch: 2, iteration: 174

TEST AUROC: 0.881073, TEST Accus: 0.549504, TEST Senss: 0.829830, TEST Specs: 0.756724
AUROCs: Melanoma:0.824120 Melanocytic nevus:0.910053 Basal cell carcinoma:0.901160 Actinic keratosis:0.871892 Benign keratosis:0.903530 Dermatofibroma:0.769831 Vascular lesion:0.986928
Accus: Melanoma:0.389610 Melanocytic nevus:0.790215 Basal cell carcinoma:0.563636 Actinic keratosis:0.396552 Benign keratosis:0.771028 Dermatofibroma:0.000000 Vascular lesion:0.935484
Senss: Melanoma:0.939394 Melanocytic nevus:0.965901 Basal cell carcinoma:0.845455 Actinic keratosis:0.810345 Benign keratosis:0.948598 Dermatofibroma:0.363636 Vascular lesion:0.935484
Specs: Melanoma:0.499439 Melanocytic nevus:0.600601 Basal cell carcinoma:0.871916 Actinic keratosis:0.888094 Benign keratosis:0.619656 Dermatofibroma:0.928751 Vascular lesion:0.888609
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_3.pth

Epoch: 3, iteration: 0/175, ==> train <===, loss: 1.848787, classification loss: 1.848787,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 7.290000000000001e-05

Epoch: 3, iteration: 100/175, ==> train <===, loss: 1.861627, classification loss: 1.861627,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 7.290000000000001e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 476.0, 32.0, 21.0, 62.0, 1.0, 10.0]

VAL Student: Epoch: 3, iteration: 174

VAL AUROC: 0.861255, VAL Accus: 0.551300, VAL Senss: 0.689213, VAL Specs: 0.889984
AUROCs: Melanoma:0.854043 Melanocytic nevus:0.915535 Basal cell carcinoma:0.940314 Actinic keratosis:0.918523 Benign keratosis:0.850994 Dermatofibroma:0.653201 Vascular lesion:0.896176
Accus: Melanoma:0.563025 Melanocytic nevus:0.717949 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.620000 Dermatofibroma:0.062500 Vascular lesion:0.666667
Senss: Melanoma:0.789916 Melanocytic nevus:0.858220 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.770000 Dermatofibroma:0.187500 Vascular lesion:0.666667
Specs: Melanoma:0.728717 Melanocytic nevus:0.810089 Basal cell carcinoma:0.952431 Actinic keratosis:0.912099 Benign keratosis:0.848889 Dermatofibroma:0.998984 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 973.0, 70.0, 37.0, 140.0, 1.0, 26.0]

TEST Student: Epoch: 3, iteration: 174

TEST AUROC: 0.900779, TEST Accus: 0.595758, TEST Senss: 0.863225, TEST Specs: 0.791169
AUROCs: Melanoma:0.871016 Melanocytic nevus:0.921731 Basal cell carcinoma:0.950971 Actinic keratosis:0.927308 Benign keratosis:0.902912 Dermatofibroma:0.741550 Vascular lesion:0.989968
Accus: Melanoma:0.636364 Melanocytic nevus:0.721275 Basal cell carcinoma:0.636364 Actinic keratosis:0.637931 Benign keratosis:0.654206 Dermatofibroma:0.045455 Vascular lesion:0.838710
Senss: Melanoma:0.978355 Melanocytic nevus:0.933284 Basal cell carcinoma:0.890909 Actinic keratosis:0.879310 Benign keratosis:0.925234 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.552691 Melanocytic nevus:0.698198 Basal cell carcinoma:0.877165 Actinic keratosis:0.847215 Benign keratosis:0.700167 Dermatofibroma:0.923231 Vascular lesion:0.939516
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_4.pth

Epoch: 4, iteration: 0/175, ==> train <===, loss: 1.831630, classification loss: 1.831630,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 6.561000000000002e-05

Epoch: 4, iteration: 100/175, ==> train <===, loss: 1.837825, classification loss: 1.837825,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 6.561000000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 560.0, 22.0, 26.0, 55.0, 4.0, 10.0]

VAL Student: Epoch: 4, iteration: 174

VAL AUROC: 0.875842, VAL Accus: 0.584976, VAL Senss: 0.705795, VAL Specs: 0.895921
AUROCs: Melanoma:0.853499 Melanocytic nevus:0.930574 Basal cell carcinoma:0.912575 Actinic keratosis:0.959356 Benign keratosis:0.826089 Dermatofibroma:0.727515 Vascular lesion:0.921286
Accus: Melanoma:0.588235 Melanocytic nevus:0.844646 Basal cell carcinoma:0.407407 Actinic keratosis:0.787879 Benign keratosis:0.550000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Senss: Melanoma:0.815126 Melanocytic nevus:0.927602 Basal cell carcinoma:0.518519 Actinic keratosis:0.848485 Benign keratosis:0.660000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Specs: Melanoma:0.738933 Melanocytic nevus:0.750742 Basal cell carcinoma:0.983087 Actinic keratosis:0.932782 Benign keratosis:0.893333 Dermatofibroma:0.983740 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [154.0, 1109.0, 57.0, 41.0, 141.0, 5.0, 27.0]

TEST Student: Epoch: 4, iteration: 174

TEST AUROC: 0.909102, TEST Accus: 0.638708, TEST Senss: 0.871265, TEST Specs: 0.805771
AUROCs: Melanoma:0.877490 Melanocytic nevus:0.929754 Basal cell carcinoma:0.930437 Actinic keratosis:0.924859 Benign keratosis:0.908916 Dermatofibroma:0.801738 Vascular lesion:0.990521
Accus: Melanoma:0.666667 Melanocytic nevus:0.822090 Basal cell carcinoma:0.518182 Actinic keratosis:0.706897 Benign keratosis:0.658879 Dermatofibroma:0.227273 Vascular lesion:0.870968
Senss: Melanoma:0.969697 Melanocytic nevus:0.962194 Basal cell carcinoma:0.854545 Actinic keratosis:0.862069 Benign keratosis:0.878505 Dermatofibroma:0.636364 Vascular lesion:0.935484
Specs: Melanoma:0.557735 Melanocytic nevus:0.606607 Basal cell carcinoma:0.925459 Actinic keratosis:0.880429 Benign keratosis:0.785675 Dermatofibroma:0.907175 Vascular lesion:0.977319
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_5.pth

Epoch: 5, iteration: 0/175, ==> train <===, loss: 1.842947, classification loss: 1.842947,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.904900000000002e-05

Epoch: 5, iteration: 100/175, ==> train <===, loss: 1.844732, classification loss: 1.844732,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.904900000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [77.0, 522.0, 39.0, 22.0, 61.0, 8.0, 13.0]

VAL Student: Epoch: 5, iteration: 174

VAL AUROC: 0.892911, VAL Accus: 0.685706, VAL Senss: 0.788014, VAL Specs: 0.901613
AUROCs: Melanoma:0.854882 Melanocytic nevus:0.929661 Basal cell carcinoma:0.968875 Actinic keratosis:0.944471 Benign keratosis:0.889656 Dermatofibroma:0.734439 Vascular lesion:0.928393
Accus: Melanoma:0.647059 Melanocytic nevus:0.787330 Basal cell carcinoma:0.722222 Actinic keratosis:0.666667 Benign keratosis:0.610000 Dermatofibroma:0.500000 Vascular lesion:0.866667
Senss: Melanoma:0.831933 Melanocytic nevus:0.898944 Basal cell carcinoma:0.870370 Actinic keratosis:0.818182 Benign keratosis:0.730000 Dermatofibroma:0.500000 Vascular lesion:0.866667
Specs: Melanoma:0.744608 Melanocytic nevus:0.804154 Basal cell carcinoma:0.969345 Actinic keratosis:0.954498 Benign keratosis:0.907778 Dermatofibroma:0.943089 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1063.0, 85.0, 31.0, 137.0, 8.0, 31.0]

TEST Student: Epoch: 5, iteration: 174

TEST AUROC: 0.905248, TEST Accus: 0.674629, TEST Senss: 0.875586, TEST Specs: 0.825506
AUROCs: Melanoma:0.866139 Melanocytic nevus:0.930007 Basal cell carcinoma:0.959117 Actinic keratosis:0.889142 Benign keratosis:0.918918 Dermatofibroma:0.773868 Vascular lesion:0.999545
Accus: Melanoma:0.623377 Melanocytic nevus:0.787991 Basal cell carcinoma:0.772727 Actinic keratosis:0.534483 Benign keratosis:0.640187 Dermatofibroma:0.363636 Vascular lesion:1.000000
Senss: Melanoma:0.943723 Melanocytic nevus:0.954040 Basal cell carcinoma:0.900000 Actinic keratosis:0.793103 Benign keratosis:0.901869 Dermatofibroma:0.636364 Vascular lesion:1.000000
Specs: Melanoma:0.609865 Melanocytic nevus:0.701201 Basal cell carcinoma:0.903412 Actinic keratosis:0.929484 Benign keratosis:0.802332 Dermatofibroma:0.869042 Vascular lesion:0.963206
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_6.pth

Epoch: 6, iteration: 0/175, ==> train <===, loss: 1.795860, classification loss: 1.795860,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.314410000000002e-05

Epoch: 6, iteration: 100/175, ==> train <===, loss: 1.844668, classification loss: 1.844668,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.314410000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 530.0, 34.0, 26.0, 60.0, 8.0, 12.0]

VAL Student: Epoch: 6, iteration: 174

VAL AUROC: 0.884621, VAL Accus: 0.664960, VAL Senss: 0.760215, VAL Specs: 0.905083
AUROCs: Melanoma:0.826410 Melanocytic nevus:0.925266 Basal cell carcinoma:0.940157 Actinic keratosis:0.961173 Benign keratosis:0.853100 Dermatofibroma:0.760353 Vascular lesion:0.925888
Accus: Melanoma:0.537815 Melanocytic nevus:0.799397 Basal cell carcinoma:0.629630 Actinic keratosis:0.787879 Benign keratosis:0.600000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.722689 Melanocytic nevus:0.898944 Basal cell carcinoma:0.722222 Actinic keratosis:0.848485 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.866667
Specs: Melanoma:0.784336 Melanocytic nevus:0.813056 Basal cell carcinoma:0.964059 Actinic keratosis:0.933816 Benign keratosis:0.891111 Dermatofibroma:0.964431 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 1099.0, 84.0, 39.0, 136.0, 14.0, 30.0]

TEST Student: Epoch: 6, iteration: 174

TEST AUROC: 0.921527, TEST Accus: 0.719400, TEST Senss: 0.897533, TEST Specs: 0.821938
AUROCs: Melanoma:0.850237 Melanocytic nevus:0.928065 Basal cell carcinoma:0.949120 Actinic keratosis:0.936303 Benign keratosis:0.910629 Dermatofibroma:0.877572 Vascular lesion:0.998764
Accus: Melanoma:0.545455 Melanocytic nevus:0.814678 Basal cell carcinoma:0.763636 Actinic keratosis:0.672414 Benign keratosis:0.635514 Dermatofibroma:0.636364 Vascular lesion:0.967742
Senss: Melanoma:0.900433 Melanocytic nevus:0.945886 Basal cell carcinoma:0.909091 Actinic keratosis:0.862069 Benign keratosis:0.892523 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.615471 Melanocytic nevus:0.710210 Basal cell carcinoma:0.899738 Actinic keratosis:0.892182 Benign keratosis:0.780122 Dermatofibroma:0.889112 Vascular lesion:0.966734
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_7.pth

Epoch: 7, iteration: 0/175, ==> train <===, loss: 1.805760, classification loss: 1.805760,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.782969000000002e-05

Epoch: 7, iteration: 100/175, ==> train <===, loss: 1.830492, classification loss: 1.830492,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.782969000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 531.0, 38.0, 22.0, 63.0, 7.0, 10.0]

VAL Student: Epoch: 7, iteration: 174

VAL AUROC: 0.870986, VAL Accus: 0.637152, VAL Senss: 0.723474, VAL Specs: 0.901111
AUROCs: Melanoma:0.861626 Melanocytic nevus:0.919085 Basal cell carcinoma:0.942232 Actinic keratosis:0.919965 Benign keratosis:0.842467 Dermatofibroma:0.743712 Vascular lesion:0.867817
Accus: Melanoma:0.554622 Melanocytic nevus:0.800905 Basal cell carcinoma:0.703704 Actinic keratosis:0.666667 Benign keratosis:0.630000 Dermatofibroma:0.437500 Vascular lesion:0.666667
Senss: Melanoma:0.789916 Melanocytic nevus:0.883861 Basal cell carcinoma:0.796296 Actinic keratosis:0.757576 Benign keratosis:0.670000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Specs: Melanoma:0.784336 Melanocytic nevus:0.801187 Basal cell carcinoma:0.972516 Actinic keratosis:0.960703 Benign keratosis:0.837778 Dermatofibroma:0.987805 Vascular lesion:0.963452
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [145.0, 1083.0, 84.0, 26.0, 143.0, 9.0, 27.0]

TEST Student: Epoch: 7, iteration: 174

TEST AUROC: 0.912610, TEST Accus: 0.655817, TEST Senss: 0.859191, TEST Specs: 0.823208
AUROCs: Melanoma:0.887992 Melanocytic nevus:0.919770 Basal cell carcinoma:0.947034 Actinic keratosis:0.909221 Benign keratosis:0.904376 Dermatofibroma:0.840966 Vascular lesion:0.978912
Accus: Melanoma:0.627706 Melanocytic nevus:0.802817 Basal cell carcinoma:0.763636 Actinic keratosis:0.448276 Benign keratosis:0.668224 Dermatofibroma:0.409091 Vascular lesion:0.870968
Senss: Melanoma:0.939394 Melanocytic nevus:0.942921 Basal cell carcinoma:0.881818 Actinic keratosis:0.758621 Benign keratosis:0.906542 Dermatofibroma:0.681818 Vascular lesion:0.903226
Specs: Melanoma:0.606502 Melanocytic nevus:0.701201 Basal cell carcinoma:0.913386 Actinic keratosis:0.944303 Benign keratosis:0.720711 Dermatofibroma:0.923231 Vascular lesion:0.953125
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_8.pth

Epoch: 8, iteration: 0/175, ==> train <===, loss: 1.800879, classification loss: 1.800879,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.304672100000002e-05

Epoch: 8, iteration: 100/175, ==> train <===, loss: 1.819530, classification loss: 1.819530,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.304672100000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 553.0, 37.0, 24.0, 58.0, 8.0, 10.0]

VAL Student: Epoch: 8, iteration: 174

VAL AUROC: 0.890174, VAL Accus: 0.647290, VAL Senss: 0.724167, VAL Specs: 0.916302
AUROCs: Melanoma:0.856370 Melanocytic nevus:0.931053 Basal cell carcinoma:0.969951 Actinic keratosis:0.949077 Benign keratosis:0.860778 Dermatofibroma:0.769372 Vascular lesion:0.894619
Accus: Melanoma:0.537815 Melanocytic nevus:0.834087 Basal cell carcinoma:0.685185 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Senss: Melanoma:0.714286 Melanocytic nevus:0.920060 Basal cell carcinoma:0.777778 Actinic keratosis:0.787879 Benign keratosis:0.640000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.837684 Melanocytic nevus:0.795252 Basal cell carcinoma:0.961945 Actinic keratosis:0.961737 Benign keratosis:0.890000 Dermatofibroma:0.979675 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [136.0, 1151.0, 91.0, 25.0, 149.0, 10.0, 28.0]

TEST Student: Epoch: 8, iteration: 174

TEST AUROC: 0.910298, TEST Accus: 0.679187, TEST Senss: 0.853497, TEST Specs: 0.861386
AUROCs: Melanoma:0.890003 Melanocytic nevus:0.928919 Basal cell carcinoma:0.951668 Actinic keratosis:0.890631 Benign keratosis:0.914783 Dermatofibroma:0.809629 Vascular lesion:0.986456
Accus: Melanoma:0.588745 Melanocytic nevus:0.853225 Basal cell carcinoma:0.827273 Actinic keratosis:0.431034 Benign keratosis:0.696262 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.891775 Melanocytic nevus:0.954040 Basal cell carcinoma:0.900000 Actinic keratosis:0.741379 Benign keratosis:0.883178 Dermatofibroma:0.636364 Vascular lesion:0.967742
Specs: Melanoma:0.739350 Melanocytic nevus:0.704204 Basal cell carcinoma:0.923885 Actinic keratosis:0.946857 Benign keratosis:0.796780 Dermatofibroma:0.938284 Vascular lesion:0.980343
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_9.pth

Epoch: 9, iteration: 0/175, ==> train <===, loss: 1.805826, classification loss: 1.805826,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.874204890000002e-05

Epoch: 9, iteration: 100/175, ==> train <===, loss: 1.820081, classification loss: 1.820081,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.874204890000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 543.0, 38.0, 19.0, 53.0, 9.0, 11.0]

VAL Student: Epoch: 9, iteration: 174

VAL AUROC: 0.884066, VAL Accus: 0.649450, VAL Senss: 0.736918, VAL Specs: 0.919367
AUROCs: Melanoma:0.868646 Melanocytic nevus:0.929777 Basal cell carcinoma:0.949769 Actinic keratosis:0.915546 Benign keratosis:0.848989 Dermatofibroma:0.770960 Vascular lesion:0.904772
Accus: Melanoma:0.621849 Melanocytic nevus:0.819005 Basal cell carcinoma:0.703704 Actinic keratosis:0.575758 Benign keratosis:0.530000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.882353 Basal cell carcinoma:0.759259 Actinic keratosis:0.696970 Benign keratosis:0.680000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.795687 Melanocytic nevus:0.818991 Basal cell carcinoma:0.970402 Actinic keratosis:0.977249 Benign keratosis:0.907778 Dermatofibroma:0.982724 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [162.0, 1139.0, 84.0, 21.0, 141.0, 16.0, 28.0]

TEST Student: Epoch: 9, iteration: 174

TEST AUROC: 0.920703, TEST Accus: 0.708673, TEST Senss: 0.856196, TEST Specs: 0.867200
AUROCs: Melanoma:0.898319 Melanocytic nevus:0.936574 Basal cell carcinoma:0.950265 Actinic keratosis:0.890614 Benign keratosis:0.915924 Dermatofibroma:0.875793 Vascular lesion:0.977432
Accus: Melanoma:0.701299 Melanocytic nevus:0.844329 Basal cell carcinoma:0.763636 Actinic keratosis:0.362069 Benign keratosis:0.658879 Dermatofibroma:0.727273 Vascular lesion:0.903226
Senss: Melanoma:0.909091 Melanocytic nevus:0.952557 Basal cell carcinoma:0.900000 Actinic keratosis:0.655172 Benign keratosis:0.855140 Dermatofibroma:0.818182 Vascular lesion:0.903226
Specs: Melanoma:0.691143 Melanocytic nevus:0.720721 Basal cell carcinoma:0.931759 Actinic keratosis:0.973429 Benign keratosis:0.831205 Dermatofibroma:0.940793 Vascular lesion:0.981351
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_10.pth

Epoch: 10, iteration: 0/175, ==> train <===, loss: 1.797089, classification loss: 1.797089,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.4867844010000016e-05

Epoch: 10, iteration: 100/175, ==> train <===, loss: 1.817350, classification loss: 1.817350,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.4867844010000016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 535.0, 39.0, 23.0, 57.0, 9.0, 11.0]

VAL Student: Epoch: 10, iteration: 174

VAL AUROC: 0.873217, VAL Accus: 0.667399, VAL Senss: 0.762371, VAL Specs: 0.912926
AUROCs: Melanoma:0.868360 Melanocytic nevus:0.928595 Basal cell carcinoma:0.923029 Actinic keratosis:0.881765 Benign keratosis:0.879989 Dermatofibroma:0.720528 Vascular lesion:0.910254
Accus: Melanoma:0.579832 Melanocytic nevus:0.806938 Basal cell carcinoma:0.722222 Actinic keratosis:0.696970 Benign keratosis:0.570000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.906486 Basal cell carcinoma:0.777778 Actinic keratosis:0.818182 Benign keratosis:0.740000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.782066 Melanocytic nevus:0.813056 Basal cell carcinoma:0.964059 Actinic keratosis:0.947260 Benign keratosis:0.903333 Dermatofibroma:0.993902 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [170.0, 1121.0, 91.0, 30.0, 140.0, 11.0, 27.0]

TEST Student: Epoch: 10, iteration: 174

TEST AUROC: 0.921231, TEST Accus: 0.705229, TEST Senss: 0.868127, TEST Specs: 0.852274
AUROCs: Melanoma:0.904684 Melanocytic nevus:0.937886 Basal cell carcinoma:0.949845 Actinic keratosis:0.908481 Benign keratosis:0.926150 Dermatofibroma:0.829882 Vascular lesion:0.991692
Accus: Melanoma:0.735931 Melanocytic nevus:0.830986 Basal cell carcinoma:0.827273 Actinic keratosis:0.517241 Benign keratosis:0.654206 Dermatofibroma:0.500000 Vascular lesion:0.870968
Senss: Melanoma:0.961039 Melanocytic nevus:0.946627 Basal cell carcinoma:0.900000 Actinic keratosis:0.810345 Benign keratosis:0.873832 Dermatofibroma:0.681818 Vascular lesion:0.903226
Specs: Melanoma:0.626682 Melanocytic nevus:0.735736 Basal cell carcinoma:0.898163 Actinic keratosis:0.940726 Benign keratosis:0.822876 Dermatofibroma:0.955344 Vascular lesion:0.986391
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_11.pth

Epoch: 11, iteration: 0/175, ==> train <===, loss: 1.787186, classification loss: 1.787186,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.138105960900002e-05

Epoch: 11, iteration: 100/175, ==> train <===, loss: 1.820477, classification loss: 1.820477,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.138105960900002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 557.0, 34.0, 24.0, 68.0, 9.0, 10.0]

VAL Student: Epoch: 11, iteration: 174

VAL AUROC: 0.882505, VAL Accus: 0.659828, VAL Senss: 0.737508, VAL Specs: 0.921125
AUROCs: Melanoma:0.862494 Melanocytic nevus:0.932127 Basal cell carcinoma:0.930409 Actinic keratosis:0.928457 Benign keratosis:0.888411 Dermatofibroma:0.746570 Vascular lesion:0.889069
Accus: Melanoma:0.512605 Melanocytic nevus:0.840121 Basal cell carcinoma:0.629630 Actinic keratosis:0.727273 Benign keratosis:0.680000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.914027 Basal cell carcinoma:0.703704 Actinic keratosis:0.818182 Benign keratosis:0.800000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.849035 Melanocytic nevus:0.813056 Basal cell carcinoma:0.977801 Actinic keratosis:0.953464 Benign keratosis:0.878889 Dermatofibroma:0.991870 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1155.0, 83.0, 32.0, 157.0, 11.0, 28.0]

TEST Student: Epoch: 11, iteration: 174

TEST AUROC: 0.924264, TEST Accus: 0.701389, TEST Senss: 0.866306, TEST Specs: 0.867119
AUROCs: Melanoma:0.900831 Melanocytic nevus:0.936682 Basal cell carcinoma:0.957328 Actinic keratosis:0.915916 Benign keratosis:0.927758 Dermatofibroma:0.842813 Vascular lesion:0.988521
Accus: Melanoma:0.610390 Melanocytic nevus:0.856190 Basal cell carcinoma:0.754545 Actinic keratosis:0.551724 Benign keratosis:0.733645 Dermatofibroma:0.500000 Vascular lesion:0.903226
Senss: Melanoma:0.883117 Melanocytic nevus:0.957005 Basal cell carcinoma:0.900000 Actinic keratosis:0.810345 Benign keratosis:0.883178 Dermatofibroma:0.727273 Vascular lesion:0.903226
Specs: Melanoma:0.736547 Melanocytic nevus:0.710210 Basal cell carcinoma:0.937008 Actinic keratosis:0.948901 Benign keratosis:0.787896 Dermatofibroma:0.961365 Vascular lesion:0.987903
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_12.pth

Epoch: 12, iteration: 0/175, ==> train <===, loss: 1.792190, classification loss: 1.792190,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.8242953648100018e-05

Epoch: 12, iteration: 100/175, ==> train <===, loss: 1.812811, classification loss: 1.812811,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.8242953648100018e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 564.0, 35.0, 23.0, 68.0, 10.0, 10.0]

VAL Student: Epoch: 12, iteration: 174

VAL AUROC: 0.894471, VAL Accus: 0.674584, VAL Senss: 0.757265, VAL Specs: 0.923789
AUROCs: Melanoma:0.850151 Melanocytic nevus:0.936763 Basal cell carcinoma:0.957599 Actinic keratosis:0.934223 Benign keratosis:0.889867 Dermatofibroma:0.777566 Vascular lesion:0.915127
Accus: Melanoma:0.554622 Melanocytic nevus:0.850679 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.680000 Dermatofibroma:0.625000 Vascular lesion:0.666667
Senss: Melanoma:0.705882 Melanocytic nevus:0.909502 Basal cell carcinoma:0.759259 Actinic keratosis:0.787879 Benign keratosis:0.780000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.855846 Melanocytic nevus:0.816024 Basal cell carcinoma:0.976744 Actinic keratosis:0.965874 Benign keratosis:0.885556 Dermatofibroma:0.984756 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1156.0, 80.0, 35.0, 161.0, 12.0, 28.0]

TEST Student: Epoch: 12, iteration: 174

TEST AUROC: 0.929829, TEST Accus: 0.714151, TEST Senss: 0.879008, TEST Specs: 0.866712
AUROCs: Melanoma:0.902826 Melanocytic nevus:0.939744 Basal cell carcinoma:0.961427 Actinic keratosis:0.928154 Benign keratosis:0.929619 Dermatofibroma:0.849017 Vascular lesion:0.998016
Accus: Melanoma:0.610390 Melanocytic nevus:0.856931 Basal cell carcinoma:0.727273 Actinic keratosis:0.603448 Benign keratosis:0.752336 Dermatofibroma:0.545455 Vascular lesion:0.903226
Senss: Melanoma:0.878788 Melanocytic nevus:0.954040 Basal cell carcinoma:0.890909 Actinic keratosis:0.810345 Benign keratosis:0.878505 Dermatofibroma:0.772727 Vascular lesion:0.967742
Specs: Melanoma:0.735987 Melanocytic nevus:0.716216 Basal cell carcinoma:0.941207 Actinic keratosis:0.949923 Benign keratosis:0.809550 Dermatofibroma:0.935775 Vascular lesion:0.978327
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_13.pth

Epoch: 13, iteration: 0/175, ==> train <===, loss: 1.796857, classification loss: 1.796857,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.5418658283290016e-05

Epoch: 13, iteration: 100/175, ==> train <===, loss: 1.805749, classification loss: 1.805749,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.5418658283290016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 543.0, 38.0, 27.0, 61.0, 10.0, 11.0]

VAL Student: Epoch: 13, iteration: 174

VAL AUROC: 0.877685, VAL Accus: 0.704439, VAL Senss: 0.764909, VAL Specs: 0.920490
AUROCs: Melanoma:0.873473 Melanocytic nevus:0.935201 Basal cell carcinoma:0.937241 Actinic keratosis:0.941995 Benign keratosis:0.860167 Dermatofibroma:0.738186 Vascular lesion:0.857530
Accus: Melanoma:0.621849 Melanocytic nevus:0.819005 Basal cell carcinoma:0.703704 Actinic keratosis:0.818182 Benign keratosis:0.610000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.892911 Basal cell carcinoma:0.759259 Actinic keratosis:0.818182 Benign keratosis:0.740000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.821793 Melanocytic nevus:0.827893 Basal cell carcinoma:0.973573 Actinic keratosis:0.957601 Benign keratosis:0.890000 Dermatofibroma:0.982724 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [155.0, 1118.0, 89.0, 32.0, 144.0, 12.0, 28.0]

TEST Student: Epoch: 13, iteration: 174

TEST AUROC: 0.930448, TEST Accus: 0.711736, TEST Senss: 0.883888, TEST Specs: 0.868719
AUROCs: Melanoma:0.906510 Melanocytic nevus:0.942503 Basal cell carcinoma:0.965832 Actinic keratosis:0.937554 Benign keratosis:0.915216 Dermatofibroma:0.847831 Vascular lesion:0.997691
Accus: Melanoma:0.670996 Melanocytic nevus:0.828762 Basal cell carcinoma:0.809091 Actinic keratosis:0.551724 Benign keratosis:0.672897 Dermatofibroma:0.545455 Vascular lesion:0.903226
Senss: Melanoma:0.926407 Melanocytic nevus:0.934025 Basal cell carcinoma:0.927273 Actinic keratosis:0.775862 Benign keratosis:0.883178 Dermatofibroma:0.772727 Vascular lesion:0.967742
Specs: Melanoma:0.698430 Melanocytic nevus:0.782282 Basal cell carcinoma:0.921260 Actinic keratosis:0.952989 Benign keratosis:0.787340 Dermatofibroma:0.951330 Vascular lesion:0.987399
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_14.pth

Epoch: 14, iteration: 0/175, ==> train <===, loss: 1.791427, classification loss: 1.791427,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.2876792454961016e-05

Epoch: 14, iteration: 100/175, ==> train <===, loss: 1.808726, classification loss: 1.808726,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.2876792454961016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 548.0, 42.0, 28.0, 67.0, 9.0, 9.0]

VAL Student: Epoch: 14, iteration: 174

VAL AUROC: 0.884365, VAL Accus: 0.687817, VAL Senss: 0.758230, VAL Specs: 0.922418
AUROCs: Melanoma:0.864278 Melanocytic nevus:0.937408 Basal cell carcinoma:0.945286 Actinic keratosis:0.937764 Benign keratosis:0.880933 Dermatofibroma:0.781568 Vascular lesion:0.843316
Accus: Melanoma:0.529412 Melanocytic nevus:0.826546 Basal cell carcinoma:0.777778 Actinic keratosis:0.848485 Benign keratosis:0.670000 Dermatofibroma:0.562500 Vascular lesion:0.600000
Senss: Melanoma:0.714286 Melanocytic nevus:0.894419 Basal cell carcinoma:0.814815 Actinic keratosis:0.909091 Benign keratosis:0.750000 Dermatofibroma:0.625000 Vascular lesion:0.600000
Specs: Melanoma:0.847900 Melanocytic nevus:0.818991 Basal cell carcinoma:0.969345 Actinic keratosis:0.959669 Benign keratosis:0.895556 Dermatofibroma:0.984756 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [153.0, 1134.0, 88.0, 33.0, 155.0, 10.0, 27.0]

TEST Student: Epoch: 14, iteration: 174

TEST AUROC: 0.923096, TEST Accus: 0.703105, TEST Senss: 0.872577, TEST Specs: 0.877616
AUROCs: Melanoma:0.907218 Melanocytic nevus:0.940093 Basal cell carcinoma:0.953219 Actinic keratosis:0.920859 Benign keratosis:0.929660 Dermatofibroma:0.814510 Vascular lesion:0.996114
Accus: Melanoma:0.662338 Melanocytic nevus:0.840623 Basal cell carcinoma:0.800000 Actinic keratosis:0.568966 Benign keratosis:0.724299 Dermatofibroma:0.454545 Vascular lesion:0.870968
Senss: Melanoma:0.891775 Melanocytic nevus:0.942179 Basal cell carcinoma:0.909091 Actinic keratosis:0.827586 Benign keratosis:0.887850 Dermatofibroma:0.681818 Vascular lesion:0.967742
Specs: Melanoma:0.754484 Melanocytic nevus:0.746246 Basal cell carcinoma:0.922310 Actinic keratosis:0.948901 Benign keratosis:0.830650 Dermatofibroma:0.956347 Vascular lesion:0.984375
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_15.pth

Epoch: 15, iteration: 0/175, ==> train <===, loss: 1.787654, classification loss: 1.787654,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.0589113209464913e-05

Epoch: 15, iteration: 100/175, ==> train <===, loss: 1.806376, classification loss: 1.806376,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.0589113209464913e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 553.0, 39.0, 19.0, 63.0, 8.0, 9.0]

VAL Student: Epoch: 15, iteration: 174

VAL AUROC: 0.871579, VAL Accus: 0.633357, VAL Senss: 0.713389, VAL Specs: 0.920118
AUROCs: Melanoma:0.855722 Melanocytic nevus:0.935886 Basal cell carcinoma:0.935322 Actinic keratosis:0.848454 Benign keratosis:0.864367 Dermatofibroma:0.832063 Vascular lesion:0.829239
Accus: Melanoma:0.571429 Melanocytic nevus:0.834087 Basal cell carcinoma:0.722222 Actinic keratosis:0.575758 Benign keratosis:0.630000 Dermatofibroma:0.500000 Vascular lesion:0.600000
Senss: Melanoma:0.756303 Melanocytic nevus:0.901961 Basal cell carcinoma:0.796296 Actinic keratosis:0.666667 Benign keratosis:0.710000 Dermatofibroma:0.562500 Vascular lesion:0.600000
Specs: Melanoma:0.845630 Melanocytic nevus:0.804154 Basal cell carcinoma:0.961945 Actinic keratosis:0.976215 Benign keratosis:0.895556 Dermatofibroma:0.965447 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 1121.0, 92.0, 20.0, 154.0, 13.0, 26.0]

TEST Student: Epoch: 15, iteration: 174

TEST AUROC: 0.926727, TEST Accus: 0.686016, TEST Senss: 0.851546, TEST Specs: 0.874720
AUROCs: Melanoma:0.904946 Melanocytic nevus:0.941455 Basal cell carcinoma:0.948003 Actinic keratosis:0.901406 Benign keratosis:0.929452 Dermatofibroma:0.868768 Vascular lesion:0.993057
Accus: Melanoma:0.640693 Melanocytic nevus:0.830986 Basal cell carcinoma:0.836364 Actinic keratosis:0.344828 Benign keratosis:0.719626 Dermatofibroma:0.590909 Vascular lesion:0.838710
Senss: Melanoma:0.935065 Melanocytic nevus:0.936249 Basal cell carcinoma:0.909091 Actinic keratosis:0.689655 Benign keratosis:0.892523 Dermatofibroma:0.727273 Vascular lesion:0.870968
Specs: Melanoma:0.725897 Melanocytic nevus:0.773273 Basal cell carcinoma:0.906562 Actinic keratosis:0.975473 Benign keratosis:0.810105 Dermatofibroma:0.938786 Vascular lesion:0.992944
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_16.pth

Epoch: 16, iteration: 0/175, ==> train <===, loss: 1.802653, classification loss: 1.802653,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.8530201888518422e-05

Epoch: 16, iteration: 100/175, ==> train <===, loss: 1.808936, classification loss: 1.808936,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.8530201888518422e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 551.0, 34.0, 27.0, 56.0, 8.0, 9.0]

VAL Student: Epoch: 16, iteration: 174

VAL AUROC: 0.861521, VAL Accus: 0.651533, VAL Senss: 0.723836, VAL Specs: 0.916894
AUROCs: Melanoma:0.870535 Melanocytic nevus:0.932395 Basal cell carcinoma:0.895486 Actinic keratosis:0.932719 Benign keratosis:0.860522 Dermatofibroma:0.702236 Vascular lesion:0.836751
Accus: Melanoma:0.621849 Melanocytic nevus:0.831071 Basal cell carcinoma:0.629630 Actinic keratosis:0.818182 Benign keratosis:0.560000 Dermatofibroma:0.500000 Vascular lesion:0.600000
Senss: Melanoma:0.789916 Melanocytic nevus:0.895928 Basal cell carcinoma:0.722222 Actinic keratosis:0.878788 Benign keratosis:0.680000 Dermatofibroma:0.500000 Vascular lesion:0.600000
Specs: Melanoma:0.808173 Melanocytic nevus:0.804154 Basal cell carcinoma:0.976744 Actinic keratosis:0.941055 Benign keratosis:0.915556 Dermatofibroma:0.986789 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [167.0, 1151.0, 83.0, 41.0, 136.0, 11.0, 29.0]

TEST Student: Epoch: 16, iteration: 174

TEST AUROC: 0.928814, TEST Accus: 0.729801, TEST Senss: 0.878023, TEST Specs: 0.875025
AUROCs: Melanoma:0.903143 Melanocytic nevus:0.939411 Basal cell carcinoma:0.953114 Actinic keratosis:0.945280 Benign keratosis:0.926728 Dermatofibroma:0.836268 Vascular lesion:0.997756
Accus: Melanoma:0.722944 Melanocytic nevus:0.853225 Basal cell carcinoma:0.754545 Actinic keratosis:0.706897 Benign keratosis:0.635514 Dermatofibroma:0.500000 Vascular lesion:0.935484
Senss: Melanoma:0.926407 Melanocytic nevus:0.947368 Basal cell carcinoma:0.872727 Actinic keratosis:0.844828 Benign keratosis:0.859813 Dermatofibroma:0.727273 Vascular lesion:0.967742
Specs: Melanoma:0.683296 Melanocytic nevus:0.752252 Basal cell carcinoma:0.937008 Actinic keratosis:0.931528 Benign keratosis:0.867296 Dermatofibroma:0.963372 Vascular lesion:0.990423
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_17.pth

Epoch: 17, iteration: 0/175, ==> train <===, loss: 1.817443, classification loss: 1.817443,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.667718169966658e-05

Epoch: 17, iteration: 100/175, ==> train <===, loss: 1.811442, classification loss: 1.811442,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.667718169966658e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 564.0, 36.0, 21.0, 67.0, 8.0, 10.0]

VAL Student: Epoch: 17, iteration: 174

VAL AUROC: 0.867671, VAL Accus: 0.651686, VAL Senss: 0.723435, VAL Specs: 0.922551
AUROCs: Melanoma:0.871870 Melanocytic nevus:0.932462 Basal cell carcinoma:0.894292 Actinic keratosis:0.891667 Benign keratosis:0.879800 Dermatofibroma:0.761369 Vascular lesion:0.842234
Accus: Melanoma:0.571429 Melanocytic nevus:0.850679 Basal cell carcinoma:0.666667 Actinic keratosis:0.636364 Benign keratosis:0.670000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Senss: Melanoma:0.697479 Melanocytic nevus:0.920060 Basal cell carcinoma:0.703704 Actinic keratosis:0.696970 Benign keratosis:0.750000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.859251 Melanocytic nevus:0.774481 Basal cell carcinoma:0.977801 Actinic keratosis:0.973113 Benign keratosis:0.895556 Dermatofibroma:0.988821 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1173.0, 81.0, 29.0, 164.0, 10.0, 29.0]

TEST Student: Epoch: 17, iteration: 174

TEST AUROC: 0.928142, TEST Accus: 0.699188, TEST Senss: 0.844366, TEST Specs: 0.882608
AUROCs: Melanoma:0.907700 Melanocytic nevus:0.940974 Basal cell carcinoma:0.947001 Actinic keratosis:0.908040 Benign keratosis:0.934286 Dermatofibroma:0.861219 Vascular lesion:0.997773
Accus: Melanoma:0.632035 Melanocytic nevus:0.869533 Basal cell carcinoma:0.736364 Actinic keratosis:0.500000 Benign keratosis:0.766355 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.883117 Melanocytic nevus:0.956264 Basal cell carcinoma:0.881818 Actinic keratosis:0.637931 Benign keratosis:0.901869 Dermatofibroma:0.681818 Vascular lesion:0.967742
Specs: Melanoma:0.762332 Melanocytic nevus:0.722222 Basal cell carcinoma:0.940682 Actinic keratosis:0.971385 Benign keratosis:0.822321 Dermatofibroma:0.968389 Vascular lesion:0.990927
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_18.pth

Epoch: 18, iteration: 0/175, ==> train <===, loss: 1.840312, classification loss: 1.840312,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.5009463529699922e-05

Epoch: 18, iteration: 100/175, ==> train <===, loss: 1.803450, classification loss: 1.803450,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.5009463529699922e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 554.0, 36.0, 27.0, 55.0, 9.0, 11.0]

VAL Student: Epoch: 18, iteration: 174

VAL AUROC: 0.880391, VAL Accus: 0.686419, VAL Senss: 0.743841, VAL Specs: 0.925978
AUROCs: Melanoma:0.865642 Melanocytic nevus:0.929719 Basal cell carcinoma:0.931368 Actinic keratosis:0.935759 Benign keratosis:0.829678 Dermatofibroma:0.774327 Vascular lesion:0.896244
Accus: Melanoma:0.638655 Melanocytic nevus:0.835596 Basal cell carcinoma:0.666667 Actinic keratosis:0.818182 Benign keratosis:0.550000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.889894 Basal cell carcinoma:0.759259 Actinic keratosis:0.878788 Benign keratosis:0.610000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.835414 Melanocytic nevus:0.816024 Basal cell carcinoma:0.968288 Actinic keratosis:0.952430 Benign keratosis:0.930000 Dermatofibroma:0.991870 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [164.0, 1145.0, 88.0, 40.0, 130.0, 11.0, 30.0]

TEST Student: Epoch: 18, iteration: 174

TEST AUROC: 0.924659, TEST Accus: 0.731944, TEST Senss: 0.872294, TEST Specs: 0.881593
AUROCs: Melanoma:0.908251 Melanocytic nevus:0.935474 Basal cell carcinoma:0.934693 Actinic keratosis:0.944144 Benign keratosis:0.914697 Dermatofibroma:0.836587 Vascular lesion:0.998764
Accus: Melanoma:0.709957 Melanocytic nevus:0.848777 Basal cell carcinoma:0.800000 Actinic keratosis:0.689655 Benign keratosis:0.607477 Dermatofibroma:0.500000 Vascular lesion:0.967742
Senss: Melanoma:0.926407 Melanocytic nevus:0.936249 Basal cell carcinoma:0.854545 Actinic keratosis:0.862069 Benign keratosis:0.831776 Dermatofibroma:0.727273 Vascular lesion:0.967742
Specs: Melanoma:0.717489 Melanocytic nevus:0.755255 Basal cell carcinoma:0.920735 Actinic keratosis:0.939193 Benign keratosis:0.886730 Dermatofibroma:0.970396 Vascular lesion:0.981351
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_19.pth

Epoch: 19, iteration: 0/175, ==> train <===, loss: 1.830177, classification loss: 1.830177,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.350851717672993e-05

Epoch: 19, iteration: 100/175, ==> train <===, loss: 1.804480, classification loss: 1.804480,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.350851717672993e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [73.0, 566.0, 38.0, 22.0, 65.0, 7.0, 9.0]

VAL Student: Epoch: 19, iteration: 174

VAL AUROC: 0.874293, VAL Accus: 0.646430, VAL Senss: 0.724616, VAL Specs: 0.922780
AUROCs: Melanoma:0.857286 Melanocytic nevus:0.932677 Basal cell carcinoma:0.955368 Actinic keratosis:0.905456 Benign keratosis:0.853522 Dermatofibroma:0.732152 Vascular lesion:0.883587
Accus: Melanoma:0.613445 Melanocytic nevus:0.853695 Basal cell carcinoma:0.703704 Actinic keratosis:0.666667 Benign keratosis:0.650000 Dermatofibroma:0.437500 Vascular lesion:0.600000
Senss: Melanoma:0.697479 Melanocytic nevus:0.917044 Basal cell carcinoma:0.740741 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.844495 Melanocytic nevus:0.786350 Basal cell carcinoma:0.966173 Actinic keratosis:0.968976 Benign keratosis:0.906667 Dermatofibroma:0.994919 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 1175.0, 88.0, 28.0, 147.0, 9.0, 28.0]

TEST Student: Epoch: 19, iteration: 174

TEST AUROC: 0.930595, TEST Accus: 0.684814, TEST Senss: 0.874901, TEST Specs: 0.880639
AUROCs: Melanoma:0.914141 Melanocytic nevus:0.934031 Basal cell carcinoma:0.959361 Actinic keratosis:0.933316 Benign keratosis:0.918314 Dermatofibroma:0.856498 Vascular lesion:0.998504
Accus: Melanoma:0.640693 Melanocytic nevus:0.871016 Basal cell carcinoma:0.800000 Actinic keratosis:0.482759 Benign keratosis:0.686916 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.922078 Melanocytic nevus:0.954040 Basal cell carcinoma:0.890909 Actinic keratosis:0.793103 Benign keratosis:0.869159 Dermatofibroma:0.727273 Vascular lesion:0.967742
Specs: Melanoma:0.741592 Melanocytic nevus:0.717718 Basal cell carcinoma:0.934383 Actinic keratosis:0.961165 Benign keratosis:0.841755 Dermatofibroma:0.974410 Vascular lesion:0.993448
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_20.pth

Epoch: 20, iteration: 0/175, ==> train <===, loss: 1.786565, classification loss: 1.786565,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.2157665459056937e-05

Epoch: 20, iteration: 100/175, ==> train <===, loss: 1.811459, classification loss: 1.811459,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.2157665459056937e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 555.0, 37.0, 26.0, 54.0, 9.0, 11.0]

VAL Student: Epoch: 20, iteration: 174

VAL AUROC: 0.886341, VAL Accus: 0.677520, VAL Senss: 0.742068, VAL Specs: 0.922280
AUROCs: Melanoma:0.880407 Melanocytic nevus:0.930484 Basal cell carcinoma:0.943583 Actinic keratosis:0.915609 Benign keratosis:0.866900 Dermatofibroma:0.769944 Vascular lesion:0.897462
Accus: Melanoma:0.596639 Melanocytic nevus:0.837104 Basal cell carcinoma:0.685185 Actinic keratosis:0.787879 Benign keratosis:0.540000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.731092 Melanocytic nevus:0.909502 Basal cell carcinoma:0.759259 Actinic keratosis:0.878788 Benign keratosis:0.620000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.852440 Melanocytic nevus:0.783383 Basal cell carcinoma:0.973573 Actinic keratosis:0.961737 Benign keratosis:0.924444 Dermatofibroma:0.979675 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1193.0, 85.0, 36.0, 140.0, 12.0, 29.0]

TEST Student: Epoch: 20, iteration: 174

TEST AUROC: 0.928826, TEST Accus: 0.723800, TEST Senss: 0.868751, TEST Specs: 0.880151
AUROCs: Melanoma:0.916225 Melanocytic nevus:0.935716 Basal cell carcinoma:0.951071 Actinic keratosis:0.928656 Benign keratosis:0.917829 Dermatofibroma:0.854787 Vascular lesion:0.997496
Accus: Melanoma:0.653680 Melanocytic nevus:0.884359 Basal cell carcinoma:0.772727 Actinic keratosis:0.620690 Benign keratosis:0.654206 Dermatofibroma:0.545455 Vascular lesion:0.935484
Senss: Melanoma:0.913420 Melanocytic nevus:0.961453 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.836449 Dermatofibroma:0.727273 Vascular lesion:0.967742
Specs: Melanoma:0.754484 Melanocytic nevus:0.695195 Basal cell carcinoma:0.941732 Actinic keratosis:0.957588 Benign keratosis:0.872848 Dermatofibroma:0.956347 Vascular lesion:0.982863
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_21.pth

Epoch: 21, iteration: 0/175, ==> train <===, loss: 3.581570, classification loss: 1.824130,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.130428,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020027,wcp loss: 0.000000,entropy loss: 1.867841,consistency weight: 1.000000, lr: 1.0941898913151244e-05

Epoch: 21, iteration: 100/175, ==> train <===, loss: 3.551680, classification loss: 1.798483,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137640,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030496,wcp loss: 0.000000,entropy loss: 1.860341,consistency weight: 1.000000, lr: 1.0941898913151244e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 546.0, 43.0, 29.0, 46.0, 11.0, 12.0]

VAL Student: Epoch: 21, iteration: 174

VAL AUROC: 0.880786, VAL Accus: 0.720393, VAL Senss: 0.774119, VAL Specs: 0.910562
AUROCs: Melanoma:0.859146 Melanocytic nevus:0.934606 Basal cell carcinoma:0.957286 Actinic keratosis:0.946946 Benign keratosis:0.813878 Dermatofibroma:0.790968 Vascular lesion:0.862673
Accus: Melanoma:0.596639 Melanocytic nevus:0.823529 Basal cell carcinoma:0.796296 Actinic keratosis:0.878788 Benign keratosis:0.460000 Dermatofibroma:0.687500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.911011 Basal cell carcinoma:0.833333 Actinic keratosis:0.909091 Benign keratosis:0.530000 Dermatofibroma:0.687500 Vascular lesion:0.800000
Specs: Melanoma:0.805902 Melanocytic nevus:0.786350 Basal cell carcinoma:0.945032 Actinic keratosis:0.926577 Benign keratosis:0.970000 Dermatofibroma:0.970528 Vascular lesion:0.969543
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [152.0, 1144.0, 93.0, 45.0, 104.0, 15.0, 29.0]

TEST Student: Epoch: 21, iteration: 174

TEST AUROC: 0.920858, TEST Accus: 0.747235, TEST Senss: 0.872096, TEST Specs: 0.869219
AUROCs: Melanoma:0.888509 Melanocytic nevus:0.937470 Basal cell carcinoma:0.948041 Actinic keratosis:0.937558 Benign keratosis:0.906672 Dermatofibroma:0.829950 Vascular lesion:0.997805
Accus: Melanoma:0.658009 Melanocytic nevus:0.848036 Basal cell carcinoma:0.845455 Actinic keratosis:0.775862 Benign keratosis:0.485981 Dermatofibroma:0.681818 Vascular lesion:0.935484
Senss: Melanoma:0.909091 Melanocytic nevus:0.945886 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.728972 Dermatofibroma:0.772727 Vascular lesion:0.967742
Specs: Melanoma:0.707960 Melanocytic nevus:0.719219 Basal cell carcinoma:0.889239 Actinic keratosis:0.913643 Benign keratosis:0.943920 Dermatofibroma:0.940291 Vascular lesion:0.970262
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_22.pth

Epoch: 22, iteration: 0/175, ==> train <===, loss: 3.575610, classification loss: 1.841123,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.152993,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031989,wcp loss: 0.000000,entropy loss: 1.855492,consistency weight: 1.000000, lr: 9.84770902183612e-06

Epoch: 22, iteration: 100/175, ==> train <===, loss: 3.557589, classification loss: 1.812410,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140384,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027357,wcp loss: 0.000000,entropy loss: 1.858206,consistency weight: 1.000000, lr: 9.84770902183612e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 548.0, 39.0, 30.0, 60.0, 10.0, 12.0]

VAL Student: Epoch: 22, iteration: 174

VAL AUROC: 0.883147, VAL Accus: 0.717239, VAL Senss: 0.781469, VAL Specs: 0.910104
AUROCs: Melanoma:0.832486 Melanocytic nevus:0.936470 Basal cell carcinoma:0.959361 Actinic keratosis:0.943562 Benign keratosis:0.874444 Dermatofibroma:0.777566 Vascular lesion:0.858139
Accus: Melanoma:0.537815 Melanocytic nevus:0.826546 Basal cell carcinoma:0.722222 Actinic keratosis:0.909091 Benign keratosis:0.600000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.918552 Basal cell carcinoma:0.759259 Actinic keratosis:0.909091 Benign keratosis:0.690000 Dermatofibroma:0.687500 Vascular lesion:0.800000
Specs: Melanoma:0.818388 Melanocytic nevus:0.801187 Basal cell carcinoma:0.966173 Actinic keratosis:0.932782 Benign keratosis:0.911111 Dermatofibroma:0.967480 Vascular lesion:0.973604
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1139.0, 85.0, 41.0, 146.0, 17.0, 30.0]

TEST Student: Epoch: 22, iteration: 174

TEST AUROC: 0.921219, TEST Accus: 0.768386, TEST Senss: 0.885171, TEST Specs: 0.870824
AUROCs: Melanoma:0.886674 Melanocytic nevus:0.944187 Basal cell carcinoma:0.947201 Actinic keratosis:0.916225 Benign keratosis:0.918498 Dermatofibroma:0.837294 Vascular lesion:0.998455
Accus: Melanoma:0.632035 Melanocytic nevus:0.844329 Basal cell carcinoma:0.772727 Actinic keratosis:0.706897 Benign keratosis:0.682243 Dermatofibroma:0.772727 Vascular lesion:0.967742
Senss: Melanoma:0.887446 Melanocytic nevus:0.945145 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.855140 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.723655 Melanocytic nevus:0.738739 Basal cell carcinoma:0.931759 Actinic keratosis:0.915176 Benign keratosis:0.867851 Dermatofibroma:0.947316 Vascular lesion:0.971270
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_23.pth

Epoch: 23, iteration: 0/175, ==> train <===, loss: 3.547988, classification loss: 1.793874,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144070,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.042808,wcp loss: 0.000000,entropy loss: 1.855376,consistency weight: 1.000000, lr: 8.862938119652508e-06

Epoch: 23, iteration: 100/175, ==> train <===, loss: 3.554509, classification loss: 1.814444,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143207,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026446,wcp loss: 0.000000,entropy loss: 1.856825,consistency weight: 1.000000, lr: 8.862938119652508e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 554.0, 35.0, 29.0, 63.0, 9.0, 12.0]

VAL Student: Epoch: 23, iteration: 174

VAL AUROC: 0.880889, VAL Accus: 0.701379, VAL Senss: 0.787652, VAL Specs: 0.903840
AUROCs: Melanoma:0.837866 Melanocytic nevus:0.940080 Basal cell carcinoma:0.950356 Actinic keratosis:0.945379 Benign keratosis:0.862833 Dermatofibroma:0.769944 Vascular lesion:0.859763
Accus: Melanoma:0.554622 Melanocytic nevus:0.835596 Basal cell carcinoma:0.648148 Actinic keratosis:0.878788 Benign keratosis:0.630000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.935143 Basal cell carcinoma:0.740741 Actinic keratosis:0.909091 Benign keratosis:0.710000 Dermatofibroma:0.687500 Vascular lesion:0.800000
Specs: Melanoma:0.805902 Melanocytic nevus:0.762611 Basal cell carcinoma:0.970402 Actinic keratosis:0.929679 Benign keratosis:0.911111 Dermatofibroma:0.967480 Vascular lesion:0.979695
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1144.0, 81.0, 41.0, 144.0, 15.0, 30.0]

TEST Student: Epoch: 23, iteration: 174

TEST AUROC: 0.926993, TEST Accus: 0.747543, TEST Senss: 0.890020, TEST Specs: 0.862089
AUROCs: Melanoma:0.887249 Melanocytic nevus:0.944430 Basal cell carcinoma:0.954607 Actinic keratosis:0.935307 Benign keratosis:0.911681 Dermatofibroma:0.856863 Vascular lesion:0.998813
Accus: Melanoma:0.619048 Melanocytic nevus:0.848036 Basal cell carcinoma:0.736364 Actinic keratosis:0.706897 Benign keratosis:0.672897 Dermatofibroma:0.681818 Vascular lesion:0.967742
Senss: Melanoma:0.891775 Melanocytic nevus:0.962194 Basal cell carcinoma:0.890909 Actinic keratosis:0.862069 Benign keratosis:0.850467 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.703475 Melanocytic nevus:0.689189 Basal cell carcinoma:0.942257 Actinic keratosis:0.921308 Benign keratosis:0.862299 Dermatofibroma:0.940291 Vascular lesion:0.975806
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_24.pth

Epoch: 24, iteration: 0/175, ==> train <===, loss: 3.532585, classification loss: 1.786433,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140623,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026983,wcp loss: 0.000000,entropy loss: 1.859792,consistency weight: 1.000000, lr: 7.976644307687257e-06

Epoch: 24, iteration: 100/175, ==> train <===, loss: 3.547734, classification loss: 1.804366,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140118,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027399,wcp loss: 0.000000,entropy loss: 1.856086,consistency weight: 1.000000, lr: 7.976644307687257e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 586.0, 31.0, 28.0, 53.0, 10.0, 12.0]

VAL Student: Epoch: 24, iteration: 174

VAL AUROC: 0.879026, VAL Accus: 0.679603, VAL Senss: 0.768906, VAL Specs: 0.898277
AUROCs: Melanoma:0.833011 Melanocytic nevus:0.936137 Basal cell carcinoma:0.885072 Actinic keratosis:0.939551 Benign keratosis:0.843378 Dermatofibroma:0.850927 Vascular lesion:0.865110
Accus: Melanoma:0.495798 Melanocytic nevus:0.883861 Basal cell carcinoma:0.574074 Actinic keratosis:0.848485 Benign keratosis:0.530000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.954751 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.640000 Dermatofibroma:0.687500 Vascular lesion:0.800000
Specs: Melanoma:0.828604 Melanocytic nevus:0.679525 Basal cell carcinoma:0.983087 Actinic keratosis:0.942089 Benign keratosis:0.927778 Dermatofibroma:0.956301 Vascular lesion:0.970558
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [136.0, 1195.0, 73.0, 38.0, 142.0, 14.0, 29.0]

TEST Student: Epoch: 24, iteration: 174

TEST AUROC: 0.931166, TEST Accus: 0.718399, TEST Senss: 0.881159, TEST Specs: 0.859333
AUROCs: Melanoma:0.892243 Melanocytic nevus:0.943831 Basal cell carcinoma:0.951272 Actinic keratosis:0.945959 Benign keratosis:0.918156 Dermatofibroma:0.868198 Vascular lesion:0.998504
Accus: Melanoma:0.588745 Melanocytic nevus:0.885841 Basal cell carcinoma:0.663636 Actinic keratosis:0.655172 Benign keratosis:0.663551 Dermatofibroma:0.636364 Vascular lesion:0.935484
Senss: Melanoma:0.887446 Melanocytic nevus:0.973314 Basal cell carcinoma:0.845455 Actinic keratosis:0.862069 Benign keratosis:0.827103 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.725897 Melanocytic nevus:0.615616 Basal cell carcinoma:0.958005 Actinic keratosis:0.933572 Benign keratosis:0.881732 Dermatofibroma:0.932263 Vascular lesion:0.968246
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_25.pth

Epoch: 25, iteration: 0/175, ==> train <===, loss: 3.597056, classification loss: 1.841440,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.135251,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033320,wcp loss: 0.000000,entropy loss: 1.857547,consistency weight: 1.000000, lr: 7.1789798769185315e-06

Epoch: 25, iteration: 100/175, ==> train <===, loss: 3.547220, classification loss: 1.807298,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143087,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027547,wcp loss: 0.000000,entropy loss: 1.855460,consistency weight: 1.000000, lr: 7.1789798769185315e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [81.0, 483.0, 44.0, 23.0, 59.0, 9.0, 11.0]

VAL Student: Epoch: 25, iteration: 174

VAL AUROC: 0.893407, VAL Accus: 0.686685, VAL Senss: 0.779586, VAL Specs: 0.902687
AUROCs: Melanoma:0.843236 Melanocytic nevus:0.930775 Basal cell carcinoma:0.970872 Actinic keratosis:0.960766 Benign keratosis:0.893200 Dermatofibroma:0.807419 Vascular lesion:0.847580
Accus: Melanoma:0.680672 Melanocytic nevus:0.728507 Basal cell carcinoma:0.814815 Actinic keratosis:0.696970 Benign keratosis:0.590000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.876320 Basal cell carcinoma:0.888889 Actinic keratosis:0.787879 Benign keratosis:0.760000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.736663 Melanocytic nevus:0.866469 Basal cell carcinoma:0.933404 Actinic keratosis:0.961737 Benign keratosis:0.885556 Dermatofibroma:0.957317 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [167.0, 986.0, 92.0, 27.0, 155.0, 12.0, 29.0]

TEST Student: Epoch: 25, iteration: 174

TEST AUROC: 0.920154, TEST Accus: 0.708711, TEST Senss: 0.885897, TEST Specs: 0.858413
AUROCs: Melanoma:0.874378 Melanocytic nevus:0.945179 Basal cell carcinoma:0.964810 Actinic keratosis:0.928999 Benign keratosis:0.919359 Dermatofibroma:0.810484 Vascular lesion:0.997870
Accus: Melanoma:0.722944 Melanocytic nevus:0.730912 Basal cell carcinoma:0.836364 Actinic keratosis:0.465517 Benign keratosis:0.724299 Dermatofibroma:0.545455 Vascular lesion:0.935484
Senss: Melanoma:0.943723 Melanocytic nevus:0.918458 Basal cell carcinoma:0.936364 Actinic keratosis:0.793103 Benign keratosis:0.869159 Dermatofibroma:0.772727 Vascular lesion:0.967742
Specs: Melanoma:0.632287 Melanocytic nevus:0.831832 Basal cell carcinoma:0.870341 Actinic keratosis:0.951456 Benign keratosis:0.812882 Dermatofibroma:0.930758 Vascular lesion:0.979335
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_26.pth

Epoch: 26, iteration: 0/175, ==> train <===, loss: 3.540258, classification loss: 1.808408,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148004,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024865,wcp loss: 0.000000,entropy loss: 1.854988,consistency weight: 1.000000, lr: 6.461081889226678e-06

Epoch: 26, iteration: 100/175, ==> train <===, loss: 3.541987, classification loss: 1.807852,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145190,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024125,wcp loss: 0.000000,entropy loss: 1.855201,consistency weight: 1.000000, lr: 6.461081889226678e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 561.0, 36.0, 28.0, 56.0, 9.0, 12.0]

VAL Student: Epoch: 26, iteration: 174

VAL AUROC: 0.885442, VAL Accus: 0.698407, VAL Senss: 0.792719, VAL Specs: 0.895032
AUROCs: Melanoma:0.868036 Melanocytic nevus:0.940899 Basal cell carcinoma:0.931192 Actinic keratosis:0.960202 Benign keratosis:0.843189 Dermatofibroma:0.788110 Vascular lesion:0.866464
Accus: Melanoma:0.605042 Melanocytic nevus:0.846154 Basal cell carcinoma:0.666667 Actinic keratosis:0.848485 Benign keratosis:0.560000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.815126 Melanocytic nevus:0.951735 Basal cell carcinoma:0.777778 Actinic keratosis:0.939394 Benign keratosis:0.640000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.750284 Melanocytic nevus:0.741840 Basal cell carcinoma:0.974630 Actinic keratosis:0.935884 Benign keratosis:0.925556 Dermatofibroma:0.973577 Vascular lesion:0.963452
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [164.0, 1157.0, 82.0, 40.0, 136.0, 11.0, 29.0]

TEST Student: Epoch: 26, iteration: 174

TEST AUROC: 0.936599, TEST Accus: 0.724820, TEST Senss: 0.896713, TEST Specs: 0.850881
AUROCs: Melanoma:0.905253 Melanocytic nevus:0.940732 Basal cell carcinoma:0.971892 Actinic keratosis:0.949351 Benign keratosis:0.918545 Dermatofibroma:0.872257 Vascular lesion:0.998163
Accus: Melanoma:0.709957 Melanocytic nevus:0.857672 Basal cell carcinoma:0.745455 Actinic keratosis:0.689655 Benign keratosis:0.635514 Dermatofibroma:0.500000 Vascular lesion:0.935484
Senss: Melanoma:0.943723 Melanocytic nevus:0.967383 Basal cell carcinoma:0.872727 Actinic keratosis:0.879310 Benign keratosis:0.841121 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.640695 Melanocytic nevus:0.672673 Basal cell carcinoma:0.944882 Actinic keratosis:0.922330 Benign keratosis:0.865075 Dermatofibroma:0.949824 Vascular lesion:0.960685
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_27.pth

Epoch: 27, iteration: 0/175, ==> train <===, loss: 3.532826, classification loss: 1.812632,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.154502,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021902,wcp loss: 0.000000,entropy loss: 1.852794,consistency weight: 1.000000, lr: 5.81497370030401e-06

Epoch: 27, iteration: 100/175, ==> train <===, loss: 3.547498, classification loss: 1.806236,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141320,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028114,wcp loss: 0.000000,entropy loss: 1.854468,consistency weight: 1.000000, lr: 5.81497370030401e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 553.0, 43.0, 27.0, 53.0, 9.0, 12.0]

VAL Student: Epoch: 27, iteration: 174

VAL AUROC: 0.891649, VAL Accus: 0.706587, VAL Senss: 0.785564, VAL Specs: 0.892612
AUROCs: Melanoma:0.862809 Melanocytic nevus:0.939485 Basal cell carcinoma:0.964529 Actinic keratosis:0.961988 Benign keratosis:0.847072 Dermatofibroma:0.796557 Vascular lesion:0.869103
Accus: Melanoma:0.605042 Melanocytic nevus:0.834087 Basal cell carcinoma:0.796296 Actinic keratosis:0.818182 Benign keratosis:0.530000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.798319 Melanocytic nevus:0.945701 Basal cell carcinoma:0.833333 Actinic keratosis:0.909091 Benign keratosis:0.650000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.740068 Melanocytic nevus:0.738872 Basal cell carcinoma:0.960888 Actinic keratosis:0.951396 Benign keratosis:0.932222 Dermatofibroma:0.962398 Vascular lesion:0.962437
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [155.0, 1143.0, 91.0, 36.0, 135.0, 12.0, 30.0]

TEST Student: Epoch: 27, iteration: 174

TEST AUROC: 0.931806, TEST Accus: 0.730041, TEST Senss: 0.900549, TEST Specs: 0.849889
AUROCs: Melanoma:0.890463 Melanocytic nevus:0.935382 Basal cell carcinoma:0.972937 Actinic keratosis:0.959844 Benign keratosis:0.918883 Dermatofibroma:0.846349 Vascular lesion:0.998781
Accus: Melanoma:0.670996 Melanocytic nevus:0.847294 Basal cell carcinoma:0.827273 Actinic keratosis:0.620690 Benign keratosis:0.630841 Dermatofibroma:0.545455 Vascular lesion:0.967742
Senss: Melanoma:0.939394 Melanocytic nevus:0.970348 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.841121 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.632287 Melanocytic nevus:0.680180 Basal cell carcinoma:0.920210 Actinic keratosis:0.942259 Benign keratosis:0.882843 Dermatofibroma:0.930758 Vascular lesion:0.960685
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_28.pth

Epoch: 28, iteration: 0/175, ==> train <===, loss: 3.541072, classification loss: 1.797688,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147560,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.037581,wcp loss: 0.000000,entropy loss: 1.853364,consistency weight: 1.000000, lr: 5.23347633027361e-06

Epoch: 28, iteration: 100/175, ==> train <===, loss: 3.544325, classification loss: 1.808155,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142177,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024010,wcp loss: 0.000000,entropy loss: 1.854337,consistency weight: 1.000000, lr: 5.23347633027361e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [77.0, 527.0, 44.0, 26.0, 54.0, 9.0, 11.0]

VAL Student: Epoch: 28, iteration: 174

VAL AUROC: 0.888088, VAL Accus: 0.697208, VAL Senss: 0.778890, VAL Specs: 0.898058
AUROCs: Melanoma:0.858631 Melanocytic nevus:0.937390 Basal cell carcinoma:0.979876 Actinic keratosis:0.963618 Benign keratosis:0.860833 Dermatofibroma:0.736471 Vascular lesion:0.879797
Accus: Melanoma:0.647059 Melanocytic nevus:0.794872 Basal cell carcinoma:0.814815 Actinic keratosis:0.787879 Benign keratosis:0.540000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.926094 Basal cell carcinoma:0.833333 Actinic keratosis:0.878788 Benign keratosis:0.670000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.719637 Melanocytic nevus:0.807122 Basal cell carcinoma:0.948203 Actinic keratosis:0.948294 Benign keratosis:0.932222 Dermatofibroma:0.963415 Vascular lesion:0.967513
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 1094.0, 91.0, 33.0, 137.0, 11.0, 29.0]

TEST Student: Epoch: 28, iteration: 174

TEST AUROC: 0.925479, TEST Accus: 0.718210, TEST Senss: 0.896190, TEST Specs: 0.858569
AUROCs: Melanoma:0.884180 Melanocytic nevus:0.939239 Basal cell carcinoma:0.972336 Actinic keratosis:0.941721 Benign keratosis:0.915107 Dermatofibroma:0.827282 Vascular lesion:0.998488
Accus: Melanoma:0.744589 Melanocytic nevus:0.810971 Basal cell carcinoma:0.827273 Actinic keratosis:0.568966 Benign keratosis:0.640187 Dermatofibroma:0.500000 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.945886 Basal cell carcinoma:0.936364 Actinic keratosis:0.879310 Benign keratosis:0.836449 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.625561 Melanocytic nevus:0.740240 Basal cell carcinoma:0.915486 Actinic keratosis:0.939193 Benign keratosis:0.878956 Dermatofibroma:0.941295 Vascular lesion:0.969254
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_29.pth

Epoch: 29, iteration: 0/175, ==> train <===, loss: 3.526331, classification loss: 1.796158,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140538,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021239,wcp loss: 0.000000,entropy loss: 1.849472,consistency weight: 1.000000, lr: 4.710128697246249e-06

Epoch: 29, iteration: 100/175, ==> train <===, loss: 3.537766, classification loss: 1.802128,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144595,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027335,wcp loss: 0.000000,entropy loss: 1.852898,consistency weight: 1.000000, lr: 4.710128697246249e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 521.0, 42.0, 27.0, 58.0, 9.0, 12.0]

VAL Student: Epoch: 29, iteration: 174

VAL AUROC: 0.894129, VAL Accus: 0.706590, VAL Senss: 0.783686, VAL Specs: 0.886340
AUROCs: Melanoma:0.866777 Melanocytic nevus:0.933796 Basal cell carcinoma:0.975550 Actinic keratosis:0.962897 Benign keratosis:0.866556 Dermatofibroma:0.780297 Vascular lesion:0.873029
Accus: Melanoma:0.621849 Melanocytic nevus:0.785822 Basal cell carcinoma:0.777778 Actinic keratosis:0.818182 Benign keratosis:0.580000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.781513 Melanocytic nevus:0.939668 Basal cell carcinoma:0.833333 Actinic keratosis:0.878788 Benign keratosis:0.690000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.733258 Melanocytic nevus:0.768546 Basal cell carcinoma:0.963002 Actinic keratosis:0.948294 Benign keratosis:0.923333 Dermatofibroma:0.926829 Vascular lesion:0.941117
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [161.0, 1092.0, 90.0, 35.0, 145.0, 10.0, 30.0]

TEST Student: Epoch: 29, iteration: 174

TEST AUROC: 0.927152, TEST Accus: 0.718278, TEST Senss: 0.891865, TEST Specs: 0.840614
AUROCs: Melanoma:0.885313 Melanocytic nevus:0.934231 Basal cell carcinoma:0.972727 Actinic keratosis:0.955421 Benign keratosis:0.919385 Dermatofibroma:0.824636 Vascular lesion:0.998350
Accus: Melanoma:0.696970 Melanocytic nevus:0.809489 Basal cell carcinoma:0.818182 Actinic keratosis:0.603448 Benign keratosis:0.677570 Dermatofibroma:0.454545 Vascular lesion:0.967742
Senss: Melanoma:0.930736 Melanocytic nevus:0.963677 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.841121 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.642937 Melanocytic nevus:0.683183 Basal cell carcinoma:0.928084 Actinic keratosis:0.944303 Benign keratosis:0.872293 Dermatofibroma:0.891621 Vascular lesion:0.921875
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_30.pth

Epoch: 30, iteration: 0/175, ==> train <===, loss: 3.549933, classification loss: 1.815465,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150857,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028823,wcp loss: 0.000000,entropy loss: 1.856502,consistency weight: 1.000000, lr: 4.239115827521624e-06

Epoch: 30, iteration: 100/175, ==> train <===, loss: 3.543377, classification loss: 1.808158,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144794,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027175,wcp loss: 0.000000,entropy loss: 1.852838,consistency weight: 1.000000, lr: 4.239115827521624e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [84.0, 501.0, 34.0, 26.0, 56.0, 9.0, 12.0]

VAL Student: Epoch: 30, iteration: 174

VAL AUROC: 0.888702, VAL Accus: 0.685935, VAL Senss: 0.781312, VAL Specs: 0.892481
AUROCs: Melanoma:0.871851 Melanocytic nevus:0.938970 Basal cell carcinoma:0.928353 Actinic keratosis:0.951741 Benign keratosis:0.876522 Dermatofibroma:0.770770 Vascular lesion:0.882707
Accus: Melanoma:0.705882 Melanocytic nevus:0.755656 Basal cell carcinoma:0.629630 Actinic keratosis:0.787879 Benign keratosis:0.560000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.890756 Melanocytic nevus:0.926094 Basal cell carcinoma:0.740741 Actinic keratosis:0.909091 Benign keratosis:0.640000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.674234 Melanocytic nevus:0.804154 Basal cell carcinoma:0.976744 Actinic keratosis:0.937952 Benign keratosis:0.935556 Dermatofibroma:0.944106 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [188.0, 1043.0, 84.0, 42.0, 133.0, 12.0, 28.0]

TEST Student: Epoch: 30, iteration: 174

TEST AUROC: 0.931274, TEST Accus: 0.734995, TEST Senss: 0.894951, TEST Specs: 0.852705
AUROCs: Melanoma:0.889164 Melanocytic nevus:0.942424 Basal cell carcinoma:0.967020 Actinic keratosis:0.957905 Benign keratosis:0.911163 Dermatofibroma:0.852529 Vascular lesion:0.998716
Accus: Melanoma:0.813853 Melanocytic nevus:0.773165 Basal cell carcinoma:0.763636 Actinic keratosis:0.724138 Benign keratosis:0.621495 Dermatofibroma:0.545455 Vascular lesion:0.903226
Senss: Melanoma:0.974026 Melanocytic nevus:0.948110 Basal cell carcinoma:0.872727 Actinic keratosis:0.879310 Benign keratosis:0.817757 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.568386 Melanocytic nevus:0.743243 Basal cell carcinoma:0.952756 Actinic keratosis:0.929484 Benign keratosis:0.890061 Dermatofibroma:0.906172 Vascular lesion:0.978831
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_31.pth

Epoch: 31, iteration: 0/175, ==> train <===, loss: 3.540525, classification loss: 1.796846,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148326,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.036750,wcp loss: 0.000000,entropy loss: 1.855256,consistency weight: 1.000000, lr: 3.815204244769462e-06

Epoch: 31, iteration: 100/175, ==> train <===, loss: 3.547520, classification loss: 1.812175,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143006,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025295,wcp loss: 0.000000,entropy loss: 1.853057,consistency weight: 1.000000, lr: 3.815204244769462e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 529.0, 45.0, 23.0, 60.0, 10.0, 12.0]

VAL Student: Epoch: 31, iteration: 174

VAL AUROC: 0.890723, VAL Accus: 0.708319, VAL Senss: 0.791528, VAL Specs: 0.895527
AUROCs: Melanoma:0.862990 Melanocytic nevus:0.938500 Basal cell carcinoma:0.980777 Actinic keratosis:0.907524 Benign keratosis:0.887722 Dermatofibroma:0.789190 Vascular lesion:0.868359
Accus: Melanoma:0.605042 Melanocytic nevus:0.797888 Basal cell carcinoma:0.833333 Actinic keratosis:0.696970 Benign keratosis:0.600000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Senss: Melanoma:0.773109 Melanocytic nevus:0.927602 Basal cell carcinoma:0.907407 Actinic keratosis:0.757576 Benign keratosis:0.750000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.745743 Melanocytic nevus:0.804154 Basal cell carcinoma:0.946089 Actinic keratosis:0.970010 Benign keratosis:0.914444 Dermatofibroma:0.921748 Vascular lesion:0.966497
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [160.0, 1089.0, 94.0, 27.0, 147.0, 10.0, 29.0]

TEST Student: Epoch: 31, iteration: 174

TEST AUROC: 0.924375, TEST Accus: 0.699559, TEST Senss: 0.879573, TEST Specs: 0.851804
AUROCs: Melanoma:0.885400 Melanocytic nevus:0.942009 Basal cell carcinoma:0.968714 Actinic keratosis:0.935307 Benign keratosis:0.927615 Dermatofibroma:0.812720 Vascular lesion:0.998862
Accus: Melanoma:0.692641 Melanocytic nevus:0.807265 Basal cell carcinoma:0.854545 Actinic keratosis:0.465517 Benign keratosis:0.686916 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.930736 Melanocytic nevus:0.953299 Basal cell carcinoma:0.927273 Actinic keratosis:0.758621 Benign keratosis:0.859813 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.659753 Melanocytic nevus:0.722222 Basal cell carcinoma:0.898163 Actinic keratosis:0.967297 Benign keratosis:0.857857 Dermatofibroma:0.894129 Vascular lesion:0.963206
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_32.pth

Epoch: 32, iteration: 0/175, ==> train <===, loss: 3.541704, classification loss: 1.790880,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.137416,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030355,wcp loss: 0.000000,entropy loss: 1.857884,consistency weight: 1.000000, lr: 3.4336838202925156e-06

Epoch: 32, iteration: 100/175, ==> train <===, loss: 3.542398, classification loss: 1.807903,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144041,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026400,wcp loss: 0.000000,entropy loss: 1.852135,consistency weight: 1.000000, lr: 3.4336838202925156e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [78.0, 493.0, 43.0, 27.0, 57.0, 9.0, 12.0]

VAL Student: Epoch: 32, iteration: 174

VAL AUROC: 0.900487, VAL Accus: 0.706576, VAL Senss: 0.789576, VAL Specs: 0.891632
AUROCs: Melanoma:0.854997 Melanocytic nevus:0.929106 Basal cell carcinoma:0.978271 Actinic keratosis:0.961017 Benign keratosis:0.890411 Dermatofibroma:0.795668 Vascular lesion:0.893942
Accus: Melanoma:0.655462 Melanocytic nevus:0.743590 Basal cell carcinoma:0.796296 Actinic keratosis:0.818182 Benign keratosis:0.570000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.773109 Melanocytic nevus:0.901961 Basal cell carcinoma:0.870370 Actinic keratosis:0.909091 Benign keratosis:0.710000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.728717 Melanocytic nevus:0.827893 Basal cell carcinoma:0.948203 Actinic keratosis:0.928645 Benign keratosis:0.916667 Dermatofibroma:0.929878 Vascular lesion:0.961421
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [162.0, 1030.0, 95.0, 36.0, 144.0, 12.0, 29.0]

TEST Student: Epoch: 32, iteration: 174

TEST AUROC: 0.919639, TEST Accus: 0.728998, TEST Senss: 0.894606, TEST Specs: 0.844614
AUROCs: Melanoma:0.876752 Melanocytic nevus:0.934089 Basal cell carcinoma:0.964114 Actinic keratosis:0.947923 Benign keratosis:0.906773 Dermatofibroma:0.809333 Vascular lesion:0.998488
Accus: Melanoma:0.701299 Melanocytic nevus:0.763529 Basal cell carcinoma:0.863636 Actinic keratosis:0.620690 Benign keratosis:0.672897 Dermatofibroma:0.545455 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.939214 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.841121 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.639013 Melanocytic nevus:0.762763 Basal cell carcinoma:0.889764 Actinic keratosis:0.915176 Benign keratosis:0.857301 Dermatofibroma:0.890115 Vascular lesion:0.958165
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_33.pth

Epoch: 33, iteration: 0/175, ==> train <===, loss: 3.551413, classification loss: 1.813176,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145698,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026354,wcp loss: 0.000000,entropy loss: 1.857581,consistency weight: 1.000000, lr: 3.090315438263264e-06

Epoch: 33, iteration: 100/175, ==> train <===, loss: 3.547012, classification loss: 1.812575,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143528,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025467,wcp loss: 0.000000,entropy loss: 1.852497,consistency weight: 1.000000, lr: 3.090315438263264e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 508.0, 39.0, 28.0, 56.0, 7.0, 12.0]

VAL Student: Epoch: 33, iteration: 174

VAL AUROC: 0.893755, VAL Accus: 0.681868, VAL Senss: 0.792778, VAL Specs: 0.891605
AUROCs: Melanoma:0.842978 Melanocytic nevus:0.933152 Basal cell carcinoma:0.967739 Actinic keratosis:0.958948 Benign keratosis:0.868056 Dermatofibroma:0.749301 Vascular lesion:0.936108
Accus: Melanoma:0.638655 Melanocytic nevus:0.766214 Basal cell carcinoma:0.722222 Actinic keratosis:0.848485 Benign keratosis:0.560000 Dermatofibroma:0.437500 Vascular lesion:0.800000
Senss: Melanoma:0.789916 Melanocytic nevus:0.912519 Basal cell carcinoma:0.814815 Actinic keratosis:0.969697 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.710556 Melanocytic nevus:0.813056 Basal cell carcinoma:0.958774 Actinic keratosis:0.912099 Benign keratosis:0.906667 Dermatofibroma:0.979675 Vascular lesion:0.960406
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [164.0, 1064.0, 88.0, 43.0, 145.0, 8.0, 30.0]

TEST Student: Epoch: 33, iteration: 174

TEST AUROC: 0.919799, TEST Accus: 0.721288, TEST Senss: 0.882682, TEST Specs: 0.842976
AUROCs: Melanoma:0.871907 Melanocytic nevus:0.935364 Basal cell carcinoma:0.968929 Actinic keratosis:0.949765 Benign keratosis:0.899228 Dermatofibroma:0.814715 Vascular lesion:0.998683
Accus: Melanoma:0.709957 Melanocytic nevus:0.788732 Basal cell carcinoma:0.800000 Actinic keratosis:0.741379 Benign keratosis:0.677570 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.948052 Melanocytic nevus:0.951075 Basal cell carcinoma:0.918182 Actinic keratosis:0.879310 Benign keratosis:0.845794 Dermatofibroma:0.636364 Vascular lesion:1.000000
Specs: Melanoma:0.612108 Melanocytic nevus:0.746246 Basal cell carcinoma:0.916535 Actinic keratosis:0.887583 Benign keratosis:0.838423 Dermatofibroma:0.947817 Vascular lesion:0.952117
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_34.pth

Epoch: 34, iteration: 0/175, ==> train <===, loss: 3.527381, classification loss: 1.798231,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143535,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024508,wcp loss: 0.000000,entropy loss: 1.848177,consistency weight: 1.000000, lr: 2.7812838944369375e-06

Epoch: 34, iteration: 100/175, ==> train <===, loss: 3.539020, classification loss: 1.802415,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143215,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026024,wcp loss: 0.000000,entropy loss: 1.853795,consistency weight: 1.000000, lr: 2.7812838944369375e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [80.0, 499.0, 41.0, 23.0, 59.0, 9.0, 12.0]

VAL Student: Epoch: 34, iteration: 174

VAL AUROC: 0.888584, VAL Accus: 0.690520, VAL Senss: 0.776363, VAL Specs: 0.885321
AUROCs: Melanoma:0.868227 Melanocytic nevus:0.937350 Basal cell carcinoma:0.970010 Actinic keratosis:0.873241 Benign keratosis:0.889400 Dermatofibroma:0.769372 Vascular lesion:0.912487
Accus: Melanoma:0.672269 Melanocytic nevus:0.752640 Basal cell carcinoma:0.759259 Actinic keratosis:0.696970 Benign keratosis:0.590000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.823529 Melanocytic nevus:0.927602 Basal cell carcinoma:0.833333 Actinic keratosis:0.757576 Benign keratosis:0.730000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.685585 Melanocytic nevus:0.795252 Basal cell carcinoma:0.961945 Actinic keratosis:0.967942 Benign keratosis:0.903333 Dermatofibroma:0.939024 Vascular lesion:0.944162
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [178.0, 1029.0, 89.0, 28.0, 146.0, 10.0, 30.0]

TEST Student: Epoch: 34, iteration: 174

TEST AUROC: 0.921919, TEST Accus: 0.704247, TEST Senss: 0.873130, TEST Specs: 0.841609
AUROCs: Melanoma:0.875925 Melanocytic nevus:0.936142 Basal cell carcinoma:0.970742 Actinic keratosis:0.939378 Benign keratosis:0.911363 Dermatofibroma:0.821523 Vascular lesion:0.998358
Accus: Melanoma:0.770563 Melanocytic nevus:0.762787 Basal cell carcinoma:0.809091 Actinic keratosis:0.482759 Benign keratosis:0.682243 Dermatofibroma:0.454545 Vascular lesion:0.967742
Senss: Melanoma:0.969697 Melanocytic nevus:0.954781 Basal cell carcinoma:0.909091 Actinic keratosis:0.741379 Benign keratosis:0.855140 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.584081 Melanocytic nevus:0.732733 Basal cell carcinoma:0.924409 Actinic keratosis:0.962187 Benign keratosis:0.846197 Dermatofibroma:0.906673 Vascular lesion:0.934980
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_35.pth

Epoch: 35, iteration: 0/175, ==> train <===, loss: 3.548535, classification loss: 1.816460,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143344,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024354,wcp loss: 0.000000,entropy loss: 1.851066,consistency weight: 1.000000, lr: 2.503155504993244e-06

Epoch: 35, iteration: 100/175, ==> train <===, loss: 3.556853, classification loss: 1.827941,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147514,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023646,wcp loss: 0.000000,entropy loss: 1.852781,consistency weight: 1.000000, lr: 2.503155504993244e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 541.0, 42.0, 24.0, 62.0, 8.0, 12.0]

VAL Student: Epoch: 35, iteration: 174

VAL AUROC: 0.890454, VAL Accus: 0.687495, VAL Senss: 0.777981, VAL Specs: 0.889057
AUROCs: Melanoma:0.868112 Melanocytic nevus:0.935577 Basal cell carcinoma:0.965762 Actinic keratosis:0.948983 Benign keratosis:0.871233 Dermatofibroma:0.759654 Vascular lesion:0.883858
Accus: Melanoma:0.571429 Melanocytic nevus:0.815988 Basal cell carcinoma:0.777778 Actinic keratosis:0.727273 Benign keratosis:0.620000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.773109 Melanocytic nevus:0.950226 Basal cell carcinoma:0.851852 Actinic keratosis:0.818182 Benign keratosis:0.690000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.744608 Melanocytic nevus:0.747774 Basal cell carcinoma:0.961945 Actinic keratosis:0.960703 Benign keratosis:0.921111 Dermatofibroma:0.949187 Vascular lesion:0.938071
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [158.0, 1137.0, 87.0, 32.0, 147.0, 9.0, 31.0]

TEST Student: Epoch: 35, iteration: 174

TEST AUROC: 0.928089, TEST Accus: 0.709353, TEST Senss: 0.891373, TEST Specs: 0.846132
AUROCs: Melanoma:0.894980 Melanocytic nevus:0.936832 Basal cell carcinoma:0.977480 Actinic keratosis:0.948531 Benign keratosis:0.920649 Dermatofibroma:0.819482 Vascular lesion:0.998667
Accus: Melanoma:0.683983 Melanocytic nevus:0.842847 Basal cell carcinoma:0.790909 Actinic keratosis:0.551724 Benign keratosis:0.686916 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.930736 Melanocytic nevus:0.968125 Basal cell carcinoma:0.918182 Actinic keratosis:0.844828 Benign keratosis:0.850467 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.653587 Melanocytic nevus:0.686186 Basal cell carcinoma:0.932808 Actinic keratosis:0.957077 Benign keratosis:0.866741 Dermatofibroma:0.909182 Vascular lesion:0.917339
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_36.pth

Epoch: 36, iteration: 0/175, ==> train <===, loss: 3.520513, classification loss: 1.786689,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146735,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029121,wcp loss: 0.000000,entropy loss: 1.851438,consistency weight: 1.000000, lr: 2.2528399544939195e-06

Epoch: 36, iteration: 100/175, ==> train <===, loss: 3.538784, classification loss: 1.805704,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146038,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026382,wcp loss: 0.000000,entropy loss: 1.852735,consistency weight: 1.000000, lr: 2.2528399544939195e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 519.0, 44.0, 24.0, 58.0, 9.0, 11.0]

VAL Student: Epoch: 36, iteration: 174

VAL AUROC: 0.891204, VAL Accus: 0.691340, VAL Senss: 0.778715, VAL Specs: 0.891264
AUROCs: Melanoma:0.855063 Melanocytic nevus:0.940107 Basal cell carcinoma:0.981873 Actinic keratosis:0.949861 Benign keratosis:0.880878 Dermatofibroma:0.758765 Vascular lesion:0.871878
Accus: Melanoma:0.638655 Melanocytic nevus:0.782805 Basal cell carcinoma:0.814815 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.789916 Melanocytic nevus:0.932127 Basal cell carcinoma:0.888889 Actinic keratosis:0.757576 Benign keratosis:0.720000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.711691 Melanocytic nevus:0.807122 Basal cell carcinoma:0.945032 Actinic keratosis:0.959669 Benign keratosis:0.907778 Dermatofibroma:0.945122 Vascular lesion:0.962437
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [166.0, 1077.0, 89.0, 30.0, 145.0, 10.0, 29.0]

TEST Student: Epoch: 36, iteration: 174

TEST AUROC: 0.922306, TEST Accus: 0.701559, TEST Senss: 0.894118, TEST Specs: 0.847905
AUROCs: Melanoma:0.880467 Melanocytic nevus:0.937609 Basal cell carcinoma:0.976316 Actinic keratosis:0.941545 Benign keratosis:0.912143 Dermatofibroma:0.809561 Vascular lesion:0.998504
Accus: Melanoma:0.718615 Melanocytic nevus:0.798369 Basal cell carcinoma:0.809091 Actinic keratosis:0.517241 Benign keratosis:0.677570 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.952381 Melanocytic nevus:0.958488 Basal cell carcinoma:0.936364 Actinic keratosis:0.879310 Benign keratosis:0.850467 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.619955 Melanocytic nevus:0.726727 Basal cell carcinoma:0.906037 Actinic keratosis:0.949412 Benign keratosis:0.857301 Dermatofibroma:0.912694 Vascular lesion:0.963206
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_37.pth

Epoch: 37, iteration: 0/175, ==> train <===, loss: 3.530015, classification loss: 1.806288,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150385,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020913,wcp loss: 0.000000,entropy loss: 1.853199,consistency weight: 1.000000, lr: 2.0275559590445276e-06

Epoch: 37, iteration: 100/175, ==> train <===, loss: 3.547937, classification loss: 1.818462,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146716,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024210,wcp loss: 0.000000,entropy loss: 1.851980,consistency weight: 1.000000, lr: 2.0275559590445276e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 527.0, 42.0, 26.0, 55.0, 9.0, 11.0]

VAL Student: Epoch: 37, iteration: 174

VAL AUROC: 0.893501, VAL Accus: 0.686143, VAL Senss: 0.788958, VAL Specs: 0.884901
AUROCs: Melanoma:0.868150 Melanocytic nevus:0.936965 Basal cell carcinoma:0.964196 Actinic keratosis:0.969572 Benign keratosis:0.864117 Dermatofibroma:0.769817 Vascular lesion:0.881692
Accus: Melanoma:0.596639 Melanocytic nevus:0.794872 Basal cell carcinoma:0.777778 Actinic keratosis:0.787879 Benign keratosis:0.550000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.815126 Melanocytic nevus:0.941176 Basal cell carcinoma:0.814815 Actinic keratosis:0.909091 Benign keratosis:0.680000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.724177 Melanocytic nevus:0.774481 Basal cell carcinoma:0.961945 Actinic keratosis:0.951396 Benign keratosis:0.925556 Dermatofibroma:0.898374 Vascular lesion:0.958376
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [161.0, 1085.0, 89.0, 33.0, 145.0, 11.0, 30.0]

TEST Student: Epoch: 37, iteration: 174

TEST AUROC: 0.930740, TEST Accus: 0.717805, TEST Senss: 0.900594, TEST Specs: 0.846855
AUROCs: Melanoma:0.886339 Melanocytic nevus:0.937655 Basal cell carcinoma:0.973372 Actinic keratosis:0.958452 Benign keratosis:0.918018 Dermatofibroma:0.842551 Vascular lesion:0.998797
Accus: Melanoma:0.696970 Melanocytic nevus:0.804299 Basal cell carcinoma:0.809091 Actinic keratosis:0.568966 Benign keratosis:0.677570 Dermatofibroma:0.500000 Vascular lesion:0.967742
Senss: Melanoma:0.935065 Melanocytic nevus:0.965901 Basal cell carcinoma:0.927273 Actinic keratosis:0.862069 Benign keratosis:0.841121 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.635650 Melanocytic nevus:0.707207 Basal cell carcinoma:0.929659 Actinic keratosis:0.949923 Benign keratosis:0.872293 Dermatofibroma:0.869543 Vascular lesion:0.963710
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_38.pth

Epoch: 38, iteration: 0/175, ==> train <===, loss: 3.512418, classification loss: 1.785675,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148407,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023526,wcp loss: 0.000000,entropy loss: 1.851624,consistency weight: 1.000000, lr: 1.824800363140075e-06

Epoch: 38, iteration: 100/175, ==> train <===, loss: 3.535263, classification loss: 1.805575,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146233,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024277,wcp loss: 0.000000,entropy loss: 1.851644,consistency weight: 1.000000, lr: 1.824800363140075e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [82.0, 504.0, 39.0, 28.0, 53.0, 8.0, 11.0]

VAL Student: Epoch: 38, iteration: 174

VAL AUROC: 0.892259, VAL Accus: 0.683328, VAL Senss: 0.798144, VAL Specs: 0.887141
AUROCs: Melanoma:0.859766 Melanocytic nevus:0.940908 Basal cell carcinoma:0.969677 Actinic keratosis:0.963586 Benign keratosis:0.865133 Dermatofibroma:0.747586 Vascular lesion:0.899154
Accus: Melanoma:0.689076 Melanocytic nevus:0.760181 Basal cell carcinoma:0.722222 Actinic keratosis:0.848485 Benign keratosis:0.530000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.857143 Melanocytic nevus:0.927602 Basal cell carcinoma:0.870370 Actinic keratosis:0.939394 Benign keratosis:0.630000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.681044 Melanocytic nevus:0.786350 Basal cell carcinoma:0.955603 Actinic keratosis:0.922441 Benign keratosis:0.936667 Dermatofibroma:0.966463 Vascular lesion:0.961421
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [178.0, 1066.0, 90.0, 44.0, 132.0, 9.0, 28.0]

TEST Student: Epoch: 38, iteration: 174

TEST AUROC: 0.924123, TEST Accus: 0.723817, TEST Senss: 0.861183, TEST Specs: 0.843845
AUROCs: Melanoma:0.872569 Melanocytic nevus:0.939341 Basal cell carcinoma:0.976526 Actinic keratosis:0.961764 Benign keratosis:0.904277 Dermatofibroma:0.815992 Vascular lesion:0.998390
Accus: Melanoma:0.770563 Melanocytic nevus:0.790215 Basal cell carcinoma:0.818182 Actinic keratosis:0.758621 Benign keratosis:0.616822 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.956710 Melanocytic nevus:0.965159 Basal cell carcinoma:0.900000 Actinic keratosis:0.879310 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.580157 Melanocytic nevus:0.716216 Basal cell carcinoma:0.921785 Actinic keratosis:0.911088 Benign keratosis:0.886730 Dermatofibroma:0.931259 Vascular lesion:0.959677
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_39.pth

Epoch: 39, iteration: 0/175, ==> train <===, loss: 3.532178, classification loss: 1.802987,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142958,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019882,wcp loss: 0.000000,entropy loss: 1.852267,consistency weight: 1.000000, lr: 1.6423203268260674e-06

Epoch: 39, iteration: 100/175, ==> train <===, loss: 3.534721, classification loss: 1.805088,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146461,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024464,wcp loss: 0.000000,entropy loss: 1.851629,consistency weight: 1.000000, lr: 1.6423203268260674e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [78.0, 498.0, 43.0, 25.0, 63.0, 8.0, 11.0]

VAL Student: Epoch: 39, iteration: 174

VAL AUROC: 0.898321, VAL Accus: 0.689114, VAL Senss: 0.782658, VAL Specs: 0.886541
AUROCs: Melanoma:0.862952 Melanocytic nevus:0.936817 Basal cell carcinoma:0.974845 Actinic keratosis:0.962677 Benign keratosis:0.892733 Dermatofibroma:0.771659 Vascular lesion:0.886565
Accus: Melanoma:0.655462 Melanocytic nevus:0.751131 Basal cell carcinoma:0.796296 Actinic keratosis:0.757576 Benign keratosis:0.630000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.923077 Basal cell carcinoma:0.833333 Actinic keratosis:0.818182 Benign keratosis:0.760000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.702611 Melanocytic nevus:0.816024 Basal cell carcinoma:0.954545 Actinic keratosis:0.956567 Benign keratosis:0.887778 Dermatofibroma:0.935976 Vascular lesion:0.952284
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [170.0, 1025.0, 89.0, 32.0, 156.0, 10.0, 29.0]

TEST Student: Epoch: 39, iteration: 174

TEST AUROC: 0.922407, TEST Accus: 0.710796, TEST Senss: 0.889766, TEST Specs: 0.844529
AUROCs: Melanoma:0.874516 Melanocytic nevus:0.936443 Basal cell carcinoma:0.970713 Actinic keratosis:0.945880 Benign keratosis:0.913947 Dermatofibroma:0.818490 Vascular lesion:0.996862
Accus: Melanoma:0.735931 Melanocytic nevus:0.759822 Basal cell carcinoma:0.809091 Actinic keratosis:0.551724 Benign keratosis:0.728972 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.950334 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.873832 Dermatofibroma:0.681818 Vascular lesion:0.967742
Specs: Melanoma:0.616592 Melanocytic nevus:0.755255 Basal cell carcinoma:0.918635 Actinic keratosis:0.947879 Benign keratosis:0.819545 Dermatofibroma:0.897140 Vascular lesion:0.956653
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_40.pth

Epoch: 40, iteration: 0/175, ==> train <===, loss: 3.540714, classification loss: 1.807793,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150020,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028032,wcp loss: 0.000000,entropy loss: 1.854909,consistency weight: 1.000000, lr: 1.4780882941434607e-06

Epoch: 40, iteration: 100/175, ==> train <===, loss: 3.535266, classification loss: 1.804059,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145650,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024495,wcp loss: 0.000000,entropy loss: 1.852363,consistency weight: 1.000000, lr: 1.4780882941434607e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 496.0, 47.0, 24.0, 58.0, 7.0, 11.0]

VAL Student: Epoch: 40, iteration: 174

VAL AUROC: 0.897682, VAL Accus: 0.680065, VAL Senss: 0.795397, VAL Specs: 0.886814
AUROCs: Melanoma:0.846794 Melanocytic nevus:0.934879 Basal cell carcinoma:0.980620 Actinic keratosis:0.963148 Benign keratosis:0.880333 Dermatofibroma:0.795160 Vascular lesion:0.882843
Accus: Melanoma:0.663866 Melanocytic nevus:0.748115 Basal cell carcinoma:0.870370 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.914027 Basal cell carcinoma:0.944444 Actinic keratosis:0.848485 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.701476 Melanocytic nevus:0.818991 Basal cell carcinoma:0.922833 Actinic keratosis:0.948294 Benign keratosis:0.916667 Dermatofibroma:0.946138 Vascular lesion:0.953299
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [165.0, 1021.0, 96.0, 30.0, 137.0, 9.0, 29.0]

TEST Student: Epoch: 40, iteration: 174

TEST AUROC: 0.915627, TEST Accus: 0.692268, TEST Senss: 0.892551, TEST Specs: 0.842487
AUROCs: Melanoma:0.864019 Melanocytic nevus:0.935192 Basal cell carcinoma:0.970871 Actinic keratosis:0.939492 Benign keratosis:0.909155 Dermatofibroma:0.792775 Vascular lesion:0.997886
Accus: Melanoma:0.714286 Melanocytic nevus:0.756857 Basal cell carcinoma:0.872727 Actinic keratosis:0.517241 Benign keratosis:0.640187 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.943723 Melanocytic nevus:0.942921 Basal cell carcinoma:0.963636 Actinic keratosis:0.879310 Benign keratosis:0.836449 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.613229 Melanocytic nevus:0.744745 Basal cell carcinoma:0.871391 Actinic keratosis:0.938682 Benign keratosis:0.859522 Dermatofibroma:0.915203 Vascular lesion:0.954637
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_41.pth

Epoch: 41, iteration: 0/175, ==> train <===, loss: 3.530649, classification loss: 1.796982,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146675,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026245,wcp loss: 0.000000,entropy loss: 1.854098,consistency weight: 1.000000, lr: 1.3302794647291146e-06

Epoch: 41, iteration: 100/175, ==> train <===, loss: 3.532262, classification loss: 1.803162,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145871,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023043,wcp loss: 0.000000,entropy loss: 1.851928,consistency weight: 1.000000, lr: 1.3302794647291146e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 529.0, 46.0, 23.0, 58.0, 8.0, 11.0]

VAL Student: Epoch: 41, iteration: 174

VAL AUROC: 0.889252, VAL Accus: 0.680726, VAL Senss: 0.781102, VAL Specs: 0.882726
AUROCs: Melanoma:0.852545 Melanocytic nevus:0.936781 Basal cell carcinoma:0.982832 Actinic keratosis:0.927893 Benign keratosis:0.871733 Dermatofibroma:0.780488 Vascular lesion:0.872487
Accus: Melanoma:0.605042 Melanocytic nevus:0.797888 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.948718 Basal cell carcinoma:0.907407 Actinic keratosis:0.757576 Benign keratosis:0.710000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.701476 Melanocytic nevus:0.759644 Basal cell carcinoma:0.942918 Actinic keratosis:0.964840 Benign keratosis:0.918889 Dermatofibroma:0.944106 Vascular lesion:0.947208
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [160.0, 1093.0, 94.0, 30.0, 144.0, 10.0, 29.0]

TEST Student: Epoch: 41, iteration: 174

TEST AUROC: 0.920742, TEST Accus: 0.705369, TEST Senss: 0.879325, TEST Specs: 0.838138
AUROCs: Melanoma:0.874768 Melanocytic nevus:0.927219 Basal cell carcinoma:0.974627 Actinic keratosis:0.944664 Benign keratosis:0.913924 Dermatofibroma:0.812286 Vascular lesion:0.997707
Accus: Melanoma:0.692641 Melanocytic nevus:0.810230 Basal cell carcinoma:0.854545 Actinic keratosis:0.517241 Benign keratosis:0.672897 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.967383 Basal cell carcinoma:0.936364 Actinic keratosis:0.775862 Benign keratosis:0.845794 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.616031 Melanocytic nevus:0.674174 Basal cell carcinoma:0.903412 Actinic keratosis:0.959121 Benign keratosis:0.864520 Dermatofibroma:0.908680 Vascular lesion:0.941028
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_42.pth

Epoch: 42, iteration: 0/175, ==> train <===, loss: 3.522933, classification loss: 1.794269,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150642,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030389,wcp loss: 0.000000,entropy loss: 1.848916,consistency weight: 1.000000, lr: 1.1972515182562032e-06

Epoch: 42, iteration: 100/175, ==> train <===, loss: 3.537782, classification loss: 1.810026,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147652,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024627,wcp loss: 0.000000,entropy loss: 1.850781,consistency weight: 1.000000, lr: 1.1972515182562032e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [85.0, 483.0, 45.0, 24.0, 58.0, 8.0, 11.0]

VAL Student: Epoch: 42, iteration: 174

VAL AUROC: 0.891215, VAL Accus: 0.688105, VAL Senss: 0.773392, VAL Specs: 0.890255
AUROCs: Melanoma:0.860004 Melanocytic nevus:0.933823 Basal cell carcinoma:0.971615 Actinic keratosis:0.962521 Benign keratosis:0.870156 Dermatofibroma:0.760925 Vascular lesion:0.879459
Accus: Melanoma:0.714286 Melanocytic nevus:0.728507 Basal cell carcinoma:0.833333 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.857143 Melanocytic nevus:0.912519 Basal cell carcinoma:0.870370 Actinic keratosis:0.787879 Benign keratosis:0.690000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.667423 Melanocytic nevus:0.824926 Basal cell carcinoma:0.946089 Actinic keratosis:0.955533 Benign keratosis:0.921111 Dermatofibroma:0.951220 Vascular lesion:0.965482
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [187.0, 999.0, 92.0, 28.0, 138.0, 9.0, 28.0]

TEST Student: Epoch: 42, iteration: 174

TEST AUROC: 0.920582, TEST Accus: 0.689482, TEST Senss: 0.875613, TEST Specs: 0.850390
AUROCs: Melanoma:0.868520 Melanocytic nevus:0.940317 Basal cell carcinoma:0.972756 Actinic keratosis:0.941140 Benign keratosis:0.909340 Dermatofibroma:0.815901 Vascular lesion:0.996098
Accus: Melanoma:0.809524 Melanocytic nevus:0.740549 Basal cell carcinoma:0.836364 Actinic keratosis:0.482759 Benign keratosis:0.644860 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.961039 Melanocytic nevus:0.937732 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.841121 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.576233 Melanocytic nevus:0.764264 Basal cell carcinoma:0.906562 Actinic keratosis:0.943281 Benign keratosis:0.868406 Dermatofibroma:0.926744 Vascular lesion:0.967238
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_43.pth

Epoch: 43, iteration: 0/175, ==> train <===, loss: 3.513015, classification loss: 1.788424,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147731,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022113,wcp loss: 0.000000,entropy loss: 1.850208,consistency weight: 1.000000, lr: 1.0775263664305828e-06

Epoch: 43, iteration: 100/175, ==> train <===, loss: 3.546274, classification loss: 1.814028,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146313,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026017,wcp loss: 0.000000,entropy loss: 1.852542,consistency weight: 1.000000, lr: 1.0775263664305828e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 531.0, 39.0, 26.0, 65.0, 8.0, 11.0]

VAL Student: Epoch: 43, iteration: 174

VAL AUROC: 0.895020, VAL Accus: 0.684425, VAL Senss: 0.772980, VAL Specs: 0.887955
AUROCs: Melanoma:0.859117 Melanocytic nevus:0.942354 Basal cell carcinoma:0.953762 Actinic keratosis:0.958259 Benign keratosis:0.883600 Dermatofibroma:0.771468 Vascular lesion:0.896582
Accus: Melanoma:0.596639 Melanocytic nevus:0.800905 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.650000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.781513 Melanocytic nevus:0.936652 Basal cell carcinoma:0.814815 Actinic keratosis:0.787879 Benign keratosis:0.790000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.712826 Melanocytic nevus:0.780415 Basal cell carcinoma:0.965116 Actinic keratosis:0.950362 Benign keratosis:0.881111 Dermatofibroma:0.963415 Vascular lesion:0.962437
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [167.0, 1093.0, 85.0, 35.0, 156.0, 9.0, 28.0]

TEST Student: Epoch: 43, iteration: 174

TEST AUROC: 0.927054, TEST Accus: 0.707234, TEST Senss: 0.877953, TEST Specs: 0.847431
AUROCs: Melanoma:0.880193 Melanocytic nevus:0.940164 Basal cell carcinoma:0.978110 Actinic keratosis:0.950769 Benign keratosis:0.915013 Dermatofibroma:0.827373 Vascular lesion:0.997756
Accus: Melanoma:0.722944 Melanocytic nevus:0.810230 Basal cell carcinoma:0.772727 Actinic keratosis:0.603448 Benign keratosis:0.728972 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.943723 Melanocytic nevus:0.962194 Basal cell carcinoma:0.909091 Actinic keratosis:0.862069 Benign keratosis:0.864486 Dermatofibroma:0.636364 Vascular lesion:0.967742
Specs: Melanoma:0.620516 Melanocytic nevus:0.719219 Basal cell carcinoma:0.938058 Actinic keratosis:0.944303 Benign keratosis:0.813437 Dermatofibroma:0.930256 Vascular lesion:0.966230
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_44.pth

Epoch: 44, iteration: 0/175, ==> train <===, loss: 3.512539, classification loss: 1.784033,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145969,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023744,wcp loss: 0.000000,entropy loss: 1.850731,consistency weight: 1.000000, lr: 9.697737297875246e-07

Epoch: 44, iteration: 100/175, ==> train <===, loss: 3.538331, classification loss: 1.809317,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145964,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022971,wcp loss: 0.000000,entropy loss: 1.852007,consistency weight: 1.000000, lr: 9.697737297875246e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [83.0, 472.0, 39.0, 24.0, 64.0, 8.0, 12.0]

VAL Student: Epoch: 44, iteration: 174

VAL AUROC: 0.898878, VAL Accus: 0.685556, VAL Senss: 0.791436, VAL Specs: 0.890337
AUROCs: Melanoma:0.856847 Melanocytic nevus:0.931912 Basal cell carcinoma:0.964881 Actinic keratosis:0.958666 Benign keratosis:0.899522 Dermatofibroma:0.771214 Vascular lesion:0.909103
Accus: Melanoma:0.697479 Melanocytic nevus:0.711916 Basal cell carcinoma:0.722222 Actinic keratosis:0.727273 Benign keratosis:0.640000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.781513 Melanocytic nevus:0.886878 Basal cell carcinoma:0.870370 Actinic keratosis:0.878788 Benign keratosis:0.760000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.699205 Melanocytic nevus:0.845697 Basal cell carcinoma:0.958774 Actinic keratosis:0.938987 Benign keratosis:0.881111 Dermatofibroma:0.956301 Vascular lesion:0.952284
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [174.0, 983.0, 89.0, 35.0, 155.0, 9.0, 30.0]

TEST Student: Epoch: 44, iteration: 174

TEST AUROC: 0.918109, TEST Accus: 0.713658, TEST Senss: 0.875980, TEST Specs: 0.847803
AUROCs: Melanoma:0.863792 Melanocytic nevus:0.941319 Basal cell carcinoma:0.971439 Actinic keratosis:0.938576 Benign keratosis:0.911116 Dermatofibroma:0.802262 Vascular lesion:0.998260
Accus: Melanoma:0.753247 Melanocytic nevus:0.728688 Basal cell carcinoma:0.809091 Actinic keratosis:0.603448 Benign keratosis:0.724299 Dermatofibroma:0.409091 Vascular lesion:0.967742
Senss: Melanoma:0.943723 Melanocytic nevus:0.930319 Basal cell carcinoma:0.909091 Actinic keratosis:0.879310 Benign keratosis:0.878505 Dermatofibroma:0.590909 Vascular lesion:1.000000
Specs: Melanoma:0.619955 Melanocytic nevus:0.786787 Basal cell carcinoma:0.920735 Actinic keratosis:0.930506 Benign keratosis:0.807329 Dermatofibroma:0.921224 Vascular lesion:0.948085
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_45.pth

Epoch: 45, iteration: 0/175, ==> train <===, loss: 3.530399, classification loss: 1.797015,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.140810,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023342,wcp loss: 0.000000,entropy loss: 1.850852,consistency weight: 1.000000, lr: 8.727963568087721e-07

Epoch: 45, iteration: 100/175, ==> train <===, loss: 3.555185, classification loss: 1.824612,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145703,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024904,wcp loss: 0.000000,entropy loss: 1.851372,consistency weight: 1.000000, lr: 8.727963568087721e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [77.0, 527.0, 35.0, 24.0, 57.0, 9.0, 10.0]

VAL Student: Epoch: 45, iteration: 174

VAL AUROC: 0.883714, VAL Accus: 0.659503, VAL Senss: 0.764803, VAL Specs: 0.882719
AUROCs: Melanoma:0.881800 Melanocytic nevus:0.939811 Basal cell carcinoma:0.933267 Actinic keratosis:0.913541 Benign keratosis:0.875256 Dermatofibroma:0.761306 Vascular lesion:0.881015
Accus: Melanoma:0.647059 Melanocytic nevus:0.794872 Basal cell carcinoma:0.648148 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Senss: Melanoma:0.890756 Melanocytic nevus:0.956259 Basal cell carcinoma:0.759259 Actinic keratosis:0.818182 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.677639 Melanocytic nevus:0.765579 Basal cell carcinoma:0.976744 Actinic keratosis:0.962771 Benign keratosis:0.911111 Dermatofibroma:0.912602 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [182.0, 1071.0, 81.0, 30.0, 145.0, 11.0, 28.0]

TEST Student: Epoch: 45, iteration: 174

TEST AUROC: 0.931507, TEST Accus: 0.702314, TEST Senss: 0.872919, TEST Specs: 0.842260
AUROCs: Melanoma:0.902505 Melanocytic nevus:0.942115 Basal cell carcinoma:0.971009 Actinic keratosis:0.951201 Benign keratosis:0.921331 Dermatofibroma:0.835983 Vascular lesion:0.996407
Accus: Melanoma:0.787879 Melanocytic nevus:0.793921 Basal cell carcinoma:0.736364 Actinic keratosis:0.517241 Benign keratosis:0.677570 Dermatofibroma:0.500000 Vascular lesion:0.903226
Senss: Melanoma:0.974026 Melanocytic nevus:0.967383 Basal cell carcinoma:0.890909 Actinic keratosis:0.810345 Benign keratosis:0.850467 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.580157 Melanocytic nevus:0.674174 Basal cell carcinoma:0.962205 Actinic keratosis:0.960143 Benign keratosis:0.867296 Dermatofibroma:0.882087 Vascular lesion:0.969758
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_46.pth

Epoch: 46, iteration: 0/175, ==> train <===, loss: 3.540131, classification loss: 1.806084,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146530,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033295,wcp loss: 0.000000,entropy loss: 1.847282,consistency weight: 1.000000, lr: 7.855167211278949e-07

Epoch: 46, iteration: 100/175, ==> train <===, loss: 3.549237, classification loss: 1.816967,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144656,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025284,wcp loss: 0.000000,entropy loss: 1.851642,consistency weight: 1.000000, lr: 7.855167211278949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [80.0, 453.0, 43.0, 24.0, 60.0, 9.0, 11.0]

VAL Student: Epoch: 46, iteration: 174

VAL AUROC: 0.895343, VAL Accus: 0.682133, VAL Senss: 0.785358, VAL Specs: 0.884542
AUROCs: Melanoma:0.865489 Melanocytic nevus:0.928206 Basal cell carcinoma:0.974513 Actinic keratosis:0.950926 Benign keratosis:0.899311 Dermatofibroma:0.772675 Vascular lesion:0.876277
Accus: Melanoma:0.672269 Melanocytic nevus:0.683258 Basal cell carcinoma:0.796296 Actinic keratosis:0.727273 Benign keratosis:0.600000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.877828 Basal cell carcinoma:0.870370 Actinic keratosis:0.848485 Benign keratosis:0.740000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.725312 Melanocytic nevus:0.842730 Basal cell carcinoma:0.945032 Actinic keratosis:0.953464 Benign keratosis:0.900000 Dermatofibroma:0.879065 Vascular lesion:0.946193
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [174.0, 945.0, 94.0, 31.0, 153.0, 13.0, 29.0]

TEST Student: Epoch: 46, iteration: 174

TEST AUROC: 0.918004, TEST Accus: 0.726306, TEST Senss: 0.880964, TEST Specs: 0.844316
AUROCs: Melanoma:0.874675 Melanocytic nevus:0.939962 Basal cell carcinoma:0.966504 Actinic keratosis:0.944267 Benign keratosis:0.915120 Dermatofibroma:0.788168 Vascular lesion:0.997334
Accus: Melanoma:0.753247 Melanocytic nevus:0.700519 Basal cell carcinoma:0.854545 Actinic keratosis:0.534483 Benign keratosis:0.714953 Dermatofibroma:0.590909 Vascular lesion:0.935484
Senss: Melanoma:0.926407 Melanocytic nevus:0.926612 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.859813 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.643498 Melanocytic nevus:0.809309 Basal cell carcinoma:0.898163 Actinic keratosis:0.948390 Benign keratosis:0.822321 Dermatofibroma:0.839438 Vascular lesion:0.949093
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_47.pth

Epoch: 47, iteration: 0/175, ==> train <===, loss: 3.532896, classification loss: 1.813477,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150302,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021223,wcp loss: 0.000000,entropy loss: 1.848499,consistency weight: 1.000000, lr: 7.069650490151055e-07

Epoch: 47, iteration: 100/175, ==> train <===, loss: 3.536260, classification loss: 1.803514,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146072,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027762,wcp loss: 0.000000,entropy loss: 1.851057,consistency weight: 1.000000, lr: 7.069650490151055e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 559.0, 38.0, 25.0, 54.0, 8.0, 12.0]

VAL Student: Epoch: 47, iteration: 174

VAL AUROC: 0.890521, VAL Accus: 0.672492, VAL Senss: 0.771633, VAL Specs: 0.878057
AUROCs: Melanoma:0.867902 Melanocytic nevus:0.939751 Basal cell carcinoma:0.960790 Actinic keratosis:0.948858 Benign keratosis:0.861322 Dermatofibroma:0.755399 Vascular lesion:0.899628
Accus: Melanoma:0.563025 Melanocytic nevus:0.843137 Basal cell carcinoma:0.703704 Actinic keratosis:0.757576 Benign keratosis:0.540000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.831933 Melanocytic nevus:0.971342 Basal cell carcinoma:0.777778 Actinic keratosis:0.787879 Benign keratosis:0.670000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.701476 Melanocytic nevus:0.700297 Basal cell carcinoma:0.970402 Actinic keratosis:0.960703 Benign keratosis:0.922222 Dermatofibroma:0.929878 Vascular lesion:0.961421
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [165.0, 1156.0, 81.0, 30.0, 138.0, 11.0, 29.0]

TEST Student: Epoch: 47, iteration: 174

TEST AUROC: 0.932758, TEST Accus: 0.700738, TEST Senss: 0.887418, TEST Specs: 0.834061
AUROCs: Melanoma:0.897223 Melanocytic nevus:0.932183 Basal cell carcinoma:0.974545 Actinic keratosis:0.955738 Benign keratosis:0.921926 Dermatofibroma:0.848698 Vascular lesion:0.998992
Accus: Melanoma:0.714286 Melanocytic nevus:0.856931 Basal cell carcinoma:0.736364 Actinic keratosis:0.517241 Benign keratosis:0.644860 Dermatofibroma:0.500000 Vascular lesion:0.935484
Senss: Melanoma:0.961039 Melanocytic nevus:0.977761 Basal cell carcinoma:0.881818 Actinic keratosis:0.827586 Benign keratosis:0.836449 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.600897 Melanocytic nevus:0.584084 Basal cell carcinoma:0.947507 Actinic keratosis:0.961165 Benign keratosis:0.878401 Dermatofibroma:0.901154 Vascular lesion:0.965222
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_48.pth

Epoch: 48, iteration: 0/175, ==> train <===, loss: 3.526980, classification loss: 1.799596,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.149984,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026542,wcp loss: 0.000000,entropy loss: 1.850826,consistency weight: 1.000000, lr: 6.362685441135949e-07

Epoch: 48, iteration: 100/175, ==> train <===, loss: 3.537203, classification loss: 1.805873,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145402,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024850,wcp loss: 0.000000,entropy loss: 1.851882,consistency weight: 1.000000, lr: 6.362685441135949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [82.0, 462.0, 44.0, 24.0, 59.0, 9.0, 11.0]

VAL Student: Epoch: 48, iteration: 174

VAL AUROC: 0.896660, VAL Accus: 0.687690, VAL Senss: 0.811666, VAL Specs: 0.883987
AUROCs: Melanoma:0.863515 Melanocytic nevus:0.930641 Basal cell carcinoma:0.972672 Actinic keratosis:0.952869 Benign keratosis:0.889344 Dermatofibroma:0.779662 Vascular lesion:0.887919
Accus: Melanoma:0.689076 Melanocytic nevus:0.696833 Basal cell carcinoma:0.814815 Actinic keratosis:0.727273 Benign keratosis:0.590000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.806723 Melanocytic nevus:0.901961 Basal cell carcinoma:0.888889 Actinic keratosis:0.909091 Benign keratosis:0.750000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.703746 Melanocytic nevus:0.833828 Basal cell carcinoma:0.939746 Actinic keratosis:0.942089 Benign keratosis:0.906667 Dermatofibroma:0.905488 Vascular lesion:0.956345
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 974.0, 97.0, 34.0, 146.0, 10.0, 28.0]

TEST Student: Epoch: 48, iteration: 174

TEST AUROC: 0.918540, TEST Accus: 0.710663, TEST Senss: 0.892863, TEST Specs: 0.840097
AUROCs: Melanoma:0.868415 Melanocytic nevus:0.932945 Basal cell carcinoma:0.967946 Actinic keratosis:0.941756 Benign keratosis:0.910307 Dermatofibroma:0.810701 Vascular lesion:0.997707
Accus: Melanoma:0.744589 Melanocytic nevus:0.722016 Basal cell carcinoma:0.881818 Actinic keratosis:0.586207 Benign keratosis:0.682243 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.952381 Melanocytic nevus:0.936249 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.859813 Dermatofibroma:0.727273 Vascular lesion:0.967742
Specs: Melanoma:0.615471 Melanocytic nevus:0.768769 Basal cell carcinoma:0.886614 Actinic keratosis:0.936127 Benign keratosis:0.838423 Dermatofibroma:0.868038 Vascular lesion:0.967238
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_49.pth

Epoch: 49, iteration: 0/175, ==> train <===, loss: 3.510881, classification loss: 1.787440,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.149835,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021837,wcp loss: 0.000000,entropy loss: 1.851439,consistency weight: 1.000000, lr: 5.726416897022355e-07

Epoch: 49, iteration: 100/175, ==> train <===, loss: 3.540735, classification loss: 1.811230,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145539,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024014,wcp loss: 0.000000,entropy loss: 1.851031,consistency weight: 1.000000, lr: 5.726416897022355e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [75.0, 509.0, 42.0, 25.0, 59.0, 9.0, 11.0]

VAL Student: Epoch: 49, iteration: 174

VAL AUROC: 0.895578, VAL Accus: 0.688452, VAL Senss: 0.797149, VAL Specs: 0.885863
AUROCs: Melanoma:0.865937 Melanocytic nevus:0.938017 Basal cell carcinoma:0.974513 Actinic keratosis:0.954310 Benign keratosis:0.883333 Dermatofibroma:0.768674 Vascular lesion:0.884264
Accus: Melanoma:0.630252 Melanocytic nevus:0.767722 Basal cell carcinoma:0.777778 Actinic keratosis:0.757576 Benign keratosis:0.590000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.831933 Melanocytic nevus:0.930618 Basal cell carcinoma:0.870370 Actinic keratosis:0.878788 Benign keratosis:0.710000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.700341 Melanocytic nevus:0.804154 Basal cell carcinoma:0.957717 Actinic keratosis:0.945191 Benign keratosis:0.915556 Dermatofibroma:0.911585 Vascular lesion:0.966497
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [173.0, 1038.0, 92.0, 33.0, 145.0, 10.0, 28.0]

TEST Student: Epoch: 49, iteration: 174

TEST AUROC: 0.924448, TEST Accus: 0.708435, TEST Senss: 0.882960, TEST Specs: 0.844458
AUROCs: Melanoma:0.875709 Melanocytic nevus:0.940002 Basal cell carcinoma:0.972699 Actinic keratosis:0.946250 Benign keratosis:0.918615 Dermatofibroma:0.819961 Vascular lesion:0.997903
Accus: Melanoma:0.748918 Melanocytic nevus:0.769459 Basal cell carcinoma:0.836364 Actinic keratosis:0.568966 Benign keratosis:0.677570 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.943723 Melanocytic nevus:0.955523 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.859813 Dermatofibroma:0.681818 Vascular lesion:0.967742
Specs: Melanoma:0.611547 Melanocytic nevus:0.729730 Basal cell carcinoma:0.923360 Actinic keratosis:0.941237 Benign keratosis:0.858967 Dermatofibroma:0.868540 Vascular lesion:0.977823
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_50.pth

Epoch: 50, iteration: 0/175, ==> train <===, loss: 3.584168, classification loss: 1.852145,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147294,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028867,wcp loss: 0.000000,entropy loss: 1.850451,consistency weight: 1.000000, lr: 5.15377520732012e-07

Epoch: 50, iteration: 100/175, ==> train <===, loss: 3.535057, classification loss: 1.805946,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146393,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024326,wcp loss: 0.000000,entropy loss: 1.851178,consistency weight: 1.000000, lr: 5.15377520732012e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [82.0, 474.0, 45.0, 26.0, 61.0, 9.0, 11.0]

VAL Student: Epoch: 50, iteration: 174

VAL AUROC: 0.893145, VAL Accus: 0.704436, VAL Senss: 0.799613, VAL Specs: 0.892021
AUROCs: Melanoma:0.857114 Melanocytic nevus:0.928998 Basal cell carcinoma:0.971889 Actinic keratosis:0.963618 Benign keratosis:0.894622 Dermatofibroma:0.746570 Vascular lesion:0.889205
Accus: Melanoma:0.689076 Melanocytic nevus:0.714932 Basal cell carcinoma:0.833333 Actinic keratosis:0.787879 Benign keratosis:0.610000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.823529 Melanocytic nevus:0.892911 Basal cell carcinoma:0.925926 Actinic keratosis:0.909091 Benign keratosis:0.750000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.710556 Melanocytic nevus:0.851632 Basal cell carcinoma:0.936575 Actinic keratosis:0.935884 Benign keratosis:0.898889 Dermatofibroma:0.948171 Vascular lesion:0.962437
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 993.0, 98.0, 34.0, 147.0, 9.0, 28.0]

TEST Student: Epoch: 50, iteration: 174

TEST AUROC: 0.915289, TEST Accus: 0.708148, TEST Senss: 0.856720, TEST Specs: 0.847637
AUROCs: Melanoma:0.876693 Melanocytic nevus:0.937842 Basal cell carcinoma:0.971988 Actinic keratosis:0.938558 Benign keratosis:0.907898 Dermatofibroma:0.778258 Vascular lesion:0.995789
Accus: Melanoma:0.744589 Melanocytic nevus:0.736101 Basal cell carcinoma:0.890909 Actinic keratosis:0.586207 Benign keratosis:0.686916 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.943723 Melanocytic nevus:0.928836 Basal cell carcinoma:0.954545 Actinic keratosis:0.879310 Benign keratosis:0.855140 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.624439 Melanocytic nevus:0.789790 Basal cell carcinoma:0.886089 Actinic keratosis:0.922330 Benign keratosis:0.827873 Dermatofibroma:0.917210 Vascular lesion:0.965726
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_51.pth

Epoch: 51, iteration: 0/175, ==> train <===, loss: 3.528343, classification loss: 1.804385,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148867,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020502,wcp loss: 0.000000,entropy loss: 1.852323,consistency weight: 1.000000, lr: 4.638397686588108e-07

Epoch: 51, iteration: 100/175, ==> train <===, loss: 3.537894, classification loss: 1.807703,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147630,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026373,wcp loss: 0.000000,entropy loss: 1.851448,consistency weight: 1.000000, lr: 4.638397686588108e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 537.0, 46.0, 23.0, 54.0, 8.0, 11.0]

VAL Student: Epoch: 51, iteration: 174

VAL AUROC: 0.893255, VAL Accus: 0.681538, VAL Senss: 0.787945, VAL Specs: 0.890958
AUROCs: Melanoma:0.867979 Melanocytic nevus:0.943799 Basal cell carcinoma:0.981051 Actinic keratosis:0.958102 Benign keratosis:0.873933 Dermatofibroma:0.766260 Vascular lesion:0.861658
Accus: Melanoma:0.638655 Melanocytic nevus:0.809955 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.540000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.823529 Melanocytic nevus:0.938160 Basal cell carcinoma:0.907407 Actinic keratosis:0.818182 Benign keratosis:0.670000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.696935 Melanocytic nevus:0.783383 Basal cell carcinoma:0.936575 Actinic keratosis:0.967942 Benign keratosis:0.931111 Dermatofibroma:0.948171 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [175.0, 1089.0, 96.0, 28.0, 135.0, 9.0, 28.0]

TEST Student: Epoch: 51, iteration: 174

TEST AUROC: 0.926129, TEST Accus: 0.694783, TEST Senss: 0.877036, TEST Specs: 0.851533
AUROCs: Melanoma:0.882737 Melanocytic nevus:0.942896 Basal cell carcinoma:0.975447 Actinic keratosis:0.946426 Benign keratosis:0.921196 Dermatofibroma:0.817532 Vascular lesion:0.996667
Accus: Melanoma:0.757576 Melanocytic nevus:0.807265 Basal cell carcinoma:0.872727 Actinic keratosis:0.482759 Benign keratosis:0.630841 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.956710 Melanocytic nevus:0.959229 Basal cell carcinoma:0.954545 Actinic keratosis:0.810345 Benign keratosis:0.841121 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.610987 Melanocytic nevus:0.713213 Basal cell carcinoma:0.893963 Actinic keratosis:0.961676 Benign keratosis:0.882843 Dermatofibroma:0.918214 Vascular lesion:0.979839
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_52.pth

Epoch: 52, iteration: 0/175, ==> train <===, loss: 3.520039, classification loss: 1.792224,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147015,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022151,wcp loss: 0.000000,entropy loss: 1.852679,consistency weight: 1.000000, lr: 4.1745579179292974e-07

Epoch: 52, iteration: 100/175, ==> train <===, loss: 3.547954, classification loss: 1.816126,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146871,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026536,wcp loss: 0.000000,entropy loss: 1.852162,consistency weight: 1.000000, lr: 4.1745579179292974e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 543.0, 43.0, 25.0, 56.0, 9.0, 10.0]

VAL Student: Epoch: 52, iteration: 174

VAL AUROC: 0.892353, VAL Accus: 0.676210, VAL Senss: 0.768011, VAL Specs: 0.875099
AUROCs: Melanoma:0.865632 Melanocytic nevus:0.936526 Basal cell carcinoma:0.977253 Actinic keratosis:0.962458 Benign keratosis:0.872611 Dermatofibroma:0.750572 Vascular lesion:0.881421
Accus: Melanoma:0.571429 Melanocytic nevus:0.819005 Basal cell carcinoma:0.796296 Actinic keratosis:0.757576 Benign keratosis:0.560000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Senss: Melanoma:0.840336 Melanocytic nevus:0.968326 Basal cell carcinoma:0.870370 Actinic keratosis:0.787879 Benign keratosis:0.680000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.711691 Melanocytic nevus:0.712166 Basal cell carcinoma:0.956660 Actinic keratosis:0.953464 Benign keratosis:0.928889 Dermatofibroma:0.880081 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [159.0, 1117.0, 92.0, 33.0, 140.0, 11.0, 27.0]

TEST Student: Epoch: 52, iteration: 174

TEST AUROC: 0.929738, TEST Accus: 0.706691, TEST Senss: 0.889737, TEST Specs: 0.834310
AUROCs: Melanoma:0.887706 Melanocytic nevus:0.935216 Basal cell carcinoma:0.973505 Actinic keratosis:0.961747 Benign keratosis:0.921743 Dermatofibroma:0.829825 Vascular lesion:0.998423
Accus: Melanoma:0.688312 Melanocytic nevus:0.828021 Basal cell carcinoma:0.836364 Actinic keratosis:0.568966 Benign keratosis:0.654206 Dermatofibroma:0.500000 Vascular lesion:0.870968
Senss: Melanoma:0.943723 Melanocytic nevus:0.977020 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.827103 Dermatofibroma:0.772727 Vascular lesion:0.935484
Specs: Melanoma:0.624439 Melanocytic nevus:0.620120 Basal cell carcinoma:0.925984 Actinic keratosis:0.950945 Benign keratosis:0.877290 Dermatofibroma:0.852985 Vascular lesion:0.988407
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_53.pth

Epoch: 53, iteration: 0/175, ==> train <===, loss: 3.550824, classification loss: 1.818921,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148570,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029248,wcp loss: 0.000000,entropy loss: 1.851225,consistency weight: 1.000000, lr: 3.7571021261363677e-07

Epoch: 53, iteration: 100/175, ==> train <===, loss: 3.536612, classification loss: 1.806534,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145898,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025092,wcp loss: 0.000000,entropy loss: 1.850883,consistency weight: 1.000000, lr: 3.7571021261363677e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 533.0, 46.0, 25.0, 63.0, 7.0, 11.0]

VAL Student: Epoch: 53, iteration: 174

VAL AUROC: 0.894308, VAL Accus: 0.680057, VAL Senss: 0.787552, VAL Specs: 0.890262
AUROCs: Melanoma:0.843799 Melanocytic nevus:0.936446 Basal cell carcinoma:0.979798 Actinic keratosis:0.960578 Benign keratosis:0.886056 Dermatofibroma:0.784108 Vascular lesion:0.869374
Accus: Melanoma:0.546218 Melanocytic nevus:0.803922 Basal cell carcinoma:0.851852 Actinic keratosis:0.757576 Benign keratosis:0.630000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Senss: Melanoma:0.764706 Melanocytic nevus:0.923077 Basal cell carcinoma:0.962963 Actinic keratosis:0.878788 Benign keratosis:0.750000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Specs: Melanoma:0.760499 Melanocytic nevus:0.798220 Basal cell carcinoma:0.919662 Actinic keratosis:0.954498 Benign keratosis:0.894444 Dermatofibroma:0.946138 Vascular lesion:0.958376
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1092.0, 98.0, 32.0, 154.0, 9.0, 28.0]

TEST Student: Epoch: 53, iteration: 174

TEST AUROC: 0.917194, TEST Accus: 0.697352, TEST Senss: 0.882487, TEST Specs: 0.839158
AUROCs: Melanoma:0.876293 Melanocytic nevus:0.933690 Basal cell carcinoma:0.973763 Actinic keratosis:0.945862 Benign keratosis:0.910569 Dermatofibroma:0.784085 Vascular lesion:0.996098
Accus: Melanoma:0.597403 Melanocytic nevus:0.809489 Basal cell carcinoma:0.890909 Actinic keratosis:0.551724 Benign keratosis:0.719626 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.904762 Melanocytic nevus:0.957005 Basal cell carcinoma:0.954545 Actinic keratosis:0.879310 Benign keratosis:0.864486 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.670404 Melanocytic nevus:0.720721 Basal cell carcinoma:0.855643 Actinic keratosis:0.941237 Benign keratosis:0.811216 Dermatofibroma:0.914701 Vascular lesion:0.960181
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_54.pth

Epoch: 54, iteration: 0/175, ==> train <===, loss: 3.528944, classification loss: 1.795323,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.151797,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033702,wcp loss: 0.000000,entropy loss: 1.851715,consistency weight: 1.000000, lr: 3.3813919135227313e-07

Epoch: 54, iteration: 100/175, ==> train <===, loss: 3.551666, classification loss: 1.818647,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145104,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026374,wcp loss: 0.000000,entropy loss: 1.851749,consistency weight: 1.000000, lr: 3.3813919135227313e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [77.0, 520.0, 42.0, 29.0, 55.0, 9.0, 11.0]

VAL Student: Epoch: 54, iteration: 174

VAL AUROC: 0.896093, VAL Accus: 0.704825, VAL Senss: 0.805106, VAL Specs: 0.882163
AUROCs: Melanoma:0.849841 Melanocytic nevus:0.940254 Basal cell carcinoma:0.979152 Actinic keratosis:0.970700 Benign keratosis:0.868956 Dermatofibroma:0.770008 Vascular lesion:0.893739
Accus: Melanoma:0.647059 Melanocytic nevus:0.784314 Basal cell carcinoma:0.777778 Actinic keratosis:0.878788 Benign keratosis:0.550000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.941176 Basal cell carcinoma:0.851852 Actinic keratosis:0.939394 Benign keratosis:0.680000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.699205 Melanocytic nevus:0.780415 Basal cell carcinoma:0.956660 Actinic keratosis:0.928645 Benign keratosis:0.931111 Dermatofibroma:0.919715 Vascular lesion:0.959391
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [170.0, 1077.0, 91.0, 39.0, 134.0, 9.0, 28.0]

TEST Student: Epoch: 54, iteration: 174

TEST AUROC: 0.923019, TEST Accus: 0.710353, TEST Senss: 0.894287, TEST Specs: 0.840886
AUROCs: Melanoma:0.863329 Melanocytic nevus:0.936423 Basal cell carcinoma:0.971854 Actinic keratosis:0.955007 Benign keratosis:0.911181 Dermatofibroma:0.825206 Vascular lesion:0.998130
Accus: Melanoma:0.735931 Melanocytic nevus:0.798369 Basal cell carcinoma:0.827273 Actinic keratosis:0.672414 Benign keratosis:0.626168 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.943723 Melanocytic nevus:0.964418 Basal cell carcinoma:0.918182 Actinic keratosis:0.879310 Benign keratosis:0.827103 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.613229 Melanocytic nevus:0.698198 Basal cell carcinoma:0.923885 Actinic keratosis:0.921819 Benign keratosis:0.882288 Dermatofibroma:0.886101 Vascular lesion:0.960685
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_55.pth

Epoch: 55, iteration: 0/175, ==> train <===, loss: 3.547967, classification loss: 1.804093,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141510,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.035788,wcp loss: 0.000000,entropy loss: 1.849596,consistency weight: 1.000000, lr: 3.043252722170458e-07

Epoch: 55, iteration: 100/175, ==> train <===, loss: 3.541132, classification loss: 1.812274,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146890,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024683,wcp loss: 0.000000,entropy loss: 1.851067,consistency weight: 1.000000, lr: 3.043252722170458e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 522.0, 46.0, 24.0, 67.0, 8.0, 11.0]

VAL Student: Epoch: 55, iteration: 174

VAL AUROC: 0.890843, VAL Accus: 0.681999, VAL Senss: 0.777589, VAL Specs: 0.883691
AUROCs: Melanoma:0.845268 Melanocytic nevus:0.933138 Basal cell carcinoma:0.982441 Actinic keratosis:0.927266 Benign keratosis:0.897344 Dermatofibroma:0.781949 Vascular lesion:0.868494
Accus: Melanoma:0.504202 Melanocytic nevus:0.787330 Basal cell carcinoma:0.851852 Actinic keratosis:0.727273 Benign keratosis:0.670000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.764706 Melanocytic nevus:0.927602 Basal cell carcinoma:0.907407 Actinic keratosis:0.757576 Benign keratosis:0.790000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.757094 Melanocytic nevus:0.792285 Basal cell carcinoma:0.933404 Actinic keratosis:0.963806 Benign keratosis:0.873333 Dermatofibroma:0.925813 Vascular lesion:0.940102
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1092.0, 95.0, 29.0, 160.0, 10.0, 29.0]

TEST Student: Epoch: 55, iteration: 174

TEST AUROC: 0.918992, TEST Accus: 0.698701, TEST Senss: 0.879746, TEST Specs: 0.838081
AUROCs: Melanoma:0.875319 Melanocytic nevus:0.928657 Basal cell carcinoma:0.970651 Actinic keratosis:0.931466 Benign keratosis:0.913375 Dermatofibroma:0.817167 Vascular lesion:0.996309
Accus: Melanoma:0.580087 Melanocytic nevus:0.809489 Basal cell carcinoma:0.863636 Actinic keratosis:0.500000 Benign keratosis:0.747664 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.913420 Melanocytic nevus:0.958488 Basal cell carcinoma:0.945455 Actinic keratosis:0.775862 Benign keratosis:0.883178 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.665919 Melanocytic nevus:0.723724 Basal cell carcinoma:0.889764 Actinic keratosis:0.957077 Benign keratosis:0.798445 Dermatofibroma:0.892624 Vascular lesion:0.939012
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_56.pth

Epoch: 56, iteration: 0/175, ==> train <===, loss: 3.542930, classification loss: 1.824233,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147544,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.013016,wcp loss: 0.000000,entropy loss: 1.853225,consistency weight: 1.000000, lr: 2.7389274499534124e-07

Epoch: 56, iteration: 100/175, ==> train <===, loss: 3.531254, classification loss: 1.802594,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148470,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025912,wcp loss: 0.000000,entropy loss: 1.851218,consistency weight: 1.000000, lr: 2.7389274499534124e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [86.0, 484.0, 39.0, 20.0, 65.0, 6.0, 9.0]

VAL Student: Epoch: 56, iteration: 174

VAL AUROC: 0.872580, VAL Accus: 0.629427, VAL Senss: 0.744207, VAL Specs: 0.881636
AUROCs: Melanoma:0.853795 Melanocytic nevus:0.938728 Basal cell carcinoma:0.936262 Actinic keratosis:0.884867 Benign keratosis:0.891250 Dermatofibroma:0.732025 Vascular lesion:0.871134
Accus: Melanoma:0.722689 Melanocytic nevus:0.730015 Basal cell carcinoma:0.722222 Actinic keratosis:0.606061 Benign keratosis:0.650000 Dermatofibroma:0.375000 Vascular lesion:0.600000
Senss: Melanoma:0.865546 Melanocytic nevus:0.918552 Basal cell carcinoma:0.777778 Actinic keratosis:0.757576 Benign keratosis:0.790000 Dermatofibroma:0.500000 Vascular lesion:0.600000
Specs: Melanoma:0.616345 Melanocytic nevus:0.801187 Basal cell carcinoma:0.965116 Actinic keratosis:0.965874 Benign keratosis:0.877778 Dermatofibroma:0.973577 Vascular lesion:0.971574
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [191.0, 988.0, 83.0, 27.0, 155.0, 8.0, 26.0]

TEST Student: Epoch: 56, iteration: 174

TEST AUROC: 0.920891, TEST Accus: 0.672277, TEST Senss: 0.820917, TEST Specs: 0.842474
AUROCs: Melanoma:0.868617 Melanocytic nevus:0.942001 Basal cell carcinoma:0.976249 Actinic keratosis:0.953271 Benign keratosis:0.914191 Dermatofibroma:0.799161 Vascular lesion:0.992748
Accus: Melanoma:0.826840 Melanocytic nevus:0.732394 Basal cell carcinoma:0.754545 Actinic keratosis:0.465517 Benign keratosis:0.724299 Dermatofibroma:0.363636 Vascular lesion:0.838710
Senss: Melanoma:0.974026 Melanocytic nevus:0.951075 Basal cell carcinoma:0.881818 Actinic keratosis:0.689655 Benign keratosis:0.859813 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.489910 Melanocytic nevus:0.749249 Basal cell carcinoma:0.947507 Actinic keratosis:0.965253 Benign keratosis:0.821766 Dermatofibroma:0.945309 Vascular lesion:0.978327
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_57.pth

Epoch: 57, iteration: 0/175, ==> train <===, loss: 3.524166, classification loss: 1.795961,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143249,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018806,wcp loss: 0.000000,entropy loss: 1.852649,consistency weight: 1.000000, lr: 2.465034704958071e-07

Epoch: 57, iteration: 100/175, ==> train <===, loss: 3.535276, classification loss: 1.802413,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144273,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025936,wcp loss: 0.000000,entropy loss: 1.851199,consistency weight: 1.000000, lr: 2.465034704958071e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 506.0, 43.0, 24.0, 59.0, 8.0, 11.0]

VAL Student: Epoch: 57, iteration: 174

VAL AUROC: 0.893610, VAL Accus: 0.681995, VAL Senss: 0.777203, VAL Specs: 0.886559
AUROCs: Melanoma:0.864030 Melanocytic nevus:0.936531 Basal cell carcinoma:0.976509 Actinic keratosis:0.951396 Benign keratosis:0.891244 Dermatofibroma:0.762259 Vascular lesion:0.873299
Accus: Melanoma:0.663866 Melanocytic nevus:0.763198 Basal cell carcinoma:0.796296 Actinic keratosis:0.727273 Benign keratosis:0.590000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.789916 Melanocytic nevus:0.927602 Basal cell carcinoma:0.888889 Actinic keratosis:0.818182 Benign keratosis:0.720000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.702611 Melanocytic nevus:0.816024 Basal cell carcinoma:0.948203 Actinic keratosis:0.958635 Benign keratosis:0.915556 Dermatofibroma:0.914634 Vascular lesion:0.950254
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [171.0, 1032.0, 92.0, 30.0, 144.0, 9.0, 29.0]

TEST Student: Epoch: 57, iteration: 174

TEST AUROC: 0.922909, TEST Accus: 0.696621, TEST Senss: 0.895698, TEST Specs: 0.844363
AUROCs: Melanoma:0.875769 Melanocytic nevus:0.937257 Basal cell carcinoma:0.973491 Actinic keratosis:0.944796 Benign keratosis:0.915622 Dermatofibroma:0.815867 Vascular lesion:0.997561
Accus: Melanoma:0.740260 Melanocytic nevus:0.765011 Basal cell carcinoma:0.836364 Actinic keratosis:0.517241 Benign keratosis:0.672897 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.950334 Basal cell carcinoma:0.936364 Actinic keratosis:0.862069 Benign keratosis:0.845794 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.617152 Melanocytic nevus:0.737237 Basal cell carcinoma:0.906562 Actinic keratosis:0.952989 Benign keratosis:0.863409 Dermatofibroma:0.883091 Vascular lesion:0.950101
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_58.pth

Epoch: 58, iteration: 0/175, ==> train <===, loss: 3.536779, classification loss: 1.821227,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.152012,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017745,wcp loss: 0.000000,entropy loss: 1.849820,consistency weight: 1.000000, lr: 2.218531234462264e-07

Epoch: 58, iteration: 100/175, ==> train <===, loss: 3.544930, classification loss: 1.811864,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145700,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026792,wcp loss: 0.000000,entropy loss: 1.851974,consistency weight: 1.000000, lr: 2.218531234462264e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [77.0, 534.0, 43.0, 26.0, 53.0, 9.0, 10.0]

VAL Student: Epoch: 58, iteration: 174

VAL AUROC: 0.893119, VAL Accus: 0.685119, VAL Senss: 0.782082, VAL Specs: 0.884819
AUROCs: Melanoma:0.875027 Melanocytic nevus:0.939377 Basal cell carcinoma:0.972672 Actinic keratosis:0.957820 Benign keratosis:0.871422 Dermatofibroma:0.761941 Vascular lesion:0.873570
Accus: Melanoma:0.647059 Melanocytic nevus:0.805430 Basal cell carcinoma:0.796296 Actinic keratosis:0.787879 Benign keratosis:0.530000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Senss: Melanoma:0.848739 Melanocytic nevus:0.947210 Basal cell carcinoma:0.870370 Actinic keratosis:0.909091 Benign keratosis:0.670000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.691260 Melanocytic nevus:0.759644 Basal cell carcinoma:0.952431 Actinic keratosis:0.944157 Benign keratosis:0.936667 Dermatofibroma:0.929878 Vascular lesion:0.979695
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [170.0, 1084.0, 95.0, 36.0, 127.0, 10.0, 26.0]

TEST Student: Epoch: 58, iteration: 174

TEST AUROC: 0.931043, TEST Accus: 0.701504, TEST Senss: 0.891322, TEST Specs: 0.843348
AUROCs: Melanoma:0.891694 Melanocytic nevus:0.935730 Basal cell carcinoma:0.974245 Actinic keratosis:0.957077 Benign keratosis:0.918733 Dermatofibroma:0.843349 Vascular lesion:0.996472
Accus: Melanoma:0.735931 Melanocytic nevus:0.803558 Basal cell carcinoma:0.863636 Actinic keratosis:0.620690 Benign keratosis:0.593458 Dermatofibroma:0.454545 Vascular lesion:0.838710
Senss: Melanoma:0.965368 Melanocytic nevus:0.963677 Basal cell carcinoma:0.936364 Actinic keratosis:0.879310 Benign keratosis:0.831776 Dermatofibroma:0.727273 Vascular lesion:0.935484
Specs: Melanoma:0.588004 Melanocytic nevus:0.692192 Basal cell carcinoma:0.909186 Actinic keratosis:0.938171 Benign keratosis:0.887840 Dermatofibroma:0.902659 Vascular lesion:0.985383
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_59.pth

Epoch: 59, iteration: 0/175, ==> train <===, loss: 3.546974, classification loss: 1.807481,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.151202,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.042566,wcp loss: 0.000000,entropy loss: 1.848129,consistency weight: 1.000000, lr: 1.9966781110160376e-07

Epoch: 59, iteration: 100/175, ==> train <===, loss: 3.541759, classification loss: 1.809663,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145559,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026676,wcp loss: 0.000000,entropy loss: 1.850980,consistency weight: 1.000000, lr: 1.9966781110160376e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 519.0, 45.0, 26.0, 58.0, 8.0, 11.0]

VAL Student: Epoch: 59, iteration: 174

VAL AUROC: 0.894205, VAL Accus: 0.691314, VAL Senss: 0.799085, VAL Specs: 0.886376
AUROCs: Melanoma:0.870802 Melanocytic nevus:0.937399 Basal cell carcinoma:0.980229 Actinic keratosis:0.953966 Benign keratosis:0.876367 Dermatofibroma:0.777185 Vascular lesion:0.863486
Accus: Melanoma:0.621849 Melanocytic nevus:0.782805 Basal cell carcinoma:0.833333 Actinic keratosis:0.787879 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.815126 Melanocytic nevus:0.933635 Basal cell carcinoma:0.907407 Actinic keratosis:0.909091 Benign keratosis:0.670000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.717367 Melanocytic nevus:0.792285 Basal cell carcinoma:0.941860 Actinic keratosis:0.951396 Benign keratosis:0.926667 Dermatofibroma:0.928862 Vascular lesion:0.946193
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [165.0, 1067.0, 97.0, 34.0, 135.0, 9.0, 28.0]

TEST Student: Epoch: 59, iteration: 174

TEST AUROC: 0.921859, TEST Accus: 0.702346, TEST Senss: 0.883929, TEST Specs: 0.842478
AUROCs: Melanoma:0.881052 Melanocytic nevus:0.937525 Basal cell carcinoma:0.971844 Actinic keratosis:0.945924 Benign keratosis:0.916575 Dermatofibroma:0.804874 Vascular lesion:0.995220
Accus: Melanoma:0.714286 Melanocytic nevus:0.790956 Basal cell carcinoma:0.881818 Actinic keratosis:0.586207 Benign keratosis:0.630841 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.943723 Melanocytic nevus:0.954040 Basal cell carcinoma:0.936364 Actinic keratosis:0.844828 Benign keratosis:0.845794 Dermatofibroma:0.727273 Vascular lesion:0.935484
Specs: Melanoma:0.635090 Melanocytic nevus:0.722222 Basal cell carcinoma:0.883990 Actinic keratosis:0.941748 Benign keratosis:0.870072 Dermatofibroma:0.895133 Vascular lesion:0.949093
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_60.pth

Epoch: 60, iteration: 0/175, ==> train <===, loss: 3.510264, classification loss: 1.782642,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146004,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023166,wcp loss: 0.000000,entropy loss: 1.850460,consistency weight: 1.000000, lr: 1.7970102999144338e-07

Epoch: 60, iteration: 100/175, ==> train <===, loss: 3.531860, classification loss: 1.801667,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146180,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024741,wcp loss: 0.000000,entropy loss: 1.851632,consistency weight: 1.000000, lr: 1.7970102999144338e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [87.0, 469.0, 42.0, 25.0, 57.0, 8.0, 11.0]

VAL Student: Epoch: 60, iteration: 174

VAL AUROC: 0.895526, VAL Accus: 0.682453, VAL Senss: 0.792667, VAL Specs: 0.886911
AUROCs: Melanoma:0.869352 Melanocytic nevus:0.932995 Basal cell carcinoma:0.971987 Actinic keratosis:0.967159 Benign keratosis:0.887056 Dermatofibroma:0.747142 Vascular lesion:0.892995
Accus: Melanoma:0.731092 Melanocytic nevus:0.707391 Basal cell carcinoma:0.777778 Actinic keratosis:0.757576 Benign keratosis:0.570000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.857143 Melanocytic nevus:0.888386 Basal cell carcinoma:0.851852 Actinic keratosis:0.878788 Benign keratosis:0.710000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.671964 Melanocytic nevus:0.848665 Basal cell carcinoma:0.956660 Actinic keratosis:0.944157 Benign keratosis:0.920000 Dermatofibroma:0.926829 Vascular lesion:0.940102
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [185.0, 978.0, 91.0, 33.0, 145.0, 9.0, 29.0]

TEST Student: Epoch: 60, iteration: 174

TEST AUROC: 0.921365, TEST Accus: 0.706319, TEST Senss: 0.881153, TEST Specs: 0.846848
AUROCs: Melanoma:0.879422 Melanocytic nevus:0.941522 Basal cell carcinoma:0.975395 Actinic keratosis:0.954284 Benign keratosis:0.913890 Dermatofibroma:0.790083 Vascular lesion:0.994960
Accus: Melanoma:0.800866 Melanocytic nevus:0.724981 Basal cell carcinoma:0.827273 Actinic keratosis:0.568966 Benign keratosis:0.677570 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.969697 Melanocytic nevus:0.932543 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.855140 Dermatofibroma:0.636364 Vascular lesion:0.967742
Specs: Melanoma:0.584641 Melanocytic nevus:0.794294 Basal cell carcinoma:0.922310 Actinic keratosis:0.935105 Benign keratosis:0.853415 Dermatofibroma:0.896136 Vascular lesion:0.942036
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_61.pth

Epoch: 61, iteration: 0/175, ==> train <===, loss: 3.531025, classification loss: 1.805160,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150221,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024800,wcp loss: 0.000000,entropy loss: 1.851286,consistency weight: 1.000000, lr: 1.6173092699229905e-07

Epoch: 61, iteration: 100/175, ==> train <===, loss: 3.544610, classification loss: 1.811027,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147022,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028764,wcp loss: 0.000000,entropy loss: 1.851841,consistency weight: 1.000000, lr: 1.6173092699229905e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 550.0, 43.0, 25.0, 60.0, 8.0, 10.0]

VAL Student: Epoch: 61, iteration: 174

VAL AUROC: 0.889188, VAL Accus: 0.674504, VAL Senss: 0.763799, VAL Specs: 0.885310
AUROCs: Melanoma:0.860930 Melanocytic nevus:0.940738 Basal cell carcinoma:0.976235 Actinic keratosis:0.949641 Benign keratosis:0.875167 Dermatofibroma:0.753176 Vascular lesion:0.868426
Accus: Melanoma:0.571429 Melanocytic nevus:0.829563 Basal cell carcinoma:0.796296 Actinic keratosis:0.757576 Benign keratosis:0.600000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Senss: Melanoma:0.781513 Melanocytic nevus:0.963801 Basal cell carcinoma:0.870370 Actinic keratosis:0.757576 Benign keratosis:0.740000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Specs: Melanoma:0.740068 Melanocytic nevus:0.727003 Basal cell carcinoma:0.957717 Actinic keratosis:0.961737 Benign keratosis:0.912222 Dermatofibroma:0.949187 Vascular lesion:0.949239
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [153.0, 1149.0, 90.0, 32.0, 149.0, 10.0, 28.0]

TEST Student: Epoch: 61, iteration: 174

TEST AUROC: 0.925914, TEST Accus: 0.705431, TEST Senss: 0.875585, TEST Specs: 0.845862
AUROCs: Melanoma:0.890412 Melanocytic nevus:0.937304 Basal cell carcinoma:0.978454 Actinic keratosis:0.950813 Benign keratosis:0.922553 Dermatofibroma:0.807599 Vascular lesion:0.994261
Accus: Melanoma:0.662338 Melanocytic nevus:0.851742 Basal cell carcinoma:0.818182 Actinic keratosis:0.551724 Benign keratosis:0.696262 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.935065 Melanocytic nevus:0.971831 Basal cell carcinoma:0.936364 Actinic keratosis:0.844828 Benign keratosis:0.869159 Dermatofibroma:0.636364 Vascular lesion:0.935484
Specs: Melanoma:0.655269 Melanocytic nevus:0.668168 Basal cell carcinoma:0.923885 Actinic keratosis:0.956055 Benign keratosis:0.852860 Dermatofibroma:0.915203 Vascular lesion:0.949597
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_62.pth

Epoch: 62, iteration: 0/175, ==> train <===, loss: 3.542327, classification loss: 1.815432,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150519,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025293,wcp loss: 0.000000,entropy loss: 1.852121,consistency weight: 1.000000, lr: 1.4555783429306916e-07

Epoch: 62, iteration: 100/175, ==> train <===, loss: 3.538895, classification loss: 1.808401,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145812,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024786,wcp loss: 0.000000,entropy loss: 1.851520,consistency weight: 1.000000, lr: 1.4555783429306916e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 493.0, 41.0, 22.0, 63.0, 8.0, 11.0]

VAL Student: Epoch: 62, iteration: 174

VAL AUROC: 0.892376, VAL Accus: 0.670959, VAL Senss: 0.778963, VAL Specs: 0.884148
AUROCs: Melanoma:0.864611 Melanocytic nevus:0.938218 Basal cell carcinoma:0.974689 Actinic keratosis:0.928363 Benign keratosis:0.896167 Dermatofibroma:0.759845 Vascular lesion:0.884738
Accus: Melanoma:0.663866 Melanocytic nevus:0.743590 Basal cell carcinoma:0.759259 Actinic keratosis:0.666667 Benign keratosis:0.630000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.789916 Melanocytic nevus:0.929110 Basal cell carcinoma:0.833333 Actinic keratosis:0.787879 Benign keratosis:0.750000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.690125 Melanocytic nevus:0.816024 Basal cell carcinoma:0.963002 Actinic keratosis:0.972079 Benign keratosis:0.902222 Dermatofibroma:0.899390 Vascular lesion:0.946193
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [180.0, 1013.0, 89.0, 28.0, 155.0, 10.0, 29.0]

TEST Student: Epoch: 62, iteration: 174

TEST AUROC: 0.923505, TEST Accus: 0.705189, TEST Senss: 0.859448, TEST Specs: 0.844608
AUROCs: Melanoma:0.872029 Melanocytic nevus:0.938635 Basal cell carcinoma:0.973209 Actinic keratosis:0.947324 Benign keratosis:0.920260 Dermatofibroma:0.819094 Vascular lesion:0.993984
Accus: Melanoma:0.779221 Melanocytic nevus:0.750927 Basal cell carcinoma:0.809091 Actinic keratosis:0.482759 Benign keratosis:0.724299 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.956710 Melanocytic nevus:0.952557 Basal cell carcinoma:0.918182 Actinic keratosis:0.706897 Benign keratosis:0.864486 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.605381 Melanocytic nevus:0.741742 Basal cell carcinoma:0.930709 Actinic keratosis:0.972407 Benign keratosis:0.842865 Dermatofibroma:0.867035 Vascular lesion:0.952117
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_63.pth

Epoch: 63, iteration: 0/175, ==> train <===, loss: 3.525909, classification loss: 1.791618,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.141109,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019733,wcp loss: 0.000000,entropy loss: 1.855666,consistency weight: 1.000000, lr: 1.3100205086376224e-07

Epoch: 63, iteration: 100/175, ==> train <===, loss: 3.543885, classification loss: 1.811937,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145051,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025453,wcp loss: 0.000000,entropy loss: 1.851547,consistency weight: 1.000000, lr: 1.3100205086376224e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 513.0, 42.0, 24.0, 58.0, 8.0, 11.0]

VAL Student: Epoch: 63, iteration: 174

VAL AUROC: 0.894683, VAL Accus: 0.675828, VAL Senss: 0.793805, VAL Specs: 0.881015
AUROCs: Melanoma:0.866901 Melanocytic nevus:0.934642 Basal cell carcinoma:0.975080 Actinic keratosis:0.963806 Benign keratosis:0.877089 Dermatofibroma:0.769118 Vascular lesion:0.876142
Accus: Melanoma:0.638655 Melanocytic nevus:0.773756 Basal cell carcinoma:0.777778 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.831933 Melanocytic nevus:0.939668 Basal cell carcinoma:0.851852 Actinic keratosis:0.818182 Benign keratosis:0.690000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.706016 Melanocytic nevus:0.786350 Basal cell carcinoma:0.953488 Actinic keratosis:0.957601 Benign keratosis:0.921111 Dermatofibroma:0.903455 Vascular lesion:0.939086
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [175.0, 1055.0, 92.0, 32.0, 141.0, 10.0, 29.0]

TEST Student: Epoch: 63, iteration: 174

TEST AUROC: 0.924843, TEST Accus: 0.710947, TEST Senss: 0.891111, TEST Specs: 0.839673
AUROCs: Melanoma:0.878768 Melanocytic nevus:0.935999 Basal cell carcinoma:0.972761 Actinic keratosis:0.951421 Benign keratosis:0.920192 Dermatofibroma:0.817737 Vascular lesion:0.997025
Accus: Melanoma:0.757576 Melanocytic nevus:0.782061 Basal cell carcinoma:0.836364 Actinic keratosis:0.551724 Benign keratosis:0.658879 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.943723 Melanocytic nevus:0.961453 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.850467 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.620516 Melanocytic nevus:0.698198 Basal cell carcinoma:0.920735 Actinic keratosis:0.958099 Benign keratosis:0.870627 Dermatofibroma:0.875564 Vascular lesion:0.933972
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_64.pth

Epoch: 64, iteration: 0/175, ==> train <===, loss: 3.550555, classification loss: 1.826657,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.150111,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026127,wcp loss: 0.000000,entropy loss: 1.847881,consistency weight: 1.000000, lr: 1.1790184577738602e-07

Epoch: 64, iteration: 100/175, ==> train <===, loss: 3.545385, classification loss: 1.816785,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147040,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025102,wcp loss: 0.000000,entropy loss: 1.850538,consistency weight: 1.000000, lr: 1.1790184577738602e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 505.0, 44.0, 30.0, 52.0, 7.0, 11.0]

VAL Student: Epoch: 64, iteration: 174

VAL AUROC: 0.897041, VAL Accus: 0.691471, VAL Senss: 0.783544, VAL Specs: 0.889156
AUROCs: Melanoma:0.865766 Melanocytic nevus:0.930788 Basal cell carcinoma:0.969736 Actinic keratosis:0.968412 Benign keratosis:0.873067 Dermatofibroma:0.775343 Vascular lesion:0.896176
Accus: Melanoma:0.663866 Melanocytic nevus:0.761689 Basal cell carcinoma:0.814815 Actinic keratosis:0.909091 Benign keratosis:0.520000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Senss: Melanoma:0.823529 Melanocytic nevus:0.898944 Basal cell carcinoma:0.907407 Actinic keratosis:0.909091 Benign keratosis:0.650000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.718502 Melanocytic nevus:0.821958 Basal cell carcinoma:0.931290 Actinic keratosis:0.905895 Benign keratosis:0.938889 Dermatofibroma:0.946138 Vascular lesion:0.961421
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [167.0, 1041.0, 98.0, 40.0, 124.0, 9.0, 28.0]

TEST Student: Epoch: 64, iteration: 174

TEST AUROC: 0.918634, TEST Accus: 0.709564, TEST Senss: 0.889786, TEST Specs: 0.843728
AUROCs: Melanoma:0.875544 Melanocytic nevus:0.937542 Basal cell carcinoma:0.968082 Actinic keratosis:0.947545 Benign keratosis:0.907890 Dermatofibroma:0.796583 Vascular lesion:0.997252
Accus: Melanoma:0.722944 Melanocytic nevus:0.771683 Basal cell carcinoma:0.890909 Actinic keratosis:0.689655 Benign keratosis:0.579439 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.948052 Melanocytic nevus:0.934766 Basal cell carcinoma:0.936364 Actinic keratosis:0.896552 Benign keratosis:0.817757 Dermatofibroma:0.727273 Vascular lesion:0.967742
Specs: Melanoma:0.620516 Melanocytic nevus:0.762763 Basal cell carcinoma:0.870341 Actinic keratosis:0.885539 Benign keratosis:0.884509 Dermatofibroma:0.917712 Vascular lesion:0.964718
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_65.pth

Epoch: 65, iteration: 0/175, ==> train <===, loss: 3.534492, classification loss: 1.804353,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147699,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026138,wcp loss: 0.000000,entropy loss: 1.851700,consistency weight: 1.000000, lr: 1.0611166119964742e-07

Epoch: 65, iteration: 100/175, ==> train <===, loss: 3.533484, classification loss: 1.805250,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147697,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026087,wcp loss: 0.000000,entropy loss: 1.849844,consistency weight: 1.000000, lr: 1.0611166119964742e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [75.0, 521.0, 43.0, 26.0, 55.0, 9.0, 11.0]

VAL Student: Epoch: 65, iteration: 174

VAL AUROC: 0.897223, VAL Accus: 0.692298, VAL Senss: 0.783835, VAL Specs: 0.885339
AUROCs: Melanoma:0.867816 Melanocytic nevus:0.938240 Basal cell carcinoma:0.975061 Actinic keratosis:0.970261 Benign keratosis:0.879000 Dermatofibroma:0.770389 Vascular lesion:0.879797
Accus: Melanoma:0.630252 Melanocytic nevus:0.785822 Basal cell carcinoma:0.796296 Actinic keratosis:0.787879 Benign keratosis:0.550000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.831933 Melanocytic nevus:0.936652 Basal cell carcinoma:0.833333 Actinic keratosis:0.909091 Benign keratosis:0.680000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.702611 Melanocytic nevus:0.801187 Basal cell carcinoma:0.952431 Actinic keratosis:0.943123 Benign keratosis:0.931111 Dermatofibroma:0.909553 Vascular lesion:0.957360
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 1063.0, 93.0, 33.0, 140.0, 10.0, 29.0]

TEST Student: Epoch: 65, iteration: 174

TEST AUROC: 0.924550, TEST Accus: 0.713034, TEST Senss: 0.884112, TEST Specs: 0.845838
AUROCs: Melanoma:0.875005 Melanocytic nevus:0.939694 Basal cell carcinoma:0.973629 Actinic keratosis:0.954038 Benign keratosis:0.917507 Dermatofibroma:0.814613 Vascular lesion:0.997366
Accus: Melanoma:0.744589 Melanocytic nevus:0.787991 Basal cell carcinoma:0.845455 Actinic keratosis:0.568966 Benign keratosis:0.654206 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.960712 Basal cell carcinoma:0.927273 Actinic keratosis:0.862069 Benign keratosis:0.841121 Dermatofibroma:0.681818 Vascular lesion:0.967742
Specs: Melanoma:0.613789 Melanocytic nevus:0.719219 Basal cell carcinoma:0.922310 Actinic keratosis:0.939704 Benign keratosis:0.885064 Dermatofibroma:0.877572 Vascular lesion:0.963206
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_66.pth

Epoch: 66, iteration: 0/175, ==> train <===, loss: 3.512101, classification loss: 1.786472,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143250,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019107,wcp loss: 0.000000,entropy loss: 1.849770,consistency weight: 1.000000, lr: 9.550049507968268e-08

Epoch: 66, iteration: 100/175, ==> train <===, loss: 3.538985, classification loss: 1.808430,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146922,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026464,wcp loss: 0.000000,entropy loss: 1.851013,consistency weight: 1.000000, lr: 9.550049507968268e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [80.0, 480.0, 40.0, 25.0, 57.0, 9.0, 12.0]

VAL Student: Epoch: 66, iteration: 174

VAL AUROC: 0.894634, VAL Accus: 0.689581, VAL Senss: 0.795372, VAL Specs: 0.885676
AUROCs: Melanoma:0.874951 Melanocytic nevus:0.933483 Basal cell carcinoma:0.961260 Actinic keratosis:0.950299 Benign keratosis:0.899856 Dermatofibroma:0.757177 Vascular lesion:0.885415
Accus: Melanoma:0.672269 Melanocytic nevus:0.723982 Basal cell carcinoma:0.740741 Actinic keratosis:0.757576 Benign keratosis:0.570000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Senss: Melanoma:0.865546 Melanocytic nevus:0.897436 Basal cell carcinoma:0.833333 Actinic keratosis:0.878788 Benign keratosis:0.730000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.696935 Melanocytic nevus:0.833828 Basal cell carcinoma:0.963002 Actinic keratosis:0.942089 Benign keratosis:0.912222 Dermatofibroma:0.878049 Vascular lesion:0.973604
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [180.0, 974.0, 89.0, 37.0, 147.0, 11.0, 28.0]

TEST Student: Epoch: 66, iteration: 174

TEST AUROC: 0.924240, TEST Accus: 0.719772, TEST Senss: 0.891878, TEST Specs: 0.848328
AUROCs: Melanoma:0.885331 Melanocytic nevus:0.941602 Basal cell carcinoma:0.969625 Actinic keratosis:0.954135 Benign keratosis:0.920633 Dermatofibroma:0.799719 Vascular lesion:0.998634
Accus: Melanoma:0.779221 Melanocytic nevus:0.722016 Basal cell carcinoma:0.809091 Actinic keratosis:0.637931 Benign keratosis:0.686916 Dermatofibroma:0.500000 Vascular lesion:0.903226
Senss: Melanoma:0.952381 Melanocytic nevus:0.936249 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.855140 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.610426 Melanocytic nevus:0.777778 Basal cell carcinoma:0.937008 Actinic keratosis:0.937660 Benign keratosis:0.850639 Dermatofibroma:0.846463 Vascular lesion:0.978327
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_67.pth

Epoch: 67, iteration: 0/175, ==> train <===, loss: 3.536771, classification loss: 1.804776,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142225,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023678,wcp loss: 0.000000,entropy loss: 1.850542,consistency weight: 1.000000, lr: 8.595044557171442e-08

Epoch: 67, iteration: 100/175, ==> train <===, loss: 3.536776, classification loss: 1.810349,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148132,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024133,wcp loss: 0.000000,entropy loss: 1.850426,consistency weight: 1.000000, lr: 8.595044557171442e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [78.0, 517.0, 44.0, 26.0, 56.0, 8.0, 10.0]

VAL Student: Epoch: 67, iteration: 174

VAL AUROC: 0.893900, VAL Accus: 0.680659, VAL Senss: 0.783630, VAL Specs: 0.886544
AUROCs: Melanoma:0.867969 Melanocytic nevus:0.939597 Basal cell carcinoma:0.969717 Actinic keratosis:0.965842 Benign keratosis:0.869911 Dermatofibroma:0.755462 Vascular lesion:0.888799
Accus: Melanoma:0.655462 Melanocytic nevus:0.779789 Basal cell carcinoma:0.814815 Actinic keratosis:0.787879 Benign keratosis:0.560000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Senss: Melanoma:0.857143 Melanocytic nevus:0.938160 Basal cell carcinoma:0.851852 Actinic keratosis:0.909091 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.693530 Melanocytic nevus:0.795252 Basal cell carcinoma:0.955603 Actinic keratosis:0.936918 Benign keratosis:0.920000 Dermatofibroma:0.935976 Vascular lesion:0.968528
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 1059.0, 92.0, 35.0, 138.0, 10.0, 27.0]

TEST Student: Epoch: 67, iteration: 174

TEST AUROC: 0.925317, TEST Accus: 0.705686, TEST Senss: 0.881527, TEST Specs: 0.846806
AUROCs: Melanoma:0.883958 Melanocytic nevus:0.937849 Basal cell carcinoma:0.976473 Actinic keratosis:0.953879 Benign keratosis:0.914681 Dermatofibroma:0.813985 Vascular lesion:0.996390
Accus: Melanoma:0.744589 Melanocytic nevus:0.785026 Basal cell carcinoma:0.836364 Actinic keratosis:0.603448 Benign keratosis:0.644860 Dermatofibroma:0.454545 Vascular lesion:0.870968
Senss: Melanoma:0.952381 Melanocytic nevus:0.953299 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.841121 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.604260 Melanocytic nevus:0.720721 Basal cell carcinoma:0.920210 Actinic keratosis:0.930506 Benign keratosis:0.868962 Dermatofibroma:0.906172 Vascular lesion:0.976815
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_68.pth

Epoch: 68, iteration: 0/175, ==> train <===, loss: 3.507578, classification loss: 1.788906,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.152913,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022022,wcp loss: 0.000000,entropy loss: 1.849563,consistency weight: 1.000000, lr: 7.735540101454298e-08

Epoch: 68, iteration: 100/175, ==> train <===, loss: 3.534625, classification loss: 1.802043,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145564,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026866,wcp loss: 0.000000,entropy loss: 1.851280,consistency weight: 1.000000, lr: 7.735540101454298e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [83.0, 510.0, 41.0, 24.0, 59.0, 8.0, 11.0]

VAL Student: Epoch: 68, iteration: 174

VAL AUROC: 0.888968, VAL Accus: 0.682368, VAL Senss: 0.790768, VAL Specs: 0.890271
AUROCs: Melanoma:0.862837 Melanocytic nevus:0.944238 Basal cell carcinoma:0.971361 Actinic keratosis:0.928144 Benign keratosis:0.877889 Dermatofibroma:0.751334 Vascular lesion:0.886971
Accus: Melanoma:0.697479 Melanocytic nevus:0.769231 Basal cell carcinoma:0.759259 Actinic keratosis:0.727273 Benign keratosis:0.590000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.865546 Melanocytic nevus:0.927602 Basal cell carcinoma:0.851852 Actinic keratosis:0.787879 Benign keratosis:0.740000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.671964 Melanocytic nevus:0.801187 Basal cell carcinoma:0.951374 Actinic keratosis:0.956567 Benign keratosis:0.906667 Dermatofibroma:0.975610 Vascular lesion:0.968528
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [183.0, 1058.0, 90.0, 30.0, 149.0, 8.0, 29.0]

TEST Student: Epoch: 68, iteration: 174

TEST AUROC: 0.925406, TEST Accus: 0.701043, TEST Senss: 0.853809, TEST Specs: 0.851429
AUROCs: Melanoma:0.879692 Melanocytic nevus:0.943118 Basal cell carcinoma:0.978502 Actinic keratosis:0.941862 Benign keratosis:0.917420 Dermatofibroma:0.818843 Vascular lesion:0.998407
Accus: Melanoma:0.792208 Melanocytic nevus:0.784285 Basal cell carcinoma:0.818182 Actinic keratosis:0.517241 Benign keratosis:0.696262 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.956710 Melanocytic nevus:0.954781 Basal cell carcinoma:0.927273 Actinic keratosis:0.810345 Benign keratosis:0.859813 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.584641 Melanocytic nevus:0.735736 Basal cell carcinoma:0.920735 Actinic keratosis:0.952478 Benign keratosis:0.847307 Dermatofibroma:0.943302 Vascular lesion:0.975806
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_69.pth

Epoch: 69, iteration: 0/175, ==> train <===, loss: 3.543109, classification loss: 1.826949,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.151658,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019685,wcp loss: 0.000000,entropy loss: 1.848133,consistency weight: 1.000000, lr: 6.961986091308869e-08

Epoch: 69, iteration: 100/175, ==> train <===, loss: 3.533936, classification loss: 1.805893,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147082,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023484,wcp loss: 0.000000,entropy loss: 1.851641,consistency weight: 1.000000, lr: 6.961986091308869e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 480.0, 36.0, 29.0, 55.0, 9.0, 11.0]

VAL Student: Epoch: 69, iteration: 174

VAL AUROC: 0.897240, VAL Accus: 0.682734, VAL Senss: 0.780599, VAL Specs: 0.880853
AUROCs: Melanoma:0.866538 Melanocytic nevus:0.935622 Basal cell carcinoma:0.972477 Actinic keratosis:0.963649 Benign keratosis:0.889100 Dermatofibroma:0.757050 Vascular lesion:0.896244
Accus: Melanoma:0.663866 Melanocytic nevus:0.723982 Basal cell carcinoma:0.666667 Actinic keratosis:0.878788 Benign keratosis:0.550000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.831933 Melanocytic nevus:0.912519 Basal cell carcinoma:0.814815 Actinic keratosis:0.909091 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.704881 Melanocytic nevus:0.816024 Basal cell carcinoma:0.961945 Actinic keratosis:0.924509 Benign keratosis:0.910000 Dermatofibroma:0.880081 Vascular lesion:0.968528
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [173.0, 994.0, 91.0, 42.0, 143.0, 11.0, 28.0]

TEST Student: Epoch: 69, iteration: 174

TEST AUROC: 0.921444, TEST Accus: 0.729803, TEST Senss: 0.888239, TEST Specs: 0.838496
AUROCs: Melanoma:0.876233 Melanocytic nevus:0.938250 Basal cell carcinoma:0.972231 Actinic keratosis:0.950417 Benign keratosis:0.909186 Dermatofibroma:0.806584 Vascular lesion:0.997203
Accus: Melanoma:0.748918 Melanocytic nevus:0.736842 Basal cell carcinoma:0.827273 Actinic keratosis:0.724138 Benign keratosis:0.668224 Dermatofibroma:0.500000 Vascular lesion:0.903226
Senss: Melanoma:0.948052 Melanocytic nevus:0.945145 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.855140 Dermatofibroma:0.727273 Vascular lesion:0.935484
Specs: Melanoma:0.619395 Melanocytic nevus:0.744745 Basal cell carcinoma:0.930184 Actinic keratosis:0.908533 Benign keratosis:0.842865 Dermatofibroma:0.852985 Vascular lesion:0.970766
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_70.pth

Epoch: 70, iteration: 0/175, ==> train <===, loss: 3.513700, classification loss: 1.797440,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.152242,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020782,wcp loss: 0.000000,entropy loss: 1.847720,consistency weight: 1.000000, lr: 6.265787482177982e-08

Epoch: 70, iteration: 100/175, ==> train <===, loss: 3.538574, classification loss: 1.807057,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145217,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024763,wcp loss: 0.000000,entropy loss: 1.851972,consistency weight: 1.000000, lr: 6.265787482177982e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 524.0, 46.0, 23.0, 60.0, 8.0, 11.0]

VAL Student: Epoch: 70, iteration: 174

VAL AUROC: 0.883109, VAL Accus: 0.681306, VAL Senss: 0.768059, VAL Specs: 0.893068
AUROCs: Melanoma:0.865747 Melanocytic nevus:0.934597 Basal cell carcinoma:0.980248 Actinic keratosis:0.926546 Benign keratosis:0.885456 Dermatofibroma:0.737868 Vascular lesion:0.851303
Accus: Melanoma:0.596639 Melanocytic nevus:0.790347 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.600000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.789916 Melanocytic nevus:0.926094 Basal cell carcinoma:0.888889 Actinic keratosis:0.818182 Benign keratosis:0.720000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Specs: Melanoma:0.750284 Melanocytic nevus:0.816024 Basal cell carcinoma:0.936575 Actinic keratosis:0.962771 Benign keratosis:0.918889 Dermatofibroma:0.926829 Vascular lesion:0.940102
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [160.0, 1082.0, 97.0, 30.0, 146.0, 9.0, 29.0]

TEST Student: Epoch: 70, iteration: 174

TEST AUROC: 0.921169, TEST Accus: 0.702942, TEST Senss: 0.880705, TEST Specs: 0.847787
AUROCs: Melanoma:0.888124 Melanocytic nevus:0.938927 Basal cell carcinoma:0.975824 Actinic keratosis:0.934241 Benign keratosis:0.920526 Dermatofibroma:0.794280 Vascular lesion:0.996260
Accus: Melanoma:0.692641 Melanocytic nevus:0.802076 Basal cell carcinoma:0.881818 Actinic keratosis:0.517241 Benign keratosis:0.682243 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.930736 Melanocytic nevus:0.949592 Basal cell carcinoma:0.954545 Actinic keratosis:0.793103 Benign keratosis:0.855140 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.661996 Melanocytic nevus:0.731231 Basal cell carcinoma:0.889239 Actinic keratosis:0.957077 Benign keratosis:0.862854 Dermatofibroma:0.898144 Vascular lesion:0.933972
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_71.pth

Epoch: 71, iteration: 0/175, ==> train <===, loss: 3.519953, classification loss: 1.789435,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146931,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026497,wcp loss: 0.000000,entropy loss: 1.850952,consistency weight: 1.000000, lr: 5.6392087339601844e-08

Epoch: 71, iteration: 100/175, ==> train <===, loss: 3.534893, classification loss: 1.809420,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146433,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021099,wcp loss: 0.000000,entropy loss: 1.850806,consistency weight: 1.000000, lr: 5.6392087339601844e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 541.0, 41.0, 22.0, 64.0, 8.0, 10.0]

VAL Student: Epoch: 71, iteration: 174

VAL AUROC: 0.880877, VAL Accus: 0.663603, VAL Senss: 0.776691, VAL Specs: 0.880682
AUROCs: Melanoma:0.863419 Melanocytic nevus:0.943987 Basal cell carcinoma:0.959890 Actinic keratosis:0.888158 Benign keratosis:0.884944 Dermatofibroma:0.745744 Vascular lesion:0.880000
Accus: Melanoma:0.596639 Melanocytic nevus:0.815988 Basal cell carcinoma:0.759259 Actinic keratosis:0.666667 Benign keratosis:0.640000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Senss: Melanoma:0.831933 Melanocytic nevus:0.959276 Basal cell carcinoma:0.888889 Actinic keratosis:0.757576 Benign keratosis:0.770000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.677639 Melanocytic nevus:0.747774 Basal cell carcinoma:0.959831 Actinic keratosis:0.971044 Benign keratosis:0.898889 Dermatofibroma:0.955285 Vascular lesion:0.954315
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 1113.0, 87.0, 28.0, 153.0, 8.0, 29.0]

TEST Student: Epoch: 71, iteration: 174

TEST AUROC: 0.928045, TEST Accus: 0.693912, TEST Senss: 0.848591, TEST Specs: 0.834260
AUROCs: Melanoma:0.883643 Melanocytic nevus:0.936295 Basal cell carcinoma:0.982147 Actinic keratosis:0.957289 Benign keratosis:0.919987 Dermatofibroma:0.820645 Vascular lesion:0.996309
Accus: Melanoma:0.744589 Melanocytic nevus:0.825056 Basal cell carcinoma:0.790909 Actinic keratosis:0.482759 Benign keratosis:0.714953 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.961039 Melanocytic nevus:0.977020 Basal cell carcinoma:0.936364 Actinic keratosis:0.724138 Benign keratosis:0.873832 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.580717 Melanocytic nevus:0.638138 Basal cell carcinoma:0.930709 Actinic keratosis:0.971385 Benign keratosis:0.838978 Dermatofibroma:0.920723 Vascular lesion:0.959173
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_72.pth

Epoch: 72, iteration: 0/175, ==> train <===, loss: 3.523821, classification loss: 1.787760,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145911,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026849,wcp loss: 0.000000,entropy loss: 1.855123,consistency weight: 1.000000, lr: 5.075287860564166e-08

Epoch: 72, iteration: 100/175, ==> train <===, loss: 3.535928, classification loss: 1.807562,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145094,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021614,wcp loss: 0.000000,entropy loss: 1.851846,consistency weight: 1.000000, lr: 5.075287860564166e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [82.0, 459.0, 40.0, 24.0, 61.0, 8.0, 11.0]

VAL Student: Epoch: 72, iteration: 174

VAL AUROC: 0.894499, VAL Accus: 0.670390, VAL Senss: 0.770136, VAL Specs: 0.887554
AUROCs: Melanoma:0.862570 Melanocytic nevus:0.930336 Basal cell carcinoma:0.962943 Actinic keratosis:0.960108 Benign keratosis:0.888522 Dermatofibroma:0.763338 Vascular lesion:0.893672
Accus: Melanoma:0.689076 Melanocytic nevus:0.692308 Basal cell carcinoma:0.740741 Actinic keratosis:0.727273 Benign keratosis:0.610000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.897436 Basal cell carcinoma:0.814815 Actinic keratosis:0.787879 Benign keratosis:0.730000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.683314 Melanocytic nevus:0.851632 Basal cell carcinoma:0.964059 Actinic keratosis:0.949328 Benign keratosis:0.907778 Dermatofibroma:0.917683 Vascular lesion:0.939086
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [184.0, 963.0, 88.0, 34.0, 153.0, 10.0, 29.0]

TEST Student: Epoch: 72, iteration: 174

TEST AUROC: 0.920515, TEST Accus: 0.714513, TEST Senss: 0.881492, TEST Specs: 0.847436
AUROCs: Melanoma:0.866882 Melanocytic nevus:0.937466 Basal cell carcinoma:0.970050 Actinic keratosis:0.944073 Benign keratosis:0.907956 Dermatofibroma:0.821420 Vascular lesion:0.995756
Accus: Melanoma:0.796537 Melanocytic nevus:0.713862 Basal cell carcinoma:0.800000 Actinic keratosis:0.586207 Benign keratosis:0.714953 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.952381 Melanocytic nevus:0.932543 Basal cell carcinoma:0.881818 Actinic keratosis:0.862069 Benign keratosis:0.859813 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.597534 Melanocytic nevus:0.788288 Basal cell carcinoma:0.939108 Actinic keratosis:0.945324 Benign keratosis:0.846752 Dermatofibroma:0.883091 Vascular lesion:0.931956
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_73.pth

Epoch: 73, iteration: 0/175, ==> train <===, loss: 3.520666, classification loss: 1.789963,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145241,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024763,wcp loss: 0.000000,entropy loss: 1.851181,consistency weight: 1.000000, lr: 4.567759074507749e-08

Epoch: 73, iteration: 100/175, ==> train <===, loss: 3.536424, classification loss: 1.805568,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145900,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026090,wcp loss: 0.000000,entropy loss: 1.850665,consistency weight: 1.000000, lr: 4.567759074507749e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 521.0, 46.0, 23.0, 67.0, 7.0, 11.0]

VAL Student: Epoch: 73, iteration: 174

VAL AUROC: 0.886194, VAL Accus: 0.673327, VAL Senss: 0.786510, VAL Specs: 0.893152
AUROCs: Melanoma:0.847185 Melanocytic nevus:0.934239 Basal cell carcinoma:0.981325 Actinic keratosis:0.896619 Benign keratosis:0.898011 Dermatofibroma:0.771596 Vascular lesion:0.874382
Accus: Melanoma:0.537815 Melanocytic nevus:0.785822 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.670000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.904977 Basal cell carcinoma:0.907407 Actinic keratosis:0.757576 Benign keratosis:0.800000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.744608 Melanocytic nevus:0.836795 Basal cell carcinoma:0.933404 Actinic keratosis:0.960703 Benign keratosis:0.870000 Dermatofibroma:0.952236 Vascular lesion:0.954315
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1064.0, 93.0, 30.0, 165.0, 9.0, 29.0]

TEST Student: Epoch: 73, iteration: 174

TEST AUROC: 0.912695, TEST Accus: 0.698630, TEST Senss: 0.874830, TEST Specs: 0.850201
AUROCs: Melanoma:0.869827 Melanocytic nevus:0.934083 Basal cell carcinoma:0.975330 Actinic keratosis:0.918692 Benign keratosis:0.913176 Dermatofibroma:0.780276 Vascular lesion:0.997480
Accus: Melanoma:0.623377 Melanocytic nevus:0.788732 Basal cell carcinoma:0.845455 Actinic keratosis:0.517241 Benign keratosis:0.771028 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.917749 Melanocytic nevus:0.936990 Basal cell carcinoma:0.945455 Actinic keratosis:0.758621 Benign keratosis:0.883178 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.660314 Melanocytic nevus:0.774775 Basal cell carcinoma:0.889764 Actinic keratosis:0.953500 Benign keratosis:0.801222 Dermatofibroma:0.919719 Vascular lesion:0.952117
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_74.pth

Epoch: 74, iteration: 0/175, ==> train <===, loss: 3.568026, classification loss: 1.830874,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143902,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028718,wcp loss: 0.000000,entropy loss: 1.852337,consistency weight: 1.000000, lr: 4.1109831670569744e-08

Epoch: 74, iteration: 100/175, ==> train <===, loss: 3.536777, classification loss: 1.805629,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146735,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025937,wcp loss: 0.000000,entropy loss: 1.851946,consistency weight: 1.000000, lr: 4.1109831670569744e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 516.0, 47.0, 25.0, 61.0, 7.0, 11.0]

VAL Student: Epoch: 74, iteration: 174

VAL AUROC: 0.897435, VAL Accus: 0.679784, VAL Senss: 0.803286, VAL Specs: 0.884964
AUROCs: Melanoma:0.843856 Melanocytic nevus:0.932422 Basal cell carcinoma:0.980581 Actinic keratosis:0.968161 Benign keratosis:0.890544 Dermatofibroma:0.782012 Vascular lesion:0.884467
Accus: Melanoma:0.571429 Melanocytic nevus:0.778281 Basal cell carcinoma:0.870370 Actinic keratosis:0.757576 Benign keratosis:0.610000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.909502 Basal cell carcinoma:0.962963 Actinic keratosis:0.909091 Benign keratosis:0.710000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.729852 Melanocytic nevus:0.804154 Basal cell carcinoma:0.921776 Actinic keratosis:0.948294 Benign keratosis:0.904444 Dermatofibroma:0.936992 Vascular lesion:0.949239
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1069.0, 99.0, 30.0, 149.0, 9.0, 29.0]

TEST Student: Epoch: 74, iteration: 174

TEST AUROC: 0.914580, TEST Accus: 0.696270, TEST Senss: 0.886638, TEST Specs: 0.841153
AUROCs: Melanoma:0.864152 Melanocytic nevus:0.925626 Basal cell carcinoma:0.971739 Actinic keratosis:0.943624 Benign keratosis:0.909256 Dermatofibroma:0.790277 Vascular lesion:0.997382
Accus: Melanoma:0.623377 Melanocytic nevus:0.792439 Basal cell carcinoma:0.900000 Actinic keratosis:0.517241 Benign keratosis:0.696262 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.917749 Melanocytic nevus:0.949592 Basal cell carcinoma:0.963636 Actinic keratosis:0.879310 Benign keratosis:0.859813 Dermatofibroma:0.636364 Vascular lesion:1.000000
Specs: Melanoma:0.640135 Melanocytic nevus:0.747748 Basal cell carcinoma:0.864042 Actinic keratosis:0.933572 Benign keratosis:0.836757 Dermatofibroma:0.913196 Vascular lesion:0.952621
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_75.pth

Epoch: 75, iteration: 0/175, ==> train <===, loss: 3.520064, classification loss: 1.790898,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.149557,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025726,wcp loss: 0.000000,entropy loss: 1.852997,consistency weight: 1.000000, lr: 3.699884850351277e-08

Epoch: 75, iteration: 100/175, ==> train <===, loss: 3.544179, classification loss: 1.815332,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148189,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026870,wcp loss: 0.000000,entropy loss: 1.850166,consistency weight: 1.000000, lr: 3.699884850351277e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 499.0, 44.0, 25.0, 67.0, 9.0, 11.0]

VAL Student: Epoch: 75, iteration: 174

VAL AUROC: 0.898064, VAL Accus: 0.694613, VAL Senss: 0.808153, VAL Specs: 0.884682
AUROCs: Melanoma:0.857954 Melanocytic nevus:0.929155 Basal cell carcinoma:0.975785 Actinic keratosis:0.961863 Benign keratosis:0.900289 Dermatofibroma:0.768610 Vascular lesion:0.892792
Accus: Melanoma:0.571429 Melanocytic nevus:0.752640 Basal cell carcinoma:0.814815 Actinic keratosis:0.757576 Benign keratosis:0.670000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.909502 Basal cell carcinoma:0.870370 Actinic keratosis:0.909091 Benign keratosis:0.770000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.752554 Melanocytic nevus:0.821958 Basal cell carcinoma:0.951374 Actinic keratosis:0.941055 Benign keratosis:0.871111 Dermatofibroma:0.898374 Vascular lesion:0.956345
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1039.0, 91.0, 33.0, 165.0, 11.0, 29.0]

TEST Student: Epoch: 75, iteration: 174

TEST AUROC: 0.919015, TEST Accus: 0.713761, TEST Senss: 0.894144, TEST Specs: 0.836760
AUROCs: Melanoma:0.874575 Melanocytic nevus:0.931435 Basal cell carcinoma:0.971434 Actinic keratosis:0.938206 Benign keratosis:0.917631 Dermatofibroma:0.801419 Vascular lesion:0.998407
Accus: Melanoma:0.623377 Melanocytic nevus:0.770200 Basal cell carcinoma:0.827273 Actinic keratosis:0.568966 Benign keratosis:0.771028 Dermatofibroma:0.500000 Vascular lesion:0.935484
Senss: Melanoma:0.917749 Melanocytic nevus:0.945886 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.887850 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.660314 Melanocytic nevus:0.752252 Basal cell carcinoma:0.907087 Actinic keratosis:0.931528 Benign keratosis:0.788451 Dermatofibroma:0.856498 Vascular lesion:0.961190
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_76.pth

Epoch: 76, iteration: 0/175, ==> train <===, loss: 3.509771, classification loss: 1.787061,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.153078,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023813,wcp loss: 0.000000,entropy loss: 1.851976,consistency weight: 1.000000, lr: 3.3298963653161496e-08

Epoch: 76, iteration: 100/175, ==> train <===, loss: 3.531203, classification loss: 1.800377,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146236,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026305,wcp loss: 0.000000,entropy loss: 1.850757,consistency weight: 1.000000, lr: 3.3298963653161496e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [86.0, 476.0, 42.0, 24.0, 58.0, 9.0, 10.0]

VAL Student: Epoch: 76, iteration: 174

VAL AUROC: 0.889362, VAL Accus: 0.679265, VAL Senss: 0.775099, VAL Specs: 0.883779
AUROCs: Melanoma:0.871374 Melanocytic nevus:0.938415 Basal cell carcinoma:0.973123 Actinic keratosis:0.950425 Benign keratosis:0.887356 Dermatofibroma:0.754891 Vascular lesion:0.849949
Accus: Melanoma:0.722689 Melanocytic nevus:0.717949 Basal cell carcinoma:0.777778 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Senss: Melanoma:0.873950 Melanocytic nevus:0.914027 Basal cell carcinoma:0.870370 Actinic keratosis:0.818182 Benign keratosis:0.720000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Specs: Melanoma:0.676504 Melanocytic nevus:0.816024 Basal cell carcinoma:0.954545 Actinic keratosis:0.955533 Benign keratosis:0.920000 Dermatofibroma:0.886179 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [188.0, 962.0, 93.0, 31.0, 143.0, 11.0, 26.0]

TEST Student: Epoch: 76, iteration: 174

TEST AUROC: 0.925616, TEST Accus: 0.701978, TEST Senss: 0.885751, TEST Specs: 0.845959
AUROCs: Melanoma:0.879575 Melanocytic nevus:0.942153 Basal cell carcinoma:0.974479 Actinic keratosis:0.951130 Benign keratosis:0.917258 Dermatofibroma:0.818718 Vascular lesion:0.996000
Accus: Melanoma:0.813853 Melanocytic nevus:0.713121 Basal cell carcinoma:0.845455 Actinic keratosis:0.534483 Benign keratosis:0.668224 Dermatofibroma:0.500000 Vascular lesion:0.838710
Senss: Melanoma:0.965368 Melanocytic nevus:0.945145 Basal cell carcinoma:0.936364 Actinic keratosis:0.844828 Benign keratosis:0.845794 Dermatofibroma:0.727273 Vascular lesion:0.935484
Specs: Melanoma:0.585762 Melanocytic nevus:0.756757 Basal cell carcinoma:0.920735 Actinic keratosis:0.956055 Benign keratosis:0.859522 Dermatofibroma:0.857501 Vascular lesion:0.985383
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_77.pth

Epoch: 77, iteration: 0/175, ==> train <===, loss: 3.516693, classification loss: 1.789805,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.152256,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023787,wcp loss: 0.000000,entropy loss: 1.855357,consistency weight: 1.000000, lr: 2.996906728784535e-08

Epoch: 77, iteration: 100/175, ==> train <===, loss: 3.535451, classification loss: 1.807281,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146897,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023184,wcp loss: 0.000000,entropy loss: 1.851883,consistency weight: 1.000000, lr: 2.996906728784535e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 496.0, 44.0, 24.0, 57.0, 8.0, 12.0]

VAL Student: Epoch: 77, iteration: 174

VAL AUROC: 0.895592, VAL Accus: 0.689153, VAL Senss: 0.793327, VAL Specs: 0.883371
AUROCs: Melanoma:0.871947 Melanocytic nevus:0.936513 Basal cell carcinoma:0.974454 Actinic keratosis:0.964088 Benign keratosis:0.873478 Dermatofibroma:0.765689 Vascular lesion:0.882978
Accus: Melanoma:0.663866 Melanocytic nevus:0.748115 Basal cell carcinoma:0.814815 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.840336 Melanocytic nevus:0.923077 Basal cell carcinoma:0.888889 Actinic keratosis:0.848485 Benign keratosis:0.690000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.694665 Melanocytic nevus:0.804154 Basal cell carcinoma:0.950317 Actinic keratosis:0.946225 Benign keratosis:0.923333 Dermatofibroma:0.927846 Vascular lesion:0.937056
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [173.0, 1043.0, 92.0, 33.0, 139.0, 10.0, 29.0]

TEST Student: Epoch: 77, iteration: 174

TEST AUROC: 0.924567, TEST Accus: 0.709568, TEST Senss: 0.891724, TEST Specs: 0.840935
AUROCs: Melanoma:0.885327 Melanocytic nevus:0.936479 Basal cell carcinoma:0.971424 Actinic keratosis:0.948553 Benign keratosis:0.913402 Dermatofibroma:0.819014 Vascular lesion:0.997764
Accus: Melanoma:0.748918 Melanocytic nevus:0.773165 Basal cell carcinoma:0.836364 Actinic keratosis:0.568966 Benign keratosis:0.649533 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.952381 Melanocytic nevus:0.951075 Basal cell carcinoma:0.936364 Actinic keratosis:0.879310 Benign keratosis:0.841121 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.602578 Melanocytic nevus:0.732733 Basal cell carcinoma:0.916535 Actinic keratosis:0.943281 Benign keratosis:0.867851 Dermatofibroma:0.894129 Vascular lesion:0.929435
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_78.pth

Epoch: 78, iteration: 0/175, ==> train <===, loss: 3.558968, classification loss: 1.811862,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.143433,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.037788,wcp loss: 0.000000,entropy loss: 1.852750,consistency weight: 1.000000, lr: 2.6972160559060813e-08

Epoch: 78, iteration: 100/175, ==> train <===, loss: 3.536809, classification loss: 1.808572,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146203,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022255,wcp loss: 0.000000,entropy loss: 1.852186,consistency weight: 1.000000, lr: 2.6972160559060813e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 521.0, 46.0, 24.0, 58.0, 9.0, 11.0]

VAL Student: Epoch: 78, iteration: 174

VAL AUROC: 0.889399, VAL Accus: 0.688659, VAL Senss: 0.785613, VAL Specs: 0.892597
AUROCs: Melanoma:0.869199 Melanocytic nevus:0.930569 Basal cell carcinoma:0.979191 Actinic keratosis:0.953590 Benign keratosis:0.875500 Dermatofibroma:0.754256 Vascular lesion:0.863486
Accus: Melanoma:0.579832 Melanocytic nevus:0.785822 Basal cell carcinoma:0.851852 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.789916 Melanocytic nevus:0.909502 Basal cell carcinoma:0.888889 Actinic keratosis:0.848485 Benign keratosis:0.700000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.757094 Melanocytic nevus:0.801187 Basal cell carcinoma:0.939746 Actinic keratosis:0.960703 Benign keratosis:0.925556 Dermatofibroma:0.933943 Vascular lesion:0.929949
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1088.0, 97.0, 31.0, 145.0, 9.0, 30.0]

TEST Student: Epoch: 78, iteration: 174

TEST AUROC: 0.921907, TEST Accus: 0.704415, TEST Senss: 0.884770, TEST Specs: 0.845610
AUROCs: Melanoma:0.887138 Melanocytic nevus:0.933444 Basal cell carcinoma:0.971062 Actinic keratosis:0.937633 Benign keratosis:0.918246 Dermatofibroma:0.807668 Vascular lesion:0.998155
Accus: Melanoma:0.653680 Melanocytic nevus:0.806523 Basal cell carcinoma:0.881818 Actinic keratosis:0.534483 Benign keratosis:0.677570 Dermatofibroma:0.409091 Vascular lesion:0.967742
Senss: Melanoma:0.913420 Melanocytic nevus:0.947368 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.850467 Dermatofibroma:0.727273 Vascular lesion:1.000000
Specs: Melanoma:0.669843 Melanocytic nevus:0.735736 Basal cell carcinoma:0.883465 Actinic keratosis:0.954522 Benign keratosis:0.867296 Dermatofibroma:0.901656 Vascular lesion:0.906754
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_79.pth

Epoch: 79, iteration: 0/175, ==> train <===, loss: 3.524835, classification loss: 1.792631,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.151456,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029546,wcp loss: 0.000000,entropy loss: 1.854114,consistency weight: 1.000000, lr: 2.4274944503154732e-08

Epoch: 79, iteration: 100/175, ==> train <===, loss: 3.533942, classification loss: 1.804484,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145667,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023855,wcp loss: 0.000000,entropy loss: 1.851271,consistency weight: 1.000000, lr: 2.4274944503154732e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 544.0, 41.0, 26.0, 62.0, 8.0, 11.0]

VAL Student: Epoch: 79, iteration: 174

VAL AUROC: 0.894381, VAL Accus: 0.684630, VAL Senss: 0.783716, VAL Specs: 0.881334
AUROCs: Melanoma:0.856132 Melanocytic nevus:0.941523 Basal cell carcinoma:0.969071 Actinic keratosis:0.964338 Benign keratosis:0.872822 Dermatofibroma:0.772993 Vascular lesion:0.883790
Accus: Melanoma:0.571429 Melanocytic nevus:0.820513 Basal cell carcinoma:0.759259 Actinic keratosis:0.787879 Benign keratosis:0.620000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.960784 Basal cell carcinoma:0.833333 Actinic keratosis:0.878788 Benign keratosis:0.740000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.707151 Melanocytic nevus:0.729970 Basal cell carcinoma:0.959831 Actinic keratosis:0.956567 Benign keratosis:0.913333 Dermatofibroma:0.948171 Vascular lesion:0.954315
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [158.0, 1128.0, 86.0, 33.0, 147.0, 9.0, 28.0]

TEST Student: Epoch: 79, iteration: 174

TEST AUROC: 0.926563, TEST Accus: 0.695739, TEST Senss: 0.880229, TEST Specs: 0.841919
AUROCs: Melanoma:0.879892 Melanocytic nevus:0.934894 Basal cell carcinoma:0.978831 Actinic keratosis:0.951262 Benign keratosis:0.916923 Dermatofibroma:0.827031 Vascular lesion:0.997106
Accus: Melanoma:0.683983 Melanocytic nevus:0.836175 Basal cell carcinoma:0.781818 Actinic keratosis:0.568966 Benign keratosis:0.686916 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.948052 Melanocytic nevus:0.974055 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.855140 Dermatofibroma:0.636364 Vascular lesion:0.967742
Specs: Melanoma:0.619955 Melanocytic nevus:0.653153 Basal cell carcinoma:0.935433 Actinic keratosis:0.951456 Benign keratosis:0.860078 Dermatofibroma:0.917210 Vascular lesion:0.956149
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_80.pth

Epoch: 80, iteration: 0/175, ==> train <===, loss: 3.522430, classification loss: 1.805431,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.154116,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020136,wcp loss: 0.000000,entropy loss: 1.850978,consistency weight: 1.000000, lr: 2.184745005283926e-08

Epoch: 80, iteration: 100/175, ==> train <===, loss: 3.557421, classification loss: 1.827355,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145483,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024349,wcp loss: 0.000000,entropy loss: 1.851200,consistency weight: 1.000000, lr: 2.184745005283926e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 495.0, 46.0, 24.0, 64.0, 8.0, 11.0]

VAL Student: Epoch: 80, iteration: 174

VAL AUROC: 0.898490, VAL Accus: 0.691103, VAL Senss: 0.799267, VAL Specs: 0.882980
AUROCs: Melanoma:0.863515 Melanocytic nevus:0.931218 Basal cell carcinoma:0.973025 Actinic keratosis:0.950801 Benign keratosis:0.895956 Dermatofibroma:0.781314 Vascular lesion:0.893604
Accus: Melanoma:0.638655 Melanocytic nevus:0.746606 Basal cell carcinoma:0.851852 Actinic keratosis:0.727273 Benign keratosis:0.640000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.806723 Melanocytic nevus:0.906486 Basal cell carcinoma:0.870370 Actinic keratosis:0.878788 Benign keratosis:0.770000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.700341 Melanocytic nevus:0.816024 Basal cell carcinoma:0.947146 Actinic keratosis:0.952430 Benign keratosis:0.876667 Dermatofibroma:0.929878 Vascular lesion:0.958376
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [173.0, 1015.0, 94.0, 31.0, 156.0, 9.0, 28.0]

TEST Student: Epoch: 80, iteration: 174

TEST AUROC: 0.919971, TEST Accus: 0.704521, TEST Senss: 0.883222, TEST Specs: 0.837892
AUROCs: Melanoma:0.880723 Melanocytic nevus:0.930968 Basal cell carcinoma:0.972398 Actinic keratosis:0.933598 Benign keratosis:0.913494 Dermatofibroma:0.813347 Vascular lesion:0.995269
Accus: Melanoma:0.748918 Melanocytic nevus:0.752409 Basal cell carcinoma:0.854545 Actinic keratosis:0.534483 Benign keratosis:0.728972 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.956710 Melanocytic nevus:0.940697 Basal cell carcinoma:0.927273 Actinic keratosis:0.862069 Benign keratosis:0.878505 Dermatofibroma:0.681818 Vascular lesion:0.935484
Specs: Melanoma:0.604260 Melanocytic nevus:0.761261 Basal cell carcinoma:0.900262 Actinic keratosis:0.942770 Benign keratosis:0.792338 Dermatofibroma:0.902158 Vascular lesion:0.962198
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_81.pth

Epoch: 81, iteration: 0/175, ==> train <===, loss: 3.552376, classification loss: 1.809679,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145413,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.036394,wcp loss: 0.000000,entropy loss: 1.851715,consistency weight: 1.000000, lr: 1.9662705047555335e-08

Epoch: 81, iteration: 100/175, ==> train <===, loss: 3.542384, classification loss: 1.809915,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146439,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026824,wcp loss: 0.000000,entropy loss: 1.852084,consistency weight: 1.000000, lr: 1.9662705047555335e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [81.0, 453.0, 44.0, 25.0, 66.0, 9.0, 11.0]

VAL Student: Epoch: 81, iteration: 174

VAL AUROC: 0.893362, VAL Accus: 0.698879, VAL Senss: 0.794068, VAL Specs: 0.883949
AUROCs: Melanoma:0.852183 Melanocytic nevus:0.930052 Basal cell carcinoma:0.974532 Actinic keratosis:0.944941 Benign keratosis:0.899667 Dermatofibroma:0.765053 Vascular lesion:0.887107
Accus: Melanoma:0.680672 Melanocytic nevus:0.683258 Basal cell carcinoma:0.814815 Actinic keratosis:0.757576 Benign keratosis:0.660000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Senss: Melanoma:0.798319 Melanocytic nevus:0.888386 Basal cell carcinoma:0.888889 Actinic keratosis:0.787879 Benign keratosis:0.770000 Dermatofibroma:0.625000 Vascular lesion:0.800000
Specs: Melanoma:0.696935 Melanocytic nevus:0.851632 Basal cell carcinoma:0.946089 Actinic keratosis:0.948294 Benign keratosis:0.877778 Dermatofibroma:0.913618 Vascular lesion:0.953299
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 949.0, 88.0, 32.0, 162.0, 9.0, 29.0]

TEST Student: Epoch: 81, iteration: 174

TEST AUROC: 0.915868, TEST Accus: 0.700197, TEST Senss: 0.889402, TEST Specs: 0.843318
AUROCs: Melanoma:0.859163 Melanocytic nevus:0.936726 Basal cell carcinoma:0.970761 Actinic keratosis:0.939818 Benign keratosis:0.908753 Dermatofibroma:0.798226 Vascular lesion:0.997626
Accus: Melanoma:0.744589 Melanocytic nevus:0.703484 Basal cell carcinoma:0.800000 Actinic keratosis:0.551724 Benign keratosis:0.757009 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.948052 Melanocytic nevus:0.928095 Basal cell carcinoma:0.927273 Actinic keratosis:0.862069 Benign keratosis:0.878505 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.612668 Melanocytic nevus:0.800300 Basal cell carcinoma:0.901312 Actinic keratosis:0.942259 Benign keratosis:0.808440 Dermatofibroma:0.880080 Vascular lesion:0.958165
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_82.pth

Epoch: 82, iteration: 0/175, ==> train <===, loss: 3.520546, classification loss: 1.784200,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139652,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022720,wcp loss: 0.000000,entropy loss: 1.853277,consistency weight: 1.000000, lr: 1.7696434542799804e-08

Epoch: 82, iteration: 100/175, ==> train <===, loss: 3.530799, classification loss: 1.802521,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146665,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024010,wcp loss: 0.000000,entropy loss: 1.850933,consistency weight: 1.000000, lr: 1.7696434542799804e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 512.0, 42.0, 22.0, 71.0, 5.0, 10.0]

VAL Student: Epoch: 82, iteration: 174

VAL AUROC: 0.887452, VAL Accus: 0.640813, VAL Senss: 0.766815, VAL Specs: 0.883287
AUROCs: Melanoma:0.839735 Melanocytic nevus:0.935985 Basal cell carcinoma:0.956699 Actinic keratosis:0.925637 Benign keratosis:0.899556 Dermatofibroma:0.745046 Vascular lesion:0.909509
Accus: Melanoma:0.579832 Melanocytic nevus:0.772247 Basal cell carcinoma:0.777778 Actinic keratosis:0.666667 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.806723 Melanocytic nevus:0.924585 Basal cell carcinoma:0.851852 Actinic keratosis:0.787879 Benign keratosis:0.830000 Dermatofibroma:0.500000 Vascular lesion:0.666667
Specs: Melanoma:0.695800 Melanocytic nevus:0.807122 Basal cell carcinoma:0.957717 Actinic keratosis:0.952430 Benign keratosis:0.852222 Dermatofibroma:0.954268 Vascular lesion:0.963452
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [164.0, 1052.0, 87.0, 32.0, 166.0, 8.0, 26.0]

TEST Student: Epoch: 82, iteration: 174

TEST AUROC: 0.915867, TEST Accus: 0.687211, TEST Senss: 0.858096, TEST Specs: 0.841229
AUROCs: Melanoma:0.863255 Melanocytic nevus:0.936240 Basal cell carcinoma:0.978253 Actinic keratosis:0.943241 Benign keratosis:0.911137 Dermatofibroma:0.784815 Vascular lesion:0.994130
Accus: Melanoma:0.709957 Melanocytic nevus:0.779837 Basal cell carcinoma:0.790909 Actinic keratosis:0.551724 Benign keratosis:0.775701 Dermatofibroma:0.363636 Vascular lesion:0.838710
Senss: Melanoma:0.952381 Melanocytic nevus:0.952557 Basal cell carcinoma:0.927273 Actinic keratosis:0.810345 Benign keratosis:0.883178 Dermatofibroma:0.545455 Vascular lesion:0.935484
Specs: Melanoma:0.596413 Melanocytic nevus:0.752252 Basal cell carcinoma:0.927034 Actinic keratosis:0.942770 Benign keratosis:0.780677 Dermatofibroma:0.924737 Vascular lesion:0.964718
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_83.pth

Epoch: 83, iteration: 0/175, ==> train <===, loss: 3.515519, classification loss: 1.789172,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145544,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020010,wcp loss: 0.000000,entropy loss: 1.851881,consistency weight: 1.000000, lr: 1.5926791088519824e-08

Epoch: 83, iteration: 100/175, ==> train <===, loss: 3.536486, classification loss: 1.811206,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147592,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022547,wcp loss: 0.000000,entropy loss: 1.850326,consistency weight: 1.000000, lr: 1.5926791088519824e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [84.0, 507.0, 34.0, 25.0, 58.0, 8.0, 12.0]

VAL Student: Epoch: 83, iteration: 174

VAL AUROC: 0.887959, VAL Accus: 0.676828, VAL Senss: 0.781045, VAL Specs: 0.879046
AUROCs: Melanoma:0.875533 Melanocytic nevus:0.942904 Basal cell carcinoma:0.937025 Actinic keratosis:0.916612 Benign keratosis:0.883233 Dermatofibroma:0.753874 Vascular lesion:0.906531
Accus: Melanoma:0.705882 Melanocytic nevus:0.764706 Basal cell carcinoma:0.629630 Actinic keratosis:0.757576 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.915966 Melanocytic nevus:0.950226 Basal cell carcinoma:0.740741 Actinic keratosis:0.787879 Benign keratosis:0.710000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.632236 Melanocytic nevus:0.756677 Basal cell carcinoma:0.976744 Actinic keratosis:0.958635 Benign keratosis:0.913333 Dermatofibroma:0.958333 Vascular lesion:0.957360
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [190.0, 1066.0, 81.0, 32.0, 140.0, 10.0, 28.0]

TEST Student: Epoch: 83, iteration: 174

TEST AUROC: 0.930008, TEST Accus: 0.701827, TEST Senss: 0.853339, TEST Specs: 0.840135
AUROCs: Melanoma:0.887617 Melanocytic nevus:0.938515 Basal cell carcinoma:0.978497 Actinic keratosis:0.950126 Benign keratosis:0.918066 Dermatofibroma:0.839575 Vascular lesion:0.997659
Accus: Melanoma:0.822511 Melanocytic nevus:0.790215 Basal cell carcinoma:0.736364 Actinic keratosis:0.551724 Benign keratosis:0.654206 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.987013 Melanocytic nevus:0.966642 Basal cell carcinoma:0.881818 Actinic keratosis:0.810345 Benign keratosis:0.859813 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.527466 Melanocytic nevus:0.686186 Basal cell carcinoma:0.959055 Actinic keratosis:0.958610 Benign keratosis:0.861188 Dermatofibroma:0.926744 Vascular lesion:0.961694
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_84.pth

Epoch: 84, iteration: 0/175, ==> train <===, loss: 3.518104, classification loss: 1.784143,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147770,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031528,wcp loss: 0.000000,entropy loss: 1.850203,consistency weight: 1.000000, lr: 1.4334111979667841e-08

Epoch: 84, iteration: 100/175, ==> train <===, loss: 3.534735, classification loss: 1.804621,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146583,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026572,wcp loss: 0.000000,entropy loss: 1.850125,consistency weight: 1.000000, lr: 1.4334111979667841e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 483.0, 42.0, 30.0, 51.0, 10.0, 11.0]

VAL Student: Epoch: 84, iteration: 174

VAL AUROC: 0.894526, VAL Accus: 0.694792, VAL Senss: 0.776056, VAL Specs: 0.881474
AUROCs: Melanoma:0.845601 Melanocytic nevus:0.931209 Basal cell carcinoma:0.977312 Actinic keratosis:0.972141 Benign keratosis:0.890344 Dermatofibroma:0.762640 Vascular lesion:0.882437
Accus: Melanoma:0.579832 Melanocytic nevus:0.728507 Basal cell carcinoma:0.777778 Actinic keratosis:0.909091 Benign keratosis:0.510000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.917044 Basal cell carcinoma:0.814815 Actinic keratosis:0.909091 Benign keratosis:0.660000 Dermatofibroma:0.625000 Vascular lesion:0.733333
Specs: Melanoma:0.774120 Melanocytic nevus:0.798220 Basal cell carcinoma:0.943975 Actinic keratosis:0.927611 Benign keratosis:0.925556 Dermatofibroma:0.824187 Vascular lesion:0.976650
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [154.0, 1010.0, 93.0, 38.0, 140.0, 13.0, 28.0]

TEST Student: Epoch: 84, iteration: 174

TEST AUROC: 0.919777, TEST Accus: 0.723477, TEST Senss: 0.894057, TEST Specs: 0.839618
AUROCs: Melanoma:0.878813 Melanocytic nevus:0.940228 Basal cell carcinoma:0.963842 Actinic keratosis:0.953509 Benign keratosis:0.911999 Dermatofibroma:0.791463 Vascular lesion:0.998585
Accus: Melanoma:0.666667 Melanocytic nevus:0.748703 Basal cell carcinoma:0.845455 Actinic keratosis:0.655172 Benign keratosis:0.654206 Dermatofibroma:0.590909 Vascular lesion:0.903226
Senss: Melanoma:0.909091 Melanocytic nevus:0.946627 Basal cell carcinoma:0.945455 Actinic keratosis:0.862069 Benign keratosis:0.822430 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.678812 Melanocytic nevus:0.734234 Basal cell carcinoma:0.913911 Actinic keratosis:0.918242 Benign keratosis:0.864520 Dermatofibroma:0.785750 Vascular lesion:0.981855
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_85.pth

Epoch: 85, iteration: 0/175, ==> train <===, loss: 3.532736, classification loss: 1.798513,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.151400,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032330,wcp loss: 0.000000,entropy loss: 1.853292,consistency weight: 1.000000, lr: 1.2900700781701057e-08

Epoch: 85, iteration: 100/175, ==> train <===, loss: 3.535264, classification loss: 1.808613,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146512,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022784,wcp loss: 0.000000,entropy loss: 1.850379,consistency weight: 1.000000, lr: 1.2900700781701057e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [80.0, 461.0, 47.0, 27.0, 61.0, 7.0, 11.0]

VAL Student: Epoch: 85, iteration: 174

VAL AUROC: 0.893774, VAL Accus: 0.690997, VAL Senss: 0.797134, VAL Specs: 0.887026
AUROCs: Melanoma:0.850065 Melanocytic nevus:0.922692 Basal cell carcinoma:0.972046 Actinic keratosis:0.969666 Benign keratosis:0.888222 Dermatofibroma:0.774200 Vascular lesion:0.879526
Accus: Melanoma:0.672269 Melanocytic nevus:0.695324 Basal cell carcinoma:0.870370 Actinic keratosis:0.818182 Benign keratosis:0.610000 Dermatofibroma:0.437500 Vascular lesion:0.733333
Senss: Melanoma:0.773109 Melanocytic nevus:0.877828 Basal cell carcinoma:0.907407 Actinic keratosis:0.909091 Benign keratosis:0.750000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.719637 Melanocytic nevus:0.857567 Basal cell carcinoma:0.922833 Actinic keratosis:0.943123 Benign keratosis:0.901111 Dermatofibroma:0.938008 Vascular lesion:0.926904
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [167.0, 979.0, 97.0, 33.0, 147.0, 7.0, 29.0]

TEST Student: Epoch: 85, iteration: 174

TEST AUROC: 0.909521, TEST Accus: 0.691433, TEST Senss: 0.865151, TEST Specs: 0.840247
AUROCs: Melanoma:0.861405 Melanocytic nevus:0.933343 Basal cell carcinoma:0.969563 Actinic keratosis:0.940171 Benign keratosis:0.907633 Dermatofibroma:0.760936 Vascular lesion:0.993594
Accus: Melanoma:0.722944 Melanocytic nevus:0.725723 Basal cell carcinoma:0.881818 Actinic keratosis:0.568966 Benign keratosis:0.686916 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.930736 Melanocytic nevus:0.918458 Basal cell carcinoma:0.954545 Actinic keratosis:0.879310 Benign keratosis:0.859813 Dermatofibroma:0.545455 Vascular lesion:0.967742
Specs: Melanoma:0.639574 Melanocytic nevus:0.813814 Basal cell carcinoma:0.855643 Actinic keratosis:0.929484 Benign keratosis:0.826763 Dermatofibroma:0.906172 Vascular lesion:0.910282
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_86.pth

Epoch: 86, iteration: 0/175, ==> train <===, loss: 3.536784, classification loss: 1.805106,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.142707,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021329,wcp loss: 0.000000,entropy loss: 1.853056,consistency weight: 1.000000, lr: 1.1610630703530951e-08

Epoch: 86, iteration: 100/175, ==> train <===, loss: 3.535175, classification loss: 1.805863,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145769,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024940,wcp loss: 0.000000,entropy loss: 1.850142,consistency weight: 1.000000, lr: 1.1610630703530951e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [90.0, 504.0, 46.0, 27.0, 41.0, 9.0, 10.0]

VAL Student: Epoch: 86, iteration: 174

VAL AUROC: 0.884912, VAL Accus: 0.689383, VAL Senss: 0.769630, VAL Specs: 0.881771
AUROCs: Melanoma:0.876029 Melanocytic nevus:0.935175 Basal cell carcinoma:0.975217 Actinic keratosis:0.966438 Benign keratosis:0.828122 Dermatofibroma:0.761560 Vascular lesion:0.851844
Accus: Melanoma:0.756303 Melanocytic nevus:0.760181 Basal cell carcinoma:0.851852 Actinic keratosis:0.818182 Benign keratosis:0.410000 Dermatofibroma:0.562500 Vascular lesion:0.666667
Senss: Melanoma:0.857143 Melanocytic nevus:0.930618 Basal cell carcinoma:0.888889 Actinic keratosis:0.909091 Benign keratosis:0.510000 Dermatofibroma:0.625000 Vascular lesion:0.666667
Specs: Melanoma:0.674234 Melanocytic nevus:0.774481 Basal cell carcinoma:0.939746 Actinic keratosis:0.945191 Benign keratosis:0.967778 Dermatofibroma:0.899390 Vascular lesion:0.971574
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [186.0, 1019.0, 96.0, 36.0, 95.0, 11.0, 28.0]

TEST Student: Epoch: 86, iteration: 174

TEST AUROC: 0.924998, TEST Accus: 0.700162, TEST Senss: 0.875589, TEST Specs: 0.843121
AUROCs: Melanoma:0.881768 Melanocytic nevus:0.935703 Basal cell carcinoma:0.972510 Actinic keratosis:0.953201 Benign keratosis:0.908833 Dermatofibroma:0.826985 Vascular lesion:0.995984
Accus: Melanoma:0.805195 Melanocytic nevus:0.755374 Basal cell carcinoma:0.872727 Actinic keratosis:0.620690 Benign keratosis:0.443925 Dermatofibroma:0.500000 Vascular lesion:0.903226
Senss: Melanoma:0.961039 Melanocytic nevus:0.956264 Basal cell carcinoma:0.945455 Actinic keratosis:0.879310 Benign keratosis:0.724299 Dermatofibroma:0.727273 Vascular lesion:0.935484
Specs: Melanoma:0.588565 Melanocytic nevus:0.699700 Basal cell carcinoma:0.889239 Actinic keratosis:0.935616 Benign keratosis:0.943365 Dermatofibroma:0.866031 Vascular lesion:0.979335
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_87.pth

Epoch: 87, iteration: 0/175, ==> train <===, loss: 3.538688, classification loss: 1.786420,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.139157,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.036960,wcp loss: 0.000000,entropy loss: 1.854465,consistency weight: 1.000000, lr: 1.0449567633177856e-08

Epoch: 87, iteration: 100/175, ==> train <===, loss: 3.544170, classification loss: 1.814483,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146418,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024828,wcp loss: 0.000000,entropy loss: 1.851278,consistency weight: 1.000000, lr: 1.0449567633177856e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 551.0, 42.0, 26.0, 48.0, 8.0, 11.0]

VAL Student: Epoch: 87, iteration: 174

VAL AUROC: 0.889748, VAL Accus: 0.668784, VAL Senss: 0.784487, VAL Specs: 0.876155
AUROCs: Melanoma:0.865918 Melanocytic nevus:0.938540 Basal cell carcinoma:0.979446 Actinic keratosis:0.964652 Benign keratosis:0.849444 Dermatofibroma:0.742251 Vascular lesion:0.887986
Accus: Melanoma:0.571429 Melanocytic nevus:0.831071 Basal cell carcinoma:0.777778 Actinic keratosis:0.787879 Benign keratosis:0.480000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.848739 Melanocytic nevus:0.969834 Basal cell carcinoma:0.851852 Actinic keratosis:0.848485 Benign keratosis:0.610000 Dermatofibroma:0.562500 Vascular lesion:0.800000
Specs: Melanoma:0.703746 Melanocytic nevus:0.697329 Basal cell carcinoma:0.955603 Actinic keratosis:0.960703 Benign keratosis:0.947778 Dermatofibroma:0.910569 Vascular lesion:0.957360
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [165.0, 1139.0, 90.0, 32.0, 124.0, 10.0, 29.0]

TEST Student: Epoch: 87, iteration: 174

TEST AUROC: 0.929018, TEST Accus: 0.699713, TEST Senss: 0.874445, TEST Specs: 0.835917
AUROCs: Melanoma:0.885167 Melanocytic nevus:0.937924 Basal cell carcinoma:0.974531 Actinic keratosis:0.958910 Benign keratosis:0.922805 Dermatofibroma:0.825982 Vascular lesion:0.997805
Accus: Melanoma:0.714286 Melanocytic nevus:0.844329 Basal cell carcinoma:0.818182 Actinic keratosis:0.551724 Benign keratosis:0.579439 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.943723 Melanocytic nevus:0.977761 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.808411 Dermatofibroma:0.636364 Vascular lesion:1.000000
Specs: Melanoma:0.614910 Melanocytic nevus:0.594595 Basal cell carcinoma:0.931759 Actinic keratosis:0.958099 Benign keratosis:0.907274 Dermatofibroma:0.883593 Vascular lesion:0.961190
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_88.pth

Epoch: 88, iteration: 0/175, ==> train <===, loss: 3.543555, classification loss: 1.792964,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.145639,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.039140,wcp loss: 0.000000,entropy loss: 1.857090,consistency weight: 1.000000, lr: 9.40461086986007e-09

Epoch: 88, iteration: 100/175, ==> train <===, loss: 3.546957, classification loss: 1.814648,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146345,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027029,wcp loss: 0.000000,entropy loss: 1.851625,consistency weight: 1.000000, lr: 9.40461086986007e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 542.0, 41.0, 24.0, 54.0, 8.0, 12.0]

VAL Student: Epoch: 88, iteration: 174

VAL AUROC: 0.892976, VAL Accus: 0.668835, VAL Senss: 0.774685, VAL Specs: 0.879044
AUROCs: Melanoma:0.868818 Melanocytic nevus:0.924397 Basal cell carcinoma:0.969227 Actinic keratosis:0.947040 Benign keratosis:0.872967 Dermatofibroma:0.766387 Vascular lesion:0.901997
Accus: Melanoma:0.537815 Melanocytic nevus:0.817496 Basal cell carcinoma:0.759259 Actinic keratosis:0.727273 Benign keratosis:0.540000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Senss: Melanoma:0.789916 Melanocytic nevus:0.959276 Basal cell carcinoma:0.814815 Actinic keratosis:0.878788 Benign keratosis:0.680000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.761635 Melanocytic nevus:0.729970 Basal cell carcinoma:0.966173 Actinic keratosis:0.963806 Benign keratosis:0.927778 Dermatofibroma:0.885163 Vascular lesion:0.918782
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [150.0, 1127.0, 84.0, 31.0, 145.0, 11.0, 30.0]

TEST Student: Epoch: 88, iteration: 174

TEST AUROC: 0.927051, TEST Accus: 0.704031, TEST Senss: 0.895107, TEST Specs: 0.834345
AUROCs: Melanoma:0.887985 Melanocytic nevus:0.933854 Basal cell carcinoma:0.971611 Actinic keratosis:0.948928 Benign keratosis:0.922873 Dermatofibroma:0.826814 Vascular lesion:0.997293
Accus: Melanoma:0.649351 Melanocytic nevus:0.835434 Basal cell carcinoma:0.763636 Actinic keratosis:0.534483 Benign keratosis:0.677570 Dermatofibroma:0.500000 Vascular lesion:0.967742
Senss: Melanoma:0.926407 Melanocytic nevus:0.971831 Basal cell carcinoma:0.918182 Actinic keratosis:0.844828 Benign keratosis:0.831776 Dermatofibroma:0.772727 Vascular lesion:1.000000
Specs: Melanoma:0.664238 Melanocytic nevus:0.647147 Basal cell carcinoma:0.941207 Actinic keratosis:0.957077 Benign keratosis:0.875069 Dermatofibroma:0.859508 Vascular lesion:0.896169
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_89.pth

Epoch: 89, iteration: 0/175, ==> train <===, loss: 3.568669, classification loss: 1.822032,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.144654,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.037269,wcp loss: 0.000000,entropy loss: 1.854022,consistency weight: 1.000000, lr: 8.464149782874063e-09

Epoch: 89, iteration: 100/175, ==> train <===, loss: 3.538430, classification loss: 1.807655,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.146735,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025826,wcp loss: 0.000000,entropy loss: 1.851684,consistency weight: 1.000000, lr: 8.464149782874063e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [78.0, 487.0, 43.0, 24.0, 67.0, 8.0, 11.0]

VAL Student: Epoch: 89, iteration: 174

VAL AUROC: 0.893887, VAL Accus: 0.688129, VAL Senss: 0.773835, VAL Specs: 0.888476
AUROCs: Melanoma:0.848425 Melanocytic nevus:0.937748 Basal cell carcinoma:0.963942 Actinic keratosis:0.933189 Benign keratosis:0.901622 Dermatofibroma:0.776105 Vascular lesion:0.896176
Accus: Melanoma:0.655462 Melanocytic nevus:0.734540 Basal cell carcinoma:0.796296 Actinic keratosis:0.727273 Benign keratosis:0.670000 Dermatofibroma:0.500000 Vascular lesion:0.733333
Senss: Melanoma:0.815126 Melanocytic nevus:0.904977 Basal cell carcinoma:0.833333 Actinic keratosis:0.757576 Benign keratosis:0.810000 Dermatofibroma:0.562500 Vascular lesion:0.733333
Specs: Melanoma:0.704881 Melanocytic nevus:0.836795 Basal cell carcinoma:0.954545 Actinic keratosis:0.956567 Benign keratosis:0.860000 Dermatofibroma:0.945122 Vascular lesion:0.961421
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [169.0, 1007.0, 89.0, 32.0, 165.0, 8.0, 28.0]

TEST Student: Epoch: 89, iteration: 174

TEST AUROC: 0.918052, TEST Accus: 0.696684, TEST Senss: 0.865827, TEST Specs: 0.845448
AUROCs: Melanoma:0.866441 Melanocytic nevus:0.941490 Basal cell carcinoma:0.974092 Actinic keratosis:0.938735 Benign keratosis:0.911755 Dermatofibroma:0.798727 Vascular lesion:0.995122
Accus: Melanoma:0.731602 Melanocytic nevus:0.746479 Basal cell carcinoma:0.809091 Actinic keratosis:0.551724 Benign keratosis:0.771028 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.948052 Melanocytic nevus:0.939214 Basal cell carcinoma:0.936364 Actinic keratosis:0.827586 Benign keratosis:0.883178 Dermatofibroma:0.590909 Vascular lesion:0.935484
Specs: Melanoma:0.609865 Melanocytic nevus:0.774775 Basal cell carcinoma:0.916535 Actinic keratosis:0.946346 Benign keratosis:0.785675 Dermatofibroma:0.919719 Vascular lesion:0.965222
save model to ../model/skin_0722_frac02_BNM_w10_vat_ent_batch32_densenet121/checkpoint/epoch_90.pth

Epoch: 90, iteration: 0/175, ==> train <===, loss: 3.509479, classification loss: 1.796508,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.148558,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012414,wcp loss: 0.000000,entropy loss: 1.849115,consistency weight: 1.000000, lr: 7.617734804586658e-09

Epoch: 90, iteration: 100/175, ==> train <===, loss: 3.540733, classification loss: 1.811494,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.147357,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025550,wcp loss: 0.000000,entropy loss: 1.851047,consistency weight: 1.000000, lr: 7.617734804586658e-09
