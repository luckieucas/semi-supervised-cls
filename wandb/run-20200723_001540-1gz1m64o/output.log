create semi supervised model
create semi supervised model
single label  Total # images:7000, labels:7000
single label  Total # images:1000, labels:1000
single label  Total # images:2015, labels:2015
train_dataset len: 7000
labeled_num: 700

Epoch: 0, iteration: 0/87, ==> train <===, loss: 1.940537, classification loss: 1.940537,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 0.0001
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [38.0, 446.0, 29.0, 22.0, 64.0, 0.0, 0.0]

VAL Student: Epoch: 0, iteration: 86

VAL AUROC: 0.793872, VAL Accus: 0.405104, VAL Senss: 0.558496, VAL Specs: 0.863721
AUROCs: Melanoma:0.771850 Melanocytic nevus:0.874950 Basal cell carcinoma:0.909013 Actinic keratosis:0.943217 Benign keratosis:0.820378 Dermatofibroma:0.459286 Vascular lesion:0.778409
Accus: Melanoma:0.319328 Melanocytic nevus:0.672700 Basal cell carcinoma:0.537037 Actinic keratosis:0.666667 Benign keratosis:0.640000 Dermatofibroma:0.000000 Vascular lesion:0.000000
Senss: Melanoma:0.579832 Melanocytic nevus:0.701357 Basal cell carcinoma:0.888889 Actinic keratosis:0.939394 Benign keratosis:0.800000 Dermatofibroma:0.000000 Vascular lesion:0.000000
Specs: Melanoma:0.800227 Melanocytic nevus:0.884273 Basal cell carcinoma:0.805497 Actinic keratosis:0.879007 Benign keratosis:0.681111 Dermatofibroma:0.995935 Vascular lesion:1.000000
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [63.0, 854.0, 60.0, 31.0, 145.0, 0.0, 0.0]

TEST Student: Epoch: 0, iteration: 86

TEST AUROC: 0.821356, TEST Accus: 0.380471, TEST Senss: 0.954982, TEST Specs: 0.228288
AUROCs: Melanoma:0.792589 Melanocytic nevus:0.877619 Basal cell carcinoma:0.889234 Actinic keratosis:0.919405 Benign keratosis:0.849440 Dermatofibroma:0.563586 Vascular lesion:0.857619
Accus: Melanoma:0.272727 Melanocytic nevus:0.633062 Basal cell carcinoma:0.545455 Actinic keratosis:0.534483 Benign keratosis:0.677570 Dermatofibroma:0.000000 Vascular lesion:0.000000
Senss: Melanoma:1.000000 Melanocytic nevus:0.944403 Basal cell carcinoma:1.000000 Actinic keratosis:1.000000 Benign keratosis:1.000000 Dermatofibroma:0.772727 Vascular lesion:0.967742
Specs: Melanoma:0.011771 Melanocytic nevus:0.429429 Basal cell carcinoma:0.169029 Actinic keratosis:0.109862 Benign keratosis:0.005552 Dermatofibroma:0.356749 Vascular lesion:0.515625
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_1.pth

Epoch: 1, iteration: 0/87, ==> train <===, loss: 1.913160, classification loss: 1.913160,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 9e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 476.0, 20.0, 25.0, 50.0, 1.0, 11.0]

VAL Student: Epoch: 1, iteration: 86

VAL AUROC: 0.846006, VAL Accus: 0.516045, VAL Senss: 0.664907, VAL Specs: 0.861299
AUROCs: Melanoma:0.811835 Melanocytic nevus:0.881628 Basal cell carcinoma:0.926004 Actinic keratosis:0.928739 Benign keratosis:0.858356 Dermatofibroma:0.587970 Vascular lesion:0.927513
Accus: Melanoma:0.470588 Melanocytic nevus:0.717949 Basal cell carcinoma:0.370370 Actinic keratosis:0.757576 Benign keratosis:0.500000 Dermatofibroma:0.062500 Vascular lesion:0.733333
Senss: Melanoma:0.697479 Melanocytic nevus:0.832579 Basal cell carcinoma:0.777778 Actinic keratosis:0.818182 Benign keratosis:0.670000 Dermatofibroma:0.125000 Vascular lesion:0.733333
Specs: Melanoma:0.794552 Melanocytic nevus:0.753709 Basal cell carcinoma:0.866808 Actinic keratosis:0.873837 Benign keratosis:0.860000 Dermatofibroma:0.985772 Vascular lesion:0.894416
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [109.0, 896.0, 56.0, 36.0, 132.0, 1.0, 29.0]

TEST Student: Epoch: 1, iteration: 86

TEST AUROC: 0.855136, TEST Accus: 0.551943, TEST Senss: 0.902730, TEST Specs: 0.426578
AUROCs: Melanoma:0.803540 Melanocytic nevus:0.895614 Basal cell carcinoma:0.931339 Actinic keratosis:0.892076 Benign keratosis:0.867841 Dermatofibroma:0.615267 Vascular lesion:0.980278
Accus: Melanoma:0.471861 Melanocytic nevus:0.664196 Basal cell carcinoma:0.509091 Actinic keratosis:0.620690 Benign keratosis:0.616822 Dermatofibroma:0.045455 Vascular lesion:0.935484
Senss: Melanoma:0.952381 Melanocytic nevus:0.961453 Basal cell carcinoma:0.981818 Actinic keratosis:0.965517 Benign keratosis:0.957944 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.286435 Melanocytic nevus:0.424925 Basal cell carcinoma:0.433596 Actinic keratosis:0.359223 Benign keratosis:0.410328 Dermatofibroma:0.562469 Vascular lesion:0.509073
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_2.pth

Epoch: 2, iteration: 0/87, ==> train <===, loss: 1.935019, classification loss: 1.935019,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 8.1e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 445.0, 35.0, 22.0, 59.0, 1.0, 9.0]

VAL Student: Epoch: 2, iteration: 86

VAL AUROC: 0.850204, VAL Accus: 0.539474, VAL Senss: 0.692522, VAL Specs: 0.869177
AUROCs: Melanoma:0.782490 Melanocytic nevus:0.903926 Basal cell carcinoma:0.951824 Actinic keratosis:0.941368 Benign keratosis:0.834511 Dermatofibroma:0.655615 Vascular lesion:0.881692
Accus: Melanoma:0.537815 Melanocytic nevus:0.671192 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.590000 Dermatofibroma:0.062500 Vascular lesion:0.600000
Senss: Melanoma:0.680672 Melanocytic nevus:0.811463 Basal cell carcinoma:0.870370 Actinic keratosis:0.848485 Benign keratosis:0.720000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Specs: Melanoma:0.750284 Melanocytic nevus:0.830861 Basal cell carcinoma:0.885835 Actinic keratosis:0.889349 Benign keratosis:0.812222 Dermatofibroma:0.951220 Vascular lesion:0.964467
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 875.0, 65.0, 42.0, 132.0, 6.0, 22.0]

TEST Student: Epoch: 2, iteration: 86

TEST AUROC: 0.867501, TEST Accus: 0.590619, TEST Senss: 0.894556, TEST Specs: 0.586864
AUROCs: Melanoma:0.814850 Melanocytic nevus:0.906486 Basal cell carcinoma:0.929821 Actinic keratosis:0.921370 Benign keratosis:0.856814 Dermatofibroma:0.690234 Vascular lesion:0.952930
Accus: Melanoma:0.571429 Melanocytic nevus:0.648629 Basal cell carcinoma:0.590909 Actinic keratosis:0.724138 Benign keratosis:0.616822 Dermatofibroma:0.272727 Vascular lesion:0.709677
Senss: Melanoma:0.948052 Melanocytic nevus:0.945886 Basal cell carcinoma:0.972727 Actinic keratosis:0.948276 Benign keratosis:0.920561 Dermatofibroma:0.590909 Vascular lesion:0.935484
Specs: Melanoma:0.439462 Melanocytic nevus:0.596096 Basal cell carcinoma:0.609974 Actinic keratosis:0.621870 Benign keratosis:0.525819 Dermatofibroma:0.598595 Vascular lesion:0.716230
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_3.pth

Epoch: 3, iteration: 0/87, ==> train <===, loss: 1.930994, classification loss: 1.930994,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 7.290000000000001e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 497.0, 39.0, 16.0, 55.0, 3.0, 11.0]

VAL Student: Epoch: 3, iteration: 86

VAL AUROC: 0.826518, VAL Accus: 0.580883, VAL Senss: 0.708376, VAL Specs: 0.881678
AUROCs: Melanoma:0.846565 Melanocytic nevus:0.914945 Basal cell carcinoma:0.965938 Actinic keratosis:0.794961 Benign keratosis:0.874489 Dermatofibroma:0.480437 Vascular lesion:0.908291
Accus: Melanoma:0.638655 Melanocytic nevus:0.749623 Basal cell carcinoma:0.722222 Actinic keratosis:0.484848 Benign keratosis:0.550000 Dermatofibroma:0.187500 Vascular lesion:0.733333
Senss: Melanoma:0.806723 Melanocytic nevus:0.853695 Basal cell carcinoma:0.851852 Actinic keratosis:0.636364 Benign keratosis:0.760000 Dermatofibroma:0.250000 Vascular lesion:0.800000
Specs: Melanoma:0.721907 Melanocytic nevus:0.813056 Basal cell carcinoma:0.914376 Actinic keratosis:0.956567 Benign keratosis:0.840000 Dermatofibroma:0.955285 Vascular lesion:0.970558
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [163.0, 966.0, 86.0, 26.0, 122.0, 5.0, 28.0]

TEST Student: Epoch: 3, iteration: 86

TEST AUROC: 0.866924, TEST Accus: 0.621771, TEST Senss: 0.860013, TEST Specs: 0.686272
AUROCs: Melanoma:0.869142 Melanocytic nevus:0.917697 Basal cell carcinoma:0.961861 Actinic keratosis:0.863725 Benign keratosis:0.892466 Dermatofibroma:0.568490 Vascular lesion:0.995090
Accus: Melanoma:0.705628 Melanocytic nevus:0.716086 Basal cell carcinoma:0.781818 Actinic keratosis:0.448276 Benign keratosis:0.570093 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.969697 Melanocytic nevus:0.939956 Basal cell carcinoma:0.990909 Actinic keratosis:0.775862 Benign keratosis:0.934579 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.397422 Melanocytic nevus:0.689189 Basal cell carcinoma:0.790026 Actinic keratosis:0.790496 Benign keratosis:0.569128 Dermatofibroma:0.755143 Vascular lesion:0.812500
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_4.pth

Epoch: 4, iteration: 0/87, ==> train <===, loss: 1.843418, classification loss: 1.843418,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 6.561000000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 492.0, 31.0, 24.0, 62.0, 2.0, 9.0]

VAL Student: Epoch: 4, iteration: 86

VAL AUROC: 0.877464, VAL Accus: 0.568095, VAL Senss: 0.718176, VAL Specs: 0.895493
AUROCs: Melanoma:0.818550 Melanocytic nevus:0.922191 Basal cell carcinoma:0.927218 Actinic keratosis:0.961612 Benign keratosis:0.857533 Dermatofibroma:0.751524 Vascular lesion:0.903621
Accus: Melanoma:0.588235 Melanocytic nevus:0.742081 Basal cell carcinoma:0.574074 Actinic keratosis:0.727273 Benign keratosis:0.620000 Dermatofibroma:0.125000 Vascular lesion:0.600000
Senss: Melanoma:0.747899 Melanocytic nevus:0.844646 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.759364 Melanocytic nevus:0.830861 Basal cell carcinoma:0.958774 Actinic keratosis:0.915202 Benign keratosis:0.837778 Dermatofibroma:0.977642 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 953.0, 60.0, 44.0, 133.0, 5.0, 25.0]

TEST Student: Epoch: 4, iteration: 86

TEST AUROC: 0.883126, TEST Accus: 0.615205, TEST Senss: 0.852244, TEST Specs: 0.742637
AUROCs: Melanoma:0.843925 Melanocytic nevus:0.928072 Basal cell carcinoma:0.929912 Actinic keratosis:0.923995 Benign keratosis:0.865742 Dermatofibroma:0.722689 Vascular lesion:0.967547
Accus: Melanoma:0.640693 Melanocytic nevus:0.706449 Basal cell carcinoma:0.545455 Actinic keratosis:0.758621 Benign keratosis:0.621495 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.943723 Melanocytic nevus:0.925130 Basal cell carcinoma:0.881818 Actinic keratosis:0.913793 Benign keratosis:0.911215 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.489350 Melanocytic nevus:0.720721 Basal cell carcinoma:0.875591 Actinic keratosis:0.834951 Benign keratosis:0.561355 Dermatofibroma:0.831410 Vascular lesion:0.885081
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_5.pth

Epoch: 5, iteration: 0/87, ==> train <===, loss: 1.871700, classification loss: 1.871700,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.904900000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [73.0, 511.0, 32.0, 18.0, 50.0, 7.0, 12.0]

VAL Student: Epoch: 5, iteration: 86

VAL AUROC: 0.844152, VAL Accus: 0.608533, VAL Senss: 0.707290, VAL Specs: 0.889091
AUROCs: Melanoma:0.826019 Melanocytic nevus:0.926622 Basal cell carcinoma:0.947126 Actinic keratosis:0.861834 Benign keratosis:0.828067 Dermatofibroma:0.670668 Vascular lesion:0.848731
Accus: Melanoma:0.613445 Melanocytic nevus:0.770739 Basal cell carcinoma:0.592593 Actinic keratosis:0.545455 Benign keratosis:0.500000 Dermatofibroma:0.437500 Vascular lesion:0.800000
Senss: Melanoma:0.764706 Melanocytic nevus:0.897436 Basal cell carcinoma:0.722222 Actinic keratosis:0.666667 Benign keratosis:0.600000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.724177 Melanocytic nevus:0.777448 Basal cell carcinoma:0.959831 Actinic keratosis:0.948294 Benign keratosis:0.891111 Dermatofibroma:0.934959 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [156.0, 1013.0, 73.0, 33.0, 116.0, 7.0, 25.0]

TEST Student: Epoch: 5, iteration: 86

TEST AUROC: 0.885593, TEST Accus: 0.617935, TEST Senss: 0.850755, TEST Specs: 0.760637
AUROCs: Melanoma:0.857313 Melanocytic nevus:0.923915 Basal cell carcinoma:0.946471 Actinic keratosis:0.900737 Benign keratosis:0.866489 Dermatofibroma:0.720796 Vascular lesion:0.983432
Accus: Melanoma:0.675325 Melanocytic nevus:0.750927 Basal cell carcinoma:0.663636 Actinic keratosis:0.568966 Benign keratosis:0.542056 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.943723 Melanocytic nevus:0.965901 Basal cell carcinoma:0.881818 Actinic keratosis:0.810345 Benign keratosis:0.827103 Dermatofibroma:0.590909 Vascular lesion:0.935484
Specs: Melanoma:0.507287 Melanocytic nevus:0.588589 Basal cell carcinoma:0.858793 Actinic keratosis:0.871231 Benign keratosis:0.782898 Dermatofibroma:0.791771 Vascular lesion:0.923891
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_6.pth

Epoch: 6, iteration: 0/87, ==> train <===, loss: 1.848934, classification loss: 1.848934,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.314410000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 538.0, 30.0, 17.0, 47.0, 6.0, 12.0]

VAL Student: Epoch: 6, iteration: 86

VAL AUROC: 0.847146, VAL Accus: 0.581913, VAL Senss: 0.679733, VAL Specs: 0.899938
AUROCs: Melanoma:0.851630 Melanocytic nevus:0.921555 Basal cell carcinoma:0.909385 Actinic keratosis:0.878788 Benign keratosis:0.856400 Dermatofibroma:0.670033 Vascular lesion:0.842234
Accus: Melanoma:0.546218 Melanocytic nevus:0.811463 Basal cell carcinoma:0.555556 Actinic keratosis:0.515152 Benign keratosis:0.470000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.885370 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.650000 Dermatofibroma:0.437500 Vascular lesion:0.800000
Specs: Melanoma:0.793417 Melanocytic nevus:0.768546 Basal cell carcinoma:0.968288 Actinic keratosis:0.948294 Benign keratosis:0.891111 Dermatofibroma:0.963415 Vascular lesion:0.966497
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1077.0, 66.0, 33.0, 113.0, 6.0, 30.0]

TEST Student: Epoch: 6, iteration: 86

TEST AUROC: 0.886775, TEST Accus: 0.622745, TEST Senss: 0.870268, TEST Specs: 0.772727
AUROCs: Melanoma:0.860103 Melanocytic nevus:0.916658 Basal cell carcinoma:0.917561 Actinic keratosis:0.903811 Benign keratosis:0.881177 Dermatofibroma:0.732062 Vascular lesion:0.996049
Accus: Melanoma:0.623377 Melanocytic nevus:0.798369 Basal cell carcinoma:0.600000 Actinic keratosis:0.568966 Benign keratosis:0.528037 Dermatofibroma:0.272727 Vascular lesion:0.967742
Senss: Melanoma:0.922078 Melanocytic nevus:0.954040 Basal cell carcinoma:0.818182 Actinic keratosis:0.879310 Benign keratosis:0.836449 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.586883 Melanocytic nevus:0.609610 Basal cell carcinoma:0.895538 Actinic keratosis:0.866633 Benign keratosis:0.744031 Dermatofibroma:0.835424 Vascular lesion:0.870968
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_7.pth

Epoch: 7, iteration: 0/87, ==> train <===, loss: 1.825244, classification loss: 1.825244,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.782969000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 475.0, 25.0, 26.0, 44.0, 5.0, 12.0]

VAL Student: Epoch: 7, iteration: 86

VAL AUROC: 0.839829, VAL Accus: 0.582058, VAL Senss: 0.669930, VAL Specs: 0.901661
AUROCs: Melanoma:0.817511 Melanocytic nevus:0.924191 Basal cell carcinoma:0.918272 Actinic keratosis:0.952023 Benign keratosis:0.794344 Dermatofibroma:0.633003 Vascular lesion:0.839459
Accus: Melanoma:0.554622 Melanocytic nevus:0.716440 Basal cell carcinoma:0.462963 Actinic keratosis:0.787879 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.811463 Basal cell carcinoma:0.592593 Actinic keratosis:0.909091 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.802497 Melanocytic nevus:0.878338 Basal cell carcinoma:0.950317 Actinic keratosis:0.872802 Benign keratosis:0.877778 Dermatofibroma:0.946138 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 946.0, 72.0, 46.0, 120.0, 6.0, 26.0]

TEST Student: Epoch: 7, iteration: 86

TEST AUROC: 0.878642, TEST Accus: 0.629358, TEST Senss: 0.833331, TEST Specs: 0.797643
AUROCs: Melanoma:0.842438 Melanocytic nevus:0.928666 Basal cell carcinoma:0.937919 Actinic keratosis:0.927766 Benign keratosis:0.825738 Dermatofibroma:0.709688 Vascular lesion:0.978278
Accus: Melanoma:0.584416 Melanocytic nevus:0.701260 Basal cell carcinoma:0.654545 Actinic keratosis:0.793103 Benign keratosis:0.560748 Dermatofibroma:0.272727 Vascular lesion:0.838710
Senss: Melanoma:0.883117 Melanocytic nevus:0.884359 Basal cell carcinoma:0.890909 Actinic keratosis:0.931034 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.644058 Melanocytic nevus:0.786787 Basal cell carcinoma:0.857218 Actinic keratosis:0.784875 Benign keratosis:0.703498 Dermatofibroma:0.865028 Vascular lesion:0.942036
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_8.pth

Epoch: 8, iteration: 0/87, ==> train <===, loss: 1.830860, classification loss: 1.830860,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.304672100000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 546.0, 29.0, 23.0, 46.0, 6.0, 12.0]

VAL Student: Epoch: 8, iteration: 86

VAL AUROC: 0.866203, VAL Accus: 0.603135, VAL Senss: 0.689871, VAL Specs: 0.907010
AUROCs: Melanoma:0.844438 Melanocytic nevus:0.925104 Basal cell carcinoma:0.925202 Actinic keratosis:0.937921 Benign keratosis:0.864589 Dermatofibroma:0.705793 Vascular lesion:0.860372
Accus: Melanoma:0.529412 Melanocytic nevus:0.823529 Basal cell carcinoma:0.537037 Actinic keratosis:0.696970 Benign keratosis:0.460000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.901961 Basal cell carcinoma:0.685185 Actinic keratosis:0.787879 Benign keratosis:0.590000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.828604 Melanocytic nevus:0.774481 Basal cell carcinoma:0.942918 Actinic keratosis:0.924509 Benign keratosis:0.934444 Dermatofibroma:0.953252 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1135.0, 85.0, 42.0, 107.0, 8.0, 26.0]

TEST Student: Epoch: 8, iteration: 86

TEST AUROC: 0.895246, TEST Accus: 0.663187, TEST Senss: 0.844249, TEST Specs: 0.806475
AUROCs: Melanoma:0.866679 Melanocytic nevus:0.926473 Basal cell carcinoma:0.951014 Actinic keratosis:0.915723 Benign keratosis:0.882814 Dermatofibroma:0.728162 Vascular lesion:0.995854
Accus: Melanoma:0.601732 Melanocytic nevus:0.841364 Basal cell carcinoma:0.772727 Actinic keratosis:0.724138 Benign keratosis:0.500000 Dermatofibroma:0.363636 Vascular lesion:0.838710
Senss: Melanoma:0.900433 Melanocytic nevus:0.962194 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.785047 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.639574 Melanocytic nevus:0.624625 Basal cell carcinoma:0.883990 Actinic keratosis:0.833929 Benign keratosis:0.823987 Dermatofibroma:0.887105 Vascular lesion:0.952117
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_9.pth

Epoch: 9, iteration: 0/87, ==> train <===, loss: 1.795632, classification loss: 1.795632,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.874204890000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 530.0, 29.0, 25.0, 52.0, 5.0, 10.0]

VAL Student: Epoch: 9, iteration: 86

VAL AUROC: 0.871976, VAL Accus: 0.588941, VAL Senss: 0.672096, VAL Specs: 0.912668
AUROCs: Melanoma:0.842644 Melanocytic nevus:0.933711 Basal cell carcinoma:0.915610 Actinic keratosis:0.967002 Benign keratosis:0.863244 Dermatofibroma:0.711573 Vascular lesion:0.870051
Accus: Melanoma:0.529412 Melanocytic nevus:0.799397 Basal cell carcinoma:0.537037 Actinic keratosis:0.757576 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.722689 Melanocytic nevus:0.906486 Basal cell carcinoma:0.648148 Actinic keratosis:0.818182 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.834279 Melanocytic nevus:0.821958 Basal cell carcinoma:0.954545 Actinic keratosis:0.919338 Benign keratosis:0.914444 Dermatofibroma:0.951220 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [152.0, 1088.0, 79.0, 41.0, 121.0, 8.0, 27.0]

TEST Student: Epoch: 9, iteration: 86

TEST AUROC: 0.896967, TEST Accus: 0.669948, TEST Senss: 0.831896, TEST Specs: 0.822466
AUROCs: Melanoma:0.872777 Melanocytic nevus:0.931657 Basal cell carcinoma:0.945397 Actinic keratosis:0.935105 Benign keratosis:0.875806 Dermatofibroma:0.729896 Vascular lesion:0.988131
Accus: Melanoma:0.658009 Melanocytic nevus:0.806523 Basal cell carcinoma:0.718182 Actinic keratosis:0.706897 Benign keratosis:0.565421 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.904762 Melanocytic nevus:0.954781 Basal cell carcinoma:0.900000 Actinic keratosis:0.879310 Benign keratosis:0.794393 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.654709 Melanocytic nevus:0.678679 Basal cell carcinoma:0.899738 Actinic keratosis:0.853347 Benign keratosis:0.818434 Dermatofibroma:0.880080 Vascular lesion:0.972278
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_10.pth

Epoch: 10, iteration: 0/87, ==> train <===, loss: 1.819713, classification loss: 1.819713,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.4867844010000016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 526.0, 29.0, 22.0, 59.0, 4.0, 12.0]

VAL Student: Epoch: 10, iteration: 86

VAL AUROC: 0.840446, VAL Accus: 0.586808, VAL Senss: 0.679643, VAL Specs: 0.916217
AUROCs: Melanoma:0.838400 Melanocytic nevus:0.924925 Basal cell carcinoma:0.900673 Actinic keratosis:0.911285 Benign keratosis:0.853833 Dermatofibroma:0.607914 Vascular lesion:0.846091
Accus: Melanoma:0.470588 Melanocytic nevus:0.793363 Basal cell carcinoma:0.537037 Actinic keratosis:0.666667 Benign keratosis:0.590000 Dermatofibroma:0.250000 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.871795 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.844495 Melanocytic nevus:0.839763 Basal cell carcinoma:0.964059 Actinic keratosis:0.915202 Benign keratosis:0.885556 Dermatofibroma:0.979675 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1081.0, 73.0, 46.0, 123.0, 6.0, 28.0]

TEST Student: Epoch: 10, iteration: 86

TEST AUROC: 0.878402, TEST Accus: 0.655554, TEST Senss: 0.814767, TEST Specs: 0.832103
AUROCs: Melanoma:0.858548 Melanocytic nevus:0.930743 Basal cell carcinoma:0.925125 Actinic keratosis:0.923863 Benign keratosis:0.872003 Dermatofibroma:0.641655 Vascular lesion:0.996878
Accus: Melanoma:0.580087 Melanocytic nevus:0.801334 Basal cell carcinoma:0.663636 Actinic keratosis:0.793103 Benign keratosis:0.574766 Dermatofibroma:0.272727 Vascular lesion:0.903226
Senss: Melanoma:0.874459 Melanocytic nevus:0.938473 Basal cell carcinoma:0.854545 Actinic keratosis:0.896552 Benign keratosis:0.775701 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.705157 Melanocytic nevus:0.714715 Basal cell carcinoma:0.888714 Actinic keratosis:0.844660 Benign keratosis:0.790117 Dermatofibroma:0.931259 Vascular lesion:0.950101
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_11.pth

Epoch: 11, iteration: 0/87, ==> train <===, loss: 1.808301, classification loss: 1.808301,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.138105960900002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 526.0, 32.0, 19.0, 46.0, 5.0, 12.0]

VAL Student: Epoch: 11, iteration: 86

VAL AUROC: 0.866378, VAL Accus: 0.580518, VAL Senss: 0.667244, VAL Specs: 0.912848
AUROCs: Melanoma:0.840794 Melanocytic nevus:0.929383 Basal cell carcinoma:0.895016 Actinic keratosis:0.947636 Benign keratosis:0.853378 Dermatofibroma:0.731771 Vascular lesion:0.866667
Accus: Melanoma:0.529412 Melanocytic nevus:0.793363 Basal cell carcinoma:0.592593 Actinic keratosis:0.575758 Benign keratosis:0.460000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.888386 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.830874 Melanocytic nevus:0.810089 Basal cell carcinoma:0.946089 Actinic keratosis:0.948294 Benign keratosis:0.915556 Dermatofibroma:0.952236 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1094.0, 83.0, 37.0, 113.0, 8.0, 28.0]

TEST Student: Epoch: 11, iteration: 86

TEST AUROC: 0.895334, TEST Accus: 0.664575, TEST Senss: 0.810875, TEST Specs: 0.838787
AUROCs: Melanoma:0.863379 Melanocytic nevus:0.937902 Basal cell carcinoma:0.950146 Actinic keratosis:0.914040 Benign keratosis:0.878782 Dermatofibroma:0.727204 Vascular lesion:0.995886
Accus: Melanoma:0.653680 Melanocytic nevus:0.810971 Basal cell carcinoma:0.754545 Actinic keratosis:0.637931 Benign keratosis:0.528037 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.883117 Melanocytic nevus:0.942179 Basal cell carcinoma:0.909091 Actinic keratosis:0.844828 Benign keratosis:0.752336 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.670404 Melanocytic nevus:0.716216 Basal cell carcinoma:0.891339 Actinic keratosis:0.895759 Benign keratosis:0.838978 Dermatofibroma:0.901154 Vascular lesion:0.957661
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_12.pth

Epoch: 12, iteration: 0/87, ==> train <===, loss: 1.838937, classification loss: 1.838937,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.8242953648100018e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 545.0, 28.0, 19.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 12, iteration: 86

VAL AUROC: 0.847496, VAL Accus: 0.585687, VAL Senss: 0.659972, VAL Specs: 0.910940
AUROCs: Melanoma:0.848682 Melanocytic nevus:0.925198 Basal cell carcinoma:0.882037 Actinic keratosis:0.906991 Benign keratosis:0.831822 Dermatofibroma:0.685086 Vascular lesion:0.852657
Accus: Melanoma:0.521008 Melanocytic nevus:0.822021 Basal cell carcinoma:0.518519 Actinic keratosis:0.575758 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.900452 Basal cell carcinoma:0.611111 Actinic keratosis:0.666667 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.843360 Melanocytic nevus:0.786350 Basal cell carcinoma:0.960888 Actinic keratosis:0.947260 Benign keratosis:0.884444 Dermatofibroma:0.962398 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1148.0, 81.0, 38.0, 109.0, 7.0, 26.0]

TEST Student: Epoch: 12, iteration: 86

TEST AUROC: 0.885648, TEST Accus: 0.636937, TEST Senss: 0.814088, TEST Specs: 0.827298
AUROCs: Melanoma:0.866529 Melanocytic nevus:0.927665 Basal cell carcinoma:0.943336 Actinic keratosis:0.909723 Benign keratosis:0.851067 Dermatofibroma:0.703234 Vascular lesion:0.997984
Accus: Melanoma:0.549784 Melanocytic nevus:0.851001 Basal cell carcinoma:0.736364 Actinic keratosis:0.655172 Benign keratosis:0.509346 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.887446 Melanocytic nevus:0.960712 Basal cell carcinoma:0.854545 Actinic keratosis:0.862069 Benign keratosis:0.757009 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.679933 Melanocytic nevus:0.647147 Basal cell carcinoma:0.893438 Actinic keratosis:0.891671 Benign keratosis:0.771793 Dermatofibroma:0.922228 Vascular lesion:0.984879
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_13.pth

Epoch: 13, iteration: 0/87, ==> train <===, loss: 1.787075, classification loss: 1.787075,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.5418658283290016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 543.0, 31.0, 20.0, 53.0, 6.0, 12.0]

VAL Student: Epoch: 13, iteration: 86

VAL AUROC: 0.879354, VAL Accus: 0.615597, VAL Senss: 0.684505, VAL Specs: 0.918436
AUROCs: Melanoma:0.848978 Melanocytic nevus:0.931473 Basal cell carcinoma:0.873933 Actinic keratosis:0.960076 Benign keratosis:0.842378 Dermatofibroma:0.818979 Vascular lesion:0.879662
Accus: Melanoma:0.605042 Melanocytic nevus:0.819005 Basal cell carcinoma:0.574074 Actinic keratosis:0.606061 Benign keratosis:0.530000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.895928 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.818388 Melanocytic nevus:0.821958 Basal cell carcinoma:0.957717 Actinic keratosis:0.952430 Benign keratosis:0.934444 Dermatofibroma:0.951220 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1130.0, 82.0, 40.0, 108.0, 11.0, 27.0]

TEST Student: Epoch: 13, iteration: 86

TEST AUROC: 0.901969, TEST Accus: 0.680447, TEST Senss: 0.830254, TEST Specs: 0.845173
AUROCs: Melanoma:0.872076 Melanocytic nevus:0.935582 Basal cell carcinoma:0.924820 Actinic keratosis:0.927132 Benign keratosis:0.882612 Dermatofibroma:0.773480 Vascular lesion:0.998081
Accus: Melanoma:0.614719 Melanocytic nevus:0.837658 Basal cell carcinoma:0.745455 Actinic keratosis:0.689655 Benign keratosis:0.504673 Dermatofibroma:0.500000 Vascular lesion:0.870968
Senss: Melanoma:0.887446 Melanocytic nevus:0.950334 Basal cell carcinoma:0.863636 Actinic keratosis:0.844828 Benign keratosis:0.752336 Dermatofibroma:0.545455 Vascular lesion:0.967742
Specs: Melanoma:0.682735 Melanocytic nevus:0.707207 Basal cell carcinoma:0.880315 Actinic keratosis:0.910577 Benign keratosis:0.858412 Dermatofibroma:0.899649 Vascular lesion:0.977319
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_14.pth

Epoch: 14, iteration: 0/87, ==> train <===, loss: 1.807578, classification loss: 1.807578,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.2876792454961016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 546.0, 36.0, 19.0, 58.0, 5.0, 10.0]

VAL Student: Epoch: 14, iteration: 86

VAL AUROC: 0.864924, VAL Accus: 0.593505, VAL Senss: 0.668835, VAL Specs: 0.920680
AUROCs: Melanoma:0.841767 Melanocytic nevus:0.932655 Basal cell carcinoma:0.900576 Actinic keratosis:0.923725 Benign keratosis:0.853522 Dermatofibroma:0.758702 Vascular lesion:0.843519
Accus: Melanoma:0.529412 Melanocytic nevus:0.823529 Basal cell carcinoma:0.666667 Actinic keratosis:0.575758 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.892911 Basal cell carcinoma:0.777778 Actinic keratosis:0.666667 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.870602 Melanocytic nevus:0.818991 Basal cell carcinoma:0.948203 Actinic keratosis:0.946225 Benign keratosis:0.892222 Dermatofibroma:0.985772 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1149.0, 84.0, 42.0, 132.0, 7.0, 28.0]

TEST Student: Epoch: 14, iteration: 86

TEST AUROC: 0.895527, TEST Accus: 0.673506, TEST Senss: 0.810034, TEST Specs: 0.853432
AUROCs: Melanoma:0.855180 Melanocytic nevus:0.935725 Basal cell carcinoma:0.948871 Actinic keratosis:0.916445 Benign keratosis:0.893665 Dermatofibroma:0.720545 Vascular lesion:0.998260
Accus: Melanoma:0.536797 Melanocytic nevus:0.851742 Basal cell carcinoma:0.763636 Actinic keratosis:0.724138 Benign keratosis:0.616822 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.800866 Melanocytic nevus:0.946627 Basal cell carcinoma:0.863636 Actinic keratosis:0.827586 Benign keratosis:0.822430 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.765695 Melanocytic nevus:0.696697 Basal cell carcinoma:0.883465 Actinic keratosis:0.891671 Benign keratosis:0.813437 Dermatofibroma:0.960863 Vascular lesion:0.962198
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_15.pth

Epoch: 15, iteration: 0/87, ==> train <===, loss: 1.839744, classification loss: 1.839744,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.0589113209464913e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 561.0, 29.0, 18.0, 45.0, 6.0, 10.0]

VAL Student: Epoch: 15, iteration: 86

VAL AUROC: 0.862949, VAL Accus: 0.571449, VAL Senss: 0.643676, VAL Specs: 0.914301
AUROCs: Melanoma:0.863829 Melanocytic nevus:0.928255 Basal cell carcinoma:0.907995 Actinic keratosis:0.938109 Benign keratosis:0.809622 Dermatofibroma:0.741870 Vascular lesion:0.850964
Accus: Melanoma:0.579832 Melanocytic nevus:0.846154 Basal cell carcinoma:0.537037 Actinic keratosis:0.545455 Benign keratosis:0.450000 Dermatofibroma:0.375000 Vascular lesion:0.666667
Senss: Melanoma:0.680672 Melanocytic nevus:0.912519 Basal cell carcinoma:0.648148 Actinic keratosis:0.606061 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.733333
Specs: Melanoma:0.856981 Melanocytic nevus:0.753709 Basal cell carcinoma:0.964059 Actinic keratosis:0.953464 Benign keratosis:0.927778 Dermatofibroma:0.955285 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1186.0, 79.0, 43.0, 110.0, 9.0, 26.0]

TEST Student: Epoch: 15, iteration: 86

TEST AUROC: 0.896761, TEST Accus: 0.667426, TEST Senss: 0.817344, TEST Specs: 0.851366
AUROCs: Melanoma:0.876121 Melanocytic nevus:0.934630 Basal cell carcinoma:0.951883 Actinic keratosis:0.918894 Benign keratosis:0.878263 Dermatofibroma:0.719518 Vascular lesion:0.998016
Accus: Melanoma:0.571429 Melanocytic nevus:0.879170 Basal cell carcinoma:0.718182 Actinic keratosis:0.741379 Benign keratosis:0.514019 Dermatofibroma:0.409091 Vascular lesion:0.838710
Senss: Melanoma:0.861472 Melanocytic nevus:0.973314 Basal cell carcinoma:0.836364 Actinic keratosis:0.862069 Benign keratosis:0.733645 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.729260 Melanocytic nevus:0.633634 Basal cell carcinoma:0.919160 Actinic keratosis:0.910577 Benign keratosis:0.847307 Dermatofibroma:0.940291 Vascular lesion:0.979335
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_16.pth

Epoch: 16, iteration: 0/87, ==> train <===, loss: 1.820894, classification loss: 1.820894,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.8530201888518422e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 544.0, 33.0, 20.0, 55.0, 5.0, 10.0]

VAL Student: Epoch: 16, iteration: 86

VAL AUROC: 0.863716, VAL Accus: 0.594784, VAL Senss: 0.672040, VAL Specs: 0.918252
AUROCs: Melanoma:0.866519 Melanocytic nevus:0.930972 Basal cell carcinoma:0.914122 Actinic keratosis:0.902071 Benign keratosis:0.854689 Dermatofibroma:0.726880 Vascular lesion:0.850761
Accus: Melanoma:0.596639 Melanocytic nevus:0.820513 Basal cell carcinoma:0.611111 Actinic keratosis:0.606061 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.747899 Melanocytic nevus:0.901961 Basal cell carcinoma:0.722222 Actinic keratosis:0.636364 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.826334 Melanocytic nevus:0.807122 Basal cell carcinoma:0.952431 Actinic keratosis:0.960703 Benign keratosis:0.905556 Dermatofibroma:0.985772 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1120.0, 85.0, 42.0, 120.0, 7.0, 25.0]

TEST Student: Epoch: 16, iteration: 86

TEST AUROC: 0.905940, TEST Accus: 0.666596, TEST Senss: 0.828025, TEST Specs: 0.848868
AUROCs: Melanoma:0.880981 Melanocytic nevus:0.935974 Basal cell carcinoma:0.967674 Actinic keratosis:0.917132 Benign keratosis:0.889402 Dermatofibroma:0.757424 Vascular lesion:0.992992
Accus: Melanoma:0.653680 Melanocytic nevus:0.830245 Basal cell carcinoma:0.772727 Actinic keratosis:0.724138 Benign keratosis:0.560748 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.904762 Melanocytic nevus:0.949592 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.789720 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.651345 Melanocytic nevus:0.692192 Basal cell carcinoma:0.901312 Actinic keratosis:0.915176 Benign keratosis:0.837313 Dermatofibroma:0.960361 Vascular lesion:0.984375
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_17.pth

Epoch: 17, iteration: 0/87, ==> train <===, loss: 1.783229, classification loss: 1.783229,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.667718169966658e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 560.0, 30.0, 20.0, 63.0, 5.0, 11.0]

VAL Student: Epoch: 17, iteration: 86

VAL AUROC: 0.856962, VAL Accus: 0.602844, VAL Senss: 0.654982, VAL Specs: 0.919395
AUROCs: Melanoma:0.869371 Melanocytic nevus:0.932973 Basal cell carcinoma:0.897678 Actinic keratosis:0.894331 Benign keratosis:0.867111 Dermatofibroma:0.671621 Vascular lesion:0.865651
Accus: Melanoma:0.537815 Melanocytic nevus:0.844646 Basal cell carcinoma:0.555556 Actinic keratosis:0.606061 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.689076 Melanocytic nevus:0.911011 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.859251 Melanocytic nevus:0.804154 Basal cell carcinoma:0.965116 Actinic keratosis:0.958635 Benign keratosis:0.881111 Dermatofibroma:0.981707 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1146.0, 77.0, 43.0, 134.0, 7.0, 26.0]

TEST Student: Epoch: 17, iteration: 86

TEST AUROC: 0.901134, TEST Accus: 0.667956, TEST Senss: 0.830228, TEST Specs: 0.855351
AUROCs: Melanoma:0.882197 Melanocytic nevus:0.936341 Basal cell carcinoma:0.953686 Actinic keratosis:0.920753 Benign keratosis:0.892970 Dermatofibroma:0.726771 Vascular lesion:0.995220
Accus: Melanoma:0.601732 Melanocytic nevus:0.849518 Basal cell carcinoma:0.700000 Actinic keratosis:0.741379 Benign keratosis:0.626168 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.887446 Melanocytic nevus:0.956264 Basal cell carcinoma:0.845455 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.713565 Melanocytic nevus:0.684685 Basal cell carcinoma:0.932808 Actinic keratosis:0.922841 Benign keratosis:0.797890 Dermatofibroma:0.958856 Vascular lesion:0.976815
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_18.pth

Epoch: 18, iteration: 0/87, ==> train <===, loss: 1.794003, classification loss: 1.794003,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.5009463529699922e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 569.0, 37.0, 18.0, 47.0, 5.0, 11.0]

VAL Student: Epoch: 18, iteration: 86

VAL AUROC: 0.842032, VAL Accus: 0.598990, VAL Senss: 0.657102, VAL Specs: 0.920136
AUROCs: Melanoma:0.861054 Melanocytic nevus:0.933814 Basal cell carcinoma:0.912928 Actinic keratosis:0.867945 Benign keratosis:0.839478 Dermatofibroma:0.621951 Vascular lesion:0.857056
Accus: Melanoma:0.588235 Melanocytic nevus:0.858220 Basal cell carcinoma:0.685185 Actinic keratosis:0.545455 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.714286 Melanocytic nevus:0.911011 Basal cell carcinoma:0.722222 Actinic keratosis:0.636364 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.851305 Melanocytic nevus:0.780415 Basal cell carcinoma:0.942918 Actinic keratosis:0.959669 Benign keratosis:0.930000 Dermatofibroma:0.991870 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1168.0, 86.0, 39.0, 111.0, 8.0, 27.0]

TEST Student: Epoch: 18, iteration: 86

TEST AUROC: 0.898351, TEST Accus: 0.666633, TEST Senss: 0.816271, TEST Specs: 0.854294
AUROCs: Melanoma:0.871297 Melanocytic nevus:0.936024 Basal cell carcinoma:0.964658 Actinic keratosis:0.905564 Benign keratosis:0.883956 Dermatofibroma:0.729462 Vascular lesion:0.997496
Accus: Melanoma:0.593074 Melanocytic nevus:0.865827 Basal cell carcinoma:0.781818 Actinic keratosis:0.672414 Benign keratosis:0.518692 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.878788 Melanocytic nevus:0.959229 Basal cell carcinoma:0.890909 Actinic keratosis:0.810345 Benign keratosis:0.752336 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.709641 Melanocytic nevus:0.660661 Basal cell carcinoma:0.906037 Actinic keratosis:0.912621 Benign keratosis:0.848418 Dermatofibroma:0.969393 Vascular lesion:0.973286
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_19.pth

Epoch: 19, iteration: 0/87, ==> train <===, loss: 1.791279, classification loss: 1.791279,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.350851717672993e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 578.0, 33.0, 24.0, 49.0, 5.0, 11.0]

VAL Student: Epoch: 19, iteration: 86

VAL AUROC: 0.864377, VAL Accus: 0.610775, VAL Senss: 0.655904, VAL Specs: 0.921643
AUROCs: Melanoma:0.853509 Melanocytic nevus:0.935121 Basal cell carcinoma:0.895251 Actinic keratosis:0.933189 Benign keratosis:0.857367 Dermatofibroma:0.712652 Vascular lesion:0.863553
Accus: Melanoma:0.529412 Melanocytic nevus:0.871795 Basal cell carcinoma:0.611111 Actinic keratosis:0.727273 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.655462 Melanocytic nevus:0.926094 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.888763 Melanocytic nevus:0.780415 Basal cell carcinoma:0.953488 Actinic keratosis:0.943123 Benign keratosis:0.911111 Dermatofibroma:0.982724 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1175.0, 80.0, 45.0, 121.0, 7.0, 25.0]

TEST Student: Epoch: 19, iteration: 86

TEST AUROC: 0.902372, TEST Accus: 0.657286, TEST Senss: 0.823778, TEST Specs: 0.855186
AUROCs: Melanoma:0.869290 Melanocytic nevus:0.936148 Basal cell carcinoma:0.959695 Actinic keratosis:0.930268 Benign keratosis:0.888055 Dermatofibroma:0.738494 Vascular lesion:0.994651
Accus: Melanoma:0.536797 Melanocytic nevus:0.871016 Basal cell carcinoma:0.727273 Actinic keratosis:0.775862 Benign keratosis:0.565421 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.831169 Melanocytic nevus:0.959229 Basal cell carcinoma:0.863636 Actinic keratosis:0.896552 Benign keratosis:0.780374 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.765695 Melanocytic nevus:0.665165 Basal cell carcinoma:0.913386 Actinic keratosis:0.886050 Benign keratosis:0.822321 Dermatofibroma:0.952333 Vascular lesion:0.981351
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_20.pth

Epoch: 20, iteration: 0/87, ==> train <===, loss: 1.815957, classification loss: 1.815957,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.2157665459056937e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 571.0, 37.0, 23.0, 51.0, 5.0, 11.0]

VAL Student: Epoch: 20, iteration: 86

VAL AUROC: 0.853639, VAL Accus: 0.618377, VAL Senss: 0.669192, VAL Specs: 0.924337
AUROCs: Melanoma:0.860529 Melanocytic nevus:0.931388 Basal cell carcinoma:0.909991 Actinic keratosis:0.942214 Benign keratosis:0.852644 Dermatofibroma:0.623412 Vascular lesion:0.855296
Accus: Melanoma:0.529412 Melanocytic nevus:0.861237 Basal cell carcinoma:0.685185 Actinic keratosis:0.696970 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.638655 Melanocytic nevus:0.920060 Basal cell carcinoma:0.722222 Actinic keratosis:0.757576 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.892168 Melanocytic nevus:0.783383 Basal cell carcinoma:0.937632 Actinic keratosis:0.951396 Benign keratosis:0.920000 Dermatofibroma:0.992886 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 1178.0, 93.0, 43.0, 124.0, 6.0, 27.0]

TEST Student: Epoch: 20, iteration: 86

TEST AUROC: 0.904976, TEST Accus: 0.671194, TEST Senss: 0.820711, TEST Specs: 0.856322
AUROCs: Melanoma:0.878315 Melanocytic nevus:0.933682 Basal cell carcinoma:0.972155 Actinic keratosis:0.931907 Benign keratosis:0.885196 Dermatofibroma:0.736943 Vascular lesion:0.996634
Accus: Melanoma:0.515152 Melanocytic nevus:0.873239 Basal cell carcinoma:0.845455 Actinic keratosis:0.741379 Benign keratosis:0.579439 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.844156 Melanocytic nevus:0.960712 Basal cell carcinoma:0.909091 Actinic keratosis:0.879310 Benign keratosis:0.761682 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.774103 Melanocytic nevus:0.660661 Basal cell carcinoma:0.874016 Actinic keratosis:0.908533 Benign keratosis:0.826208 Dermatofibroma:0.971400 Vascular lesion:0.979335
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_21.pth

Epoch: 21, iteration: 0/87, ==> train <===, loss: 1.772189, classification loss: 1.809049,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069252,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032391,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0941898913151244e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 552.0, 33.0, 26.0, 43.0, 5.0, 12.0]

VAL Student: Epoch: 21, iteration: 86

VAL AUROC: 0.855746, VAL Accus: 0.618384, VAL Senss: 0.699739, VAL Specs: 0.918707
AUROCs: Melanoma:0.851219 Melanocytic nevus:0.937744 Basal cell carcinoma:0.901574 Actinic keratosis:0.962834 Benign keratosis:0.832200 Dermatofibroma:0.649962 Vascular lesion:0.854687
Accus: Melanoma:0.554622 Melanocytic nevus:0.832579 Basal cell carcinoma:0.611111 Actinic keratosis:0.787879 Benign keratosis:0.430000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.904977 Basal cell carcinoma:0.703704 Actinic keratosis:0.909091 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.852440 Melanocytic nevus:0.804154 Basal cell carcinoma:0.946089 Actinic keratosis:0.906929 Benign keratosis:0.935556 Dermatofibroma:0.992886 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1129.0, 88.0, 46.0, 110.0, 6.0, 27.0]

TEST Student: Epoch: 21, iteration: 86

TEST AUROC: 0.902806, TEST Accus: 0.674253, TEST Senss: 0.819042, TEST Specs: 0.865314
AUROCs: Melanoma:0.874389 Melanocytic nevus:0.940741 Basal cell carcinoma:0.965812 Actinic keratosis:0.936382 Benign keratosis:0.877013 Dermatofibroma:0.726931 Vascular lesion:0.998374
Accus: Melanoma:0.632035 Melanocytic nevus:0.836916 Basal cell carcinoma:0.800000 Actinic keratosis:0.793103 Benign keratosis:0.514019 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.844156 Melanocytic nevus:0.946627 Basal cell carcinoma:0.900000 Actinic keratosis:0.913793 Benign keratosis:0.719626 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.756166 Melanocytic nevus:0.723724 Basal cell carcinoma:0.895013 Actinic keratosis:0.854880 Benign keratosis:0.865630 Dermatofibroma:0.979428 Vascular lesion:0.982359
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_22.pth

Epoch: 22, iteration: 0/87, ==> train <===, loss: 1.742765, classification loss: 1.788672,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066484,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020577,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.84770902183612e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 568.0, 37.0, 16.0, 53.0, 6.0, 12.0]

VAL Student: Epoch: 22, iteration: 86

VAL AUROC: 0.861426, VAL Accus: 0.609937, VAL Senss: 0.667464, VAL Specs: 0.917629
AUROCs: Melanoma:0.867225 Melanocytic nevus:0.933161 Basal cell carcinoma:0.908876 Actinic keratosis:0.866378 Benign keratosis:0.867533 Dermatofibroma:0.701664 Vascular lesion:0.885144
Accus: Melanoma:0.537815 Melanocytic nevus:0.856712 Basal cell carcinoma:0.685185 Actinic keratosis:0.484848 Benign keratosis:0.530000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.714286 Melanocytic nevus:0.918552 Basal cell carcinoma:0.759259 Actinic keratosis:0.515152 Benign keratosis:0.590000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.854711 Melanocytic nevus:0.771513 Basal cell carcinoma:0.941860 Actinic keratosis:0.972079 Benign keratosis:0.917778 Dermatofibroma:0.980691 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1155.0, 84.0, 26.0, 123.0, 7.0, 28.0]

TEST Student: Epoch: 22, iteration: 86

TEST AUROC: 0.900304, TEST Accus: 0.640475, TEST Senss: 0.824376, TEST Specs: 0.857644
AUROCs: Melanoma:0.883055 Melanocytic nevus:0.937684 Basal cell carcinoma:0.968294 Actinic keratosis:0.880597 Benign keratosis:0.895616 Dermatofibroma:0.738768 Vascular lesion:0.998114
Accus: Melanoma:0.619048 Melanocytic nevus:0.856190 Basal cell carcinoma:0.763636 Actinic keratosis:0.448276 Benign keratosis:0.574766 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.865801 Melanocytic nevus:0.959970 Basal cell carcinoma:0.909091 Actinic keratosis:0.741379 Benign keratosis:0.794393 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.739350 Melanocytic nevus:0.678679 Basal cell carcinoma:0.888189 Actinic keratosis:0.950945 Benign keratosis:0.821766 Dermatofibroma:0.958856 Vascular lesion:0.965726
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_23.pth

Epoch: 23, iteration: 0/87, ==> train <===, loss: 1.757331, classification loss: 1.797551,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067446,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027226,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.862938119652508e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [75.0, 560.0, 29.0, 26.0, 48.0, 5.0, 12.0]

VAL Student: Epoch: 23, iteration: 86

VAL AUROC: 0.871044, VAL Accus: 0.627473, VAL Senss: 0.694897, VAL Specs: 0.919404
AUROCs: Melanoma:0.865642 Melanocytic nevus:0.940621 Basal cell carcinoma:0.883173 Actinic keratosis:0.958196 Benign keratosis:0.841767 Dermatofibroma:0.731834 Vascular lesion:0.876074
Accus: Melanoma:0.630252 Melanocytic nevus:0.844646 Basal cell carcinoma:0.537037 Actinic keratosis:0.787879 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.781513 Melanocytic nevus:0.914027 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.620000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.825199 Melanocytic nevus:0.807122 Basal cell carcinoma:0.969345 Actinic keratosis:0.933816 Benign keratosis:0.927778 Dermatofibroma:0.982724 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [160.0, 1132.0, 73.0, 41.0, 122.0, 8.0, 27.0]

TEST Student: Epoch: 23, iteration: 86

TEST AUROC: 0.906718, TEST Accus: 0.672430, TEST Senss: 0.835659, TEST Specs: 0.863990
AUROCs: Melanoma:0.884432 Melanocytic nevus:0.940808 Basal cell carcinoma:0.938516 Actinic keratosis:0.942408 Benign keratosis:0.893932 Dermatofibroma:0.749350 Vascular lesion:0.997577
Accus: Melanoma:0.692641 Melanocytic nevus:0.839140 Basal cell carcinoma:0.663636 Actinic keratosis:0.706897 Benign keratosis:0.570093 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.896104 Melanocytic nevus:0.954040 Basal cell carcinoma:0.845455 Actinic keratosis:0.896552 Benign keratosis:0.789720 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.713004 Melanocytic nevus:0.723724 Basal cell carcinoma:0.943307 Actinic keratosis:0.895759 Benign keratosis:0.838978 Dermatofibroma:0.956849 Vascular lesion:0.976310
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_24.pth

Epoch: 24, iteration: 0/87, ==> train <===, loss: 1.781195, classification loss: 1.813351,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.065750,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033594,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.976644307687257e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 569.0, 35.0, 21.0, 53.0, 5.0, 12.0]

VAL Student: Epoch: 24, iteration: 86

VAL AUROC: 0.854006, VAL Accus: 0.610375, VAL Senss: 0.690107, VAL Specs: 0.917677
AUROCs: Melanoma:0.858221 Melanocytic nevus:0.933814 Basal cell carcinoma:0.919642 Actinic keratosis:0.923224 Benign keratosis:0.862422 Dermatofibroma:0.613916 Vascular lesion:0.866802
Accus: Melanoma:0.487395 Melanocytic nevus:0.858220 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.924585 Basal cell carcinoma:0.722222 Actinic keratosis:0.757576 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.880817 Melanocytic nevus:0.768546 Basal cell carcinoma:0.945032 Actinic keratosis:0.938987 Benign keratosis:0.917778 Dermatofibroma:0.989837 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1151.0, 87.0, 43.0, 128.0, 7.0, 28.0]

TEST Student: Epoch: 24, iteration: 86

TEST AUROC: 0.906421, TEST Accus: 0.679262, TEST Senss: 0.829333, TEST Specs: 0.858099
AUROCs: Melanoma:0.879361 Melanocytic nevus:0.934731 Basal cell carcinoma:0.967855 Actinic keratosis:0.931766 Benign keratosis:0.903929 Dermatofibroma:0.729029 Vascular lesion:0.998277
Accus: Melanoma:0.549784 Melanocytic nevus:0.853225 Basal cell carcinoma:0.790909 Actinic keratosis:0.741379 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.831169 Melanocytic nevus:0.961453 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.780830 Melanocytic nevus:0.678679 Basal cell carcinoma:0.885039 Actinic keratosis:0.901891 Benign keratosis:0.825652 Dermatofibroma:0.971902 Vascular lesion:0.962702
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_25.pth

Epoch: 25, iteration: 0/87, ==> train <===, loss: 1.751846, classification loss: 1.781960,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066105,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.035991,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.1789798769185315e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 509.0, 36.0, 26.0, 55.0, 5.0, 11.0]

VAL Student: Epoch: 25, iteration: 86

VAL AUROC: 0.867254, VAL Accus: 0.627076, VAL Senss: 0.706698, VAL Specs: 0.917878
AUROCs: Melanoma:0.836797 Melanocytic nevus:0.934311 Basal cell carcinoma:0.926317 Actinic keratosis:0.961925 Benign keratosis:0.856333 Dermatofibroma:0.686738 Vascular lesion:0.868359
Accus: Melanoma:0.571429 Melanocytic nevus:0.767722 Basal cell carcinoma:0.666667 Actinic keratosis:0.787879 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.705882 Melanocytic nevus:0.855204 Basal cell carcinoma:0.814815 Actinic keratosis:0.848485 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.851305 Melanocytic nevus:0.863501 Basal cell carcinoma:0.909091 Actinic keratosis:0.912099 Benign keratosis:0.915556 Dermatofibroma:0.987805 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1036.0, 94.0, 44.0, 123.0, 7.0, 27.0]

TEST Student: Epoch: 25, iteration: 86

TEST AUROC: 0.901119, TEST Accus: 0.680587, TEST Senss: 0.808794, TEST Specs: 0.858838
AUROCs: Melanoma:0.859307 Melanocytic nevus:0.939126 Basal cell carcinoma:0.968437 Actinic keratosis:0.932955 Benign keratosis:0.882705 Dermatofibroma:0.729576 Vascular lesion:0.995724
Accus: Melanoma:0.619048 Melanocytic nevus:0.767976 Basal cell carcinoma:0.854545 Actinic keratosis:0.758621 Benign keratosis:0.574766 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.813853 Melanocytic nevus:0.907339 Basal cell carcinoma:0.945455 Actinic keratosis:0.879310 Benign keratosis:0.771028 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.757848 Melanocytic nevus:0.815315 Basal cell carcinoma:0.809449 Actinic keratosis:0.858457 Benign keratosis:0.835647 Dermatofibroma:0.961867 Vascular lesion:0.973286
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_26.pth

Epoch: 26, iteration: 0/87, ==> train <===, loss: 1.782962, classification loss: 1.826137,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068167,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024992,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.461081889226678e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 557.0, 33.0, 23.0, 58.0, 6.0, 12.0]

VAL Student: Epoch: 26, iteration: 86

VAL AUROC: 0.866483, VAL Accus: 0.634431, VAL Senss: 0.719471, VAL Specs: 0.919946
AUROCs: Melanoma:0.852793 Melanocytic nevus:0.940375 Basal cell carcinoma:0.911969 Actinic keratosis:0.952869 Benign keratosis:0.867756 Dermatofibroma:0.658537 Vascular lesion:0.881083
Accus: Melanoma:0.537815 Melanocytic nevus:0.840121 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.918552 Basal cell carcinoma:0.666667 Actinic keratosis:0.818182 Benign keratosis:0.710000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.856981 Melanocytic nevus:0.798220 Basal cell carcinoma:0.956660 Actinic keratosis:0.957601 Benign keratosis:0.895556 Dermatofibroma:0.983740 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1124.0, 82.0, 41.0, 140.0, 9.0, 27.0]

TEST Student: Epoch: 26, iteration: 86

TEST AUROC: 0.912296, TEST Accus: 0.687557, TEST Senss: 0.834821, TEST Specs: 0.860910
AUROCs: Melanoma:0.884782 Melanocytic nevus:0.940993 Basal cell carcinoma:0.968418 Actinic keratosis:0.930594 Benign keratosis:0.907811 Dermatofibroma:0.756876 Vascular lesion:0.996602
Accus: Melanoma:0.593074 Melanocytic nevus:0.833210 Basal cell carcinoma:0.745455 Actinic keratosis:0.706897 Benign keratosis:0.654206 Dermatofibroma:0.409091 Vascular lesion:0.870968
Senss: Melanoma:0.865801 Melanocytic nevus:0.951075 Basal cell carcinoma:0.872727 Actinic keratosis:0.844828 Benign keratosis:0.873832 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.738789 Melanocytic nevus:0.729730 Basal cell carcinoma:0.914436 Actinic keratosis:0.919775 Benign keratosis:0.788451 Dermatofibroma:0.954340 Vascular lesion:0.980847
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_27.pth

Epoch: 27, iteration: 0/87, ==> train <===, loss: 1.756580, classification loss: 1.801771,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070195,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025004,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.81497370030401e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 574.0, 31.0, 26.0, 55.0, 6.0, 12.0]

VAL Student: Epoch: 27, iteration: 86

VAL AUROC: 0.859894, VAL Accus: 0.636702, VAL Senss: 0.700329, VAL Specs: 0.921463
AUROCs: Melanoma:0.852984 Melanocytic nevus:0.938482 Basal cell carcinoma:0.869196 Actinic keratosis:0.952900 Benign keratosis:0.852744 Dermatofibroma:0.672002 Vascular lesion:0.880948
Accus: Melanoma:0.504202 Melanocytic nevus:0.865762 Basal cell carcinoma:0.574074 Actinic keratosis:0.787879 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.932127 Basal cell carcinoma:0.611111 Actinic keratosis:0.818182 Benign keratosis:0.660000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.872872 Melanocytic nevus:0.783383 Basal cell carcinoma:0.964059 Actinic keratosis:0.940021 Benign keratosis:0.924444 Dermatofibroma:0.981707 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1151.0, 81.0, 44.0, 125.0, 8.0, 28.0]

TEST Student: Epoch: 27, iteration: 86

TEST AUROC: 0.906943, TEST Accus: 0.678424, TEST Senss: 0.831593, TEST Specs: 0.865947
AUROCs: Melanoma:0.879055 Melanocytic nevus:0.938809 Basal cell carcinoma:0.953691 Actinic keratosis:0.935052 Benign keratosis:0.896763 Dermatofibroma:0.746727 Vascular lesion:0.998504
Accus: Melanoma:0.549784 Melanocytic nevus:0.853225 Basal cell carcinoma:0.736364 Actinic keratosis:0.758621 Benign keratosis:0.584112 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.826840 Melanocytic nevus:0.955523 Basal cell carcinoma:0.863636 Actinic keratosis:0.862069 Benign keratosis:0.813084 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.775224 Melanocytic nevus:0.707207 Basal cell carcinoma:0.923885 Actinic keratosis:0.895248 Benign keratosis:0.838978 Dermatofibroma:0.950828 Vascular lesion:0.970262
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_28.pth

Epoch: 28, iteration: 0/87, ==> train <===, loss: 1.760636, classification loss: 1.798861,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068824,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030599,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.23347633027361e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 549.0, 37.0, 21.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 28, iteration: 86

VAL AUROC: 0.863204, VAL Accus: 0.624274, VAL Senss: 0.707002, VAL Specs: 0.916895
AUROCs: Melanoma:0.841147 Melanocytic nevus:0.939395 Basal cell carcinoma:0.919838 Actinic keratosis:0.913384 Benign keratosis:0.869756 Dermatofibroma:0.681275 Vascular lesion:0.877631
Accus: Melanoma:0.537815 Melanocytic nevus:0.828054 Basal cell carcinoma:0.685185 Actinic keratosis:0.636364 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.714286 Melanocytic nevus:0.904977 Basal cell carcinoma:0.777778 Actinic keratosis:0.696970 Benign keratosis:0.680000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.860386 Melanocytic nevus:0.810089 Basal cell carcinoma:0.927061 Actinic keratosis:0.949328 Benign keratosis:0.910000 Dermatofibroma:0.977642 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1102.0, 93.0, 33.0, 130.0, 8.0, 28.0]

TEST Student: Epoch: 28, iteration: 86

TEST AUROC: 0.904912, TEST Accus: 0.668156, TEST Senss: 0.825402, TEST Specs: 0.860580
AUROCs: Melanoma:0.867410 Melanocytic nevus:0.936798 Basal cell carcinoma:0.969110 Actinic keratosis:0.914128 Benign keratosis:0.898040 Dermatofibroma:0.750673 Vascular lesion:0.998228
Accus: Melanoma:0.571429 Melanocytic nevus:0.816901 Basal cell carcinoma:0.845455 Actinic keratosis:0.568966 Benign keratosis:0.607477 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.800866 Melanocytic nevus:0.943662 Basal cell carcinoma:0.927273 Actinic keratosis:0.810345 Benign keratosis:0.841121 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.764013 Melanocytic nevus:0.740240 Basal cell carcinoma:0.869816 Actinic keratosis:0.912621 Benign keratosis:0.822321 Dermatofibroma:0.948821 Vascular lesion:0.966230
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_29.pth

Epoch: 29, iteration: 0/87, ==> train <===, loss: 1.780756, classification loss: 1.830753,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.071789,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021791,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.710128697246249e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 553.0, 36.0, 20.0, 63.0, 6.0, 12.0]

VAL Student: Epoch: 29, iteration: 86

VAL AUROC: 0.860825, VAL Accus: 0.622456, VAL Senss: 0.711731, VAL Specs: 0.919503
AUROCs: Melanoma:0.842024 Melanocytic nevus:0.937927 Basal cell carcinoma:0.934246 Actinic keratosis:0.916549 Benign keratosis:0.866311 Dermatofibroma:0.639037 Vascular lesion:0.889679
Accus: Melanoma:0.445378 Melanocytic nevus:0.834087 Basal cell carcinoma:0.666667 Actinic keratosis:0.606061 Benign keratosis:0.630000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.647059 Melanocytic nevus:0.906486 Basal cell carcinoma:0.796296 Actinic keratosis:0.727273 Benign keratosis:0.730000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.886493 Melanocytic nevus:0.816024 Basal cell carcinoma:0.919662 Actinic keratosis:0.956567 Benign keratosis:0.893333 Dermatofibroma:0.976626 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [114.0, 1118.0, 93.0, 33.0, 142.0, 8.0, 27.0]

TEST Student: Epoch: 29, iteration: 86

TEST AUROC: 0.905771, TEST Accus: 0.662121, TEST Senss: 0.840749, TEST Specs: 0.861756
AUROCs: Melanoma:0.870215 Melanocytic nevus:0.937008 Basal cell carcinoma:0.970962 Actinic keratosis:0.914022 Benign keratosis:0.904360 Dermatofibroma:0.745587 Vascular lesion:0.998244
Accus: Melanoma:0.493506 Melanocytic nevus:0.828762 Basal cell carcinoma:0.845455 Actinic keratosis:0.568966 Benign keratosis:0.663551 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.800866 Melanocytic nevus:0.942179 Basal cell carcinoma:0.945455 Actinic keratosis:0.827586 Benign keratosis:0.869159 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.791480 Melanocytic nevus:0.741742 Basal cell carcinoma:0.863517 Actinic keratosis:0.921308 Benign keratosis:0.790117 Dermatofibroma:0.947316 Vascular lesion:0.976815
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_30.pth

Epoch: 30, iteration: 0/87, ==> train <===, loss: 1.766999, classification loss: 1.799824,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.061747,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028923,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.239115827521624e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 572.0, 32.0, 27.0, 42.0, 6.0, 12.0]

VAL Student: Epoch: 30, iteration: 86

VAL AUROC: 0.875510, VAL Accus: 0.628276, VAL Senss: 0.694096, VAL Specs: 0.911915
AUROCs: Melanoma:0.852250 Melanocytic nevus:0.937985 Basal cell carcinoma:0.916197 Actinic keratosis:0.970574 Benign keratosis:0.813467 Dermatofibroma:0.751397 Vascular lesion:0.886701
Accus: Melanoma:0.529412 Melanocytic nevus:0.862745 Basal cell carcinoma:0.592593 Actinic keratosis:0.818182 Benign keratosis:0.420000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.930618 Basal cell carcinoma:0.666667 Actinic keratosis:0.848485 Benign keratosis:0.490000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.836549 Melanocytic nevus:0.759644 Basal cell carcinoma:0.950317 Actinic keratosis:0.933816 Benign keratosis:0.947778 Dermatofibroma:0.970528 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1137.0, 86.0, 42.0, 105.0, 9.0, 28.0]

TEST Student: Epoch: 30, iteration: 86

TEST AUROC: 0.905547, TEST Accus: 0.681546, TEST Senss: 0.828214, TEST Specs: 0.856941
AUROCs: Melanoma:0.881076 Melanocytic nevus:0.938078 Basal cell carcinoma:0.959017 Actinic keratosis:0.939351 Benign keratosis:0.879148 Dermatofibroma:0.743557 Vascular lesion:0.998602
Accus: Melanoma:0.619048 Melanocytic nevus:0.842847 Basal cell carcinoma:0.781818 Actinic keratosis:0.724138 Benign keratosis:0.490654 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.861472 Melanocytic nevus:0.963677 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.710280 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.735426 Melanocytic nevus:0.674174 Basal cell carcinoma:0.899213 Actinic keratosis:0.896270 Benign keratosis:0.883953 Dermatofibroma:0.938786 Vascular lesion:0.970766
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_31.pth

Epoch: 31, iteration: 0/87, ==> train <===, loss: 1.754936, classification loss: 1.797285,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070662,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028313,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.815204244769462e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [51.0, 562.0, 34.0, 28.0, 54.0, 6.0, 12.0]

VAL Student: Epoch: 31, iteration: 86

VAL AUROC: 0.889949, VAL Accus: 0.638478, VAL Senss: 0.700718, VAL Specs: 0.917542
AUROCs: Melanoma:0.847414 Melanocytic nevus:0.932809 Basal cell carcinoma:0.922892 Actinic keratosis:0.963994 Benign keratosis:0.854722 Dermatofibroma:0.811230 Vascular lesion:0.896582
Accus: Melanoma:0.428571 Melanocytic nevus:0.847662 Basal cell carcinoma:0.629630 Actinic keratosis:0.848485 Benign keratosis:0.540000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.605042 Melanocytic nevus:0.911011 Basal cell carcinoma:0.685185 Actinic keratosis:0.878788 Benign keratosis:0.650000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.905789 Melanocytic nevus:0.798220 Basal cell carcinoma:0.934461 Actinic keratosis:0.931748 Benign keratosis:0.915556 Dermatofibroma:0.969512 Vascular lesion:0.967513
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [111.0, 1135.0, 89.0, 43.0, 129.0, 9.0, 31.0]

TEST Student: Epoch: 31, iteration: 86

TEST AUROC: 0.903188, TEST Accus: 0.697750, TEST Senss: 0.824980, TEST Specs: 0.863447
AUROCs: Melanoma:0.863221 Melanocytic nevus:0.935339 Basal cell carcinoma:0.961384 Actinic keratosis:0.935607 Benign keratosis:0.892438 Dermatofibroma:0.735939 Vascular lesion:0.998390
Accus: Melanoma:0.480519 Melanocytic nevus:0.841364 Basal cell carcinoma:0.809091 Actinic keratosis:0.741379 Benign keratosis:0.602804 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.748918 Melanocytic nevus:0.946627 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.822870 Melanocytic nevus:0.728228 Basal cell carcinoma:0.880840 Actinic keratosis:0.892693 Benign keratosis:0.841199 Dermatofibroma:0.938786 Vascular lesion:0.939516
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_32.pth

Epoch: 32, iteration: 0/87, ==> train <===, loss: 1.741446, classification loss: 1.797198,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070694,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.014943,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.4336838202925156e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 506.0, 37.0, 21.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 32, iteration: 86

VAL AUROC: 0.866521, VAL Accus: 0.631467, VAL Senss: 0.711398, VAL Specs: 0.918431
AUROCs: Melanoma:0.839201 Melanocytic nevus:0.938026 Basal cell carcinoma:0.936967 Actinic keratosis:0.925574 Benign keratosis:0.878233 Dermatofibroma:0.666159 Vascular lesion:0.881489
Accus: Melanoma:0.563025 Melanocytic nevus:0.763198 Basal cell carcinoma:0.685185 Actinic keratosis:0.636364 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.672269 Melanocytic nevus:0.853695 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.730000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.850170 Melanocytic nevus:0.866469 Basal cell carcinoma:0.921776 Actinic keratosis:0.956567 Benign keratosis:0.888889 Dermatofibroma:0.970528 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1037.0, 95.0, 33.0, 136.0, 8.0, 28.0]

TEST Student: Epoch: 32, iteration: 86

TEST AUROC: 0.900913, TEST Accus: 0.673441, TEST Senss: 0.831760, TEST Specs: 0.866519
AUROCs: Melanoma:0.862557 Melanocytic nevus:0.938987 Basal cell carcinoma:0.971816 Actinic keratosis:0.907230 Benign keratosis:0.890440 Dermatofibroma:0.737832 Vascular lesion:0.997529
Accus: Melanoma:0.610390 Melanocytic nevus:0.768718 Basal cell carcinoma:0.863636 Actinic keratosis:0.568966 Benign keratosis:0.635514 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.822511 Melanocytic nevus:0.902891 Basal cell carcinoma:0.945455 Actinic keratosis:0.810345 Benign keratosis:0.841121 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.759529 Melanocytic nevus:0.828829 Basal cell carcinoma:0.853018 Actinic keratosis:0.928973 Benign keratosis:0.797335 Dermatofibroma:0.941295 Vascular lesion:0.956653
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_33.pth

Epoch: 33, iteration: 0/87, ==> train <===, loss: 1.769719, classification loss: 1.823591,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070250,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016378,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.090315438263264e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [51.0, 578.0, 38.0, 22.0, 49.0, 5.0, 12.0]

VAL Student: Epoch: 33, iteration: 86

VAL AUROC: 0.872848, VAL Accus: 0.610462, VAL Senss: 0.693463, VAL Specs: 0.915216
AUROCs: Melanoma:0.845039 Melanocytic nevus:0.932444 Basal cell carcinoma:0.938415 Actinic keratosis:0.960860 Benign keratosis:0.853511 Dermatofibroma:0.696011 Vascular lesion:0.883655
Accus: Melanoma:0.428571 Melanocytic nevus:0.871795 Basal cell carcinoma:0.703704 Actinic keratosis:0.666667 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.579832 Melanocytic nevus:0.915535 Basal cell carcinoma:0.796296 Actinic keratosis:0.757576 Benign keratosis:0.630000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.909194 Melanocytic nevus:0.759644 Basal cell carcinoma:0.910148 Actinic keratosis:0.944157 Benign keratosis:0.931111 Dermatofibroma:0.974593 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [111.0, 1160.0, 97.0, 35.0, 119.0, 8.0, 29.0]

TEST Student: Epoch: 33, iteration: 86

TEST AUROC: 0.905653, TEST Accus: 0.668697, TEST Senss: 0.823740, TEST Specs: 0.856533
AUROCs: Melanoma:0.872421 Melanocytic nevus:0.934384 Basal cell carcinoma:0.973791 Actinic keratosis:0.926585 Benign keratosis:0.892030 Dermatofibroma:0.742325 Vascular lesion:0.998033
Accus: Melanoma:0.480519 Melanocytic nevus:0.859896 Basal cell carcinoma:0.881818 Actinic keratosis:0.603448 Benign keratosis:0.556075 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.748918 Melanocytic nevus:0.958488 Basal cell carcinoma:0.972727 Actinic keratosis:0.810345 Benign keratosis:0.775701 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.821188 Melanocytic nevus:0.674174 Basal cell carcinoma:0.833071 Actinic keratosis:0.913643 Benign keratosis:0.851194 Dermatofibroma:0.946312 Vascular lesion:0.956149
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_34.pth

Epoch: 34, iteration: 0/87, ==> train <===, loss: 1.740686, classification loss: 1.786499,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067439,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021625,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.7812838944369375e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 570.0, 28.0, 26.0, 60.0, 6.0, 12.0]

VAL Student: Epoch: 34, iteration: 86

VAL AUROC: 0.871692, VAL Accus: 0.637448, VAL Senss: 0.704491, VAL Specs: 0.911256
AUROCs: Melanoma:0.860233 Melanocytic nevus:0.931361 Basal cell carcinoma:0.889711 Actinic keratosis:0.969227 Benign keratosis:0.854267 Dermatofibroma:0.712716 Vascular lesion:0.884332
Accus: Melanoma:0.521008 Melanocytic nevus:0.859729 Basal cell carcinoma:0.518519 Actinic keratosis:0.787879 Benign keratosis:0.600000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.926094 Basal cell carcinoma:0.574074 Actinic keratosis:0.878788 Benign keratosis:0.680000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.879682 Melanocytic nevus:0.759644 Basal cell carcinoma:0.968288 Actinic keratosis:0.931748 Benign keratosis:0.904444 Dermatofibroma:0.964431 Vascular lesion:0.970558
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [125.0, 1149.0, 75.0, 42.0, 131.0, 9.0, 31.0]

TEST Student: Epoch: 34, iteration: 86

TEST AUROC: 0.905729, TEST Accus: 0.688581, TEST Senss: 0.847128, TEST Specs: 0.852082
AUROCs: Melanoma:0.880528 Melanocytic nevus:0.932748 Basal cell carcinoma:0.960515 Actinic keratosis:0.933713 Benign keratosis:0.899080 Dermatofibroma:0.735164 Vascular lesion:0.998358
Accus: Melanoma:0.541126 Melanocytic nevus:0.851742 Basal cell carcinoma:0.681818 Actinic keratosis:0.724138 Benign keratosis:0.612150 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.826840 Melanocytic nevus:0.960712 Basal cell carcinoma:0.854545 Actinic keratosis:0.896552 Benign keratosis:0.845794 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.764013 Melanocytic nevus:0.678679 Basal cell carcinoma:0.939108 Actinic keratosis:0.892182 Benign keratosis:0.811771 Dermatofibroma:0.935775 Vascular lesion:0.943044
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_35.pth

Epoch: 35, iteration: 0/87, ==> train <===, loss: 1.740476, classification loss: 1.791945,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068929,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017460,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.503155504993244e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 532.0, 39.0, 21.0, 65.0, 5.0, 12.0]

VAL Student: Epoch: 35, iteration: 86

VAL AUROC: 0.847098, VAL Accus: 0.630128, VAL Senss: 0.699188, VAL Specs: 0.916553
AUROCs: Melanoma:0.848406 Melanocytic nevus:0.931312 Basal cell carcinoma:0.936986 Actinic keratosis:0.890508 Benign keratosis:0.886100 Dermatofibroma:0.567137 Vascular lesion:0.869239
Accus: Melanoma:0.487395 Melanocytic nevus:0.802413 Basal cell carcinoma:0.722222 Actinic keratosis:0.636364 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.889894 Basal cell carcinoma:0.796296 Actinic keratosis:0.696970 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.863791 Melanocytic nevus:0.830861 Basal cell carcinoma:0.931290 Actinic keratosis:0.950362 Benign keratosis:0.882222 Dermatofibroma:0.986789 Vascular lesion:0.970558
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1095.0, 91.0, 36.0, 143.0, 7.0, 29.0]

TEST Student: Epoch: 35, iteration: 86

TEST AUROC: 0.898998, TEST Accus: 0.680236, TEST Senss: 0.827082, TEST Specs: 0.855545
AUROCs: Melanoma:0.872554 Melanocytic nevus:0.934026 Basal cell carcinoma:0.974751 Actinic keratosis:0.909053 Benign keratosis:0.894212 Dermatofibroma:0.710418 Vascular lesion:0.997968
Accus: Melanoma:0.580087 Melanocytic nevus:0.811712 Basal cell carcinoma:0.827273 Actinic keratosis:0.620690 Benign keratosis:0.668224 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.848485 Melanocytic nevus:0.935508 Basal cell carcinoma:0.954545 Actinic keratosis:0.827586 Benign keratosis:0.859813 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.755605 Melanocytic nevus:0.756757 Basal cell carcinoma:0.868241 Actinic keratosis:0.921308 Benign keratosis:0.773459 Dermatofibroma:0.969895 Vascular lesion:0.943548
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_36.pth

Epoch: 36, iteration: 0/87, ==> train <===, loss: 1.750469, classification loss: 1.788417,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.065516,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027569,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.2528399544939195e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 559.0, 33.0, 26.0, 53.0, 5.0, 11.0]

VAL Student: Epoch: 36, iteration: 86

VAL AUROC: 0.862401, VAL Accus: 0.621053, VAL Senss: 0.714668, VAL Specs: 0.912568
AUROCs: Melanoma:0.860195 Melanocytic nevus:0.934964 Basal cell carcinoma:0.925554 Actinic keratosis:0.966438 Benign keratosis:0.865722 Dermatofibroma:0.605691 Vascular lesion:0.878240
Accus: Melanoma:0.529412 Melanocytic nevus:0.843137 Basal cell carcinoma:0.611111 Actinic keratosis:0.787879 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.747899 Melanocytic nevus:0.921569 Basal cell carcinoma:0.722222 Actinic keratosis:0.848485 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.846765 Melanocytic nevus:0.777448 Basal cell carcinoma:0.942918 Actinic keratosis:0.934850 Benign keratosis:0.914444 Dermatofibroma:0.979675 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1132.0, 91.0, 44.0, 120.0, 7.0, 27.0]

TEST Student: Epoch: 36, iteration: 86

TEST AUROC: 0.908548, TEST Accus: 0.682999, TEST Senss: 0.835615, TEST Specs: 0.860441
AUROCs: Melanoma:0.884653 Melanocytic nevus:0.937755 Basal cell carcinoma:0.974794 Actinic keratosis:0.933730 Benign keratosis:0.896132 Dermatofibroma:0.734708 Vascular lesion:0.998065
Accus: Melanoma:0.606061 Melanocytic nevus:0.839140 Basal cell carcinoma:0.827273 Actinic keratosis:0.758621 Benign keratosis:0.560748 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.883117 Melanocytic nevus:0.951075 Basal cell carcinoma:0.890909 Actinic keratosis:0.862069 Benign keratosis:0.794393 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.722534 Melanocytic nevus:0.717718 Basal cell carcinoma:0.900787 Actinic keratosis:0.900358 Benign keratosis:0.833426 Dermatofibroma:0.959860 Vascular lesion:0.988407
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_37.pth

Epoch: 37, iteration: 0/87, ==> train <===, loss: 1.756466, classification loss: 1.788521,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066918,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.034863,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.0275559590445276e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 593.0, 31.0, 26.0, 54.0, 6.0, 12.0]

VAL Student: Epoch: 37, iteration: 86

VAL AUROC: 0.867481, VAL Accus: 0.633365, VAL Senss: 0.707267, VAL Specs: 0.915220
AUROCs: Melanoma:0.859423 Melanocytic nevus:0.933716 Basal cell carcinoma:0.922265 Actinic keratosis:0.971609 Benign keratosis:0.843611 Dermatofibroma:0.662221 Vascular lesion:0.879526
Accus: Melanoma:0.462185 Melanocytic nevus:0.894419 Basal cell carcinoma:0.574074 Actinic keratosis:0.787879 Benign keratosis:0.540000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.647059 Melanocytic nevus:0.935143 Basal cell carcinoma:0.685185 Actinic keratosis:0.848485 Benign keratosis:0.660000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.903519 Melanocytic nevus:0.732938 Basal cell carcinoma:0.949260 Actinic keratosis:0.942089 Benign keratosis:0.924444 Dermatofibroma:0.974593 Vascular lesion:0.979695
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 1178.0, 85.0, 39.0, 122.0, 8.0, 31.0]

TEST Student: Epoch: 37, iteration: 86

TEST AUROC: 0.907603, TEST Accus: 0.681656, TEST Senss: 0.823065, TEST Specs: 0.862224
AUROCs: Melanoma:0.881775 Melanocytic nevus:0.935793 Basal cell carcinoma:0.971491 Actinic keratosis:0.935766 Benign keratosis:0.901566 Dermatofibroma:0.728231 Vascular lesion:0.998602
Accus: Melanoma:0.519481 Melanocytic nevus:0.873239 Basal cell carcinoma:0.772727 Actinic keratosis:0.672414 Benign keratosis:0.570093 Dermatofibroma:0.363636 Vascular lesion:1.000000
Senss: Melanoma:0.779221 Melanocytic nevus:0.964418 Basal cell carcinoma:0.881818 Actinic keratosis:0.827586 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.811659 Melanocytic nevus:0.650150 Basal cell carcinoma:0.900262 Actinic keratosis:0.917731 Benign keratosis:0.852304 Dermatofibroma:0.948821 Vascular lesion:0.954637
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_38.pth

Epoch: 38, iteration: 0/87, ==> train <===, loss: 1.769195, classification loss: 1.815125,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068715,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022786,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.824800363140075e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 516.0, 31.0, 28.0, 63.0, 5.0, 12.0]

VAL Student: Epoch: 38, iteration: 86

VAL AUROC: 0.872484, VAL Accus: 0.641365, VAL Senss: 0.711755, VAL Specs: 0.914002
AUROCs: Melanoma:0.839087 Melanocytic nevus:0.935300 Basal cell carcinoma:0.921267 Actinic keratosis:0.967629 Benign keratosis:0.876511 Dermatofibroma:0.715955 Vascular lesion:0.851641
Accus: Melanoma:0.546218 Melanocytic nevus:0.778281 Basal cell carcinoma:0.574074 Actinic keratosis:0.848485 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.876320 Basal cell carcinoma:0.703704 Actinic keratosis:0.909091 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.852440 Melanocytic nevus:0.845697 Basal cell carcinoma:0.946089 Actinic keratosis:0.906929 Benign keratosis:0.884444 Dermatofibroma:0.976626 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1046.0, 88.0, 46.0, 134.0, 7.0, 28.0]

TEST Student: Epoch: 38, iteration: 86

TEST AUROC: 0.903036, TEST Accus: 0.688876, TEST Senss: 0.836425, TEST Specs: 0.852900
AUROCs: Melanoma:0.867121 Melanocytic nevus:0.936413 Basal cell carcinoma:0.964565 Actinic keratosis:0.934585 Benign keratosis:0.886844 Dermatofibroma:0.734115 Vascular lesion:0.997610
Accus: Melanoma:0.606061 Melanocytic nevus:0.775389 Basal cell carcinoma:0.800000 Actinic keratosis:0.793103 Benign keratosis:0.626168 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.848485 Melanocytic nevus:0.928095 Basal cell carcinoma:0.909091 Actinic keratosis:0.896552 Benign keratosis:0.850467 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.735987 Melanocytic nevus:0.777778 Basal cell carcinoma:0.895013 Actinic keratosis:0.862545 Benign keratosis:0.782898 Dermatofibroma:0.943803 Vascular lesion:0.972278
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_39.pth

Epoch: 39, iteration: 0/87, ==> train <===, loss: 1.737695, classification loss: 1.784178,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066985,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020502,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.6423203268260674e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 581.0, 28.0, 26.0, 39.0, 6.0, 12.0]

VAL Student: Epoch: 39, iteration: 86

VAL AUROC: 0.887910, VAL Accus: 0.614620, VAL Senss: 0.692534, VAL Specs: 0.911960
AUROCs: Melanoma:0.863953 Melanocytic nevus:0.939785 Basal cell carcinoma:0.917293 Actinic keratosis:0.970606 Benign keratosis:0.824144 Dermatofibroma:0.811738 Vascular lesion:0.887851
Accus: Melanoma:0.554622 Melanocytic nevus:0.876320 Basal cell carcinoma:0.518519 Actinic keratosis:0.787879 Benign keratosis:0.390000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.764706 Melanocytic nevus:0.936652 Basal cell carcinoma:0.592593 Actinic keratosis:0.878788 Benign keratosis:0.500000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.847900 Melanocytic nevus:0.744807 Basal cell carcinoma:0.954545 Actinic keratosis:0.929679 Benign keratosis:0.955556 Dermatofibroma:0.965447 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1152.0, 80.0, 42.0, 99.0, 9.0, 28.0]

TEST Student: Epoch: 39, iteration: 86

TEST AUROC: 0.908054, TEST Accus: 0.671337, TEST Senss: 0.829422, TEST Specs: 0.856971
AUROCs: Melanoma:0.884722 Melanocytic nevus:0.938723 Basal cell carcinoma:0.958988 Actinic keratosis:0.943747 Benign keratosis:0.885528 Dermatofibroma:0.746248 Vascular lesion:0.998423
Accus: Melanoma:0.619048 Melanocytic nevus:0.853966 Basal cell carcinoma:0.727273 Actinic keratosis:0.724138 Benign keratosis:0.462617 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.878788 Melanocytic nevus:0.964418 Basal cell carcinoma:0.863636 Actinic keratosis:0.862069 Benign keratosis:0.691589 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.718610 Melanocytic nevus:0.666667 Basal cell carcinoma:0.911286 Actinic keratosis:0.894226 Benign keratosis:0.898945 Dermatofibroma:0.934772 Vascular lesion:0.974294
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_40.pth

Epoch: 40, iteration: 0/87, ==> train <===, loss: 1.749337, classification loss: 1.800600,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070559,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019297,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.4780882941434607e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 592.0, 34.0, 22.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 40, iteration: 86

VAL AUROC: 0.847555, VAL Accus: 0.624962, VAL Senss: 0.682320, VAL Specs: 0.909891
AUROCs: Melanoma:0.861263 Melanocytic nevus:0.938357 Basal cell carcinoma:0.920210 Actinic keratosis:0.896650 Benign keratosis:0.856011 Dermatofibroma:0.587938 Vascular lesion:0.872453
Accus: Melanoma:0.563025 Melanocytic nevus:0.892911 Basal cell carcinoma:0.629630 Actinic keratosis:0.666667 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.945701 Basal cell carcinoma:0.685185 Actinic keratosis:0.696970 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.862656 Melanocytic nevus:0.700297 Basal cell carcinoma:0.951374 Actinic keratosis:0.952430 Benign keratosis:0.928889 Dermatofibroma:0.984756 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1196.0, 81.0, 36.0, 119.0, 7.0, 26.0]

TEST Student: Epoch: 40, iteration: 86

TEST AUROC: 0.910267, TEST Accus: 0.649954, TEST Senss: 0.823343, TEST Specs: 0.853830
AUROCs: Melanoma:0.895376 Melanocytic nevus:0.935735 Basal cell carcinoma:0.973233 Actinic keratosis:0.927440 Benign keratosis:0.902225 Dermatofibroma:0.740478 Vascular lesion:0.997382
Accus: Melanoma:0.593074 Melanocytic nevus:0.886583 Basal cell carcinoma:0.736364 Actinic keratosis:0.620690 Benign keratosis:0.556075 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.874459 Melanocytic nevus:0.974796 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.803738 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.750561 Melanocytic nevus:0.591592 Basal cell carcinoma:0.914436 Actinic keratosis:0.933061 Benign keratosis:0.838423 Dermatofibroma:0.966884 Vascular lesion:0.981855
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_41.pth

Epoch: 41, iteration: 0/87, ==> train <===, loss: 1.744537, classification loss: 1.785963,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069522,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028096,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.3302794647291146e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [86.0, 523.0, 31.0, 19.0, 58.0, 5.0, 12.0]

VAL Student: Epoch: 41, iteration: 86

VAL AUROC: 0.858404, VAL Accus: 0.621980, VAL Senss: 0.686834, VAL Specs: 0.917992
AUROCs: Melanoma:0.876983 Melanocytic nevus:0.943155 Basal cell carcinoma:0.913202 Actinic keratosis:0.909404 Benign keratosis:0.876289 Dermatofibroma:0.620554 Vascular lesion:0.869239
Accus: Melanoma:0.722689 Melanocytic nevus:0.788839 Basal cell carcinoma:0.574074 Actinic keratosis:0.575758 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.815126 Melanocytic nevus:0.886878 Basal cell carcinoma:0.666667 Actinic keratosis:0.666667 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.785471 Melanocytic nevus:0.833828 Basal cell carcinoma:0.963002 Actinic keratosis:0.959669 Benign keratosis:0.914444 Dermatofibroma:0.985772 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [177.0, 1069.0, 81.0, 36.0, 122.0, 7.0, 29.0]

TEST Student: Epoch: 41, iteration: 86

TEST AUROC: 0.903203, TEST Accus: 0.677069, TEST Senss: 0.821356, TEST Specs: 0.865990
AUROCs: Melanoma:0.886368 Melanocytic nevus:0.939409 Basal cell carcinoma:0.972207 Actinic keratosis:0.922348 Benign keratosis:0.887147 Dermatofibroma:0.716987 Vascular lesion:0.997951
Accus: Melanoma:0.766234 Melanocytic nevus:0.792439 Basal cell carcinoma:0.736364 Actinic keratosis:0.620690 Benign keratosis:0.570093 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.930736 Melanocytic nevus:0.927354 Basal cell carcinoma:0.872727 Actinic keratosis:0.793103 Benign keratosis:0.771028 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.652466 Melanocytic nevus:0.785285 Basal cell carcinoma:0.931759 Actinic keratosis:0.931528 Benign keratosis:0.832315 Dermatofibroma:0.967888 Vascular lesion:0.960685
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_42.pth

Epoch: 42, iteration: 0/87, ==> train <===, loss: 1.744758, classification loss: 1.797313,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.064781,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012226,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.1972515182562032e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 518.0, 37.0, 23.0, 65.0, 5.0, 12.0]

VAL Student: Epoch: 42, iteration: 86

VAL AUROC: 0.863425, VAL Accus: 0.636481, VAL Senss: 0.715276, VAL Specs: 0.918629
AUROCs: Melanoma:0.839411 Melanocytic nevus:0.936464 Basal cell carcinoma:0.936360 Actinic keratosis:0.948356 Benign keratosis:0.887611 Dermatofibroma:0.626334 Vascular lesion:0.869442
Accus: Melanoma:0.529412 Melanocytic nevus:0.781297 Basal cell carcinoma:0.685185 Actinic keratosis:0.696970 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.877828 Basal cell carcinoma:0.851852 Actinic keratosis:0.727273 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.856981 Melanocytic nevus:0.860534 Basal cell carcinoma:0.926004 Actinic keratosis:0.932782 Benign keratosis:0.897778 Dermatofibroma:0.978659 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1053.0, 93.0, 37.0, 134.0, 7.0, 28.0]

TEST Student: Epoch: 42, iteration: 86

TEST AUROC: 0.902392, TEST Accus: 0.675180, TEST Senss: 0.823211, TEST Specs: 0.858693
AUROCs: Melanoma:0.868237 Melanocytic nevus:0.936772 Basal cell carcinoma:0.971296 Actinic keratosis:0.927132 Benign keratosis:0.889781 Dermatofibroma:0.725836 Vascular lesion:0.997691
Accus: Melanoma:0.614719 Melanocytic nevus:0.780578 Basal cell carcinoma:0.845455 Actinic keratosis:0.637931 Benign keratosis:0.626168 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.839827 Melanocytic nevus:0.924388 Basal cell carcinoma:0.945455 Actinic keratosis:0.862069 Benign keratosis:0.827103 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.744395 Melanocytic nevus:0.789790 Basal cell carcinoma:0.864567 Actinic keratosis:0.896781 Benign keratosis:0.796780 Dermatofibroma:0.956849 Vascular lesion:0.961694
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_43.pth

Epoch: 43, iteration: 0/87, ==> train <===, loss: 1.747038, classification loss: 1.785403,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.064706,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026340,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0775263664305828e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 523.0, 33.0, 24.0, 67.0, 5.0, 10.0]

VAL Student: Epoch: 43, iteration: 86

VAL AUROC: 0.867005, VAL Accus: 0.618716, VAL Senss: 0.713020, VAL Specs: 0.915294
AUROCs: Melanoma:0.837656 Melanocytic nevus:0.937511 Basal cell carcinoma:0.933893 Actinic keratosis:0.965654 Benign keratosis:0.877933 Dermatofibroma:0.647421 Vascular lesion:0.868968
Accus: Melanoma:0.554622 Melanocytic nevus:0.788839 Basal cell carcinoma:0.611111 Actinic keratosis:0.727273 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.705882 Melanocytic nevus:0.882353 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.750000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.845630 Melanocytic nevus:0.839763 Basal cell carcinoma:0.946089 Actinic keratosis:0.922441 Benign keratosis:0.886667 Dermatofibroma:0.971545 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1059.0, 83.0, 45.0, 137.0, 7.0, 25.0]

TEST Student: Epoch: 43, iteration: 86

TEST AUROC: 0.905594, TEST Accus: 0.670092, TEST Senss: 0.823520, TEST Specs: 0.853612
AUROCs: Melanoma:0.870773 Melanocytic nevus:0.938185 Basal cell carcinoma:0.967826 Actinic keratosis:0.932497 Benign keratosis:0.895691 Dermatofibroma:0.742348 Vascular lesion:0.991838
Accus: Melanoma:0.610390 Melanocytic nevus:0.785026 Basal cell carcinoma:0.754545 Actinic keratosis:0.775862 Benign keratosis:0.640187 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.839827 Melanocytic nevus:0.927354 Basal cell carcinoma:0.909091 Actinic keratosis:0.879310 Benign keratosis:0.864486 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.726457 Melanocytic nevus:0.779279 Basal cell carcinoma:0.891339 Actinic keratosis:0.874808 Benign keratosis:0.770683 Dermatofibroma:0.943302 Vascular lesion:0.989415
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_44.pth

Epoch: 44, iteration: 0/87, ==> train <===, loss: 1.796772, classification loss: 1.845211,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067980,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019541,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.697737297875246e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 581.0, 31.0, 24.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 44, iteration: 86

VAL AUROC: 0.864780, VAL Accus: 0.624682, VAL Senss: 0.714747, VAL Specs: 0.913347
AUROCs: Melanoma:0.859651 Melanocytic nevus:0.941584 Basal cell carcinoma:0.919349 Actinic keratosis:0.969478 Benign keratosis:0.880422 Dermatofibroma:0.618140 Vascular lesion:0.864839
Accus: Melanoma:0.512605 Melanocytic nevus:0.876320 Basal cell carcinoma:0.574074 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.941176 Basal cell carcinoma:0.685185 Actinic keratosis:0.848485 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.870602 Melanocytic nevus:0.738872 Basal cell carcinoma:0.953488 Actinic keratosis:0.947260 Benign keratosis:0.905556 Dermatofibroma:0.988821 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 1164.0, 83.0, 41.0, 122.0, 7.0, 27.0]

TEST Student: Epoch: 44, iteration: 86

TEST AUROC: 0.912330, TEST Accus: 0.666852, TEST Senss: 0.845697, TEST Specs: 0.858322
AUROCs: Melanoma:0.886965 Melanocytic nevus:0.939484 Basal cell carcinoma:0.973982 Actinic keratosis:0.934585 Benign keratosis:0.907315 Dermatofibroma:0.745815 Vascular lesion:0.998163
Accus: Melanoma:0.584416 Melanocytic nevus:0.862861 Basal cell carcinoma:0.754545 Actinic keratosis:0.706897 Benign keratosis:0.570093 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.857143 Melanocytic nevus:0.965159 Basal cell carcinoma:0.881818 Actinic keratosis:0.879310 Benign keratosis:0.836449 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.754484 Melanocytic nevus:0.663664 Basal cell carcinoma:0.911811 Actinic keratosis:0.921819 Benign keratosis:0.811771 Dermatofibroma:0.967386 Vascular lesion:0.977319
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_45.pth

Epoch: 45, iteration: 0/87, ==> train <===, loss: 1.733551, classification loss: 1.787802,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067997,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.013746,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.727963568087721e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 538.0, 43.0, 21.0, 45.0, 5.0, 12.0]

VAL Student: Epoch: 45, iteration: 86

VAL AUROC: 0.873116, VAL Accus: 0.617033, VAL Senss: 0.705377, VAL Specs: 0.913124
AUROCs: Melanoma:0.842530 Melanocytic nevus:0.928237 Basal cell carcinoma:0.948007 Actinic keratosis:0.952963 Benign keratosis:0.847311 Dermatofibroma:0.689278 Vascular lesion:0.903486
Accus: Melanoma:0.512605 Melanocytic nevus:0.811463 Basal cell carcinoma:0.796296 Actinic keratosis:0.636364 Benign keratosis:0.450000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.883861 Basal cell carcinoma:0.925926 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.869467 Melanocytic nevus:0.824926 Basal cell carcinoma:0.875264 Actinic keratosis:0.945191 Benign keratosis:0.940000 Dermatofibroma:0.961382 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [130.0, 1088.0, 97.0, 33.0, 102.0, 8.0, 29.0]

TEST Student: Epoch: 45, iteration: 86

TEST AUROC: 0.897165, TEST Accus: 0.656548, TEST Senss: 0.816075, TEST Specs: 0.860712
AUROCs: Melanoma:0.865563 Melanocytic nevus:0.934445 Basal cell carcinoma:0.971215 Actinic keratosis:0.908727 Benign keratosis:0.879405 Dermatofibroma:0.722346 Vascular lesion:0.998455
Accus: Melanoma:0.562771 Melanocytic nevus:0.806523 Basal cell carcinoma:0.881818 Actinic keratosis:0.568966 Benign keratosis:0.476636 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.787879 Melanocytic nevus:0.931801 Basal cell carcinoma:0.990909 Actinic keratosis:0.810345 Benign keratosis:0.691589 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.777466 Melanocytic nevus:0.765766 Basal cell carcinoma:0.776378 Actinic keratosis:0.922841 Benign keratosis:0.895614 Dermatofibroma:0.927747 Vascular lesion:0.959173
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_46.pth

Epoch: 46, iteration: 0/87, ==> train <===, loss: 1.762520, classification loss: 1.811501,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070873,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021892,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.855167211278949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 519.0, 34.0, 25.0, 43.0, 5.0, 12.0]

VAL Student: Epoch: 46, iteration: 86

VAL AUROC: 0.883224, VAL Accus: 0.614392, VAL Senss: 0.710301, VAL Specs: 0.913395
AUROCs: Melanoma:0.848215 Melanocytic nevus:0.931988 Basal cell carcinoma:0.940608 Actinic keratosis:0.954028 Benign keratosis:0.854333 Dermatofibroma:0.763720 Vascular lesion:0.889679
Accus: Melanoma:0.588235 Melanocytic nevus:0.782805 Basal cell carcinoma:0.629630 Actinic keratosis:0.757576 Benign keratosis:0.430000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.861237 Basal cell carcinoma:0.796296 Actinic keratosis:0.848485 Benign keratosis:0.560000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.843360 Melanocytic nevus:0.845697 Basal cell carcinoma:0.911205 Actinic keratosis:0.908997 Benign keratosis:0.944444 Dermatofibroma:0.959350 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1055.0, 94.0, 42.0, 100.0, 8.0, 28.0]

TEST Student: Epoch: 46, iteration: 86

TEST AUROC: 0.901138, TEST Accus: 0.675276, TEST Senss: 0.817740, TEST Specs: 0.859866
AUROCs: Melanoma:0.867339 Melanocytic nevus:0.935984 Basal cell carcinoma:0.968719 Actinic keratosis:0.932550 Benign keratosis:0.879677 Dermatofibroma:0.725745 Vascular lesion:0.997951
Accus: Melanoma:0.632035 Melanocytic nevus:0.782061 Basal cell carcinoma:0.854545 Actinic keratosis:0.724138 Benign keratosis:0.467290 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.818182 Melanocytic nevus:0.916234 Basal cell carcinoma:0.945455 Actinic keratosis:0.862069 Benign keratosis:0.682243 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.747197 Melanocytic nevus:0.791291 Basal cell carcinoma:0.834646 Actinic keratosis:0.869699 Benign keratosis:0.887285 Dermatofibroma:0.925740 Vascular lesion:0.963206
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_47.pth

Epoch: 47, iteration: 0/87, ==> train <===, loss: 1.756231, classification loss: 1.803584,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070045,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022693,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.069650490151055e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 527.0, 33.0, 28.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 47, iteration: 86

VAL AUROC: 0.873800, VAL Accus: 0.631884, VAL Senss: 0.709332, VAL Specs: 0.919935
AUROCs: Melanoma:0.838352 Melanocytic nevus:0.933787 Basal cell carcinoma:0.931290 Actinic keratosis:0.962395 Benign keratosis:0.865956 Dermatofibroma:0.718559 Vascular lesion:0.866261
Accus: Melanoma:0.546218 Melanocytic nevus:0.794872 Basal cell carcinoma:0.611111 Actinic keratosis:0.848485 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.868778 Basal cell carcinoma:0.777778 Actinic keratosis:0.878788 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.859251 Melanocytic nevus:0.854599 Basal cell carcinoma:0.927061 Actinic keratosis:0.913133 Benign keratosis:0.932222 Dermatofibroma:0.980691 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1067.0, 95.0, 42.0, 114.0, 8.0, 29.0]

TEST Student: Epoch: 47, iteration: 86

TEST AUROC: 0.902935, TEST Accus: 0.688707, TEST Senss: 0.818797, TEST Specs: 0.864758
AUROCs: Melanoma:0.867102 Melanocytic nevus:0.938548 Basal cell carcinoma:0.969115 Actinic keratosis:0.933625 Benign keratosis:0.887171 Dermatofibroma:0.726566 Vascular lesion:0.998423
Accus: Melanoma:0.610390 Melanocytic nevus:0.790956 Basal cell carcinoma:0.863636 Actinic keratosis:0.724138 Benign keratosis:0.532710 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.809524 Melanocytic nevus:0.916234 Basal cell carcinoma:0.963636 Actinic keratosis:0.862069 Benign keratosis:0.771028 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.760090 Melanocytic nevus:0.800300 Basal cell carcinoma:0.850394 Actinic keratosis:0.874297 Benign keratosis:0.856746 Dermatofibroma:0.957852 Vascular lesion:0.953629
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_48.pth

Epoch: 48, iteration: 0/87, ==> train <===, loss: 1.759799, classification loss: 1.796733,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.072367,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.035433,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.362685441135949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 531.0, 33.0, 27.0, 56.0, 5.0, 12.0]

VAL Student: Epoch: 48, iteration: 86

VAL AUROC: 0.874348, VAL Accus: 0.629557, VAL Senss: 0.712294, VAL Specs: 0.916547
AUROCs: Melanoma:0.841843 Melanocytic nevus:0.931979 Basal cell carcinoma:0.936712 Actinic keratosis:0.964652 Benign keratosis:0.862133 Dermatofibroma:0.722815 Vascular lesion:0.860305
Accus: Melanoma:0.504202 Melanocytic nevus:0.800905 Basal cell carcinoma:0.611111 Actinic keratosis:0.818182 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.876320 Basal cell carcinoma:0.777778 Actinic keratosis:0.878788 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.866061 Melanocytic nevus:0.845697 Basal cell carcinoma:0.921776 Actinic keratosis:0.910031 Benign keratosis:0.920000 Dermatofibroma:0.976626 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 1073.0, 94.0, 43.0, 120.0, 8.0, 30.0]

TEST Student: Epoch: 48, iteration: 86

TEST AUROC: 0.900242, TEST Accus: 0.689844, TEST Senss: 0.823329, TEST Specs: 0.858122
AUROCs: Melanoma:0.866890 Melanocytic nevus:0.936083 Basal cell carcinoma:0.965693 Actinic keratosis:0.931995 Benign keratosis:0.882856 Dermatofibroma:0.719997 Vascular lesion:0.998179
Accus: Melanoma:0.545455 Melanocytic nevus:0.795404 Basal cell carcinoma:0.854545 Actinic keratosis:0.741379 Benign keratosis:0.560748 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.809524 Melanocytic nevus:0.920682 Basal cell carcinoma:0.945455 Actinic keratosis:0.862069 Benign keratosis:0.771028 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.767937 Melanocytic nevus:0.786787 Basal cell carcinoma:0.840945 Actinic keratosis:0.873275 Benign keratosis:0.838978 Dermatofibroma:0.947316 Vascular lesion:0.951613
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_49.pth

Epoch: 49, iteration: 0/87, ==> train <===, loss: 1.779547, classification loss: 1.812782,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.061644,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028409,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.726416897022355e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [51.0, 538.0, 35.0, 29.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 49, iteration: 86

VAL AUROC: 0.870673, VAL Accus: 0.635639, VAL Senss: 0.719465, VAL Specs: 0.915363
AUROCs: Melanoma:0.820582 Melanocytic nevus:0.933810 Basal cell carcinoma:0.933404 Actinic keratosis:0.964401 Benign keratosis:0.857211 Dermatofibroma:0.713288 Vascular lesion:0.872014
Accus: Melanoma:0.428571 Melanocytic nevus:0.811463 Basal cell carcinoma:0.648148 Actinic keratosis:0.878788 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.596639 Melanocytic nevus:0.892911 Basal cell carcinoma:0.814815 Actinic keratosis:0.939394 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.888763 Melanocytic nevus:0.830861 Basal cell carcinoma:0.917548 Actinic keratosis:0.905895 Benign keratosis:0.912222 Dermatofibroma:0.968496 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [116.0, 1081.0, 93.0, 45.0, 129.0, 8.0, 28.0]

TEST Student: Epoch: 49, iteration: 86

TEST AUROC: 0.900595, TEST Accus: 0.684926, TEST Senss: 0.814633, TEST Specs: 0.852371
AUROCs: Melanoma:0.857990 Melanocytic nevus:0.933893 Basal cell carcinoma:0.967044 Actinic keratosis:0.937298 Benign keratosis:0.882731 Dermatofibroma:0.727911 Vascular lesion:0.997301
Accus: Melanoma:0.502165 Melanocytic nevus:0.801334 Basal cell carcinoma:0.845455 Actinic keratosis:0.775862 Benign keratosis:0.602804 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.770563 Melanocytic nevus:0.935508 Basal cell carcinoma:0.954545 Actinic keratosis:0.862069 Benign keratosis:0.789720 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.802130 Melanocytic nevus:0.761261 Basal cell carcinoma:0.836745 Actinic keratosis:0.852836 Benign keratosis:0.815103 Dermatofibroma:0.925740 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_50.pth

Epoch: 50, iteration: 0/87, ==> train <===, loss: 1.750539, classification loss: 1.802374,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068011,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016177,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.15377520732012e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 550.0, 35.0, 22.0, 56.0, 6.0, 12.0]

VAL Student: Epoch: 50, iteration: 86

VAL AUROC: 0.881418, VAL Accus: 0.640631, VAL Senss: 0.723578, VAL Specs: 0.916197
AUROCs: Melanoma:0.861139 Melanocytic nevus:0.940156 Basal cell carcinoma:0.928118 Actinic keratosis:0.957538 Benign keratosis:0.859000 Dermatofibroma:0.738694 Vascular lesion:0.885279
Accus: Melanoma:0.605042 Melanocytic nevus:0.829563 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.560000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.918552 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.700000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.844495 Melanocytic nevus:0.804154 Basal cell carcinoma:0.946089 Actinic keratosis:0.960703 Benign keratosis:0.918889 Dermatofibroma:0.965447 Vascular lesion:0.973604
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1111.0, 88.0, 31.0, 122.0, 10.0, 29.0]

TEST Student: Epoch: 50, iteration: 86

TEST AUROC: 0.907120, TEST Accus: 0.677365, TEST Senss: 0.826164, TEST Specs: 0.864379
AUROCs: Melanoma:0.880203 Melanocytic nevus:0.938943 Basal cell carcinoma:0.970876 Actinic keratosis:0.925158 Benign keratosis:0.898507 Dermatofibroma:0.737604 Vascular lesion:0.998553
Accus: Melanoma:0.623377 Melanocytic nevus:0.823573 Basal cell carcinoma:0.800000 Actinic keratosis:0.534483 Benign keratosis:0.570093 Dermatofibroma:0.454545 Vascular lesion:0.935484
Senss: Melanoma:0.857143 Melanocytic nevus:0.951075 Basal cell carcinoma:0.900000 Actinic keratosis:0.775862 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.741592 Melanocytic nevus:0.738739 Basal cell carcinoma:0.894488 Actinic keratosis:0.938682 Benign keratosis:0.841199 Dermatofibroma:0.936779 Vascular lesion:0.959173
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_51.pth

Epoch: 51, iteration: 0/87, ==> train <===, loss: 1.785950, classification loss: 1.830450,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.071111,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026611,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.638397686588108e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 573.0, 29.0, 27.0, 44.0, 5.0, 12.0]

VAL Student: Epoch: 51, iteration: 86

VAL AUROC: 0.870714, VAL Accus: 0.618085, VAL Senss: 0.687828, VAL Specs: 0.914633
AUROCs: Melanoma:0.876945 Melanocytic nevus:0.938352 Basal cell carcinoma:0.921561 Actinic keratosis:0.972831 Benign keratosis:0.834978 Dermatofibroma:0.674797 Vascular lesion:0.875533
Accus: Melanoma:0.554622 Melanocytic nevus:0.864253 Basal cell carcinoma:0.537037 Actinic keratosis:0.818182 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.926094 Basal cell carcinoma:0.611111 Actinic keratosis:0.878788 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.843360 Melanocytic nevus:0.750742 Basal cell carcinoma:0.960888 Actinic keratosis:0.938987 Benign keratosis:0.951111 Dermatofibroma:0.984756 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [150.0, 1141.0, 83.0, 42.0, 106.0, 9.0, 29.0]

TEST Student: Epoch: 51, iteration: 86

TEST AUROC: 0.909569, TEST Accus: 0.687678, TEST Senss: 0.831879, TEST Specs: 0.860962
AUROCs: Melanoma:0.884954 Melanocytic nevus:0.938655 Basal cell carcinoma:0.967693 Actinic keratosis:0.942100 Benign keratosis:0.890982 Dermatofibroma:0.744196 Vascular lesion:0.998407
Accus: Melanoma:0.649351 Melanocytic nevus:0.845812 Basal cell carcinoma:0.754545 Actinic keratosis:0.724138 Benign keratosis:0.495327 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.891775 Melanocytic nevus:0.959970 Basal cell carcinoma:0.881818 Actinic keratosis:0.879310 Benign keratosis:0.710280 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.707960 Melanocytic nevus:0.696697 Basal cell carcinoma:0.917060 Actinic keratosis:0.896781 Benign keratosis:0.897279 Dermatofibroma:0.961867 Vascular lesion:0.949093
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_52.pth

Epoch: 52, iteration: 0/87, ==> train <===, loss: 1.758654, classification loss: 1.794384,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.065448,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029718,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.1745579179292974e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [50.0, 574.0, 34.0, 28.0, 50.0, 6.0, 12.0]

VAL Student: Epoch: 52, iteration: 86

VAL AUROC: 0.892336, VAL Accus: 0.634149, VAL Senss: 0.687738, VAL Specs: 0.913980
AUROCs: Melanoma:0.836330 Melanocytic nevus:0.934539 Basal cell carcinoma:0.922441 Actinic keratosis:0.968443 Benign keratosis:0.848700 Dermatofibroma:0.841209 Vascular lesion:0.894687
Accus: Melanoma:0.420168 Melanocytic nevus:0.865762 Basal cell carcinoma:0.629630 Actinic keratosis:0.848485 Benign keratosis:0.500000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.596639 Melanocytic nevus:0.918552 Basal cell carcinoma:0.685185 Actinic keratosis:0.878788 Benign keratosis:0.560000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.904654 Melanocytic nevus:0.771513 Basal cell carcinoma:0.931290 Actinic keratosis:0.927611 Benign keratosis:0.940000 Dermatofibroma:0.948171 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [118.0, 1148.0, 91.0, 42.0, 114.0, 10.0, 30.0]

TEST Student: Epoch: 52, iteration: 86

TEST AUROC: 0.905219, TEST Accus: 0.695462, TEST Senss: 0.835013, TEST Specs: 0.858647
AUROCs: Melanoma:0.867043 Melanocytic nevus:0.936257 Basal cell carcinoma:0.962940 Actinic keratosis:0.934567 Benign keratosis:0.892977 Dermatofibroma:0.744424 Vascular lesion:0.998325
Accus: Melanoma:0.510823 Melanocytic nevus:0.851001 Basal cell carcinoma:0.827273 Actinic keratosis:0.724138 Benign keratosis:0.532710 Dermatofibroma:0.454545 Vascular lesion:0.967742
Senss: Melanoma:0.753247 Melanocytic nevus:0.955523 Basal cell carcinoma:0.909091 Actinic keratosis:0.879310 Benign keratosis:0.757009 Dermatofibroma:0.590909 Vascular lesion:1.000000
Specs: Melanoma:0.814462 Melanocytic nevus:0.702703 Basal cell carcinoma:0.873491 Actinic keratosis:0.883495 Benign keratosis:0.870072 Dermatofibroma:0.916708 Vascular lesion:0.949597
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_53.pth

Epoch: 53, iteration: 0/87, ==> train <===, loss: 1.761133, classification loss: 1.804780,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067809,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024162,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.7571021261363677e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 569.0, 34.0, 22.0, 59.0, 5.0, 12.0]

VAL Student: Epoch: 53, iteration: 86

VAL AUROC: 0.879441, VAL Accus: 0.618229, VAL Senss: 0.721989, VAL Specs: 0.914045
AUROCs: Melanoma:0.848158 Melanocytic nevus:0.934221 Basal cell carcinoma:0.927414 Actinic keratosis:0.966720 Benign keratosis:0.871711 Dermatofibroma:0.725292 Vascular lesion:0.882572
Accus: Melanoma:0.470588 Melanocytic nevus:0.858220 Basal cell carcinoma:0.629630 Actinic keratosis:0.666667 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.912519 Basal cell carcinoma:0.740741 Actinic keratosis:0.818182 Benign keratosis:0.710000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.888763 Melanocytic nevus:0.786350 Basal cell carcinoma:0.936575 Actinic keratosis:0.932782 Benign keratosis:0.906667 Dermatofibroma:0.968496 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [121.0, 1132.0, 89.0, 40.0, 129.0, 9.0, 28.0]

TEST Student: Epoch: 53, iteration: 86

TEST AUROC: 0.906042, TEST Accus: 0.682402, TEST Senss: 0.834917, TEST Specs: 0.857790
AUROCs: Melanoma:0.876057 Melanocytic nevus:0.934846 Basal cell carcinoma:0.967335 Actinic keratosis:0.928735 Benign keratosis:0.898914 Dermatofibroma:0.738311 Vascular lesion:0.998098
Accus: Melanoma:0.523810 Melanocytic nevus:0.839140 Basal cell carcinoma:0.809091 Actinic keratosis:0.689655 Benign keratosis:0.602804 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.792208 Melanocytic nevus:0.951816 Basal cell carcinoma:0.890909 Actinic keratosis:0.827586 Benign keratosis:0.836449 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.788117 Melanocytic nevus:0.717718 Basal cell carcinoma:0.889239 Actinic keratosis:0.897292 Benign keratosis:0.816213 Dermatofibroma:0.937280 Vascular lesion:0.958669
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_54.pth

Epoch: 54, iteration: 0/87, ==> train <===, loss: 1.750208, classification loss: 1.782610,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.064620,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032217,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.3813919135227313e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [87.0, 499.0, 34.0, 20.0, 46.0, 5.0, 12.0]

VAL Student: Epoch: 54, iteration: 86

VAL AUROC: 0.850544, VAL Accus: 0.613132, VAL Senss: 0.695153, VAL Specs: 0.913791
AUROCs: Melanoma:0.865479 Melanocytic nevus:0.934230 Basal cell carcinoma:0.936399 Actinic keratosis:0.911222 Benign keratosis:0.849956 Dermatofibroma:0.604675 Vascular lesion:0.851844
Accus: Melanoma:0.731092 Melanocytic nevus:0.752640 Basal cell carcinoma:0.629630 Actinic keratosis:0.606061 Benign keratosis:0.460000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.815126 Melanocytic nevus:0.853695 Basal cell carcinoma:0.777778 Actinic keratosis:0.696970 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.762770 Melanocytic nevus:0.842730 Basal cell carcinoma:0.934461 Actinic keratosis:0.946225 Benign keratosis:0.937778 Dermatofibroma:0.986789 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [172.0, 1036.0, 93.0, 35.0, 107.0, 7.0, 28.0]

TEST Student: Epoch: 54, iteration: 86

TEST AUROC: 0.900060, TEST Accus: 0.668982, TEST Senss: 0.805686, TEST Specs: 0.863209
AUROCs: Melanoma:0.877969 Melanocytic nevus:0.937343 Basal cell carcinoma:0.970771 Actinic keratosis:0.918568 Benign keratosis:0.879524 Dermatofibroma:0.719267 Vascular lesion:0.996976
Accus: Melanoma:0.744589 Melanocytic nevus:0.767976 Basal cell carcinoma:0.845455 Actinic keratosis:0.603448 Benign keratosis:0.500000 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.935065 Melanocytic nevus:0.901408 Basal cell carcinoma:0.909091 Actinic keratosis:0.793103 Benign keratosis:0.724299 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.631166 Melanocytic nevus:0.806306 Basal cell carcinoma:0.875066 Actinic keratosis:0.920286 Benign keratosis:0.868962 Dermatofibroma:0.966884 Vascular lesion:0.973790
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_55.pth

Epoch: 55, iteration: 0/87, ==> train <===, loss: 1.732046, classification loss: 1.782622,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066322,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015746,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.043252722170458e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 556.0, 34.0, 29.0, 58.0, 5.0, 12.0]

VAL Student: Epoch: 55, iteration: 86

VAL AUROC: 0.867401, VAL Accus: 0.644303, VAL Senss: 0.710912, VAL Specs: 0.917275
AUROCs: Melanoma:0.827860 Melanocytic nevus:0.936871 Basal cell carcinoma:0.932719 Actinic keratosis:0.966626 Benign keratosis:0.867167 Dermatofibroma:0.676131 Vascular lesion:0.864433
Accus: Melanoma:0.470588 Melanocytic nevus:0.838612 Basal cell carcinoma:0.629630 Actinic keratosis:0.878788 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.647059 Melanocytic nevus:0.914027 Basal cell carcinoma:0.703704 Actinic keratosis:0.909091 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.880817 Melanocytic nevus:0.810089 Basal cell carcinoma:0.943975 Actinic keratosis:0.914168 Benign keratosis:0.915556 Dermatofibroma:0.978659 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1113.0, 90.0, 44.0, 127.0, 7.0, 29.0]

TEST Student: Epoch: 55, iteration: 86

TEST AUROC: 0.902062, TEST Accus: 0.683683, TEST Senss: 0.824953, TEST Specs: 0.864434
AUROCs: Melanoma:0.857002 Melanocytic nevus:0.936834 Basal cell carcinoma:0.964209 Actinic keratosis:0.935184 Benign keratosis:0.892557 Dermatofibroma:0.731104 Vascular lesion:0.997545
Accus: Melanoma:0.536797 Melanocytic nevus:0.825056 Basal cell carcinoma:0.818182 Actinic keratosis:0.758621 Benign keratosis:0.593458 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.779221 Melanocytic nevus:0.944403 Basal cell carcinoma:0.890909 Actinic keratosis:0.879310 Benign keratosis:0.813084 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.794283 Melanocytic nevus:0.744745 Basal cell carcinoma:0.890814 Actinic keratosis:0.869188 Benign keratosis:0.828429 Dermatofibroma:0.956849 Vascular lesion:0.966734
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_56.pth

Epoch: 56, iteration: 0/87, ==> train <===, loss: 1.742644, classification loss: 1.790174,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070754,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023224,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.7389274499534124e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 543.0, 35.0, 25.0, 50.0, 5.0, 12.0]

VAL Student: Epoch: 56, iteration: 86

VAL AUROC: 0.877487, VAL Accus: 0.643013, VAL Senss: 0.706151, VAL Specs: 0.917027
AUROCs: Melanoma:0.870630 Melanocytic nevus:0.941669 Basal cell carcinoma:0.934148 Actinic keratosis:0.964652 Benign keratosis:0.864844 Dermatofibroma:0.694995 Vascular lesion:0.871472
Accus: Melanoma:0.663866 Melanocytic nevus:0.819005 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.500000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.781513 Melanocytic nevus:0.898944 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.821793 Melanocytic nevus:0.827893 Basal cell carcinoma:0.934461 Actinic keratosis:0.942089 Benign keratosis:0.924444 Dermatofibroma:0.979675 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [158.0, 1086.0, 91.0, 40.0, 114.0, 7.0, 27.0]

TEST Student: Epoch: 56, iteration: 86

TEST AUROC: 0.909724, TEST Accus: 0.675402, TEST Senss: 0.833533, TEST Specs: 0.864160
AUROCs: Melanoma:0.885022 Melanocytic nevus:0.940086 Basal cell carcinoma:0.971434 Actinic keratosis:0.930911 Benign keratosis:0.899729 Dermatofibroma:0.743876 Vascular lesion:0.997008
Accus: Melanoma:0.683983 Melanocytic nevus:0.805041 Basal cell carcinoma:0.827273 Actinic keratosis:0.689655 Benign keratosis:0.532710 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.900433 Melanocytic nevus:0.936249 Basal cell carcinoma:0.936364 Actinic keratosis:0.827586 Benign keratosis:0.766355 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.696749 Melanocytic nevus:0.776276 Basal cell carcinoma:0.887664 Actinic keratosis:0.910577 Benign keratosis:0.846197 Dermatofibroma:0.954340 Vascular lesion:0.977319
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_57.pth

Epoch: 57, iteration: 0/87, ==> train <===, loss: 1.757881, classification loss: 1.784000,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067699,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.041581,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.465034704958071e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [54.0, 603.0, 35.0, 22.0, 57.0, 6.0, 12.0]

VAL Student: Epoch: 57, iteration: 86

VAL AUROC: 0.873252, VAL Accus: 0.631871, VAL Senss: 0.700698, VAL Specs: 0.914759
AUROCs: Melanoma:0.848854 Melanocytic nevus:0.938478 Basal cell carcinoma:0.928510 Actinic keratosis:0.970292 Benign keratosis:0.870544 Dermatofibroma:0.680958 Vascular lesion:0.875127
Accus: Melanoma:0.453782 Melanocytic nevus:0.909502 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.570000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.951735 Basal cell carcinoma:0.722222 Actinic keratosis:0.727273 Benign keratosis:0.690000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.902384 Melanocytic nevus:0.706231 Basal cell carcinoma:0.955603 Actinic keratosis:0.952430 Benign keratosis:0.922222 Dermatofibroma:0.979675 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [118.0, 1205.0, 81.0, 37.0, 131.0, 8.0, 27.0]

TEST Student: Epoch: 57, iteration: 86

TEST AUROC: 0.911689, TEST Accus: 0.660732, TEST Senss: 0.832160, TEST Specs: 0.863127
AUROCs: Melanoma:0.882901 Melanocytic nevus:0.935055 Basal cell carcinoma:0.973142 Actinic keratosis:0.931678 Benign keratosis:0.912035 Dermatofibroma:0.748346 Vascular lesion:0.998667
Accus: Melanoma:0.510823 Melanocytic nevus:0.893254 Basal cell carcinoma:0.736364 Actinic keratosis:0.637931 Benign keratosis:0.612150 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.783550 Melanocytic nevus:0.974055 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.831776 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.816143 Melanocytic nevus:0.603604 Basal cell carcinoma:0.917585 Actinic keratosis:0.932039 Benign keratosis:0.837868 Dermatofibroma:0.961867 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_58.pth

Epoch: 58, iteration: 0/87, ==> train <===, loss: 1.750291, classification loss: 1.795107,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066835,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022018,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.218531234462264e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 552.0, 38.0, 25.0, 60.0, 5.0, 12.0]

VAL Student: Epoch: 58, iteration: 86

VAL AUROC: 0.864713, VAL Accus: 0.635962, VAL Senss: 0.720366, VAL Specs: 0.915690
AUROCs: Melanoma:0.835090 Melanocytic nevus:0.935085 Basal cell carcinoma:0.940451 Actinic keratosis:0.964840 Benign keratosis:0.874800 Dermatofibroma:0.631860 Vascular lesion:0.870863
Accus: Melanoma:0.445378 Melanocytic nevus:0.832579 Basal cell carcinoma:0.703704 Actinic keratosis:0.757576 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.630252 Melanocytic nevus:0.907994 Basal cell carcinoma:0.833333 Actinic keratosis:0.848485 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.874007 Melanocytic nevus:0.810089 Basal cell carcinoma:0.924947 Actinic keratosis:0.934850 Benign keratosis:0.905556 Dermatofibroma:0.978659 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1108.0, 95.0, 40.0, 130.0, 7.0, 28.0]

TEST Student: Epoch: 58, iteration: 86

TEST AUROC: 0.904094, TEST Accus: 0.677189, TEST Senss: 0.839789, TEST Specs: 0.865610
AUROCs: Melanoma:0.864558 Melanocytic nevus:0.936611 Basal cell carcinoma:0.972341 Actinic keratosis:0.928964 Benign keratosis:0.894010 Dermatofibroma:0.733978 Vascular lesion:0.998195
Accus: Melanoma:0.536797 Melanocytic nevus:0.821349 Basal cell carcinoma:0.863636 Actinic keratosis:0.689655 Benign keratosis:0.607477 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.805195 Melanocytic nevus:0.942179 Basal cell carcinoma:0.954545 Actinic keratosis:0.844828 Benign keratosis:0.831776 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.782511 Melanocytic nevus:0.756757 Basal cell carcinoma:0.856168 Actinic keratosis:0.911599 Benign keratosis:0.830650 Dermatofibroma:0.952835 Vascular lesion:0.968750
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_59.pth

Epoch: 59, iteration: 0/87, ==> train <===, loss: 1.791452, classification loss: 1.819288,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.063674,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.035838,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.9966781110160376e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 511.0, 37.0, 22.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 59, iteration: 86

VAL AUROC: 0.855479, VAL Accus: 0.626069, VAL Senss: 0.713491, VAL Specs: 0.916017
AUROCs: Melanoma:0.839268 Melanocytic nevus:0.927821 Basal cell carcinoma:0.930076 Actinic keratosis:0.945943 Benign keratosis:0.877489 Dermatofibroma:0.608740 Vascular lesion:0.859019
Accus: Melanoma:0.487395 Melanocytic nevus:0.770739 Basal cell carcinoma:0.685185 Actinic keratosis:0.666667 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.647059 Melanocytic nevus:0.852187 Basal cell carcinoma:0.814815 Actinic keratosis:0.787879 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.874007 Melanocytic nevus:0.863501 Basal cell carcinoma:0.924947 Actinic keratosis:0.916236 Benign keratosis:0.870000 Dermatofibroma:0.979675 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 1037.0, 94.0, 42.0, 143.0, 7.0, 27.0]

TEST Student: Epoch: 59, iteration: 86

TEST AUROC: 0.897743, TEST Accus: 0.678604, TEST Senss: 0.825113, TEST Specs: 0.863825
AUROCs: Melanoma:0.864806 Melanocytic nevus:0.936079 Basal cell carcinoma:0.969530 Actinic keratosis:0.916427 Benign keratosis:0.897840 Dermatofibroma:0.701455 Vascular lesion:0.998065
Accus: Melanoma:0.545455 Melanocytic nevus:0.768718 Basal cell carcinoma:0.854545 Actinic keratosis:0.724138 Benign keratosis:0.668224 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.796537 Melanocytic nevus:0.896961 Basal cell carcinoma:0.954545 Actinic keratosis:0.844828 Benign keratosis:0.873832 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.784753 Melanocytic nevus:0.819820 Basal cell carcinoma:0.862992 Actinic keratosis:0.886561 Benign keratosis:0.764020 Dermatofibroma:0.956347 Vascular lesion:0.972278
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_60.pth

Epoch: 60, iteration: 0/87, ==> train <===, loss: 1.740609, classification loss: 1.788281,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067232,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019561,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.7970102999144338e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [88.0, 534.0, 36.0, 17.0, 48.0, 5.0, 12.0]

VAL Student: Epoch: 60, iteration: 86

VAL AUROC: 0.853468, VAL Accus: 0.617035, VAL Senss: 0.684592, VAL Specs: 0.912296
AUROCs: Melanoma:0.883183 Melanocytic nevus:0.941253 Basal cell carcinoma:0.937847 Actinic keratosis:0.854909 Benign keratosis:0.872189 Dermatofibroma:0.607533 Vascular lesion:0.877360
Accus: Melanoma:0.739496 Melanocytic nevus:0.805430 Basal cell carcinoma:0.666667 Actinic keratosis:0.515152 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.815126 Melanocytic nevus:0.909502 Basal cell carcinoma:0.759259 Actinic keratosis:0.575758 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.763905 Melanocytic nevus:0.801187 Basal cell carcinoma:0.940803 Actinic keratosis:0.970010 Benign keratosis:0.935556 Dermatofibroma:0.988821 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [179.0, 1082.0, 92.0, 26.0, 110.0, 7.0, 27.0]

TEST Student: Epoch: 60, iteration: 86

TEST AUROC: 0.904771, TEST Accus: 0.652111, TEST Senss: 0.815913, TEST Specs: 0.861739
AUROCs: Melanoma:0.891649 Melanocytic nevus:0.939456 Basal cell carcinoma:0.977037 Actinic keratosis:0.901001 Benign keratosis:0.896618 Dermatofibroma:0.730010 Vascular lesion:0.997626
Accus: Melanoma:0.774892 Melanocytic nevus:0.802076 Basal cell carcinoma:0.836364 Actinic keratosis:0.448276 Benign keratosis:0.514019 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.943723 Melanocytic nevus:0.943662 Basal cell carcinoma:0.936364 Actinic keratosis:0.689655 Benign keratosis:0.775701 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.636211 Melanocytic nevus:0.746246 Basal cell carcinoma:0.895538 Actinic keratosis:0.956055 Benign keratosis:0.858967 Dermatofibroma:0.967888 Vascular lesion:0.971270
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_61.pth

Epoch: 61, iteration: 0/87, ==> train <===, loss: 1.795829, classification loss: 1.840472,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066490,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021848,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.6173092699229905e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 568.0, 34.0, 23.0, 61.0, 5.0, 11.0]

VAL Student: Epoch: 61, iteration: 86

VAL AUROC: 0.862775, VAL Accus: 0.619278, VAL Senss: 0.695938, VAL Specs: 0.919366
AUROCs: Melanoma:0.846670 Melanocytic nevus:0.941476 Basal cell carcinoma:0.921580 Actinic keratosis:0.953088 Benign keratosis:0.891378 Dermatofibroma:0.615790 Vascular lesion:0.869442
Accus: Melanoma:0.495798 Melanocytic nevus:0.856712 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.672269 Melanocytic nevus:0.927602 Basal cell carcinoma:0.722222 Actinic keratosis:0.696970 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.874007 Melanocytic nevus:0.795252 Basal cell carcinoma:0.946089 Actinic keratosis:0.954498 Benign keratosis:0.891111 Dermatofibroma:0.984756 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 1136.0, 84.0, 35.0, 138.0, 7.0, 27.0]

TEST Student: Epoch: 61, iteration: 86

TEST AUROC: 0.909068, TEST Accus: 0.661088, TEST Senss: 0.835153, TEST Specs: 0.863899
AUROCs: Melanoma:0.882484 Melanocytic nevus:0.937926 Basal cell carcinoma:0.972054 Actinic keratosis:0.923599 Benign keratosis:0.908244 Dermatofibroma:0.741573 Vascular lesion:0.997594
Accus: Melanoma:0.584416 Melanocytic nevus:0.842105 Basal cell carcinoma:0.763636 Actinic keratosis:0.603448 Benign keratosis:0.644860 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.839827 Melanocytic nevus:0.955523 Basal cell carcinoma:0.890909 Actinic keratosis:0.827586 Benign keratosis:0.864486 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.769619 Melanocytic nevus:0.708709 Basal cell carcinoma:0.904987 Actinic keratosis:0.929484 Benign keratosis:0.791782 Dermatofibroma:0.962368 Vascular lesion:0.980343
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_62.pth

Epoch: 62, iteration: 0/87, ==> train <===, loss: 1.781938, classification loss: 1.822289,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068073,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027723,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.4555783429306916e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 568.0, 35.0, 23.0, 58.0, 5.0, 12.0]

VAL Student: Epoch: 62, iteration: 86

VAL AUROC: 0.871479, VAL Accus: 0.625961, VAL Senss: 0.713739, VAL Specs: 0.915497
AUROCs: Melanoma:0.848129 Melanocytic nevus:0.936446 Basal cell carcinoma:0.937280 Actinic keratosis:0.962834 Benign keratosis:0.877400 Dermatofibroma:0.659616 Vascular lesion:0.878646
Accus: Melanoma:0.487395 Melanocytic nevus:0.856712 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.917044 Basal cell carcinoma:0.777778 Actinic keratosis:0.727273 Benign keratosis:0.710000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.878547 Melanocytic nevus:0.783383 Basal cell carcinoma:0.936575 Actinic keratosis:0.951396 Benign keratosis:0.914444 Dermatofibroma:0.970528 Vascular lesion:0.973604
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1133.0, 89.0, 37.0, 127.0, 8.0, 31.0]

TEST Student: Epoch: 62, iteration: 86

TEST AUROC: 0.905548, TEST Accus: 0.684826, TEST Senss: 0.837733, TEST Specs: 0.860331
AUROCs: Melanoma:0.877446 Melanocytic nevus:0.935312 Basal cell carcinoma:0.969363 Actinic keratosis:0.926339 Benign keratosis:0.903032 Dermatofibroma:0.728824 Vascular lesion:0.998520
Accus: Melanoma:0.549784 Melanocytic nevus:0.839881 Basal cell carcinoma:0.809091 Actinic keratosis:0.637931 Benign keratosis:0.593458 Dermatofibroma:0.363636 Vascular lesion:1.000000
Senss: Melanoma:0.813853 Melanocytic nevus:0.954040 Basal cell carcinoma:0.918182 Actinic keratosis:0.827586 Benign keratosis:0.850467 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.788117 Melanocytic nevus:0.707207 Basal cell carcinoma:0.880315 Actinic keratosis:0.926929 Benign keratosis:0.822321 Dermatofibroma:0.944807 Vascular lesion:0.952621
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_63.pth

Epoch: 63, iteration: 0/87, ==> train <===, loss: 1.747468, classification loss: 1.787695,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068708,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028481,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.3100205086376224e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 578.0, 35.0, 22.0, 54.0, 6.0, 12.0]

VAL Student: Epoch: 63, iteration: 86

VAL AUROC: 0.873666, VAL Accus: 0.628201, VAL Senss: 0.715798, VAL Specs: 0.917137
AUROCs: Melanoma:0.851143 Melanocytic nevus:0.935045 Basal cell carcinoma:0.937965 Actinic keratosis:0.968349 Benign keratosis:0.861456 Dermatofibroma:0.678862 Vascular lesion:0.882843
Accus: Melanoma:0.495798 Melanocytic nevus:0.871795 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.540000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.924585 Basal cell carcinoma:0.759259 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.887628 Melanocytic nevus:0.765579 Basal cell carcinoma:0.936575 Actinic keratosis:0.948294 Benign keratosis:0.925556 Dermatofibroma:0.980691 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [123.0, 1155.0, 89.0, 38.0, 122.0, 8.0, 30.0]

TEST Student: Epoch: 63, iteration: 86

TEST AUROC: 0.908738, TEST Accus: 0.679199, TEST Senss: 0.835584, TEST Specs: 0.860939
AUROCs: Melanoma:0.881666 Melanocytic nevus:0.936495 Basal cell carcinoma:0.972808 Actinic keratosis:0.928383 Benign keratosis:0.907152 Dermatofibroma:0.736145 Vascular lesion:0.998520
Accus: Melanoma:0.532468 Melanocytic nevus:0.856190 Basal cell carcinoma:0.809091 Actinic keratosis:0.655172 Benign keratosis:0.570093 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.805195 Melanocytic nevus:0.957005 Basal cell carcinoma:0.918182 Actinic keratosis:0.827586 Benign keratosis:0.841121 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.791480 Melanocytic nevus:0.681682 Basal cell carcinoma:0.882415 Actinic keratosis:0.920286 Benign keratosis:0.841755 Dermatofibroma:0.958354 Vascular lesion:0.950605
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_64.pth

Epoch: 64, iteration: 0/87, ==> train <===, loss: 1.736451, classification loss: 1.782807,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069020,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022663,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.1790184577738602e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 570.0, 35.0, 25.0, 49.0, 5.0, 12.0]

VAL Student: Epoch: 64, iteration: 86

VAL AUROC: 0.864385, VAL Accus: 0.632997, VAL Senss: 0.713202, VAL Specs: 0.913532
AUROCs: Melanoma:0.865804 Melanocytic nevus:0.938317 Basal cell carcinoma:0.927179 Actinic keratosis:0.965717 Benign keratosis:0.853456 Dermatofibroma:0.617378 Vascular lesion:0.882843
Accus: Melanoma:0.563025 Melanocytic nevus:0.859729 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.929110 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.600000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.846765 Melanocytic nevus:0.753709 Basal cell carcinoma:0.946089 Actinic keratosis:0.946225 Benign keratosis:0.934444 Dermatofibroma:0.978659 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [149.0, 1144.0, 90.0, 36.0, 110.0, 9.0, 28.0]

TEST Student: Epoch: 64, iteration: 86

TEST AUROC: 0.911276, TEST Accus: 0.679752, TEST Senss: 0.834081, TEST Specs: 0.865495
AUROCs: Melanoma:0.889448 Melanocytic nevus:0.940457 Basal cell carcinoma:0.973710 Actinic keratosis:0.934506 Benign keratosis:0.897988 Dermatofibroma:0.744355 Vascular lesion:0.998472
Accus: Melanoma:0.645022 Melanocytic nevus:0.848036 Basal cell carcinoma:0.818182 Actinic keratosis:0.620690 Benign keratosis:0.514019 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.891775 Melanocytic nevus:0.962194 Basal cell carcinoma:0.900000 Actinic keratosis:0.827586 Benign keratosis:0.757009 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.728700 Melanocytic nevus:0.693694 Basal cell carcinoma:0.900262 Actinic keratosis:0.921308 Benign keratosis:0.872293 Dermatofibroma:0.961867 Vascular lesion:0.980343
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_65.pth

Epoch: 65, iteration: 0/87, ==> train <===, loss: 1.771517, classification loss: 1.816955,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070168,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024730,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0611166119964742e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 553.0, 30.0, 27.0, 52.0, 5.0, 12.0]

VAL Student: Epoch: 65, iteration: 86

VAL AUROC: 0.881850, VAL Accus: 0.625449, VAL Senss: 0.711472, VAL Specs: 0.915148
AUROCs: Melanoma:0.848902 Melanocytic nevus:0.937090 Basal cell carcinoma:0.927942 Actinic keratosis:0.968005 Benign keratosis:0.848600 Dermatofibroma:0.759972 Vascular lesion:0.882437
Accus: Melanoma:0.537815 Melanocytic nevus:0.834087 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.714286 Melanocytic nevus:0.917044 Basal cell carcinoma:0.685185 Actinic keratosis:0.878788 Benign keratosis:0.610000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.858116 Melanocytic nevus:0.789318 Basal cell carcinoma:0.948203 Actinic keratosis:0.930714 Benign keratosis:0.935556 Dermatofibroma:0.966463 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1120.0, 88.0, 42.0, 111.0, 9.0, 29.0]

TEST Student: Epoch: 65, iteration: 86

TEST AUROC: 0.906923, TEST Accus: 0.690338, TEST Senss: 0.827514, TEST Specs: 0.862628
AUROCs: Melanoma:0.873195 Melanocytic nevus:0.937135 Basal cell carcinoma:0.967755 Actinic keratosis:0.938444 Benign keratosis:0.888982 Dermatofibroma:0.744629 Vascular lesion:0.998325
Accus: Melanoma:0.614719 Melanocytic nevus:0.830245 Basal cell carcinoma:0.800000 Actinic keratosis:0.724138 Benign keratosis:0.518692 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.835498 Melanocytic nevus:0.947368 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.747664 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.748318 Melanocytic nevus:0.734234 Basal cell carcinoma:0.899738 Actinic keratosis:0.892693 Benign keratosis:0.868962 Dermatofibroma:0.934772 Vascular lesion:0.959677
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_66.pth

Epoch: 66, iteration: 0/87, ==> train <===, loss: 1.742962, classification loss: 1.789399,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069453,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023016,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.550049507968268e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 542.0, 39.0, 20.0, 50.0, 5.0, 11.0]

VAL Student: Epoch: 66, iteration: 86

VAL AUROC: 0.866180, VAL Accus: 0.618610, VAL Senss: 0.716157, VAL Specs: 0.912484
AUROCs: Melanoma:0.859279 Melanocytic nevus:0.939628 Basal cell carcinoma:0.942115 Actinic keratosis:0.958823 Benign keratosis:0.874989 Dermatofibroma:0.605246 Vascular lesion:0.883181
Accus: Melanoma:0.638655 Melanocytic nevus:0.817496 Basal cell carcinoma:0.722222 Actinic keratosis:0.606061 Benign keratosis:0.500000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.764706 Melanocytic nevus:0.918552 Basal cell carcinoma:0.870370 Actinic keratosis:0.696970 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.819523 Melanocytic nevus:0.798220 Basal cell carcinoma:0.918605 Actinic keratosis:0.949328 Benign keratosis:0.920000 Dermatofibroma:0.987805 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [152.0, 1102.0, 94.0, 33.0, 118.0, 7.0, 27.0]

TEST Student: Epoch: 66, iteration: 86

TEST AUROC: 0.910426, TEST Accus: 0.662710, TEST Senss: 0.824865, TEST Specs: 0.855167
AUROCs: Melanoma:0.883150 Melanocytic nevus:0.939011 Basal cell carcinoma:0.974622 Actinic keratosis:0.931422 Benign keratosis:0.898929 Dermatofibroma:0.749396 Vascular lesion:0.996456
Accus: Melanoma:0.658009 Melanocytic nevus:0.816901 Basal cell carcinoma:0.854545 Actinic keratosis:0.568966 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.909091 Melanocytic nevus:0.951075 Basal cell carcinoma:0.981818 Actinic keratosis:0.793103 Benign keratosis:0.794393 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.691704 Melanocytic nevus:0.717718 Basal cell carcinoma:0.849869 Actinic keratosis:0.928973 Benign keratosis:0.845641 Dermatofibroma:0.966884 Vascular lesion:0.985383
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_67.pth

Epoch: 67, iteration: 0/87, ==> train <===, loss: 1.741851, classification loss: 1.785939,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070474,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026385,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.595044557171442e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 573.0, 34.0, 22.0, 53.0, 5.0, 12.0]

VAL Student: Epoch: 67, iteration: 86

VAL AUROC: 0.861722, VAL Accus: 0.624925, VAL Senss: 0.697731, VAL Specs: 0.913625
AUROCs: Melanoma:0.857725 Melanocytic nevus:0.939973 Basal cell carcinoma:0.941626 Actinic keratosis:0.907524 Benign keratosis:0.867322 Dermatofibroma:0.641133 Vascular lesion:0.876751
Accus: Melanoma:0.571429 Melanocytic nevus:0.864253 Basal cell carcinoma:0.629630 Actinic keratosis:0.666667 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.927602 Basal cell carcinoma:0.740741 Actinic keratosis:0.696970 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.829739 Melanocytic nevus:0.765579 Basal cell carcinoma:0.950317 Actinic keratosis:0.952430 Benign keratosis:0.927778 Dermatofibroma:0.988821 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 1145.0, 81.0, 32.0, 118.0, 7.0, 29.0]

TEST Student: Epoch: 67, iteration: 86

TEST AUROC: 0.907304, TEST Accus: 0.654661, TEST Senss: 0.827117, TEST Specs: 0.861065
AUROCs: Melanoma:0.882503 Melanocytic nevus:0.936787 Basal cell carcinoma:0.974111 Actinic keratosis:0.927070 Benign keratosis:0.899199 Dermatofibroma:0.732678 Vascular lesion:0.998781
Accus: Melanoma:0.640693 Melanocytic nevus:0.848777 Basal cell carcinoma:0.736364 Actinic keratosis:0.551724 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.904762 Melanocytic nevus:0.961453 Basal cell carcinoma:0.890909 Actinic keratosis:0.793103 Benign keratosis:0.785047 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.711323 Melanocytic nevus:0.683183 Basal cell carcinoma:0.910761 Actinic keratosis:0.934083 Benign keratosis:0.859522 Dermatofibroma:0.966382 Vascular lesion:0.962198
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_68.pth

Epoch: 68, iteration: 0/87, ==> train <===, loss: 1.747127, classification loss: 1.788711,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067726,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026141,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.735540101454298e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 539.0, 36.0, 23.0, 69.0, 5.0, 12.0]

VAL Student: Epoch: 68, iteration: 86

VAL AUROC: 0.865942, VAL Accus: 0.635671, VAL Senss: 0.709234, VAL Specs: 0.915422
AUROCs: Melanoma:0.836616 Melanocytic nevus:0.936772 Basal cell carcinoma:0.936340 Actinic keratosis:0.937420 Benign keratosis:0.893444 Dermatofibroma:0.641070 Vascular lesion:0.879932
Accus: Melanoma:0.470588 Melanocytic nevus:0.812971 Basal cell carcinoma:0.666667 Actinic keratosis:0.696970 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.906486 Basal cell carcinoma:0.814815 Actinic keratosis:0.696970 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.862656 Melanocytic nevus:0.827893 Basal cell carcinoma:0.932347 Actinic keratosis:0.946225 Benign keratosis:0.885556 Dermatofibroma:0.977642 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [126.0, 1097.0, 93.0, 34.0, 142.0, 7.0, 29.0]

TEST Student: Epoch: 68, iteration: 86

TEST AUROC: 0.903465, TEST Accus: 0.672504, TEST Senss: 0.838381, TEST Specs: 0.858223
AUROCs: Melanoma:0.870770 Melanocytic nevus:0.934995 Basal cell carcinoma:0.972269 Actinic keratosis:0.919608 Benign keratosis:0.903047 Dermatofibroma:0.725471 Vascular lesion:0.998098
Accus: Melanoma:0.545455 Melanocytic nevus:0.813195 Basal cell carcinoma:0.845455 Actinic keratosis:0.586207 Benign keratosis:0.663551 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.839827 Melanocytic nevus:0.941438 Basal cell carcinoma:0.945455 Actinic keratosis:0.827586 Benign keratosis:0.859813 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.761211 Melanocytic nevus:0.756757 Basal cell carcinoma:0.878215 Actinic keratosis:0.924885 Benign keratosis:0.779012 Dermatofibroma:0.950326 Vascular lesion:0.957157
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_69.pth

Epoch: 69, iteration: 0/87, ==> train <===, loss: 1.737865, classification loss: 1.782032,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067712,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023545,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.961986091308869e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 550.0, 34.0, 23.0, 56.0, 5.0, 12.0]

VAL Student: Epoch: 69, iteration: 86

VAL AUROC: 0.861007, VAL Accus: 0.624983, VAL Senss: 0.694641, VAL Specs: 0.917081
AUROCs: Melanoma:0.845668 Melanocytic nevus:0.934248 Basal cell carcinoma:0.935909 Actinic keratosis:0.942308 Benign keratosis:0.863133 Dermatofibroma:0.635798 Vascular lesion:0.869983
Accus: Melanoma:0.546218 Melanocytic nevus:0.829563 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.714286 Melanocytic nevus:0.894419 Basal cell carcinoma:0.703704 Actinic keratosis:0.757576 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.849035 Melanocytic nevus:0.827893 Basal cell carcinoma:0.943975 Actinic keratosis:0.932782 Benign keratosis:0.916667 Dermatofibroma:0.976626 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1091.0, 88.0, 44.0, 126.0, 7.0, 30.0]

TEST Student: Epoch: 69, iteration: 86

TEST AUROC: 0.902637, TEST Accus: 0.693209, TEST Senss: 0.819842, TEST Specs: 0.862142
AUROCs: Melanoma:0.872020 Melanocytic nevus:0.934794 Basal cell carcinoma:0.967974 Actinic keratosis:0.932241 Benign keratosis:0.893019 Dermatofibroma:0.720408 Vascular lesion:0.998000
Accus: Melanoma:0.610390 Melanocytic nevus:0.808747 Basal cell carcinoma:0.800000 Actinic keratosis:0.758621 Benign keratosis:0.588785 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.839827 Melanocytic nevus:0.936990 Basal cell carcinoma:0.909091 Actinic keratosis:0.844828 Benign keratosis:0.799065 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.751121 Melanocytic nevus:0.759760 Basal cell carcinoma:0.893963 Actinic keratosis:0.894737 Benign keratosis:0.833981 Dermatofibroma:0.950828 Vascular lesion:0.950605
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_70.pth

Epoch: 70, iteration: 0/87, ==> train <===, loss: 1.736047, classification loss: 1.786805,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067370,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016613,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.265787482177982e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 558.0, 32.0, 23.0, 56.0, 5.0, 12.0]

VAL Student: Epoch: 70, iteration: 86

VAL AUROC: 0.886835, VAL Accus: 0.610611, VAL Senss: 0.699275, VAL Specs: 0.917585
AUROCs: Melanoma:0.842368 Melanocytic nevus:0.934436 Basal cell carcinoma:0.931936 Actinic keratosis:0.966783 Benign keratosis:0.871378 Dermatofibroma:0.765244 Vascular lesion:0.895702
Accus: Melanoma:0.470588 Melanocytic nevus:0.841629 Basal cell carcinoma:0.592593 Actinic keratosis:0.696970 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.613445 Melanocytic nevus:0.906486 Basal cell carcinoma:0.703704 Actinic keratosis:0.878788 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.894438 Melanocytic nevus:0.801187 Basal cell carcinoma:0.942918 Actinic keratosis:0.933816 Benign keratosis:0.917778 Dermatofibroma:0.963415 Vascular lesion:0.969543
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [118.0, 1122.0, 88.0, 41.0, 131.0, 9.0, 31.0]

TEST Student: Epoch: 70, iteration: 86

TEST AUROC: 0.905119, TEST Accus: 0.695812, TEST Senss: 0.833930, TEST Specs: 0.861251
AUROCs: Melanoma:0.871731 Melanocytic nevus:0.936082 Basal cell carcinoma:0.966213 Actinic keratosis:0.935325 Benign keratosis:0.896550 Dermatofibroma:0.731424 Vascular lesion:0.998504
Accus: Melanoma:0.510823 Melanocytic nevus:0.831727 Basal cell carcinoma:0.800000 Actinic keratosis:0.706897 Benign keratosis:0.612150 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.774892 Melanocytic nevus:0.947368 Basal cell carcinoma:0.918182 Actinic keratosis:0.879310 Benign keratosis:0.817757 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.806614 Melanocytic nevus:0.731231 Basal cell carcinoma:0.890289 Actinic keratosis:0.896270 Benign keratosis:0.829539 Dermatofibroma:0.929252 Vascular lesion:0.945565
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_71.pth

Epoch: 71, iteration: 0/87, ==> train <===, loss: 1.812731, classification loss: 1.856714,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070108,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.026124,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.6392087339601844e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 588.0, 35.0, 24.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 71, iteration: 86

VAL AUROC: 0.864769, VAL Accus: 0.639917, VAL Senss: 0.705999, VAL Specs: 0.908269
AUROCs: Melanoma:0.868684 Melanocytic nevus:0.941924 Basal cell carcinoma:0.923283 Actinic keratosis:0.958541 Benign keratosis:0.871822 Dermatofibroma:0.619284 Vascular lesion:0.869848
Accus: Melanoma:0.554622 Melanocytic nevus:0.886878 Basal cell carcinoma:0.648148 Actinic keratosis:0.727273 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.739496 Melanocytic nevus:0.948718 Basal cell carcinoma:0.703704 Actinic keratosis:0.757576 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.846765 Melanocytic nevus:0.697329 Basal cell carcinoma:0.955603 Actinic keratosis:0.961737 Benign keratosis:0.917778 Dermatofibroma:0.989837 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1175.0, 82.0, 35.0, 122.0, 7.0, 27.0]

TEST Student: Epoch: 71, iteration: 86

TEST AUROC: 0.914658, TEST Accus: 0.656887, TEST Senss: 0.832581, TEST Specs: 0.849661
AUROCs: Melanoma:0.892328 Melanocytic nevus:0.938874 Basal cell carcinoma:0.976144 Actinic keratosis:0.935713 Benign keratosis:0.909448 Dermatofibroma:0.752520 Vascular lesion:0.997577
Accus: Melanoma:0.619048 Melanocytic nevus:0.871016 Basal cell carcinoma:0.745455 Actinic keratosis:0.603448 Benign keratosis:0.570093 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.900433 Melanocytic nevus:0.972572 Basal cell carcinoma:0.900000 Actinic keratosis:0.810345 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.711883 Melanocytic nevus:0.596096 Basal cell carcinoma:0.916535 Actinic keratosis:0.939193 Benign keratosis:0.836202 Dermatofibroma:0.969895 Vascular lesion:0.977823
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_72.pth

Epoch: 72, iteration: 0/87, ==> train <===, loss: 1.736297, classification loss: 1.784980,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069699,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021015,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.075287860564166e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 545.0, 36.0, 23.0, 55.0, 5.0, 10.0]

VAL Student: Epoch: 72, iteration: 86

VAL AUROC: 0.877825, VAL Accus: 0.607520, VAL Senss: 0.722047, VAL Specs: 0.913874
AUROCs: Melanoma:0.849483 Melanocytic nevus:0.939395 Basal cell carcinoma:0.934989 Actinic keratosis:0.960703 Benign keratosis:0.869711 Dermatofibroma:0.701156 Vascular lesion:0.889340
Accus: Melanoma:0.537815 Melanocytic nevus:0.822021 Basal cell carcinoma:0.666667 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.722689 Melanocytic nevus:0.909502 Basal cell carcinoma:0.759259 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.838820 Melanocytic nevus:0.804154 Basal cell carcinoma:0.932347 Actinic keratosis:0.942089 Benign keratosis:0.912222 Dermatofibroma:0.972561 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1097.0, 92.0, 39.0, 121.0, 7.0, 27.0]

TEST Student: Epoch: 72, iteration: 86

TEST AUROC: 0.909807, TEST Accus: 0.671417, TEST Senss: 0.837369, TEST Specs: 0.858048
AUROCs: Melanoma:0.877681 Melanocytic nevus:0.939225 Basal cell carcinoma:0.974903 Actinic keratosis:0.926665 Benign keratosis:0.895572 Dermatofibroma:0.756876 Vascular lesion:0.997724
Accus: Melanoma:0.623377 Melanocytic nevus:0.813195 Basal cell carcinoma:0.836364 Actinic keratosis:0.672414 Benign keratosis:0.565421 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.878788 Melanocytic nevus:0.948110 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.713004 Melanocytic nevus:0.741742 Basal cell carcinoma:0.879790 Actinic keratosis:0.914154 Benign keratosis:0.823431 Dermatofibroma:0.946312 Vascular lesion:0.987903
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_73.pth

Epoch: 73, iteration: 0/87, ==> train <===, loss: 1.760262, classification loss: 1.809250,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068836,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019847,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.567759074507749e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 563.0, 30.0, 24.0, 50.0, 5.0, 12.0]

VAL Student: Epoch: 73, iteration: 86

VAL AUROC: 0.868231, VAL Accus: 0.617762, VAL Senss: 0.698953, VAL Specs: 0.917961
AUROCs: Melanoma:0.863257 Melanocytic nevus:0.939789 Basal cell carcinoma:0.928060 Actinic keratosis:0.965686 Benign keratosis:0.850644 Dermatofibroma:0.657965 Vascular lesion:0.872217
Accus: Melanoma:0.579832 Melanocytic nevus:0.849170 Basal cell carcinoma:0.555556 Actinic keratosis:0.727273 Benign keratosis:0.500000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.764706 Melanocytic nevus:0.930618 Basal cell carcinoma:0.666667 Actinic keratosis:0.818182 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.841090 Melanocytic nevus:0.789318 Basal cell carcinoma:0.952431 Actinic keratosis:0.934850 Benign keratosis:0.934444 Dermatofibroma:0.987805 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [145.0, 1137.0, 83.0, 44.0, 114.0, 7.0, 28.0]

TEST Student: Epoch: 73, iteration: 86

TEST AUROC: 0.911173, TEST Accus: 0.676834, TEST Senss: 0.838665, TEST Specs: 0.867194
AUROCs: Melanoma:0.885759 Melanocytic nevus:0.939829 Basal cell carcinoma:0.971706 Actinic keratosis:0.941148 Benign keratosis:0.901947 Dermatofibroma:0.739315 Vascular lesion:0.998504
Accus: Melanoma:0.627706 Melanocytic nevus:0.842847 Basal cell carcinoma:0.754545 Actinic keratosis:0.758621 Benign keratosis:0.532710 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.878788 Melanocytic nevus:0.954781 Basal cell carcinoma:0.872727 Actinic keratosis:0.879310 Benign keratosis:0.785047 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.727018 Melanocytic nevus:0.722222 Basal cell carcinoma:0.913911 Actinic keratosis:0.899336 Benign keratosis:0.866185 Dermatofibroma:0.966382 Vascular lesion:0.975302
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_74.pth

Epoch: 74, iteration: 0/87, ==> train <===, loss: 1.785325, classification loss: 1.824952,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068525,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028898,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.1109831670569744e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 534.0, 34.0, 23.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 74, iteration: 86

VAL AUROC: 0.867372, VAL Accus: 0.631019, VAL Senss: 0.704628, VAL Specs: 0.920084
AUROCs: Melanoma:0.836206 Melanocytic nevus:0.937390 Basal cell carcinoma:0.935929 Actinic keratosis:0.965466 Benign keratosis:0.891122 Dermatofibroma:0.629891 Vascular lesion:0.875601
Accus: Melanoma:0.512605 Melanocytic nevus:0.805430 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.895928 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.750000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.864926 Melanocytic nevus:0.857567 Basal cell carcinoma:0.946089 Actinic keratosis:0.941055 Benign keratosis:0.876667 Dermatofibroma:0.971545 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 1073.0, 89.0, 41.0, 142.0, 7.0, 28.0]

TEST Student: Epoch: 74, iteration: 86

TEST AUROC: 0.902106, TEST Accus: 0.678638, TEST Senss: 0.835872, TEST Specs: 0.858165
AUROCs: Melanoma:0.865345 Melanocytic nevus:0.936564 Basal cell carcinoma:0.969520 Actinic keratosis:0.929607 Benign keratosis:0.901851 Dermatofibroma:0.713383 Vascular lesion:0.998472
Accus: Melanoma:0.554113 Melanocytic nevus:0.795404 Basal cell carcinoma:0.809091 Actinic keratosis:0.706897 Benign keratosis:0.663551 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.844156 Melanocytic nevus:0.929577 Basal cell carcinoma:0.918182 Actinic keratosis:0.844828 Benign keratosis:0.859813 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.754484 Melanocytic nevus:0.777778 Basal cell carcinoma:0.887139 Actinic keratosis:0.912621 Benign keratosis:0.770128 Dermatofibroma:0.941796 Vascular lesion:0.963206
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_75.pth

Epoch: 75, iteration: 0/87, ==> train <===, loss: 1.727124, classification loss: 1.782366,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070757,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015515,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.699884850351277e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 527.0, 38.0, 23.0, 65.0, 5.0, 12.0]

VAL Student: Epoch: 75, iteration: 86

VAL AUROC: 0.863119, VAL Accus: 0.642266, VAL Senss: 0.707043, VAL Specs: 0.920849
AUROCs: Melanoma:0.839964 Melanocytic nevus:0.936871 Basal cell carcinoma:0.935812 Actinic keratosis:0.928990 Benign keratosis:0.891267 Dermatofibroma:0.632177 Vascular lesion:0.876751
Accus: Melanoma:0.537815 Melanocytic nevus:0.794872 Basal cell carcinoma:0.703704 Actinic keratosis:0.696970 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.722689 Melanocytic nevus:0.880845 Basal cell carcinoma:0.796296 Actinic keratosis:0.696970 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.854711 Melanocytic nevus:0.860534 Basal cell carcinoma:0.932347 Actinic keratosis:0.938987 Benign keratosis:0.900000 Dermatofibroma:0.974593 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1066.0, 92.0, 38.0, 134.0, 7.0, 28.0]

TEST Student: Epoch: 75, iteration: 86

TEST AUROC: 0.902196, TEST Accus: 0.677102, TEST Senss: 0.838714, TEST Specs: 0.861184
AUROCs: Melanoma:0.870225 Melanocytic nevus:0.936018 Basal cell carcinoma:0.969005 Actinic keratosis:0.918780 Benign keratosis:0.895274 Dermatofibroma:0.728299 Vascular lesion:0.997773
Accus: Melanoma:0.610390 Melanocytic nevus:0.790215 Basal cell carcinoma:0.836364 Actinic keratosis:0.655172 Benign keratosis:0.626168 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.839827 Melanocytic nevus:0.927354 Basal cell carcinoma:0.945455 Actinic keratosis:0.844828 Benign keratosis:0.845794 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.747758 Melanocytic nevus:0.791291 Basal cell carcinoma:0.876115 Actinic keratosis:0.905979 Benign keratosis:0.800111 Dermatofibroma:0.938284 Vascular lesion:0.968750
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_76.pth

Epoch: 76, iteration: 0/87, ==> train <===, loss: 1.752686, classification loss: 1.798857,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068130,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021960,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.3298963653161496e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 572.0, 35.0, 23.0, 59.0, 6.0, 12.0]

VAL Student: Epoch: 76, iteration: 86

VAL AUROC: 0.866940, VAL Accus: 0.638380, VAL Senss: 0.717113, VAL Specs: 0.914890
AUROCs: Melanoma:0.852402 Melanocytic nevus:0.940438 Basal cell carcinoma:0.919583 Actinic keratosis:0.954874 Benign keratosis:0.879689 Dermatofibroma:0.643420 Vascular lesion:0.878173
Accus: Melanoma:0.495798 Melanocytic nevus:0.862745 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.590000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.929110 Basal cell carcinoma:0.722222 Actinic keratosis:0.757576 Benign keratosis:0.730000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.869467 Melanocytic nevus:0.771513 Basal cell carcinoma:0.947146 Actinic keratosis:0.955533 Benign keratosis:0.902222 Dermatofibroma:0.976626 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1145.0, 85.0, 34.0, 132.0, 8.0, 29.0]

TEST Student: Epoch: 76, iteration: 86

TEST AUROC: 0.909285, TEST Accus: 0.671344, TEST Senss: 0.840425, TEST Specs: 0.857978
AUROCs: Melanoma:0.882833 Melanocytic nevus:0.938058 Basal cell carcinoma:0.970236 Actinic keratosis:0.929590 Benign keratosis:0.906539 Dermatofibroma:0.739315 Vascular lesion:0.998423
Accus: Melanoma:0.575758 Melanocytic nevus:0.848777 Basal cell carcinoma:0.772727 Actinic keratosis:0.586207 Benign keratosis:0.616822 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.839827 Melanocytic nevus:0.959229 Basal cell carcinoma:0.909091 Actinic keratosis:0.810345 Benign keratosis:0.864486 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.767937 Melanocytic nevus:0.695195 Basal cell carcinoma:0.893963 Actinic keratosis:0.932039 Benign keratosis:0.800666 Dermatofibroma:0.951330 Vascular lesion:0.964718
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_77.pth

Epoch: 77, iteration: 0/87, ==> train <===, loss: 1.750279, classification loss: 1.790360,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.065735,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025654,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.996906728784535e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 499.0, 36.0, 24.0, 58.0, 5.0, 11.0]

VAL Student: Epoch: 77, iteration: 86

VAL AUROC: 0.858503, VAL Accus: 0.618148, VAL Senss: 0.718345, VAL Specs: 0.912632
AUROCs: Melanoma:0.840088 Melanocytic nevus:0.933250 Basal cell carcinoma:0.933463 Actinic keratosis:0.953151 Benign keratosis:0.871633 Dermatofibroma:0.622777 Vascular lesion:0.855161
Accus: Melanoma:0.554622 Melanocytic nevus:0.752640 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.739496 Melanocytic nevus:0.855204 Basal cell carcinoma:0.833333 Actinic keratosis:0.787879 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.825199 Melanocytic nevus:0.866469 Basal cell carcinoma:0.906977 Actinic keratosis:0.914168 Benign keratosis:0.900000 Dermatofibroma:0.980691 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1027.0, 95.0, 43.0, 124.0, 7.0, 25.0]

TEST Student: Epoch: 77, iteration: 86

TEST AUROC: 0.896754, TEST Accus: 0.671775, TEST Senss: 0.812726, TEST Specs: 0.851773
AUROCs: Melanoma:0.859469 Melanocytic nevus:0.936581 Basal cell carcinoma:0.968991 Actinic keratosis:0.924647 Benign keratosis:0.883551 Dermatofibroma:0.707225 Vascular lesion:0.996813
Accus: Melanoma:0.632035 Melanocytic nevus:0.761305 Basal cell carcinoma:0.863636 Actinic keratosis:0.741379 Benign keratosis:0.579439 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.857143 Melanocytic nevus:0.906597 Basal cell carcinoma:0.963636 Actinic keratosis:0.844828 Benign keratosis:0.817757 Dermatofibroma:0.363636 Vascular lesion:0.935484
Specs: Melanoma:0.692825 Melanocytic nevus:0.806306 Basal cell carcinoma:0.829396 Actinic keratosis:0.875319 Benign keratosis:0.806774 Dermatofibroma:0.960361 Vascular lesion:0.991431
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_78.pth

Epoch: 78, iteration: 0/87, ==> train <===, loss: 1.775253, classification loss: 1.812785,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066469,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028938,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.6972160559060813e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 552.0, 34.0, 23.0, 56.0, 5.0, 12.0]

VAL Student: Epoch: 78, iteration: 86

VAL AUROC: 0.884989, VAL Accus: 0.619411, VAL Senss: 0.724931, VAL Specs: 0.918023
AUROCs: Melanoma:0.860596 Melanocytic nevus:0.937882 Basal cell carcinoma:0.935185 Actinic keratosis:0.968663 Benign keratosis:0.877089 Dermatofibroma:0.728468 Vascular lesion:0.887039
Accus: Melanoma:0.504202 Melanocytic nevus:0.832579 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.909502 Basal cell carcinoma:0.740741 Actinic keratosis:0.818182 Benign keratosis:0.700000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.863791 Melanocytic nevus:0.818991 Basal cell carcinoma:0.937632 Actinic keratosis:0.942089 Benign keratosis:0.914444 Dermatofibroma:0.974593 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 1110.0, 91.0, 39.0, 122.0, 9.0, 29.0]

TEST Student: Epoch: 78, iteration: 86

TEST AUROC: 0.907960, TEST Accus: 0.688800, TEST Senss: 0.834771, TEST Specs: 0.862672
AUROCs: Melanoma:0.877463 Melanocytic nevus:0.938670 Basal cell carcinoma:0.970661 Actinic keratosis:0.932101 Benign keratosis:0.902105 Dermatofibroma:0.736510 Vascular lesion:0.998211
Accus: Melanoma:0.584416 Melanocytic nevus:0.822832 Basal cell carcinoma:0.827273 Actinic keratosis:0.672414 Benign keratosis:0.570093 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.835498 Melanocytic nevus:0.939956 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.813084 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.766256 Melanocytic nevus:0.750751 Basal cell carcinoma:0.881890 Actinic keratosis:0.911599 Benign keratosis:0.837313 Dermatofibroma:0.939789 Vascular lesion:0.951109
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_79.pth

Epoch: 79, iteration: 0/87, ==> train <===, loss: 1.743317, classification loss: 1.799823,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070336,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.013830,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.4274944503154732e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 551.0, 33.0, 23.0, 62.0, 5.0, 12.0]

VAL Student: Epoch: 79, iteration: 86

VAL AUROC: 0.870310, VAL Accus: 0.619120, VAL Senss: 0.715130, VAL Specs: 0.916444
AUROCs: Melanoma:0.829100 Melanocytic nevus:0.933451 Basal cell carcinoma:0.935322 Actinic keratosis:0.961017 Benign keratosis:0.870122 Dermatofibroma:0.688707 Vascular lesion:0.874450
Accus: Melanoma:0.462185 Melanocytic nevus:0.831071 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.655462 Melanocytic nevus:0.903469 Basal cell carcinoma:0.796296 Actinic keratosis:0.818182 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.876277 Melanocytic nevus:0.807122 Basal cell carcinoma:0.938689 Actinic keratosis:0.927611 Benign keratosis:0.911111 Dermatofibroma:0.981707 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [123.0, 1122.0, 90.0, 42.0, 135.0, 7.0, 29.0]

TEST Student: Epoch: 79, iteration: 86

TEST AUROC: 0.903014, TEST Accus: 0.684432, TEST Senss: 0.819599, TEST Specs: 0.863885
AUROCs: Melanoma:0.861195 Melanocytic nevus:0.934160 Basal cell carcinoma:0.968199 Actinic keratosis:0.936065 Benign keratosis:0.895494 Dermatofibroma:0.727706 Vascular lesion:0.998277
Accus: Melanoma:0.532468 Melanocytic nevus:0.831727 Basal cell carcinoma:0.818182 Actinic keratosis:0.724138 Benign keratosis:0.630841 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.774892 Melanocytic nevus:0.941438 Basal cell carcinoma:0.927273 Actinic keratosis:0.862069 Benign keratosis:0.822430 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.790359 Melanocytic nevus:0.750751 Basal cell carcinoma:0.885564 Actinic keratosis:0.887072 Benign keratosis:0.818434 Dermatofibroma:0.957351 Vascular lesion:0.957661
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_80.pth

Epoch: 80, iteration: 0/87, ==> train <===, loss: 1.767920, classification loss: 1.813316,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070398,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025002,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.184745005283926e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [50.0, 558.0, 34.0, 28.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 80, iteration: 86

VAL AUROC: 0.886250, VAL Accus: 0.628916, VAL Senss: 0.712392, VAL Specs: 0.915625
AUROCs: Melanoma:0.831284 Melanocytic nevus:0.933810 Basal cell carcinoma:0.932092 Actinic keratosis:0.966125 Benign keratosis:0.854322 Dermatofibroma:0.799416 Vascular lesion:0.886701
Accus: Melanoma:0.420168 Melanocytic nevus:0.841629 Basal cell carcinoma:0.629630 Actinic keratosis:0.848485 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.630252 Melanocytic nevus:0.901961 Basal cell carcinoma:0.740741 Actinic keratosis:0.878788 Benign keratosis:0.660000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.895573 Melanocytic nevus:0.798220 Basal cell carcinoma:0.931290 Actinic keratosis:0.908997 Benign keratosis:0.920000 Dermatofibroma:0.967480 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [116.0, 1135.0, 91.0, 43.0, 121.0, 9.0, 27.0]

TEST Student: Epoch: 80, iteration: 86

TEST AUROC: 0.906457, TEST Accus: 0.679666, TEST Senss: 0.839500, TEST Specs: 0.860132
AUROCs: Melanoma:0.865391 Melanocytic nevus:0.934465 Basal cell carcinoma:0.968728 Actinic keratosis:0.933704 Benign keratosis:0.893694 Dermatofibroma:0.750878 Vascular lesion:0.998342
Accus: Melanoma:0.502165 Melanocytic nevus:0.841364 Basal cell carcinoma:0.827273 Actinic keratosis:0.741379 Benign keratosis:0.565421 Dermatofibroma:0.409091 Vascular lesion:0.870968
Senss: Melanoma:0.766234 Melanocytic nevus:0.945145 Basal cell carcinoma:0.927273 Actinic keratosis:0.879310 Benign keratosis:0.813084 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.802130 Melanocytic nevus:0.738739 Basal cell carcinoma:0.868766 Actinic keratosis:0.865100 Benign keratosis:0.835092 Dermatofibroma:0.931259 Vascular lesion:0.979839
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_81.pth

Epoch: 81, iteration: 0/87, ==> train <===, loss: 1.748757, classification loss: 1.805497,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069136,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012395,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.9662705047555335e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [83.0, 536.0, 30.0, 21.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 81, iteration: 86

VAL AUROC: 0.858866, VAL Accus: 0.617192, VAL Senss: 0.700797, VAL Specs: 0.912715
AUROCs: Melanoma:0.869514 Melanocytic nevus:0.942730 Basal cell carcinoma:0.905000 Actinic keratosis:0.945661 Benign keratosis:0.858244 Dermatofibroma:0.623031 Vascular lesion:0.867885
Accus: Melanoma:0.697479 Melanocytic nevus:0.808446 Basal cell carcinoma:0.555556 Actinic keratosis:0.636364 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.840336 Melanocytic nevus:0.915535 Basal cell carcinoma:0.629630 Actinic keratosis:0.757576 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.768445 Melanocytic nevus:0.804154 Basal cell carcinoma:0.965116 Actinic keratosis:0.957601 Benign keratosis:0.921111 Dermatofibroma:0.989837 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [176.0, 1087.0, 79.0, 36.0, 118.0, 7.0, 28.0]

TEST Student: Epoch: 81, iteration: 86

TEST AUROC: 0.907952, TEST Accus: 0.668481, TEST Senss: 0.828270, TEST Specs: 0.859262
AUROCs: Melanoma:0.886502 Melanocytic nevus:0.940107 Basal cell carcinoma:0.969530 Actinic keratosis:0.932400 Benign keratosis:0.892552 Dermatofibroma:0.736441 Vascular lesion:0.998130
Accus: Melanoma:0.761905 Melanocytic nevus:0.805782 Basal cell carcinoma:0.718182 Actinic keratosis:0.620690 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.939394 Melanocytic nevus:0.949592 Basal cell carcinoma:0.863636 Actinic keratosis:0.810345 Benign keratosis:0.780374 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.625561 Melanocytic nevus:0.729730 Basal cell carcinoma:0.939633 Actinic keratosis:0.937149 Benign keratosis:0.840089 Dermatofibroma:0.970396 Vascular lesion:0.972278
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_82.pth

Epoch: 82, iteration: 0/87, ==> train <===, loss: 1.749747, classification loss: 1.803597,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.071871,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018021,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.7696434542799804e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 583.0, 28.0, 25.0, 54.0, 5.0, 12.0]

VAL Student: Epoch: 82, iteration: 86

VAL AUROC: 0.864348, VAL Accus: 0.624422, VAL Senss: 0.699827, VAL Specs: 0.912274
AUROCs: Melanoma:0.855149 Melanocytic nevus:0.938961 Basal cell carcinoma:0.856707 Actinic keratosis:0.974366 Benign keratosis:0.850789 Dermatofibroma:0.696900 Vascular lesion:0.877563
Accus: Melanoma:0.563025 Melanocytic nevus:0.879336 Basal cell carcinoma:0.518519 Actinic keratosis:0.757576 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.933635 Basal cell carcinoma:0.574074 Actinic keratosis:0.818182 Benign keratosis:0.650000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.851305 Melanocytic nevus:0.741840 Basal cell carcinoma:0.976744 Actinic keratosis:0.942089 Benign keratosis:0.927778 Dermatofibroma:0.972561 Vascular lesion:0.973604
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1161.0, 76.0, 42.0, 115.0, 9.0, 30.0]

TEST Student: Epoch: 82, iteration: 86

TEST AUROC: 0.908039, TEST Accus: 0.686993, TEST Senss: 0.838306, TEST Specs: 0.859721
AUROCs: Melanoma:0.883122 Melanocytic nevus:0.936215 Basal cell carcinoma:0.959155 Actinic keratosis:0.940981 Benign keratosis:0.898449 Dermatofibroma:0.739817 Vascular lesion:0.998537
Accus: Melanoma:0.619048 Melanocytic nevus:0.860638 Basal cell carcinoma:0.690909 Actinic keratosis:0.724138 Benign keratosis:0.537383 Dermatofibroma:0.409091 Vascular lesion:0.967742
Senss: Melanoma:0.883117 Melanocytic nevus:0.964418 Basal cell carcinoma:0.845455 Actinic keratosis:0.862069 Benign keratosis:0.813084 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.734865 Melanocytic nevus:0.666667 Basal cell carcinoma:0.947507 Actinic keratosis:0.917731 Benign keratosis:0.852860 Dermatofibroma:0.948319 Vascular lesion:0.950101
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_83.pth

Epoch: 83, iteration: 0/87, ==> train <===, loss: 1.735154, classification loss: 1.784854,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.071099,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021399,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.5926791088519824e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 559.0, 33.0, 23.0, 59.0, 5.0, 12.0]

VAL Student: Epoch: 83, iteration: 86

VAL AUROC: 0.858216, VAL Accus: 0.621359, VAL Senss: 0.703738, VAL Specs: 0.918306
AUROCs: Melanoma:0.854720 Melanocytic nevus:0.940281 Basal cell carcinoma:0.922265 Actinic keratosis:0.949140 Benign keratosis:0.872111 Dermatofibroma:0.602261 Vascular lesion:0.866734
Accus: Melanoma:0.495798 Melanocytic nevus:0.843137 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.923077 Basal cell carcinoma:0.722222 Actinic keratosis:0.727273 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.862656 Melanocytic nevus:0.798220 Basal cell carcinoma:0.945032 Actinic keratosis:0.946225 Benign keratosis:0.904444 Dermatofibroma:0.988821 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 1125.0, 86.0, 39.0, 129.0, 7.0, 28.0]

TEST Student: Epoch: 83, iteration: 86

TEST AUROC: 0.906454, TEST Accus: 0.670973, TEST Senss: 0.829574, TEST Specs: 0.867522
AUROCs: Melanoma:0.883384 Melanocytic nevus:0.939602 Basal cell carcinoma:0.971811 Actinic keratosis:0.921740 Benign keratosis:0.903304 Dermatofibroma:0.726771 Vascular lesion:0.998569
Accus: Melanoma:0.584416 Melanocytic nevus:0.833951 Basal cell carcinoma:0.781818 Actinic keratosis:0.672414 Benign keratosis:0.602804 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.852814 Melanocytic nevus:0.953299 Basal cell carcinoma:0.909091 Actinic keratosis:0.827586 Benign keratosis:0.855140 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.751121 Melanocytic nevus:0.734234 Basal cell carcinoma:0.900787 Actinic keratosis:0.930506 Benign keratosis:0.812326 Dermatofibroma:0.970898 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_84.pth

Epoch: 84, iteration: 0/87, ==> train <===, loss: 1.745476, classification loss: 1.783575,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069548,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031449,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.4334111979667841e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 602.0, 30.0, 26.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 84, iteration: 86

VAL AUROC: 0.867308, VAL Accus: 0.625447, VAL Senss: 0.699124, VAL Specs: 0.913417
AUROCs: Melanoma:0.857629 Melanocytic nevus:0.939673 Basal cell carcinoma:0.895662 Actinic keratosis:0.973520 Benign keratosis:0.845389 Dermatofibroma:0.683816 Vascular lesion:0.875465
Accus: Melanoma:0.504202 Melanocytic nevus:0.907994 Basal cell carcinoma:0.555556 Actinic keratosis:0.787879 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.948718 Basal cell carcinoma:0.592593 Actinic keratosis:0.848485 Benign keratosis:0.640000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.886493 Melanocytic nevus:0.697329 Basal cell carcinoma:0.968288 Actinic keratosis:0.947260 Benign keratosis:0.931111 Dermatofibroma:0.987805 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1199.0, 74.0, 42.0, 119.0, 8.0, 29.0]

TEST Student: Epoch: 84, iteration: 86

TEST AUROC: 0.911265, TEST Accus: 0.668238, TEST Senss: 0.836083, TEST Specs: 0.858248
AUROCs: Melanoma:0.885774 Melanocytic nevus:0.936493 Basal cell carcinoma:0.966237 Actinic keratosis:0.941175 Benign keratosis:0.909282 Dermatofibroma:0.741322 Vascular lesion:0.998569
Accus: Melanoma:0.536797 Melanocytic nevus:0.888807 Basal cell carcinoma:0.672727 Actinic keratosis:0.724138 Benign keratosis:0.556075 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.844156 Melanocytic nevus:0.974055 Basal cell carcinoma:0.854545 Actinic keratosis:0.862069 Benign keratosis:0.817757 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.776906 Melanocytic nevus:0.603604 Basal cell carcinoma:0.932283 Actinic keratosis:0.918753 Benign keratosis:0.856191 Dermatofibroma:0.969393 Vascular lesion:0.950605
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_85.pth

Epoch: 85, iteration: 0/87, ==> train <===, loss: 1.754305, classification loss: 1.798680,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070363,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025988,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.2900700781701057e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [57.0, 549.0, 36.0, 22.0, 63.0, 5.0, 12.0]

VAL Student: Epoch: 85, iteration: 86

VAL AUROC: 0.854656, VAL Accus: 0.626126, VAL Senss: 0.715602, VAL Specs: 0.918066
AUROCs: Melanoma:0.840956 Melanocytic nevus:0.940281 Basal cell carcinoma:0.938396 Actinic keratosis:0.941400 Benign keratosis:0.888967 Dermatofibroma:0.572218 Vascular lesion:0.860372
Accus: Melanoma:0.478992 Melanocytic nevus:0.828054 Basal cell carcinoma:0.666667 Actinic keratosis:0.666667 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.914027 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.869467 Melanocytic nevus:0.810089 Basal cell carcinoma:0.934461 Actinic keratosis:0.947260 Benign keratosis:0.896667 Dermatofibroma:0.989837 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1117.0, 90.0, 34.0, 135.0, 7.0, 28.0]

TEST Student: Epoch: 85, iteration: 86

TEST AUROC: 0.902106, TEST Accus: 0.665774, TEST Senss: 0.824544, TEST Specs: 0.859656
AUROCs: Melanoma:0.872707 Melanocytic nevus:0.936668 Basal cell carcinoma:0.970112 Actinic keratosis:0.923220 Benign keratosis:0.901931 Dermatofibroma:0.712106 Vascular lesion:0.998000
Accus: Melanoma:0.575758 Melanocytic nevus:0.828021 Basal cell carcinoma:0.818182 Actinic keratosis:0.586207 Benign keratosis:0.630841 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.831169 Melanocytic nevus:0.944403 Basal cell carcinoma:0.954545 Actinic keratosis:0.827586 Benign keratosis:0.850467 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.766256 Melanocytic nevus:0.735736 Basal cell carcinoma:0.867717 Actinic keratosis:0.923352 Benign keratosis:0.793448 Dermatofibroma:0.969895 Vascular lesion:0.961190
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_86.pth

Epoch: 86, iteration: 0/87, ==> train <===, loss: 1.742102, classification loss: 1.788825,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.064252,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017529,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.1610630703530951e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 585.0, 37.0, 20.0, 53.0, 6.0, 12.0]

VAL Student: Epoch: 86, iteration: 86

VAL AUROC: 0.894602, VAL Accus: 0.624914, VAL Senss: 0.705688, VAL Specs: 0.912041
AUROCs: Melanoma:0.852593 Melanocytic nevus:0.935027 Basal cell carcinoma:0.944562 Actinic keratosis:0.961831 Benign keratosis:0.863400 Dermatofibroma:0.787983 Vascular lesion:0.916819
Accus: Melanoma:0.495798 Melanocytic nevus:0.882353 Basal cell carcinoma:0.685185 Actinic keratosis:0.606061 Benign keratosis:0.530000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.932127 Basal cell carcinoma:0.851852 Actinic keratosis:0.696970 Benign keratosis:0.620000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.897843 Melanocytic nevus:0.732938 Basal cell carcinoma:0.919662 Actinic keratosis:0.966908 Benign keratosis:0.928889 Dermatofibroma:0.974593 Vascular lesion:0.963452
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [123.0, 1178.0, 94.0, 26.0, 118.0, 7.0, 31.0]

TEST Student: Epoch: 86, iteration: 86

TEST AUROC: 0.909440, TEST Accus: 0.654016, TEST Senss: 0.831380, TEST Specs: 0.860727
AUROCs: Melanoma:0.883889 Melanocytic nevus:0.935008 Basal cell carcinoma:0.972603 Actinic keratosis:0.923264 Benign keratosis:0.908735 Dermatofibroma:0.743945 Vascular lesion:0.998634
Accus: Melanoma:0.532468 Melanocytic nevus:0.873239 Basal cell carcinoma:0.854545 Actinic keratosis:0.448276 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:1.000000
Senss: Melanoma:0.796537 Melanocytic nevus:0.961453 Basal cell carcinoma:0.972727 Actinic keratosis:0.775862 Benign keratosis:0.813084 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.804372 Melanocytic nevus:0.662162 Basal cell carcinoma:0.857743 Actinic keratosis:0.944303 Benign keratosis:0.866185 Dermatofibroma:0.955344 Vascular lesion:0.934980
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_87.pth

Epoch: 87, iteration: 0/87, ==> train <===, loss: 1.757121, classification loss: 1.816540,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068192,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.008772,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0449567633177856e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 526.0, 38.0, 23.0, 62.0, 5.0, 12.0]

VAL Student: Epoch: 87, iteration: 86

VAL AUROC: 0.853389, VAL Accus: 0.643767, VAL Senss: 0.715729, VAL Specs: 0.916585
AUROCs: Melanoma:0.851696 Melanocytic nevus:0.935049 Basal cell carcinoma:0.938963 Actinic keratosis:0.886497 Benign keratosis:0.887422 Dermatofibroma:0.625635 Vascular lesion:0.848460
Accus: Melanoma:0.579832 Melanocytic nevus:0.793363 Basal cell carcinoma:0.703704 Actinic keratosis:0.696970 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.739496 Melanocytic nevus:0.876320 Basal cell carcinoma:0.814815 Actinic keratosis:0.696970 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.828604 Melanocytic nevus:0.851632 Basal cell carcinoma:0.927061 Actinic keratosis:0.949328 Benign keratosis:0.901111 Dermatofibroma:0.983740 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [150.0, 1062.0, 91.0, 33.0, 133.0, 7.0, 28.0]

TEST Student: Epoch: 87, iteration: 86

TEST AUROC: 0.901198, TEST Accus: 0.667963, TEST Senss: 0.827505, TEST Specs: 0.856930
AUROCs: Melanoma:0.876742 Melanocytic nevus:0.933766 Basal cell carcinoma:0.969926 Actinic keratosis:0.910745 Benign keratosis:0.897146 Dermatofibroma:0.722324 Vascular lesion:0.997740
Accus: Melanoma:0.649351 Melanocytic nevus:0.787250 Basal cell carcinoma:0.827273 Actinic keratosis:0.568966 Benign keratosis:0.621495 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.896104 Melanocytic nevus:0.929577 Basal cell carcinoma:0.945455 Actinic keratosis:0.775862 Benign keratosis:0.836449 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.704596 Melanocytic nevus:0.771772 Basal cell carcinoma:0.872966 Actinic keratosis:0.923352 Benign keratosis:0.801777 Dermatofibroma:0.965379 Vascular lesion:0.958669
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_88.pth

Epoch: 88, iteration: 0/87, ==> train <===, loss: 1.740977, classification loss: 1.794664,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067761,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.014074,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.40461086986007e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 544.0, 29.0, 24.0, 61.0, 5.0, 12.0]

VAL Student: Epoch: 88, iteration: 86

VAL AUROC: 0.872123, VAL Accus: 0.614732, VAL Senss: 0.712559, VAL Specs: 0.916506
AUROCs: Melanoma:0.849999 Melanocytic nevus:0.933366 Basal cell carcinoma:0.908034 Actinic keratosis:0.968130 Benign keratosis:0.876711 Dermatofibroma:0.691057 Vascular lesion:0.877563
Accus: Melanoma:0.495798 Melanocytic nevus:0.820513 Basal cell carcinoma:0.537037 Actinic keratosis:0.727273 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.897436 Basal cell carcinoma:0.611111 Actinic keratosis:0.848485 Benign keratosis:0.750000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.870602 Melanocytic nevus:0.821958 Basal cell carcinoma:0.955603 Actinic keratosis:0.921406 Benign keratosis:0.897778 Dermatofibroma:0.969512 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 1111.0, 81.0, 43.0, 140.0, 9.0, 29.0]

TEST Student: Epoch: 88, iteration: 86

TEST AUROC: 0.905261, TEST Accus: 0.694077, TEST Senss: 0.840129, TEST Specs: 0.859118
AUROCs: Melanoma:0.874871 Melanocytic nevus:0.936525 Basal cell carcinoma:0.967029 Actinic keratosis:0.929722 Benign keratosis:0.899653 Dermatofibroma:0.730557 Vascular lesion:0.998472
Accus: Melanoma:0.558442 Melanocytic nevus:0.823573 Basal cell carcinoma:0.736364 Actinic keratosis:0.741379 Benign keratosis:0.654206 Dermatofibroma:0.409091 Vascular lesion:0.935484
Senss: Melanoma:0.813853 Melanocytic nevus:0.941438 Basal cell carcinoma:0.881818 Actinic keratosis:0.879310 Benign keratosis:0.864486 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.764013 Melanocytic nevus:0.758258 Basal cell carcinoma:0.918635 Actinic keratosis:0.883495 Benign keratosis:0.788451 Dermatofibroma:0.940291 Vascular lesion:0.960685
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_89.pth

Epoch: 89, iteration: 0/87, ==> train <===, loss: 1.730609, classification loss: 1.784570,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.074165,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020204,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.464149782874063e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 549.0, 34.0, 23.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 89, iteration: 86

VAL AUROC: 0.869011, VAL Accus: 0.628597, VAL Senss: 0.715562, VAL Specs: 0.915041
AUROCs: Melanoma:0.857553 Melanocytic nevus:0.939623 Basal cell carcinoma:0.936908 Actinic keratosis:0.965686 Benign keratosis:0.863800 Dermatofibroma:0.636052 Vascular lesion:0.883452
Accus: Melanoma:0.563025 Melanocytic nevus:0.828054 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.909502 Basal cell carcinoma:0.759259 Actinic keratosis:0.727273 Benign keratosis:0.690000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.841090 Melanocytic nevus:0.810089 Basal cell carcinoma:0.930233 Actinic keratosis:0.944157 Benign keratosis:0.912222 Dermatofibroma:0.982724 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1104.0, 89.0, 38.0, 128.0, 7.0, 28.0]

TEST Student: Epoch: 89, iteration: 86

TEST AUROC: 0.907405, TEST Accus: 0.673225, TEST Senss: 0.838903, TEST Specs: 0.859644
AUROCs: Melanoma:0.880241 Melanocytic nevus:0.938772 Basal cell carcinoma:0.971754 Actinic keratosis:0.929880 Benign keratosis:0.899456 Dermatofibroma:0.733636 Vascular lesion:0.998098
Accus: Melanoma:0.610390 Melanocytic nevus:0.818384 Basal cell carcinoma:0.809091 Actinic keratosis:0.655172 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.874459 Melanocytic nevus:0.942921 Basal cell carcinoma:0.936364 Actinic keratosis:0.827586 Benign keratosis:0.836449 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.723094 Melanocytic nevus:0.740240 Basal cell carcinoma:0.876115 Actinic keratosis:0.924885 Benign keratosis:0.824542 Dermatofibroma:0.955344 Vascular lesion:0.973286
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_90.pth

Epoch: 90, iteration: 0/87, ==> train <===, loss: 1.751515, classification loss: 1.784978,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067692,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.034228,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.617734804586658e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [77.0, 553.0, 32.0, 22.0, 51.0, 6.0, 12.0]

VAL Student: Epoch: 90, iteration: 86

VAL AUROC: 0.872572, VAL Accus: 0.632201, VAL Senss: 0.702315, VAL Specs: 0.913523
AUROCs: Melanoma:0.868389 Melanocytic nevus:0.939708 Basal cell carcinoma:0.913672 Actinic keratosis:0.942528 Benign keratosis:0.848267 Dermatofibroma:0.710366 Vascular lesion:0.885076
Accus: Melanoma:0.647059 Melanocytic nevus:0.834087 Basal cell carcinoma:0.592593 Actinic keratosis:0.666667 Benign keratosis:0.510000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.789916 Melanocytic nevus:0.917044 Basal cell carcinoma:0.666667 Actinic keratosis:0.757576 Benign keratosis:0.610000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.812713 Melanocytic nevus:0.786350 Basal cell carcinoma:0.952431 Actinic keratosis:0.956567 Benign keratosis:0.933333 Dermatofibroma:0.968496 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [161.0, 1120.0, 88.0, 34.0, 106.0, 10.0, 28.0]

TEST Student: Epoch: 90, iteration: 86

TEST AUROC: 0.909243, TEST Accus: 0.680931, TEST Senss: 0.830438, TEST Specs: 0.861895
AUROCs: Melanoma:0.886919 Melanocytic nevus:0.939604 Basal cell carcinoma:0.972565 Actinic keratosis:0.927510 Benign keratosis:0.895224 Dermatofibroma:0.744241 Vascular lesion:0.998634
Accus: Melanoma:0.696970 Melanocytic nevus:0.830245 Basal cell carcinoma:0.800000 Actinic keratosis:0.586207 Benign keratosis:0.495327 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.917749 Melanocytic nevus:0.954040 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.766355 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.691704 Melanocytic nevus:0.722222 Basal cell carcinoma:0.913386 Actinic keratosis:0.931017 Benign keratosis:0.863409 Dermatofibroma:0.947817 Vascular lesion:0.963710
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_91.pth

Epoch: 91, iteration: 0/87, ==> train <===, loss: 1.755562, classification loss: 1.798352,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066717,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023927,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.855961324127992e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 595.0, 34.0, 25.0, 46.0, 6.0, 12.0]

VAL Student: Epoch: 91, iteration: 86

VAL AUROC: 0.881007, VAL Accus: 0.629577, VAL Senss: 0.697757, VAL Specs: 0.910833
AUROCs: Melanoma:0.854854 Melanocytic nevus:0.933398 Basal cell carcinoma:0.929645 Actinic keratosis:0.970198 Benign keratosis:0.845311 Dermatofibroma:0.747078 Vascular lesion:0.886565
Accus: Melanoma:0.487395 Melanocytic nevus:0.897436 Basal cell carcinoma:0.629630 Actinic keratosis:0.757576 Benign keratosis:0.460000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.672269 Melanocytic nevus:0.935143 Basal cell carcinoma:0.703704 Actinic keratosis:0.818182 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.894438 Melanocytic nevus:0.709199 Basal cell carcinoma:0.946089 Actinic keratosis:0.946225 Benign keratosis:0.937778 Dermatofibroma:0.967480 Vascular lesion:0.974619
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 1192.0, 84.0, 35.0, 117.0, 9.0, 31.0]

TEST Student: Epoch: 91, iteration: 86

TEST AUROC: 0.908273, TEST Accus: 0.674525, TEST Senss: 0.827031, TEST Specs: 0.859433
AUROCs: Melanoma:0.878975 Melanocytic nevus:0.932401 Basal cell carcinoma:0.971792 Actinic keratosis:0.931413 Benign keratosis:0.899002 Dermatofibroma:0.745724 Vascular lesion:0.998602
Accus: Melanoma:0.515152 Melanocytic nevus:0.883617 Basal cell carcinoma:0.763636 Actinic keratosis:0.603448 Benign keratosis:0.546729 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.779221 Melanocytic nevus:0.970348 Basal cell carcinoma:0.890909 Actinic keratosis:0.827586 Benign keratosis:0.775701 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.799888 Melanocytic nevus:0.629129 Basal cell carcinoma:0.900262 Actinic keratosis:0.923863 Benign keratosis:0.874514 Dermatofibroma:0.940291 Vascular lesion:0.948085
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_92.pth

Epoch: 92, iteration: 0/87, ==> train <===, loss: 1.741950, classification loss: 1.784405,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070443,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027988,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.170365191715193e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [82.0, 537.0, 29.0, 20.0, 60.0, 5.0, 12.0]

VAL Student: Epoch: 92, iteration: 86

VAL AUROC: 0.846583, VAL Accus: 0.622090, VAL Senss: 0.687830, VAL Specs: 0.913766
AUROCs: Melanoma:0.871212 Melanocytic nevus:0.942152 Basal cell carcinoma:0.895036 Actinic keratosis:0.870860 Benign keratosis:0.878411 Dermatofibroma:0.589494 Vascular lesion:0.878917
Accus: Melanoma:0.689076 Melanocytic nevus:0.809955 Basal cell carcinoma:0.537037 Actinic keratosis:0.606061 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.798319 Melanocytic nevus:0.907994 Basal cell carcinoma:0.629630 Actinic keratosis:0.636364 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.799092 Melanocytic nevus:0.804154 Basal cell carcinoma:0.967230 Actinic keratosis:0.965874 Benign keratosis:0.895556 Dermatofibroma:0.986789 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [170.0, 1089.0, 76.0, 32.0, 134.0, 6.0, 28.0]

TEST Student: Epoch: 92, iteration: 86

TEST AUROC: 0.901726, TEST Accus: 0.655421, TEST Senss: 0.818344, TEST Specs: 0.863748
AUROCs: Melanoma:0.887674 Melanocytic nevus:0.939291 Basal cell carcinoma:0.969940 Actinic keratosis:0.911062 Benign keratosis:0.897684 Dermatofibroma:0.708183 Vascular lesion:0.998244
Accus: Melanoma:0.735931 Melanocytic nevus:0.807265 Basal cell carcinoma:0.690909 Actinic keratosis:0.551724 Benign keratosis:0.626168 Dermatofibroma:0.272727 Vascular lesion:0.903226
Senss: Melanoma:0.926407 Melanocytic nevus:0.942179 Basal cell carcinoma:0.872727 Actinic keratosis:0.724138 Benign keratosis:0.808411 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.660874 Melanocytic nevus:0.756757 Basal cell carcinoma:0.939108 Actinic keratosis:0.953500 Benign keratosis:0.808440 Dermatofibroma:0.969895 Vascular lesion:0.957661
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_93.pth

Epoch: 93, iteration: 0/87, ==> train <===, loss: 1.753162, classification loss: 1.792367,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.068424,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029219,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.553328672543673e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 569.0, 29.0, 23.0, 62.0, 5.0, 12.0]

VAL Student: Epoch: 93, iteration: 86

VAL AUROC: 0.869608, VAL Accus: 0.620819, VAL Senss: 0.702233, VAL Specs: 0.915873
AUROCs: Melanoma:0.847652 Melanocytic nevus:0.942336 Basal cell carcinoma:0.905078 Actinic keratosis:0.967597 Benign keratosis:0.882178 Dermatofibroma:0.662348 Vascular lesion:0.880068
Accus: Melanoma:0.521008 Melanocytic nevus:0.858220 Basal cell carcinoma:0.537037 Actinic keratosis:0.696970 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.921569 Basal cell carcinoma:0.592593 Actinic keratosis:0.787879 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.844495 Melanocytic nevus:0.798220 Basal cell carcinoma:0.972516 Actinic keratosis:0.946225 Benign keratosis:0.893333 Dermatofibroma:0.978659 Vascular lesion:0.977665
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1120.0, 76.0, 39.0, 140.0, 8.0, 30.0]

TEST Student: Epoch: 93, iteration: 86

TEST AUROC: 0.908262, TEST Accus: 0.681746, TEST Senss: 0.840084, TEST Specs: 0.861014
AUROCs: Melanoma:0.879395 Melanocytic nevus:0.937936 Basal cell carcinoma:0.967559 Actinic keratosis:0.930744 Benign keratosis:0.904138 Dermatofibroma:0.739657 Vascular lesion:0.998407
Accus: Melanoma:0.593074 Melanocytic nevus:0.830245 Basal cell carcinoma:0.690909 Actinic keratosis:0.672414 Benign keratosis:0.654206 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.870130 Melanocytic nevus:0.950334 Basal cell carcinoma:0.872727 Actinic keratosis:0.827586 Benign keratosis:0.859813 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.736547 Melanocytic nevus:0.726727 Basal cell carcinoma:0.941732 Actinic keratosis:0.917731 Benign keratosis:0.797890 Dermatofibroma:0.950828 Vascular lesion:0.955645
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_94.pth

Epoch: 94, iteration: 0/87, ==> train <===, loss: 1.753352, classification loss: 1.798116,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.067909,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023145,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.997995805289306e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [84.0, 527.0, 35.0, 22.0, 52.0, 5.0, 12.0]

VAL Student: Epoch: 94, iteration: 86

VAL AUROC: 0.856682, VAL Accus: 0.635438, VAL Senss: 0.715234, VAL Specs: 0.912699
AUROCs: Melanoma:0.871670 Melanocytic nevus:0.938554 Basal cell carcinoma:0.924105 Actinic keratosis:0.922597 Benign keratosis:0.853744 Dermatofibroma:0.607660 Vascular lesion:0.878443
Accus: Melanoma:0.705882 Melanocytic nevus:0.794872 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.806723 Melanocytic nevus:0.888386 Basal cell carcinoma:0.759259 Actinic keratosis:0.727273 Benign keratosis:0.650000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.793417 Melanocytic nevus:0.824926 Basal cell carcinoma:0.940803 Actinic keratosis:0.951396 Benign keratosis:0.920000 Dermatofibroma:0.974593 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [166.0, 1057.0, 90.0, 36.0, 121.0, 8.0, 28.0]

TEST Student: Epoch: 94, iteration: 86

TEST AUROC: 0.905269, TEST Accus: 0.681902, TEST Senss: 0.827651, TEST Specs: 0.865875
AUROCs: Melanoma:0.882945 Melanocytic nevus:0.939145 Basal cell carcinoma:0.970313 Actinic keratosis:0.924145 Benign keratosis:0.892715 Dermatofibroma:0.729553 Vascular lesion:0.998065
Accus: Melanoma:0.718615 Melanocytic nevus:0.783543 Basal cell carcinoma:0.818182 Actinic keratosis:0.620690 Benign keratosis:0.565421 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.926407 Melanocytic nevus:0.925871 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.766355 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.668722 Melanocytic nevus:0.788288 Basal cell carcinoma:0.903412 Actinic keratosis:0.931528 Benign keratosis:0.850083 Dermatofibroma:0.946312 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_95.pth

Epoch: 95, iteration: 0/87, ==> train <===, loss: 1.739707, classification loss: 1.790328,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070171,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019550,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.498196224760376e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 567.0, 38.0, 22.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 95, iteration: 86

VAL AUROC: 0.864780, VAL Accus: 0.629125, VAL Senss: 0.718822, VAL Specs: 0.911205
AUROCs: Melanoma:0.841509 Melanocytic nevus:0.933702 Basal cell carcinoma:0.943779 Actinic keratosis:0.941274 Benign keratosis:0.866378 Dermatofibroma:0.645262 Vascular lesion:0.881557
Accus: Melanoma:0.495798 Melanocytic nevus:0.855204 Basal cell carcinoma:0.703704 Actinic keratosis:0.666667 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.918552 Basal cell carcinoma:0.851852 Actinic keratosis:0.727273 Benign keratosis:0.670000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.867196 Melanocytic nevus:0.756677 Basal cell carcinoma:0.924947 Actinic keratosis:0.952430 Benign keratosis:0.930000 Dermatofibroma:0.974593 Vascular lesion:0.972589
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1148.0, 90.0, 33.0, 119.0, 7.0, 31.0]

TEST Student: Epoch: 95, iteration: 86

TEST AUROC: 0.903711, TEST Accus: 0.669119, TEST Senss: 0.833696, TEST Specs: 0.858014
AUROCs: Melanoma:0.871444 Melanocytic nevus:0.933799 Basal cell carcinoma:0.974102 Actinic keratosis:0.919678 Benign keratosis:0.896239 Dermatofibroma:0.732017 Vascular lesion:0.998699
Accus: Melanoma:0.571429 Melanocytic nevus:0.851001 Basal cell carcinoma:0.818182 Actinic keratosis:0.568966 Benign keratosis:0.556075 Dermatofibroma:0.318182 Vascular lesion:1.000000
Senss: Melanoma:0.809524 Melanocytic nevus:0.953299 Basal cell carcinoma:0.963636 Actinic keratosis:0.810345 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.773543 Melanocytic nevus:0.683183 Basal cell carcinoma:0.867192 Actinic keratosis:0.928462 Benign keratosis:0.852304 Dermatofibroma:0.954842 Vascular lesion:0.946573
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_96.pth

Epoch: 96, iteration: 0/87, ==> train <===, loss: 1.730699, classification loss: 1.788267,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.070491,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012924,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.048376602284338e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 554.0, 34.0, 23.0, 54.0, 5.0, 12.0]

VAL Student: Epoch: 96, iteration: 86

VAL AUROC: 0.854637, VAL Accus: 0.619386, VAL Senss: 0.706796, VAL Specs: 0.915940
AUROCs: Melanoma:0.855970 Melanocytic nevus:0.935063 Basal cell carcinoma:0.927394 Actinic keratosis:0.943186 Benign keratosis:0.854567 Dermatofibroma:0.607533 Vascular lesion:0.858748
Accus: Melanoma:0.521008 Melanocytic nevus:0.835596 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.900452 Basal cell carcinoma:0.740741 Actinic keratosis:0.757576 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.843360 Melanocytic nevus:0.810089 Basal cell carcinoma:0.940803 Actinic keratosis:0.927611 Benign keratosis:0.922222 Dermatofibroma:0.979675 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1123.0, 88.0, 44.0, 121.0, 7.0, 28.0]

TEST Student: Epoch: 96, iteration: 86

TEST AUROC: 0.904385, TEST Accus: 0.682807, TEST Senss: 0.820653, TEST Specs: 0.861348
AUROCs: Melanoma:0.877919 Melanocytic nevus:0.935591 Basal cell carcinoma:0.970733 Actinic keratosis:0.925502 Benign keratosis:0.893221 Dermatofibroma:0.729759 Vascular lesion:0.997968
Accus: Melanoma:0.601732 Melanocytic nevus:0.832468 Basal cell carcinoma:0.800000 Actinic keratosis:0.758621 Benign keratosis:0.565421 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.883117 Melanocytic nevus:0.945145 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.803738 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.734305 Melanocytic nevus:0.735736 Basal cell carcinoma:0.892913 Actinic keratosis:0.888605 Benign keratosis:0.841199 Dermatofibroma:0.958856 Vascular lesion:0.977823
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_97.pth

Epoch: 97, iteration: 0/87, ==> train <===, loss: 1.739580, classification loss: 1.787401,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066438,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018617,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.6435389420559043e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 546.0, 35.0, 23.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 97, iteration: 86

VAL AUROC: 0.863382, VAL Accus: 0.641052, VAL Senss: 0.700792, VAL Specs: 0.916932
AUROCs: Melanoma:0.850046 Melanocytic nevus:0.936602 Basal cell carcinoma:0.916236 Actinic keratosis:0.925104 Benign keratosis:0.887967 Dermatofibroma:0.651105 Vascular lesion:0.876616
Accus: Melanoma:0.546218 Melanocytic nevus:0.823529 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.906486 Basal cell carcinoma:0.703704 Actinic keratosis:0.696970 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.846765 Melanocytic nevus:0.836795 Basal cell carcinoma:0.949260 Actinic keratosis:0.950362 Benign keratosis:0.892222 Dermatofibroma:0.975610 Vascular lesion:0.967513
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1093.0, 85.0, 36.0, 141.0, 7.0, 30.0]

TEST Student: Epoch: 97, iteration: 86

TEST AUROC: 0.902926, TEST Accus: 0.680453, TEST Senss: 0.834295, TEST Specs: 0.861859
AUROCs: Melanoma:0.880195 Melanocytic nevus:0.935519 Basal cell carcinoma:0.966385 Actinic keratosis:0.919943 Benign keratosis:0.901581 Dermatofibroma:0.718583 Vascular lesion:0.998277
Accus: Melanoma:0.614719 Melanocytic nevus:0.810230 Basal cell carcinoma:0.772727 Actinic keratosis:0.620690 Benign keratosis:0.658879 Dermatofibroma:0.318182 Vascular lesion:0.967742
Senss: Melanoma:0.861472 Melanocytic nevus:0.934766 Basal cell carcinoma:0.890909 Actinic keratosis:0.793103 Benign keratosis:0.859813 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.747758 Melanocytic nevus:0.765766 Basal cell carcinoma:0.908136 Actinic keratosis:0.927440 Benign keratosis:0.794559 Dermatofibroma:0.946312 Vascular lesion:0.943044
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_98.pth

Epoch: 98, iteration: 0/87, ==> train <===, loss: 1.742208, classification loss: 1.783895,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.066339,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024653,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.279185047850314e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 591.0, 34.0, 22.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 98, iteration: 86

VAL AUROC: 0.866465, VAL Accus: 0.616055, VAL Senss: 0.706973, VAL Specs: 0.915826
AUROCs: Melanoma:0.853079 Melanocytic nevus:0.938003 Basal cell carcinoma:0.922774 Actinic keratosis:0.969133 Benign keratosis:0.863511 Dermatofibroma:0.640307 Vascular lesion:0.878443
Accus: Melanoma:0.462185 Melanocytic nevus:0.891403 Basal cell carcinoma:0.629630 Actinic keratosis:0.666667 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.672269 Melanocytic nevus:0.933635 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.885358 Melanocytic nevus:0.747774 Basal cell carcinoma:0.946089 Actinic keratosis:0.944157 Benign keratosis:0.918889 Dermatofibroma:0.985772 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [121.0, 1182.0, 86.0, 39.0, 125.0, 8.0, 28.0]

TEST Student: Epoch: 98, iteration: 86

TEST AUROC: 0.911565, TEST Accus: 0.672174, TEST Senss: 0.840134, TEST Specs: 0.862220
AUROCs: Melanoma:0.884425 Melanocytic nevus:0.936556 Basal cell carcinoma:0.973858 Actinic keratosis:0.934307 Benign keratosis:0.909650 Dermatofibroma:0.743557 Vascular lesion:0.998602
Accus: Melanoma:0.523810 Melanocytic nevus:0.876205 Basal cell carcinoma:0.781818 Actinic keratosis:0.672414 Benign keratosis:0.584112 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.835498 Melanocytic nevus:0.964418 Basal cell carcinoma:0.909091 Actinic keratosis:0.844828 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.778027 Melanocytic nevus:0.653153 Basal cell carcinoma:0.904987 Actinic keratosis:0.921308 Benign keratosis:0.843420 Dermatofibroma:0.963372 Vascular lesion:0.971270
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_99.pth

Epoch: 99, iteration: 0/87, ==> train <===, loss: 1.743073, classification loss: 1.789299,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.069744,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023517,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.951266543065283e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 545.0, 32.0, 25.0, 60.0, 6.0, 12.0]

VAL Student: Epoch: 99, iteration: 86

VAL AUROC: 0.869104, VAL Accus: 0.643116, VAL Senss: 0.719644, VAL Specs: 0.920272
AUROCs: Melanoma:0.858297 Melanocytic nevus:0.936938 Basal cell carcinoma:0.922246 Actinic keratosis:0.970982 Benign keratosis:0.867067 Dermatofibroma:0.645833 Vascular lesion:0.882369
Accus: Melanoma:0.554622 Melanocytic nevus:0.822021 Basal cell carcinoma:0.592593 Actinic keratosis:0.757576 Benign keratosis:0.600000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.911011 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.680000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.850170 Melanocytic nevus:0.824926 Basal cell carcinoma:0.949260 Actinic keratosis:0.947260 Benign keratosis:0.908889 Dermatofibroma:0.980691 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1110.0, 87.0, 38.0, 125.0, 8.0, 29.0]

TEST Student: Epoch: 99, iteration: 86

TEST AUROC: 0.907048, TEST Accus: 0.681599, TEST Senss: 0.833119, TEST Specs: 0.869692
AUROCs: Melanoma:0.880727 Melanocytic nevus:0.939672 Basal cell carcinoma:0.972241 Actinic keratosis:0.931034 Benign keratosis:0.896747 Dermatofibroma:0.730283 Vascular lesion:0.998634
Accus: Melanoma:0.619048 Melanocytic nevus:0.822832 Basal cell carcinoma:0.790909 Actinic keratosis:0.655172 Benign keratosis:0.584112 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.870130 Melanocytic nevus:0.939214 Basal cell carcinoma:0.881818 Actinic keratosis:0.827586 Benign keratosis:0.813084 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.746076 Melanocytic nevus:0.762763 Basal cell carcinoma:0.907612 Actinic keratosis:0.920797 Benign keratosis:0.829539 Dermatofibroma:0.957852 Vascular lesion:0.963206
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/checkpoint/epoch_100.pth
save model to ../model/skin_0722_frac01_BNM_w05_vat_batch32_densenet121/iter_8701.pth
