create semi supervised model
create semi supervised model
single label  Total # images:7000, labels:7000
single label  Total # images:1000, labels:1000
single label  Total # images:2015, labels:2015
train_dataset len: 7000
labeled_num: 700

Epoch: 0, iteration: 0/87, ==> train <===, loss: 1.940537, classification loss: 1.940537,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 0.0001
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [38.0, 446.0, 29.0, 22.0, 64.0, 0.0, 0.0]

VAL Student: Epoch: 0, iteration: 86

VAL AUROC: 0.793872, VAL Accus: 0.405104, VAL Senss: 0.558496, VAL Specs: 0.863721
AUROCs: Melanoma:0.771850 Melanocytic nevus:0.874950 Basal cell carcinoma:0.909013 Actinic keratosis:0.943217 Benign keratosis:0.820378 Dermatofibroma:0.459286 Vascular lesion:0.778409
Accus: Melanoma:0.319328 Melanocytic nevus:0.672700 Basal cell carcinoma:0.537037 Actinic keratosis:0.666667 Benign keratosis:0.640000 Dermatofibroma:0.000000 Vascular lesion:0.000000
Senss: Melanoma:0.579832 Melanocytic nevus:0.701357 Basal cell carcinoma:0.888889 Actinic keratosis:0.939394 Benign keratosis:0.800000 Dermatofibroma:0.000000 Vascular lesion:0.000000
Specs: Melanoma:0.800227 Melanocytic nevus:0.884273 Basal cell carcinoma:0.805497 Actinic keratosis:0.879007 Benign keratosis:0.681111 Dermatofibroma:0.995935 Vascular lesion:1.000000
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [63.0, 854.0, 60.0, 31.0, 145.0, 0.0, 0.0]

TEST Student: Epoch: 0, iteration: 86

TEST AUROC: 0.821356, TEST Accus: 0.380471, TEST Senss: 0.954982, TEST Specs: 0.228288
AUROCs: Melanoma:0.792589 Melanocytic nevus:0.877619 Basal cell carcinoma:0.889234 Actinic keratosis:0.919405 Benign keratosis:0.849440 Dermatofibroma:0.563586 Vascular lesion:0.857619
Accus: Melanoma:0.272727 Melanocytic nevus:0.633062 Basal cell carcinoma:0.545455 Actinic keratosis:0.534483 Benign keratosis:0.677570 Dermatofibroma:0.000000 Vascular lesion:0.000000
Senss: Melanoma:1.000000 Melanocytic nevus:0.944403 Basal cell carcinoma:1.000000 Actinic keratosis:1.000000 Benign keratosis:1.000000 Dermatofibroma:0.772727 Vascular lesion:0.967742
Specs: Melanoma:0.011771 Melanocytic nevus:0.429429 Basal cell carcinoma:0.169029 Actinic keratosis:0.109862 Benign keratosis:0.005552 Dermatofibroma:0.356749 Vascular lesion:0.515625
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_1.pth

Epoch: 1, iteration: 0/87, ==> train <===, loss: 1.913160, classification loss: 1.913160,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 9e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 476.0, 20.0, 25.0, 50.0, 1.0, 11.0]

VAL Student: Epoch: 1, iteration: 86

VAL AUROC: 0.846006, VAL Accus: 0.516045, VAL Senss: 0.664907, VAL Specs: 0.861299
AUROCs: Melanoma:0.811835 Melanocytic nevus:0.881628 Basal cell carcinoma:0.926004 Actinic keratosis:0.928739 Benign keratosis:0.858356 Dermatofibroma:0.587970 Vascular lesion:0.927513
Accus: Melanoma:0.470588 Melanocytic nevus:0.717949 Basal cell carcinoma:0.370370 Actinic keratosis:0.757576 Benign keratosis:0.500000 Dermatofibroma:0.062500 Vascular lesion:0.733333
Senss: Melanoma:0.697479 Melanocytic nevus:0.832579 Basal cell carcinoma:0.777778 Actinic keratosis:0.818182 Benign keratosis:0.670000 Dermatofibroma:0.125000 Vascular lesion:0.733333
Specs: Melanoma:0.794552 Melanocytic nevus:0.753709 Basal cell carcinoma:0.866808 Actinic keratosis:0.873837 Benign keratosis:0.860000 Dermatofibroma:0.985772 Vascular lesion:0.894416
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [109.0, 896.0, 56.0, 36.0, 132.0, 1.0, 29.0]

TEST Student: Epoch: 1, iteration: 86

TEST AUROC: 0.855136, TEST Accus: 0.551943, TEST Senss: 0.902730, TEST Specs: 0.426578
AUROCs: Melanoma:0.803540 Melanocytic nevus:0.895614 Basal cell carcinoma:0.931339 Actinic keratosis:0.892076 Benign keratosis:0.867841 Dermatofibroma:0.615267 Vascular lesion:0.980278
Accus: Melanoma:0.471861 Melanocytic nevus:0.664196 Basal cell carcinoma:0.509091 Actinic keratosis:0.620690 Benign keratosis:0.616822 Dermatofibroma:0.045455 Vascular lesion:0.935484
Senss: Melanoma:0.952381 Melanocytic nevus:0.961453 Basal cell carcinoma:0.981818 Actinic keratosis:0.965517 Benign keratosis:0.957944 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.286435 Melanocytic nevus:0.424925 Basal cell carcinoma:0.433596 Actinic keratosis:0.359223 Benign keratosis:0.410328 Dermatofibroma:0.562469 Vascular lesion:0.509073
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_2.pth

Epoch: 2, iteration: 0/87, ==> train <===, loss: 1.935019, classification loss: 1.935019,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 8.1e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 445.0, 35.0, 22.0, 59.0, 1.0, 9.0]

VAL Student: Epoch: 2, iteration: 86

VAL AUROC: 0.850204, VAL Accus: 0.539474, VAL Senss: 0.692522, VAL Specs: 0.869177
AUROCs: Melanoma:0.782490 Melanocytic nevus:0.903926 Basal cell carcinoma:0.951824 Actinic keratosis:0.941368 Benign keratosis:0.834511 Dermatofibroma:0.655615 Vascular lesion:0.881692
Accus: Melanoma:0.537815 Melanocytic nevus:0.671192 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.590000 Dermatofibroma:0.062500 Vascular lesion:0.600000
Senss: Melanoma:0.680672 Melanocytic nevus:0.811463 Basal cell carcinoma:0.870370 Actinic keratosis:0.848485 Benign keratosis:0.720000 Dermatofibroma:0.250000 Vascular lesion:0.666667
Specs: Melanoma:0.750284 Melanocytic nevus:0.830861 Basal cell carcinoma:0.885835 Actinic keratosis:0.889349 Benign keratosis:0.812222 Dermatofibroma:0.951220 Vascular lesion:0.964467
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 875.0, 65.0, 42.0, 132.0, 6.0, 22.0]

TEST Student: Epoch: 2, iteration: 86

TEST AUROC: 0.867501, TEST Accus: 0.590619, TEST Senss: 0.894556, TEST Specs: 0.586864
AUROCs: Melanoma:0.814850 Melanocytic nevus:0.906486 Basal cell carcinoma:0.929821 Actinic keratosis:0.921370 Benign keratosis:0.856814 Dermatofibroma:0.690234 Vascular lesion:0.952930
Accus: Melanoma:0.571429 Melanocytic nevus:0.648629 Basal cell carcinoma:0.590909 Actinic keratosis:0.724138 Benign keratosis:0.616822 Dermatofibroma:0.272727 Vascular lesion:0.709677
Senss: Melanoma:0.948052 Melanocytic nevus:0.945886 Basal cell carcinoma:0.972727 Actinic keratosis:0.948276 Benign keratosis:0.920561 Dermatofibroma:0.590909 Vascular lesion:0.935484
Specs: Melanoma:0.439462 Melanocytic nevus:0.596096 Basal cell carcinoma:0.609974 Actinic keratosis:0.621870 Benign keratosis:0.525819 Dermatofibroma:0.598595 Vascular lesion:0.716230
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_3.pth

Epoch: 3, iteration: 0/87, ==> train <===, loss: 1.930994, classification loss: 1.930994,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 7.290000000000001e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 497.0, 39.0, 16.0, 55.0, 3.0, 11.0]

VAL Student: Epoch: 3, iteration: 86

VAL AUROC: 0.826518, VAL Accus: 0.580883, VAL Senss: 0.708376, VAL Specs: 0.881678
AUROCs: Melanoma:0.846565 Melanocytic nevus:0.914945 Basal cell carcinoma:0.965938 Actinic keratosis:0.794961 Benign keratosis:0.874489 Dermatofibroma:0.480437 Vascular lesion:0.908291
Accus: Melanoma:0.638655 Melanocytic nevus:0.749623 Basal cell carcinoma:0.722222 Actinic keratosis:0.484848 Benign keratosis:0.550000 Dermatofibroma:0.187500 Vascular lesion:0.733333
Senss: Melanoma:0.806723 Melanocytic nevus:0.853695 Basal cell carcinoma:0.851852 Actinic keratosis:0.636364 Benign keratosis:0.760000 Dermatofibroma:0.250000 Vascular lesion:0.800000
Specs: Melanoma:0.721907 Melanocytic nevus:0.813056 Basal cell carcinoma:0.914376 Actinic keratosis:0.956567 Benign keratosis:0.840000 Dermatofibroma:0.955285 Vascular lesion:0.970558
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [163.0, 966.0, 86.0, 26.0, 122.0, 5.0, 28.0]

TEST Student: Epoch: 3, iteration: 86

TEST AUROC: 0.866924, TEST Accus: 0.621771, TEST Senss: 0.860013, TEST Specs: 0.686272
AUROCs: Melanoma:0.869142 Melanocytic nevus:0.917697 Basal cell carcinoma:0.961861 Actinic keratosis:0.863725 Benign keratosis:0.892466 Dermatofibroma:0.568490 Vascular lesion:0.995090
Accus: Melanoma:0.705628 Melanocytic nevus:0.716086 Basal cell carcinoma:0.781818 Actinic keratosis:0.448276 Benign keratosis:0.570093 Dermatofibroma:0.227273 Vascular lesion:0.903226
Senss: Melanoma:0.969697 Melanocytic nevus:0.939956 Basal cell carcinoma:0.990909 Actinic keratosis:0.775862 Benign keratosis:0.934579 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.397422 Melanocytic nevus:0.689189 Basal cell carcinoma:0.790026 Actinic keratosis:0.790496 Benign keratosis:0.569128 Dermatofibroma:0.755143 Vascular lesion:0.812500
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_4.pth

Epoch: 4, iteration: 0/87, ==> train <===, loss: 1.843418, classification loss: 1.843418,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 6.561000000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 492.0, 31.0, 24.0, 62.0, 2.0, 9.0]

VAL Student: Epoch: 4, iteration: 86

VAL AUROC: 0.877464, VAL Accus: 0.568095, VAL Senss: 0.718176, VAL Specs: 0.895493
AUROCs: Melanoma:0.818550 Melanocytic nevus:0.922191 Basal cell carcinoma:0.927218 Actinic keratosis:0.961612 Benign keratosis:0.857533 Dermatofibroma:0.751524 Vascular lesion:0.903621
Accus: Melanoma:0.588235 Melanocytic nevus:0.742081 Basal cell carcinoma:0.574074 Actinic keratosis:0.727273 Benign keratosis:0.620000 Dermatofibroma:0.125000 Vascular lesion:0.600000
Senss: Melanoma:0.747899 Melanocytic nevus:0.844646 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.759364 Melanocytic nevus:0.830861 Basal cell carcinoma:0.958774 Actinic keratosis:0.915202 Benign keratosis:0.837778 Dermatofibroma:0.977642 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [148.0, 953.0, 60.0, 44.0, 133.0, 5.0, 25.0]

TEST Student: Epoch: 4, iteration: 86

TEST AUROC: 0.883126, TEST Accus: 0.615205, TEST Senss: 0.852244, TEST Specs: 0.742637
AUROCs: Melanoma:0.843925 Melanocytic nevus:0.928072 Basal cell carcinoma:0.929912 Actinic keratosis:0.923995 Benign keratosis:0.865742 Dermatofibroma:0.722689 Vascular lesion:0.967547
Accus: Melanoma:0.640693 Melanocytic nevus:0.706449 Basal cell carcinoma:0.545455 Actinic keratosis:0.758621 Benign keratosis:0.621495 Dermatofibroma:0.227273 Vascular lesion:0.806452
Senss: Melanoma:0.943723 Melanocytic nevus:0.925130 Basal cell carcinoma:0.881818 Actinic keratosis:0.913793 Benign keratosis:0.911215 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.489350 Melanocytic nevus:0.720721 Basal cell carcinoma:0.875591 Actinic keratosis:0.834951 Benign keratosis:0.561355 Dermatofibroma:0.831410 Vascular lesion:0.885081
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_5.pth

Epoch: 5, iteration: 0/87, ==> train <===, loss: 1.871700, classification loss: 1.871700,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.904900000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [73.0, 511.0, 32.0, 18.0, 50.0, 7.0, 12.0]

VAL Student: Epoch: 5, iteration: 86

VAL AUROC: 0.844152, VAL Accus: 0.608533, VAL Senss: 0.707290, VAL Specs: 0.889091
AUROCs: Melanoma:0.826019 Melanocytic nevus:0.926622 Basal cell carcinoma:0.947126 Actinic keratosis:0.861834 Benign keratosis:0.828067 Dermatofibroma:0.670668 Vascular lesion:0.848731
Accus: Melanoma:0.613445 Melanocytic nevus:0.770739 Basal cell carcinoma:0.592593 Actinic keratosis:0.545455 Benign keratosis:0.500000 Dermatofibroma:0.437500 Vascular lesion:0.800000
Senss: Melanoma:0.764706 Melanocytic nevus:0.897436 Basal cell carcinoma:0.722222 Actinic keratosis:0.666667 Benign keratosis:0.600000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.724177 Melanocytic nevus:0.777448 Basal cell carcinoma:0.959831 Actinic keratosis:0.948294 Benign keratosis:0.891111 Dermatofibroma:0.934959 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [156.0, 1013.0, 73.0, 33.0, 116.0, 7.0, 25.0]

TEST Student: Epoch: 5, iteration: 86

TEST AUROC: 0.885593, TEST Accus: 0.617935, TEST Senss: 0.850755, TEST Specs: 0.760637
AUROCs: Melanoma:0.857313 Melanocytic nevus:0.923915 Basal cell carcinoma:0.946471 Actinic keratosis:0.900737 Benign keratosis:0.866489 Dermatofibroma:0.720796 Vascular lesion:0.983432
Accus: Melanoma:0.675325 Melanocytic nevus:0.750927 Basal cell carcinoma:0.663636 Actinic keratosis:0.568966 Benign keratosis:0.542056 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.943723 Melanocytic nevus:0.965901 Basal cell carcinoma:0.881818 Actinic keratosis:0.810345 Benign keratosis:0.827103 Dermatofibroma:0.590909 Vascular lesion:0.935484
Specs: Melanoma:0.507287 Melanocytic nevus:0.588589 Basal cell carcinoma:0.858793 Actinic keratosis:0.871231 Benign keratosis:0.782898 Dermatofibroma:0.791771 Vascular lesion:0.923891
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_6.pth

Epoch: 6, iteration: 0/87, ==> train <===, loss: 1.848934, classification loss: 1.848934,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 5.314410000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 538.0, 30.0, 17.0, 47.0, 6.0, 12.0]

VAL Student: Epoch: 6, iteration: 86

VAL AUROC: 0.847146, VAL Accus: 0.581913, VAL Senss: 0.679733, VAL Specs: 0.899938
AUROCs: Melanoma:0.851630 Melanocytic nevus:0.921555 Basal cell carcinoma:0.909385 Actinic keratosis:0.878788 Benign keratosis:0.856400 Dermatofibroma:0.670033 Vascular lesion:0.842234
Accus: Melanoma:0.546218 Melanocytic nevus:0.811463 Basal cell carcinoma:0.555556 Actinic keratosis:0.515152 Benign keratosis:0.470000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.885370 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.650000 Dermatofibroma:0.437500 Vascular lesion:0.800000
Specs: Melanoma:0.793417 Melanocytic nevus:0.768546 Basal cell carcinoma:0.968288 Actinic keratosis:0.948294 Benign keratosis:0.891111 Dermatofibroma:0.963415 Vascular lesion:0.966497
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1077.0, 66.0, 33.0, 113.0, 6.0, 30.0]

TEST Student: Epoch: 6, iteration: 86

TEST AUROC: 0.886775, TEST Accus: 0.622745, TEST Senss: 0.870268, TEST Specs: 0.772727
AUROCs: Melanoma:0.860103 Melanocytic nevus:0.916658 Basal cell carcinoma:0.917561 Actinic keratosis:0.903811 Benign keratosis:0.881177 Dermatofibroma:0.732062 Vascular lesion:0.996049
Accus: Melanoma:0.623377 Melanocytic nevus:0.798369 Basal cell carcinoma:0.600000 Actinic keratosis:0.568966 Benign keratosis:0.528037 Dermatofibroma:0.272727 Vascular lesion:0.967742
Senss: Melanoma:0.922078 Melanocytic nevus:0.954040 Basal cell carcinoma:0.818182 Actinic keratosis:0.879310 Benign keratosis:0.836449 Dermatofibroma:0.681818 Vascular lesion:1.000000
Specs: Melanoma:0.586883 Melanocytic nevus:0.609610 Basal cell carcinoma:0.895538 Actinic keratosis:0.866633 Benign keratosis:0.744031 Dermatofibroma:0.835424 Vascular lesion:0.870968
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_7.pth

Epoch: 7, iteration: 0/87, ==> train <===, loss: 1.825244, classification loss: 1.825244,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.782969000000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 475.0, 25.0, 26.0, 44.0, 5.0, 12.0]

VAL Student: Epoch: 7, iteration: 86

VAL AUROC: 0.839829, VAL Accus: 0.582058, VAL Senss: 0.669930, VAL Specs: 0.901661
AUROCs: Melanoma:0.817511 Melanocytic nevus:0.924191 Basal cell carcinoma:0.918272 Actinic keratosis:0.952023 Benign keratosis:0.794344 Dermatofibroma:0.633003 Vascular lesion:0.839459
Accus: Melanoma:0.554622 Melanocytic nevus:0.716440 Basal cell carcinoma:0.462963 Actinic keratosis:0.787879 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.663866 Melanocytic nevus:0.811463 Basal cell carcinoma:0.592593 Actinic keratosis:0.909091 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.802497 Melanocytic nevus:0.878338 Basal cell carcinoma:0.950317 Actinic keratosis:0.872802 Benign keratosis:0.877778 Dermatofibroma:0.946138 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [135.0, 946.0, 72.0, 46.0, 120.0, 6.0, 26.0]

TEST Student: Epoch: 7, iteration: 86

TEST AUROC: 0.878642, TEST Accus: 0.629358, TEST Senss: 0.833331, TEST Specs: 0.797643
AUROCs: Melanoma:0.842438 Melanocytic nevus:0.928666 Basal cell carcinoma:0.937919 Actinic keratosis:0.927766 Benign keratosis:0.825738 Dermatofibroma:0.709688 Vascular lesion:0.978278
Accus: Melanoma:0.584416 Melanocytic nevus:0.701260 Basal cell carcinoma:0.654545 Actinic keratosis:0.793103 Benign keratosis:0.560748 Dermatofibroma:0.272727 Vascular lesion:0.838710
Senss: Melanoma:0.883117 Melanocytic nevus:0.884359 Basal cell carcinoma:0.890909 Actinic keratosis:0.931034 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.644058 Melanocytic nevus:0.786787 Basal cell carcinoma:0.857218 Actinic keratosis:0.784875 Benign keratosis:0.703498 Dermatofibroma:0.865028 Vascular lesion:0.942036
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_8.pth

Epoch: 8, iteration: 0/87, ==> train <===, loss: 1.830860, classification loss: 1.830860,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 4.304672100000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 546.0, 29.0, 23.0, 46.0, 6.0, 12.0]

VAL Student: Epoch: 8, iteration: 86

VAL AUROC: 0.866203, VAL Accus: 0.603135, VAL Senss: 0.689871, VAL Specs: 0.907010
AUROCs: Melanoma:0.844438 Melanocytic nevus:0.925104 Basal cell carcinoma:0.925202 Actinic keratosis:0.937921 Benign keratosis:0.864589 Dermatofibroma:0.705793 Vascular lesion:0.860372
Accus: Melanoma:0.529412 Melanocytic nevus:0.823529 Basal cell carcinoma:0.537037 Actinic keratosis:0.696970 Benign keratosis:0.460000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.901961 Basal cell carcinoma:0.685185 Actinic keratosis:0.787879 Benign keratosis:0.590000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.828604 Melanocytic nevus:0.774481 Basal cell carcinoma:0.942918 Actinic keratosis:0.924509 Benign keratosis:0.934444 Dermatofibroma:0.953252 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1135.0, 85.0, 42.0, 107.0, 8.0, 26.0]

TEST Student: Epoch: 8, iteration: 86

TEST AUROC: 0.895246, TEST Accus: 0.663187, TEST Senss: 0.844249, TEST Specs: 0.806475
AUROCs: Melanoma:0.866679 Melanocytic nevus:0.926473 Basal cell carcinoma:0.951014 Actinic keratosis:0.915723 Benign keratosis:0.882814 Dermatofibroma:0.728162 Vascular lesion:0.995854
Accus: Melanoma:0.601732 Melanocytic nevus:0.841364 Basal cell carcinoma:0.772727 Actinic keratosis:0.724138 Benign keratosis:0.500000 Dermatofibroma:0.363636 Vascular lesion:0.838710
Senss: Melanoma:0.900433 Melanocytic nevus:0.962194 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.785047 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.639574 Melanocytic nevus:0.624625 Basal cell carcinoma:0.883990 Actinic keratosis:0.833929 Benign keratosis:0.823987 Dermatofibroma:0.887105 Vascular lesion:0.952117
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_9.pth

Epoch: 9, iteration: 0/87, ==> train <===, loss: 1.795632, classification loss: 1.795632,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.874204890000002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 530.0, 29.0, 25.0, 52.0, 5.0, 10.0]

VAL Student: Epoch: 9, iteration: 86

VAL AUROC: 0.871976, VAL Accus: 0.588941, VAL Senss: 0.672096, VAL Specs: 0.912668
AUROCs: Melanoma:0.842644 Melanocytic nevus:0.933711 Basal cell carcinoma:0.915610 Actinic keratosis:0.967002 Benign keratosis:0.863244 Dermatofibroma:0.711573 Vascular lesion:0.870051
Accus: Melanoma:0.529412 Melanocytic nevus:0.799397 Basal cell carcinoma:0.537037 Actinic keratosis:0.757576 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.722689 Melanocytic nevus:0.906486 Basal cell carcinoma:0.648148 Actinic keratosis:0.818182 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.834279 Melanocytic nevus:0.821958 Basal cell carcinoma:0.954545 Actinic keratosis:0.919338 Benign keratosis:0.914444 Dermatofibroma:0.951220 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [152.0, 1088.0, 79.0, 41.0, 121.0, 8.0, 27.0]

TEST Student: Epoch: 9, iteration: 86

TEST AUROC: 0.896967, TEST Accus: 0.669948, TEST Senss: 0.831896, TEST Specs: 0.822466
AUROCs: Melanoma:0.872777 Melanocytic nevus:0.931657 Basal cell carcinoma:0.945397 Actinic keratosis:0.935105 Benign keratosis:0.875806 Dermatofibroma:0.729896 Vascular lesion:0.988131
Accus: Melanoma:0.658009 Melanocytic nevus:0.806523 Basal cell carcinoma:0.718182 Actinic keratosis:0.706897 Benign keratosis:0.565421 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.904762 Melanocytic nevus:0.954781 Basal cell carcinoma:0.900000 Actinic keratosis:0.879310 Benign keratosis:0.794393 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.654709 Melanocytic nevus:0.678679 Basal cell carcinoma:0.899738 Actinic keratosis:0.853347 Benign keratosis:0.818434 Dermatofibroma:0.880080 Vascular lesion:0.972278
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_10.pth

Epoch: 10, iteration: 0/87, ==> train <===, loss: 1.819713, classification loss: 1.819713,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.4867844010000016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 526.0, 29.0, 22.0, 59.0, 4.0, 12.0]

VAL Student: Epoch: 10, iteration: 86

VAL AUROC: 0.840446, VAL Accus: 0.586808, VAL Senss: 0.679643, VAL Specs: 0.916217
AUROCs: Melanoma:0.838400 Melanocytic nevus:0.924925 Basal cell carcinoma:0.900673 Actinic keratosis:0.911285 Benign keratosis:0.853833 Dermatofibroma:0.607914 Vascular lesion:0.846091
Accus: Melanoma:0.470588 Melanocytic nevus:0.793363 Basal cell carcinoma:0.537037 Actinic keratosis:0.666667 Benign keratosis:0.590000 Dermatofibroma:0.250000 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.871795 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.844495 Melanocytic nevus:0.839763 Basal cell carcinoma:0.964059 Actinic keratosis:0.915202 Benign keratosis:0.885556 Dermatofibroma:0.979675 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1081.0, 73.0, 46.0, 123.0, 6.0, 28.0]

TEST Student: Epoch: 10, iteration: 86

TEST AUROC: 0.878402, TEST Accus: 0.655554, TEST Senss: 0.814767, TEST Specs: 0.832103
AUROCs: Melanoma:0.858548 Melanocytic nevus:0.930743 Basal cell carcinoma:0.925125 Actinic keratosis:0.923863 Benign keratosis:0.872003 Dermatofibroma:0.641655 Vascular lesion:0.996878
Accus: Melanoma:0.580087 Melanocytic nevus:0.801334 Basal cell carcinoma:0.663636 Actinic keratosis:0.793103 Benign keratosis:0.574766 Dermatofibroma:0.272727 Vascular lesion:0.903226
Senss: Melanoma:0.874459 Melanocytic nevus:0.938473 Basal cell carcinoma:0.854545 Actinic keratosis:0.896552 Benign keratosis:0.775701 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.705157 Melanocytic nevus:0.714715 Basal cell carcinoma:0.888714 Actinic keratosis:0.844660 Benign keratosis:0.790117 Dermatofibroma:0.931259 Vascular lesion:0.950101
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_11.pth

Epoch: 11, iteration: 0/87, ==> train <===, loss: 1.808301, classification loss: 1.808301,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 3.138105960900002e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 526.0, 32.0, 19.0, 46.0, 5.0, 12.0]

VAL Student: Epoch: 11, iteration: 86

VAL AUROC: 0.866378, VAL Accus: 0.580518, VAL Senss: 0.667244, VAL Specs: 0.912848
AUROCs: Melanoma:0.840794 Melanocytic nevus:0.929383 Basal cell carcinoma:0.895016 Actinic keratosis:0.947636 Benign keratosis:0.853378 Dermatofibroma:0.731771 Vascular lesion:0.866667
Accus: Melanoma:0.529412 Melanocytic nevus:0.793363 Basal cell carcinoma:0.592593 Actinic keratosis:0.575758 Benign keratosis:0.460000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.888386 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.830874 Melanocytic nevus:0.810089 Basal cell carcinoma:0.946089 Actinic keratosis:0.948294 Benign keratosis:0.915556 Dermatofibroma:0.952236 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1094.0, 83.0, 37.0, 113.0, 8.0, 28.0]

TEST Student: Epoch: 11, iteration: 86

TEST AUROC: 0.895334, TEST Accus: 0.664575, TEST Senss: 0.810875, TEST Specs: 0.838787
AUROCs: Melanoma:0.863379 Melanocytic nevus:0.937902 Basal cell carcinoma:0.950146 Actinic keratosis:0.914040 Benign keratosis:0.878782 Dermatofibroma:0.727204 Vascular lesion:0.995886
Accus: Melanoma:0.653680 Melanocytic nevus:0.810971 Basal cell carcinoma:0.754545 Actinic keratosis:0.637931 Benign keratosis:0.528037 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.883117 Melanocytic nevus:0.942179 Basal cell carcinoma:0.909091 Actinic keratosis:0.844828 Benign keratosis:0.752336 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.670404 Melanocytic nevus:0.716216 Basal cell carcinoma:0.891339 Actinic keratosis:0.895759 Benign keratosis:0.838978 Dermatofibroma:0.901154 Vascular lesion:0.957661
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_12.pth

Epoch: 12, iteration: 0/87, ==> train <===, loss: 1.838937, classification loss: 1.838937,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.8242953648100018e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 545.0, 28.0, 19.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 12, iteration: 86

VAL AUROC: 0.847496, VAL Accus: 0.585687, VAL Senss: 0.659972, VAL Specs: 0.910940
AUROCs: Melanoma:0.848682 Melanocytic nevus:0.925198 Basal cell carcinoma:0.882037 Actinic keratosis:0.906991 Benign keratosis:0.831822 Dermatofibroma:0.685086 Vascular lesion:0.852657
Accus: Melanoma:0.521008 Melanocytic nevus:0.822021 Basal cell carcinoma:0.518519 Actinic keratosis:0.575758 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.900452 Basal cell carcinoma:0.611111 Actinic keratosis:0.666667 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.843360 Melanocytic nevus:0.786350 Basal cell carcinoma:0.960888 Actinic keratosis:0.947260 Benign keratosis:0.884444 Dermatofibroma:0.962398 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1148.0, 81.0, 38.0, 109.0, 7.0, 26.0]

TEST Student: Epoch: 12, iteration: 86

TEST AUROC: 0.885648, TEST Accus: 0.636937, TEST Senss: 0.814088, TEST Specs: 0.827298
AUROCs: Melanoma:0.866529 Melanocytic nevus:0.927665 Basal cell carcinoma:0.943336 Actinic keratosis:0.909723 Benign keratosis:0.851067 Dermatofibroma:0.703234 Vascular lesion:0.997984
Accus: Melanoma:0.549784 Melanocytic nevus:0.851001 Basal cell carcinoma:0.736364 Actinic keratosis:0.655172 Benign keratosis:0.509346 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.887446 Melanocytic nevus:0.960712 Basal cell carcinoma:0.854545 Actinic keratosis:0.862069 Benign keratosis:0.757009 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.679933 Melanocytic nevus:0.647147 Basal cell carcinoma:0.893438 Actinic keratosis:0.891671 Benign keratosis:0.771793 Dermatofibroma:0.922228 Vascular lesion:0.984879
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_13.pth

Epoch: 13, iteration: 0/87, ==> train <===, loss: 1.787075, classification loss: 1.787075,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.5418658283290016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [72.0, 543.0, 31.0, 20.0, 53.0, 6.0, 12.0]

VAL Student: Epoch: 13, iteration: 86

VAL AUROC: 0.879354, VAL Accus: 0.615597, VAL Senss: 0.684505, VAL Specs: 0.918436
AUROCs: Melanoma:0.848978 Melanocytic nevus:0.931473 Basal cell carcinoma:0.873933 Actinic keratosis:0.960076 Benign keratosis:0.842378 Dermatofibroma:0.818979 Vascular lesion:0.879662
Accus: Melanoma:0.605042 Melanocytic nevus:0.819005 Basal cell carcinoma:0.574074 Actinic keratosis:0.606061 Benign keratosis:0.530000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.895928 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.580000 Dermatofibroma:0.500000 Vascular lesion:0.800000
Specs: Melanoma:0.818388 Melanocytic nevus:0.821958 Basal cell carcinoma:0.957717 Actinic keratosis:0.952430 Benign keratosis:0.934444 Dermatofibroma:0.951220 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1130.0, 82.0, 40.0, 108.0, 11.0, 27.0]

TEST Student: Epoch: 13, iteration: 86

TEST AUROC: 0.901969, TEST Accus: 0.680447, TEST Senss: 0.830254, TEST Specs: 0.845173
AUROCs: Melanoma:0.872076 Melanocytic nevus:0.935582 Basal cell carcinoma:0.924820 Actinic keratosis:0.927132 Benign keratosis:0.882612 Dermatofibroma:0.773480 Vascular lesion:0.998081
Accus: Melanoma:0.614719 Melanocytic nevus:0.837658 Basal cell carcinoma:0.745455 Actinic keratosis:0.689655 Benign keratosis:0.504673 Dermatofibroma:0.500000 Vascular lesion:0.870968
Senss: Melanoma:0.887446 Melanocytic nevus:0.950334 Basal cell carcinoma:0.863636 Actinic keratosis:0.844828 Benign keratosis:0.752336 Dermatofibroma:0.545455 Vascular lesion:0.967742
Specs: Melanoma:0.682735 Melanocytic nevus:0.707207 Basal cell carcinoma:0.880315 Actinic keratosis:0.910577 Benign keratosis:0.858412 Dermatofibroma:0.899649 Vascular lesion:0.977319
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_14.pth

Epoch: 14, iteration: 0/87, ==> train <===, loss: 1.807578, classification loss: 1.807578,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.2876792454961016e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 546.0, 36.0, 19.0, 58.0, 5.0, 10.0]

VAL Student: Epoch: 14, iteration: 86

VAL AUROC: 0.864924, VAL Accus: 0.593505, VAL Senss: 0.668835, VAL Specs: 0.920680
AUROCs: Melanoma:0.841767 Melanocytic nevus:0.932655 Basal cell carcinoma:0.900576 Actinic keratosis:0.923725 Benign keratosis:0.853522 Dermatofibroma:0.758702 Vascular lesion:0.843519
Accus: Melanoma:0.529412 Melanocytic nevus:0.823529 Basal cell carcinoma:0.666667 Actinic keratosis:0.575758 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.638655 Melanocytic nevus:0.892911 Basal cell carcinoma:0.777778 Actinic keratosis:0.666667 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.870602 Melanocytic nevus:0.818991 Basal cell carcinoma:0.948203 Actinic keratosis:0.946225 Benign keratosis:0.892222 Dermatofibroma:0.985772 Vascular lesion:0.982741
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1149.0, 84.0, 42.0, 132.0, 7.0, 28.0]

TEST Student: Epoch: 14, iteration: 86

TEST AUROC: 0.895527, TEST Accus: 0.673506, TEST Senss: 0.810034, TEST Specs: 0.853432
AUROCs: Melanoma:0.855180 Melanocytic nevus:0.935725 Basal cell carcinoma:0.948871 Actinic keratosis:0.916445 Benign keratosis:0.893665 Dermatofibroma:0.720545 Vascular lesion:0.998260
Accus: Melanoma:0.536797 Melanocytic nevus:0.851742 Basal cell carcinoma:0.763636 Actinic keratosis:0.724138 Benign keratosis:0.616822 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.800866 Melanocytic nevus:0.946627 Basal cell carcinoma:0.863636 Actinic keratosis:0.827586 Benign keratosis:0.822430 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.765695 Melanocytic nevus:0.696697 Basal cell carcinoma:0.883465 Actinic keratosis:0.891671 Benign keratosis:0.813437 Dermatofibroma:0.960863 Vascular lesion:0.962198
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_15.pth

Epoch: 15, iteration: 0/87, ==> train <===, loss: 1.839744, classification loss: 1.839744,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 2.0589113209464913e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 561.0, 29.0, 18.0, 45.0, 6.0, 10.0]

VAL Student: Epoch: 15, iteration: 86

VAL AUROC: 0.862949, VAL Accus: 0.571449, VAL Senss: 0.643676, VAL Specs: 0.914301
AUROCs: Melanoma:0.863829 Melanocytic nevus:0.928255 Basal cell carcinoma:0.907995 Actinic keratosis:0.938109 Benign keratosis:0.809622 Dermatofibroma:0.741870 Vascular lesion:0.850964
Accus: Melanoma:0.579832 Melanocytic nevus:0.846154 Basal cell carcinoma:0.537037 Actinic keratosis:0.545455 Benign keratosis:0.450000 Dermatofibroma:0.375000 Vascular lesion:0.666667
Senss: Melanoma:0.680672 Melanocytic nevus:0.912519 Basal cell carcinoma:0.648148 Actinic keratosis:0.606061 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.733333
Specs: Melanoma:0.856981 Melanocytic nevus:0.753709 Basal cell carcinoma:0.964059 Actinic keratosis:0.953464 Benign keratosis:0.927778 Dermatofibroma:0.955285 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1186.0, 79.0, 43.0, 110.0, 9.0, 26.0]

TEST Student: Epoch: 15, iteration: 86

TEST AUROC: 0.896761, TEST Accus: 0.667426, TEST Senss: 0.817344, TEST Specs: 0.851366
AUROCs: Melanoma:0.876121 Melanocytic nevus:0.934630 Basal cell carcinoma:0.951883 Actinic keratosis:0.918894 Benign keratosis:0.878263 Dermatofibroma:0.719518 Vascular lesion:0.998016
Accus: Melanoma:0.571429 Melanocytic nevus:0.879170 Basal cell carcinoma:0.718182 Actinic keratosis:0.741379 Benign keratosis:0.514019 Dermatofibroma:0.409091 Vascular lesion:0.838710
Senss: Melanoma:0.861472 Melanocytic nevus:0.973314 Basal cell carcinoma:0.836364 Actinic keratosis:0.862069 Benign keratosis:0.733645 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.729260 Melanocytic nevus:0.633634 Basal cell carcinoma:0.919160 Actinic keratosis:0.910577 Benign keratosis:0.847307 Dermatofibroma:0.940291 Vascular lesion:0.979335
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_16.pth

Epoch: 16, iteration: 0/87, ==> train <===, loss: 1.820894, classification loss: 1.820894,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.8530201888518422e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [71.0, 544.0, 33.0, 20.0, 55.0, 5.0, 10.0]

VAL Student: Epoch: 16, iteration: 86

VAL AUROC: 0.863716, VAL Accus: 0.594784, VAL Senss: 0.672040, VAL Specs: 0.918252
AUROCs: Melanoma:0.866519 Melanocytic nevus:0.930972 Basal cell carcinoma:0.914122 Actinic keratosis:0.902071 Benign keratosis:0.854689 Dermatofibroma:0.726880 Vascular lesion:0.850761
Accus: Melanoma:0.596639 Melanocytic nevus:0.820513 Basal cell carcinoma:0.611111 Actinic keratosis:0.606061 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.747899 Melanocytic nevus:0.901961 Basal cell carcinoma:0.722222 Actinic keratosis:0.636364 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.826334 Melanocytic nevus:0.807122 Basal cell carcinoma:0.952431 Actinic keratosis:0.960703 Benign keratosis:0.905556 Dermatofibroma:0.985772 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1120.0, 85.0, 42.0, 120.0, 7.0, 25.0]

TEST Student: Epoch: 16, iteration: 86

TEST AUROC: 0.905940, TEST Accus: 0.666596, TEST Senss: 0.828025, TEST Specs: 0.848868
AUROCs: Melanoma:0.880981 Melanocytic nevus:0.935974 Basal cell carcinoma:0.967674 Actinic keratosis:0.917132 Benign keratosis:0.889402 Dermatofibroma:0.757424 Vascular lesion:0.992992
Accus: Melanoma:0.653680 Melanocytic nevus:0.830245 Basal cell carcinoma:0.772727 Actinic keratosis:0.724138 Benign keratosis:0.560748 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.904762 Melanocytic nevus:0.949592 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.789720 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.651345 Melanocytic nevus:0.692192 Basal cell carcinoma:0.901312 Actinic keratosis:0.915176 Benign keratosis:0.837313 Dermatofibroma:0.960361 Vascular lesion:0.984375
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_17.pth

Epoch: 17, iteration: 0/87, ==> train <===, loss: 1.783229, classification loss: 1.783229,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.667718169966658e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 560.0, 30.0, 20.0, 63.0, 5.0, 11.0]

VAL Student: Epoch: 17, iteration: 86

VAL AUROC: 0.856962, VAL Accus: 0.602844, VAL Senss: 0.654982, VAL Specs: 0.919395
AUROCs: Melanoma:0.869371 Melanocytic nevus:0.932973 Basal cell carcinoma:0.897678 Actinic keratosis:0.894331 Benign keratosis:0.867111 Dermatofibroma:0.671621 Vascular lesion:0.865651
Accus: Melanoma:0.537815 Melanocytic nevus:0.844646 Basal cell carcinoma:0.555556 Actinic keratosis:0.606061 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.689076 Melanocytic nevus:0.911011 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.859251 Melanocytic nevus:0.804154 Basal cell carcinoma:0.965116 Actinic keratosis:0.958635 Benign keratosis:0.881111 Dermatofibroma:0.981707 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1146.0, 77.0, 43.0, 134.0, 7.0, 26.0]

TEST Student: Epoch: 17, iteration: 86

TEST AUROC: 0.901134, TEST Accus: 0.667956, TEST Senss: 0.830228, TEST Specs: 0.855351
AUROCs: Melanoma:0.882197 Melanocytic nevus:0.936341 Basal cell carcinoma:0.953686 Actinic keratosis:0.920753 Benign keratosis:0.892970 Dermatofibroma:0.726771 Vascular lesion:0.995220
Accus: Melanoma:0.601732 Melanocytic nevus:0.849518 Basal cell carcinoma:0.700000 Actinic keratosis:0.741379 Benign keratosis:0.626168 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.887446 Melanocytic nevus:0.956264 Basal cell carcinoma:0.845455 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.713565 Melanocytic nevus:0.684685 Basal cell carcinoma:0.932808 Actinic keratosis:0.922841 Benign keratosis:0.797890 Dermatofibroma:0.958856 Vascular lesion:0.976815
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_18.pth

Epoch: 18, iteration: 0/87, ==> train <===, loss: 1.794003, classification loss: 1.794003,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.5009463529699922e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 569.0, 37.0, 18.0, 47.0, 5.0, 11.0]

VAL Student: Epoch: 18, iteration: 86

VAL AUROC: 0.842032, VAL Accus: 0.598990, VAL Senss: 0.657102, VAL Specs: 0.920136
AUROCs: Melanoma:0.861054 Melanocytic nevus:0.933814 Basal cell carcinoma:0.912928 Actinic keratosis:0.867945 Benign keratosis:0.839478 Dermatofibroma:0.621951 Vascular lesion:0.857056
Accus: Melanoma:0.588235 Melanocytic nevus:0.858220 Basal cell carcinoma:0.685185 Actinic keratosis:0.545455 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.714286 Melanocytic nevus:0.911011 Basal cell carcinoma:0.722222 Actinic keratosis:0.636364 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.851305 Melanocytic nevus:0.780415 Basal cell carcinoma:0.942918 Actinic keratosis:0.959669 Benign keratosis:0.930000 Dermatofibroma:0.991870 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1168.0, 86.0, 39.0, 111.0, 8.0, 27.0]

TEST Student: Epoch: 18, iteration: 86

TEST AUROC: 0.898351, TEST Accus: 0.666633, TEST Senss: 0.816271, TEST Specs: 0.854294
AUROCs: Melanoma:0.871297 Melanocytic nevus:0.936024 Basal cell carcinoma:0.964658 Actinic keratosis:0.905564 Benign keratosis:0.883956 Dermatofibroma:0.729462 Vascular lesion:0.997496
Accus: Melanoma:0.593074 Melanocytic nevus:0.865827 Basal cell carcinoma:0.781818 Actinic keratosis:0.672414 Benign keratosis:0.518692 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.878788 Melanocytic nevus:0.959229 Basal cell carcinoma:0.890909 Actinic keratosis:0.810345 Benign keratosis:0.752336 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.709641 Melanocytic nevus:0.660661 Basal cell carcinoma:0.906037 Actinic keratosis:0.912621 Benign keratosis:0.848418 Dermatofibroma:0.969393 Vascular lesion:0.973286
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_19.pth

Epoch: 19, iteration: 0/87, ==> train <===, loss: 1.791279, classification loss: 1.791279,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.350851717672993e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 578.0, 33.0, 24.0, 49.0, 5.0, 11.0]

VAL Student: Epoch: 19, iteration: 86

VAL AUROC: 0.864377, VAL Accus: 0.610775, VAL Senss: 0.655904, VAL Specs: 0.921643
AUROCs: Melanoma:0.853509 Melanocytic nevus:0.935121 Basal cell carcinoma:0.895251 Actinic keratosis:0.933189 Benign keratosis:0.857367 Dermatofibroma:0.712652 Vascular lesion:0.863553
Accus: Melanoma:0.529412 Melanocytic nevus:0.871795 Basal cell carcinoma:0.611111 Actinic keratosis:0.727273 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.655462 Melanocytic nevus:0.926094 Basal cell carcinoma:0.666667 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.888763 Melanocytic nevus:0.780415 Basal cell carcinoma:0.953488 Actinic keratosis:0.943123 Benign keratosis:0.911111 Dermatofibroma:0.982724 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1175.0, 80.0, 45.0, 121.0, 7.0, 25.0]

TEST Student: Epoch: 19, iteration: 86

TEST AUROC: 0.902372, TEST Accus: 0.657286, TEST Senss: 0.823778, TEST Specs: 0.855186
AUROCs: Melanoma:0.869290 Melanocytic nevus:0.936148 Basal cell carcinoma:0.959695 Actinic keratosis:0.930268 Benign keratosis:0.888055 Dermatofibroma:0.738494 Vascular lesion:0.994651
Accus: Melanoma:0.536797 Melanocytic nevus:0.871016 Basal cell carcinoma:0.727273 Actinic keratosis:0.775862 Benign keratosis:0.565421 Dermatofibroma:0.318182 Vascular lesion:0.806452
Senss: Melanoma:0.831169 Melanocytic nevus:0.959229 Basal cell carcinoma:0.863636 Actinic keratosis:0.896552 Benign keratosis:0.780374 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.765695 Melanocytic nevus:0.665165 Basal cell carcinoma:0.913386 Actinic keratosis:0.886050 Benign keratosis:0.822321 Dermatofibroma:0.952333 Vascular lesion:0.981351
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_20.pth

Epoch: 20, iteration: 0/87, ==> train <===, loss: 1.815957, classification loss: 1.815957,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: 0.000000,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.000000,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 0.000000, lr: 1.2157665459056937e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [63.0, 571.0, 37.0, 23.0, 51.0, 5.0, 11.0]

VAL Student: Epoch: 20, iteration: 86

VAL AUROC: 0.853639, VAL Accus: 0.618377, VAL Senss: 0.669192, VAL Specs: 0.924337
AUROCs: Melanoma:0.860529 Melanocytic nevus:0.931388 Basal cell carcinoma:0.909991 Actinic keratosis:0.942214 Benign keratosis:0.852644 Dermatofibroma:0.623412 Vascular lesion:0.855296
Accus: Melanoma:0.529412 Melanocytic nevus:0.861237 Basal cell carcinoma:0.685185 Actinic keratosis:0.696970 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.638655 Melanocytic nevus:0.920060 Basal cell carcinoma:0.722222 Actinic keratosis:0.757576 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.892168 Melanocytic nevus:0.783383 Basal cell carcinoma:0.937632 Actinic keratosis:0.951396 Benign keratosis:0.920000 Dermatofibroma:0.992886 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 1178.0, 93.0, 43.0, 124.0, 6.0, 27.0]

TEST Student: Epoch: 20, iteration: 86

TEST AUROC: 0.904976, TEST Accus: 0.671194, TEST Senss: 0.820711, TEST Specs: 0.856322
AUROCs: Melanoma:0.878315 Melanocytic nevus:0.933682 Basal cell carcinoma:0.972155 Actinic keratosis:0.931907 Benign keratosis:0.885196 Dermatofibroma:0.736943 Vascular lesion:0.996634
Accus: Melanoma:0.515152 Melanocytic nevus:0.873239 Basal cell carcinoma:0.845455 Actinic keratosis:0.741379 Benign keratosis:0.579439 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.844156 Melanocytic nevus:0.960712 Basal cell carcinoma:0.909091 Actinic keratosis:0.879310 Benign keratosis:0.761682 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.774103 Melanocytic nevus:0.660661 Basal cell carcinoma:0.874016 Actinic keratosis:0.908533 Benign keratosis:0.826208 Dermatofibroma:0.971400 Vascular lesion:0.979335
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_21.pth

Epoch: 21, iteration: 0/87, ==> train <===, loss: 1.827590, classification loss: 1.809049,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013850,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032391,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0941898913151244e-05
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 563.0, 34.0, 26.0, 43.0, 5.0, 12.0]

VAL Student: Epoch: 21, iteration: 86

VAL AUROC: 0.856096, VAL Accus: 0.622200, VAL Senss: 0.689085, VAL Specs: 0.920398
AUROCs: Melanoma:0.855483 Melanocytic nevus:0.937041 Basal cell carcinoma:0.899851 Actinic keratosis:0.962427 Benign keratosis:0.833689 Dermatofibroma:0.648819 Vascular lesion:0.855364
Accus: Melanoma:0.546218 Melanocytic nevus:0.849170 Basal cell carcinoma:0.629630 Actinic keratosis:0.787879 Benign keratosis:0.430000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.911011 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.500000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.855846 Melanocytic nevus:0.804154 Basal cell carcinoma:0.948203 Actinic keratosis:0.908997 Benign keratosis:0.937778 Dermatofibroma:0.993902 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1139.0, 87.0, 46.0, 112.0, 6.0, 27.0]

TEST Student: Epoch: 21, iteration: 86

TEST AUROC: 0.902506, TEST Accus: 0.672256, TEST Senss: 0.816306, TEST Specs: 0.866564
AUROCs: Melanoma:0.876451 Melanocytic nevus:0.940486 Basal cell carcinoma:0.965168 Actinic keratosis:0.936417 Benign keratosis:0.877656 Dermatofibroma:0.722985 Vascular lesion:0.998374
Accus: Melanoma:0.610390 Melanocytic nevus:0.844329 Basal cell carcinoma:0.790909 Actinic keratosis:0.793103 Benign keratosis:0.523364 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.852814 Melanocytic nevus:0.951075 Basal cell carcinoma:0.900000 Actinic keratosis:0.913793 Benign keratosis:0.719626 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.759529 Melanocytic nevus:0.717718 Basal cell carcinoma:0.898163 Actinic keratosis:0.857435 Benign keratosis:0.867296 Dermatofibroma:0.982439 Vascular lesion:0.983367
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_22.pth

Epoch: 22, iteration: 0/87, ==> train <===, loss: 1.796029, classification loss: 1.789332,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013233,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019931,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.84770902183612e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 577.0, 39.0, 16.0, 52.0, 6.0, 12.0]

VAL Student: Epoch: 22, iteration: 86

VAL AUROC: 0.862497, VAL Accus: 0.618140, VAL Senss: 0.661891, VAL Specs: 0.919634
AUROCs: Melanoma:0.869171 Melanocytic nevus:0.932113 Basal cell carcinoma:0.909991 Actinic keratosis:0.850647 Benign keratosis:0.865989 Dermatofibroma:0.726181 Vascular lesion:0.883384
Accus: Melanoma:0.554622 Melanocytic nevus:0.870287 Basal cell carcinoma:0.722222 Actinic keratosis:0.484848 Benign keratosis:0.520000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.936652 Basal cell carcinoma:0.759259 Actinic keratosis:0.484848 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.872872 Melanocytic nevus:0.753709 Basal cell carcinoma:0.942918 Actinic keratosis:0.975181 Benign keratosis:0.922222 Dermatofibroma:0.981707 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1181.0, 87.0, 24.0, 125.0, 7.0, 28.0]

TEST Student: Epoch: 22, iteration: 86

TEST AUROC: 0.898414, TEST Accus: 0.641060, TEST Senss: 0.814742, TEST Specs: 0.860805
AUROCs: Melanoma:0.884316 Melanocytic nevus:0.935726 Basal cell carcinoma:0.968055 Actinic keratosis:0.869117 Benign keratosis:0.895847 Dermatofibroma:0.737445 Vascular lesion:0.998390
Accus: Melanoma:0.601732 Melanocytic nevus:0.875463 Basal cell carcinoma:0.790909 Actinic keratosis:0.413793 Benign keratosis:0.584112 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.844156 Melanocytic nevus:0.965901 Basal cell carcinoma:0.909091 Actinic keratosis:0.689655 Benign keratosis:0.794393 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.749439 Melanocytic nevus:0.662162 Basal cell carcinoma:0.891864 Actinic keratosis:0.957588 Benign keratosis:0.828429 Dermatofibroma:0.963372 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_23.pth

Epoch: 23, iteration: 0/87, ==> train <===, loss: 1.817328, classification loss: 1.800137,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013309,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.030500,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.862938119652508e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 576.0, 29.0, 25.0, 48.0, 5.0, 12.0]

VAL Student: Epoch: 23, iteration: 86

VAL AUROC: 0.864189, VAL Accus: 0.619389, VAL Senss: 0.682300, VAL Specs: 0.921327
AUROCs: Melanoma:0.868885 Melanocytic nevus:0.941203 Basal cell carcinoma:0.857548 Actinic keratosis:0.940209 Benign keratosis:0.842289 Dermatofibroma:0.723450 Vascular lesion:0.875736
Accus: Melanoma:0.579832 Melanocytic nevus:0.868778 Basal cell carcinoma:0.537037 Actinic keratosis:0.757576 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.714286 Melanocytic nevus:0.923077 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.590000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.847900 Melanocytic nevus:0.783383 Basal cell carcinoma:0.972516 Actinic keratosis:0.936918 Benign keratosis:0.928889 Dermatofibroma:0.987805 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [151.0, 1162.0, 72.0, 40.0, 125.0, 8.0, 27.0]

TEST Student: Epoch: 23, iteration: 86

TEST AUROC: 0.905625, TEST Accus: 0.668282, TEST Senss: 0.829266, TEST Specs: 0.867533
AUROCs: Melanoma:0.885439 Melanocytic nevus:0.940179 Basal cell carcinoma:0.933343 Actinic keratosis:0.941104 Benign keratosis:0.897355 Dermatofibroma:0.743808 Vascular lesion:0.998146
Accus: Melanoma:0.653680 Melanocytic nevus:0.861379 Basal cell carcinoma:0.654545 Actinic keratosis:0.689655 Benign keratosis:0.584112 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.861472 Melanocytic nevus:0.959970 Basal cell carcinoma:0.854545 Actinic keratosis:0.862069 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.736547 Melanocytic nevus:0.686186 Basal cell carcinoma:0.952231 Actinic keratosis:0.907001 Benign keratosis:0.844531 Dermatofibroma:0.963372 Vascular lesion:0.982863
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_24.pth

Epoch: 24, iteration: 0/87, ==> train <===, loss: 1.833042, classification loss: 1.812423,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012788,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.033407,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.976644307687257e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 593.0, 35.0, 21.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 24, iteration: 86

VAL AUROC: 0.852623, VAL Accus: 0.612689, VAL Senss: 0.676728, VAL Specs: 0.917082
AUROCs: Melanoma:0.861807 Melanocytic nevus:0.935824 Basal cell carcinoma:0.914699 Actinic keratosis:0.919558 Benign keratosis:0.854322 Dermatofibroma:0.616298 Vascular lesion:0.865854
Accus: Melanoma:0.487395 Melanocytic nevus:0.894419 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.655462 Melanocytic nevus:0.938160 Basal cell carcinoma:0.703704 Actinic keratosis:0.727273 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.888763 Melanocytic nevus:0.727003 Basal cell carcinoma:0.949260 Actinic keratosis:0.948294 Benign keratosis:0.925556 Dermatofibroma:0.991870 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [124.0, 1204.0, 82.0, 43.0, 128.0, 7.0, 28.0]

TEST Student: Epoch: 24, iteration: 86

TEST AUROC: 0.906364, TEST Accus: 0.676526, TEST Senss: 0.817102, TEST Specs: 0.863927
AUROCs: Melanoma:0.880603 Melanocytic nevus:0.933735 Basal cell carcinoma:0.966075 Actinic keratosis:0.934100 Benign keratosis:0.905496 Dermatofibroma:0.725950 Vascular lesion:0.998585
Accus: Melanoma:0.536797 Melanocytic nevus:0.892513 Basal cell carcinoma:0.745455 Actinic keratosis:0.741379 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.813853 Melanocytic nevus:0.969607 Basal cell carcinoma:0.881818 Actinic keratosis:0.827586 Benign keratosis:0.817757 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.795404 Melanocytic nevus:0.636637 Basal cell carcinoma:0.904987 Actinic keratosis:0.912110 Benign keratosis:0.845641 Dermatofibroma:0.979930 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_25.pth

Epoch: 25, iteration: 0/87, ==> train <===, loss: 1.798560, classification loss: 1.781883,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013001,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029679,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.1789798769185315e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 537.0, 36.0, 26.0, 53.0, 5.0, 12.0]

VAL Student: Epoch: 25, iteration: 86

VAL AUROC: 0.868803, VAL Accus: 0.637375, VAL Senss: 0.701038, VAL Specs: 0.923831
AUROCs: Melanoma:0.848243 Melanocytic nevus:0.935528 Basal cell carcinoma:0.921502 Actinic keratosis:0.961831 Benign keratosis:0.865622 Dermatofibroma:0.680196 Vascular lesion:0.868697
Accus: Melanoma:0.554622 Melanocytic nevus:0.809955 Basal cell carcinoma:0.666667 Actinic keratosis:0.787879 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.877828 Basal cell carcinoma:0.777778 Actinic keratosis:0.848485 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.864926 Melanocytic nevus:0.848665 Basal cell carcinoma:0.924947 Actinic keratosis:0.925543 Benign keratosis:0.920000 Dermatofibroma:0.991870 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1096.0, 94.0, 43.0, 125.0, 7.0, 26.0]

TEST Student: Epoch: 25, iteration: 86

TEST AUROC: 0.901926, TEST Accus: 0.675638, TEST Senss: 0.812321, TEST Specs: 0.867455
AUROCs: Melanoma:0.863156 Melanocytic nevus:0.938629 Basal cell carcinoma:0.967702 Actinic keratosis:0.935607 Benign keratosis:0.886078 Dermatofibroma:0.725174 Vascular lesion:0.997138
Accus: Melanoma:0.580087 Melanocytic nevus:0.812454 Basal cell carcinoma:0.854545 Actinic keratosis:0.741379 Benign keratosis:0.584112 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.813853 Melanocytic nevus:0.927354 Basal cell carcinoma:0.945455 Actinic keratosis:0.879310 Benign keratosis:0.775701 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.775224 Melanocytic nevus:0.780781 Basal cell carcinoma:0.837795 Actinic keratosis:0.877363 Benign keratosis:0.846752 Dermatofibroma:0.969393 Vascular lesion:0.984879
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_26.pth

Epoch: 26, iteration: 0/87, ==> train <===, loss: 1.834759, classification loss: 1.825578,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013231,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022412,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.461081889226678e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 582.0, 33.0, 23.0, 57.0, 6.0, 12.0]

VAL Student: Epoch: 26, iteration: 86

VAL AUROC: 0.860825, VAL Accus: 0.634788, VAL Senss: 0.713209, VAL Specs: 0.919494
AUROCs: Melanoma:0.863658 Melanocytic nevus:0.942206 Basal cell carcinoma:0.905567 Actinic keratosis:0.935759 Benign keratosis:0.865544 Dermatofibroma:0.636560 Vascular lesion:0.876481
Accus: Melanoma:0.512605 Melanocytic nevus:0.877828 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.570000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.932127 Basal cell carcinoma:0.666667 Actinic keratosis:0.757576 Benign keratosis:0.730000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.863791 Melanocytic nevus:0.759644 Basal cell carcinoma:0.963002 Actinic keratosis:0.961737 Benign keratosis:0.905556 Dermatofibroma:0.989837 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1167.0, 80.0, 36.0, 142.0, 8.0, 26.0]

TEST Student: Epoch: 26, iteration: 86

TEST AUROC: 0.910945, TEST Accus: 0.664958, TEST Senss: 0.824544, TEST Specs: 0.865230
AUROCs: Melanoma:0.886866 Melanocytic nevus:0.940824 Basal cell carcinoma:0.968022 Actinic keratosis:0.927026 Benign keratosis:0.909220 Dermatofibroma:0.747389 Vascular lesion:0.997268
Accus: Melanoma:0.575758 Melanocytic nevus:0.865085 Basal cell carcinoma:0.727273 Actinic keratosis:0.620690 Benign keratosis:0.663551 Dermatofibroma:0.363636 Vascular lesion:0.838710
Senss: Melanoma:0.848485 Melanocytic nevus:0.959970 Basal cell carcinoma:0.872727 Actinic keratosis:0.827586 Benign keratosis:0.859813 Dermatofibroma:0.500000 Vascular lesion:0.903226
Specs: Melanoma:0.761211 Melanocytic nevus:0.690691 Basal cell carcinoma:0.922835 Actinic keratosis:0.927951 Benign keratosis:0.795114 Dermatofibroma:0.968891 Vascular lesion:0.989919
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_27.pth

Epoch: 27, iteration: 0/87, ==> train <===, loss: 1.812017, classification loss: 1.802484,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013586,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023119,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.81497370030401e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 595.0, 31.0, 26.0, 49.0, 5.0, 12.0]

VAL Student: Epoch: 27, iteration: 86

VAL AUROC: 0.857787, VAL Accus: 0.626128, VAL Senss: 0.693092, VAL Specs: 0.922167
AUROCs: Melanoma:0.861283 Melanocytic nevus:0.940568 Basal cell carcinoma:0.864067 Actinic keratosis:0.949108 Benign keratosis:0.854156 Dermatofibroma:0.656949 Vascular lesion:0.878376
Accus: Melanoma:0.521008 Melanocytic nevus:0.897436 Basal cell carcinoma:0.574074 Actinic keratosis:0.787879 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.938160 Basal cell carcinoma:0.629630 Actinic keratosis:0.818182 Benign keratosis:0.610000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.884222 Melanocytic nevus:0.744807 Basal cell carcinoma:0.970402 Actinic keratosis:0.947260 Benign keratosis:0.927778 Dermatofibroma:0.989837 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [131.0, 1188.0, 78.0, 42.0, 121.0, 8.0, 28.0]

TEST Student: Epoch: 27, iteration: 86

TEST AUROC: 0.905709, TEST Accus: 0.673323, TEST Senss: 0.824564, TEST Specs: 0.872903
AUROCs: Melanoma:0.882481 Melanocytic nevus:0.938369 Basal cell carcinoma:0.948957 Actinic keratosis:0.935854 Benign keratosis:0.897225 Dermatofibroma:0.738197 Vascular lesion:0.998878
Accus: Melanoma:0.567100 Melanocytic nevus:0.880652 Basal cell carcinoma:0.709091 Actinic keratosis:0.724138 Benign keratosis:0.565421 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.818182 Melanocytic nevus:0.964418 Basal cell carcinoma:0.845455 Actinic keratosis:0.844828 Benign keratosis:0.799065 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.784753 Melanocytic nevus:0.677177 Basal cell carcinoma:0.935958 Actinic keratosis:0.910066 Benign keratosis:0.855636 Dermatofibroma:0.964877 Vascular lesion:0.981855
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_28.pth

Epoch: 28, iteration: 0/87, ==> train <===, loss: 1.814062, classification loss: 1.799873,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013556,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027745,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.23347633027361e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 574.0, 36.0, 21.0, 58.0, 5.0, 12.0]

VAL Student: Epoch: 28, iteration: 86

VAL AUROC: 0.859119, VAL Accus: 0.622441, VAL Senss: 0.695075, VAL Specs: 0.920856
AUROCs: Melanoma:0.846899 Melanocytic nevus:0.940917 Basal cell carcinoma:0.913398 Actinic keratosis:0.909185 Benign keratosis:0.870167 Dermatofibroma:0.663491 Vascular lesion:0.869780
Accus: Melanoma:0.495798 Melanocytic nevus:0.865762 Basal cell carcinoma:0.666667 Actinic keratosis:0.636364 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.927602 Basal cell carcinoma:0.777778 Actinic keratosis:0.696970 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.885358 Melanocytic nevus:0.780415 Basal cell carcinoma:0.937632 Actinic keratosis:0.952430 Benign keratosis:0.915556 Dermatofibroma:0.984756 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [125.0, 1151.0, 89.0, 35.0, 130.0, 8.0, 28.0]

TEST Student: Epoch: 28, iteration: 86

TEST AUROC: 0.905680, TEST Accus: 0.668747, TEST Senss: 0.823110, TEST Specs: 0.866154
AUROCs: Melanoma:0.871787 Melanocytic nevus:0.936286 Basal cell carcinoma:0.966762 Actinic keratosis:0.918339 Benign keratosis:0.900733 Dermatofibroma:0.747138 Vascular lesion:0.998716
Accus: Melanoma:0.541126 Melanocytic nevus:0.853225 Basal cell carcinoma:0.809091 Actinic keratosis:0.603448 Benign keratosis:0.607477 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.805195 Melanocytic nevus:0.951075 Basal cell carcinoma:0.918182 Actinic keratosis:0.810345 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.778587 Melanocytic nevus:0.705706 Basal cell carcinoma:0.882940 Actinic keratosis:0.916198 Benign keratosis:0.833426 Dermatofibroma:0.965881 Vascular lesion:0.980343
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_29.pth

Epoch: 29, iteration: 0/87, ==> train <===, loss: 1.833644, classification loss: 1.821705,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013944,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025883,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.710128697246249e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 579.0, 37.0, 21.0, 62.0, 6.0, 12.0]

VAL Student: Epoch: 29, iteration: 86

VAL AUROC: 0.858749, VAL Accus: 0.636005, VAL Senss: 0.704159, VAL Specs: 0.921517
AUROCs: Melanoma:0.855645 Melanocytic nevus:0.939610 Basal cell carcinoma:0.923753 Actinic keratosis:0.909279 Benign keratosis:0.868700 Dermatofibroma:0.630462 Vascular lesion:0.883790
Accus: Melanoma:0.462185 Melanocytic nevus:0.873303 Basal cell carcinoma:0.685185 Actinic keratosis:0.636364 Benign keratosis:0.620000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.630252 Melanocytic nevus:0.929110 Basal cell carcinoma:0.777778 Actinic keratosis:0.696970 Benign keratosis:0.720000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.901249 Melanocytic nevus:0.777448 Basal cell carcinoma:0.931290 Actinic keratosis:0.963806 Benign keratosis:0.902222 Dermatofibroma:0.983740 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [118.0, 1158.0, 90.0, 33.0, 146.0, 8.0, 27.0]

TEST Student: Epoch: 29, iteration: 86

TEST AUROC: 0.906246, TEST Accus: 0.667604, TEST Senss: 0.839443, TEST Specs: 0.866631
AUROCs: Melanoma:0.873833 Melanocytic nevus:0.936413 Basal cell carcinoma:0.970847 Actinic keratosis:0.915273 Benign keratosis:0.907629 Dermatofibroma:0.741025 Vascular lesion:0.998699
Accus: Melanoma:0.510823 Melanocytic nevus:0.858414 Basal cell carcinoma:0.818182 Actinic keratosis:0.568966 Benign keratosis:0.682243 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.805195 Melanocytic nevus:0.951816 Basal cell carcinoma:0.936364 Actinic keratosis:0.827586 Benign keratosis:0.855140 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.801009 Melanocytic nevus:0.704204 Basal cell carcinoma:0.879790 Actinic keratosis:0.932550 Benign keratosis:0.800111 Dermatofibroma:0.964375 Vascular lesion:0.984375
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_30.pth

Epoch: 30, iteration: 0/87, ==> train <===, loss: 1.818364, classification loss: 1.799274,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012040,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031130,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.239115827521624e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 591.0, 33.0, 27.0, 38.0, 6.0, 12.0]

VAL Student: Epoch: 30, iteration: 86

VAL AUROC: 0.874883, VAL Accus: 0.631702, VAL Senss: 0.690009, VAL Specs: 0.916211
AUROCs: Melanoma:0.859709 Melanocytic nevus:0.939319 Basal cell carcinoma:0.905107 Actinic keratosis:0.954686 Benign keratosis:0.815989 Dermatofibroma:0.769372 Vascular lesion:0.880000
Accus: Melanoma:0.546218 Melanocytic nevus:0.891403 Basal cell carcinoma:0.611111 Actinic keratosis:0.818182 Benign keratosis:0.380000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.945701 Basal cell carcinoma:0.703704 Actinic keratosis:0.818182 Benign keratosis:0.490000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.864926 Melanocytic nevus:0.727003 Basal cell carcinoma:0.951374 Actinic keratosis:0.945191 Benign keratosis:0.954444 Dermatofibroma:0.979675 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1191.0, 81.0, 38.0, 106.0, 9.0, 28.0]

TEST Student: Epoch: 30, iteration: 86

TEST AUROC: 0.906085, TEST Accus: 0.667876, TEST Senss: 0.828621, TEST Specs: 0.863709
AUROCs: Melanoma:0.884638 Melanocytic nevus:0.936981 Basal cell carcinoma:0.960410 Actinic keratosis:0.938179 Benign keratosis:0.882103 Dermatofibroma:0.741390 Vascular lesion:0.998894
Accus: Melanoma:0.593074 Melanocytic nevus:0.882876 Basal cell carcinoma:0.736364 Actinic keratosis:0.655172 Benign keratosis:0.495327 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.857143 Melanocytic nevus:0.970348 Basal cell carcinoma:0.881818 Actinic keratosis:0.862069 Benign keratosis:0.728972 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.757287 Melanocytic nevus:0.632132 Basal cell carcinoma:0.908661 Actinic keratosis:0.912110 Benign keratosis:0.895058 Dermatofibroma:0.957852 Vascular lesion:0.982863
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_31.pth

Epoch: 31, iteration: 0/87, ==> train <===, loss: 1.808946, classification loss: 1.795476,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013840,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027311,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.815204244769462e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 587.0, 35.0, 23.0, 55.0, 6.0, 12.0]

VAL Student: Epoch: 31, iteration: 86

VAL AUROC: 0.885648, VAL Accus: 0.628695, VAL Senss: 0.688212, VAL Specs: 0.922759
AUROCs: Melanoma:0.856313 Melanocytic nevus:0.936450 Basal cell carcinoma:0.921443 Actinic keratosis:0.954122 Benign keratosis:0.861544 Dermatofibroma:0.782012 Vascular lesion:0.887648
Accus: Melanoma:0.445378 Melanocytic nevus:0.885370 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.563025 Melanocytic nevus:0.926094 Basal cell carcinoma:0.685185 Actinic keratosis:0.818182 Benign keratosis:0.650000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.916005 Melanocytic nevus:0.771513 Basal cell carcinoma:0.936575 Actinic keratosis:0.946225 Benign keratosis:0.925556 Dermatofibroma:0.984756 Vascular lesion:0.978680
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [107.0, 1182.0, 91.0, 39.0, 129.0, 9.0, 31.0]

TEST Student: Epoch: 31, iteration: 86

TEST AUROC: 0.905402, TEST Accus: 0.692998, TEST Senss: 0.825013, TEST Specs: 0.871809
AUROCs: Melanoma:0.869215 Melanocytic nevus:0.935360 Basal cell carcinoma:0.964562 Actinic keratosis:0.935713 Benign keratosis:0.898021 Dermatofibroma:0.736145 Vascular lesion:0.998797
Accus: Melanoma:0.463203 Melanocytic nevus:0.876205 Basal cell carcinoma:0.827273 Actinic keratosis:0.672414 Benign keratosis:0.602804 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.748918 Melanocytic nevus:0.958488 Basal cell carcinoma:0.936364 Actinic keratosis:0.827586 Benign keratosis:0.803738 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.832960 Melanocytic nevus:0.695195 Basal cell carcinoma:0.888189 Actinic keratosis:0.912621 Benign keratosis:0.850639 Dermatofibroma:0.960863 Vascular lesion:0.962198
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_32.pth

Epoch: 32, iteration: 0/87, ==> train <===, loss: 1.792551, classification loss: 1.794842,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013811,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.011519,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.4336838202925156e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 536.0, 38.0, 20.0, 64.0, 5.0, 12.0]

VAL Student: Epoch: 32, iteration: 86

VAL AUROC: 0.863759, VAL Accus: 0.630990, VAL Senss: 0.691385, VAL Specs: 0.926263
AUROCs: Melanoma:0.852722 Melanocytic nevus:0.940675 Basal cell carcinoma:0.928980 Actinic keratosis:0.915609 Benign keratosis:0.877911 Dermatofibroma:0.657457 Vascular lesion:0.872961
Accus: Melanoma:0.546218 Melanocytic nevus:0.808446 Basal cell carcinoma:0.703704 Actinic keratosis:0.606061 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.883861 Basal cell carcinoma:0.796296 Actinic keratosis:0.636364 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.866061 Melanocytic nevus:0.857567 Basal cell carcinoma:0.930233 Actinic keratosis:0.962771 Benign keratosis:0.896667 Dermatofibroma:0.984756 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [136.0, 1089.0, 93.0, 32.0, 136.0, 7.0, 28.0]

TEST Student: Epoch: 32, iteration: 86

TEST AUROC: 0.902148, TEST Accus: 0.664301, TEST Senss: 0.825296, TEST Specs: 0.876499
AUROCs: Melanoma:0.867638 Melanocytic nevus:0.938934 Basal cell carcinoma:0.972446 Actinic keratosis:0.905503 Benign keratosis:0.895738 Dermatofibroma:0.736601 Vascular lesion:0.998179
Accus: Melanoma:0.588745 Melanocytic nevus:0.807265 Basal cell carcinoma:0.845455 Actinic keratosis:0.551724 Benign keratosis:0.635514 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.826840 Melanocytic nevus:0.920682 Basal cell carcinoma:0.945455 Actinic keratosis:0.793103 Benign keratosis:0.836449 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.774664 Melanocytic nevus:0.804805 Basal cell carcinoma:0.871916 Actinic keratosis:0.941237 Benign keratosis:0.806219 Dermatofibroma:0.964877 Vascular lesion:0.971774
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_33.pth

Epoch: 33, iteration: 0/87, ==> train <===, loss: 1.812011, classification loss: 1.809736,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013769,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016044,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.090315438263264e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [50.0, 593.0, 39.0, 21.0, 45.0, 5.0, 12.0]

VAL Student: Epoch: 33, iteration: 86

VAL AUROC: 0.870453, VAL Accus: 0.605096, VAL Senss: 0.687066, VAL Specs: 0.918524
AUROCs: Melanoma:0.857391 Melanocytic nevus:0.934338 Basal cell carcinoma:0.930135 Actinic keratosis:0.946163 Benign keratosis:0.855856 Dermatofibroma:0.690168 Vascular lesion:0.879120
Accus: Melanoma:0.420168 Melanocytic nevus:0.894419 Basal cell carcinoma:0.722222 Actinic keratosis:0.636364 Benign keratosis:0.450000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.571429 Melanocytic nevus:0.932127 Basal cell carcinoma:0.833333 Actinic keratosis:0.757576 Benign keratosis:0.540000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.919410 Melanocytic nevus:0.715134 Basal cell carcinoma:0.919662 Actinic keratosis:0.958635 Benign keratosis:0.942222 Dermatofibroma:0.985772 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [107.0, 1203.0, 95.0, 31.0, 114.0, 8.0, 28.0]

TEST Student: Epoch: 33, iteration: 86

TEST AUROC: 0.907093, TEST Accus: 0.650381, TEST Senss: 0.823609, TEST Specs: 0.868819
AUROCs: Melanoma:0.877499 Melanocytic nevus:0.934285 Basal cell carcinoma:0.975147 Actinic keratosis:0.925378 Benign keratosis:0.896239 Dermatofibroma:0.742485 Vascular lesion:0.998618
Accus: Melanoma:0.463203 Melanocytic nevus:0.891772 Basal cell carcinoma:0.863636 Actinic keratosis:0.534483 Benign keratosis:0.532710 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.761905 Melanocytic nevus:0.968125 Basal cell carcinoma:0.972727 Actinic keratosis:0.827586 Benign keratosis:0.780374 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.832399 Melanocytic nevus:0.641141 Basal cell carcinoma:0.854068 Actinic keratosis:0.931528 Benign keratosis:0.878401 Dermatofibroma:0.968389 Vascular lesion:0.975806
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_34.pth

Epoch: 34, iteration: 0/87, ==> train <===, loss: 1.791039, classification loss: 1.786130,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013064,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017973,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.7812838944369375e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 601.0, 28.0, 25.0, 58.0, 6.0, 12.0]

VAL Student: Epoch: 34, iteration: 86

VAL AUROC: 0.866468, VAL Accus: 0.633340, VAL Senss: 0.690418, VAL Specs: 0.917173
AUROCs: Melanoma:0.868331 Melanocytic nevus:0.935662 Basal cell carcinoma:0.886618 Actinic keratosis:0.967441 Benign keratosis:0.854656 Dermatofibroma:0.680894 Vascular lesion:0.871675
Accus: Melanoma:0.495798 Melanocytic nevus:0.906486 Basal cell carcinoma:0.518519 Actinic keratosis:0.757576 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.630252 Melanocytic nevus:0.933635 Basal cell carcinoma:0.555556 Actinic keratosis:0.848485 Benign keratosis:0.690000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.905789 Melanocytic nevus:0.712166 Basal cell carcinoma:0.974630 Actinic keratosis:0.946225 Benign keratosis:0.920000 Dermatofibroma:0.977642 Vascular lesion:0.983756
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [118.0, 1192.0, 74.0, 42.0, 136.0, 9.0, 30.0]

TEST Student: Epoch: 34, iteration: 86

TEST AUROC: 0.906615, TEST Accus: 0.686236, TEST Senss: 0.837538, TEST Specs: 0.860136
AUROCs: Melanoma:0.882721 Melanocytic nevus:0.932937 Basal cell carcinoma:0.962042 Actinic keratosis:0.934003 Benign keratosis:0.903169 Dermatofibroma:0.732701 Vascular lesion:0.998732
Accus: Melanoma:0.510823 Melanocytic nevus:0.883617 Basal cell carcinoma:0.672727 Actinic keratosis:0.724138 Benign keratosis:0.635514 Dermatofibroma:0.409091 Vascular lesion:0.967742
Senss: Melanoma:0.818182 Melanocytic nevus:0.969607 Basal cell carcinoma:0.854545 Actinic keratosis:0.879310 Benign keratosis:0.841121 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.790919 Melanocytic nevus:0.626126 Basal cell carcinoma:0.948556 Actinic keratosis:0.908533 Benign keratosis:0.821210 Dermatofibroma:0.955344 Vascular lesion:0.970262
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_35.pth

Epoch: 35, iteration: 0/87, ==> train <===, loss: 1.794704, classification loss: 1.790946,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013396,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017154,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.503155504993244e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 565.0, 39.0, 20.0, 63.0, 5.0, 12.0]

VAL Student: Epoch: 35, iteration: 86

VAL AUROC: 0.843346, VAL Accus: 0.630052, VAL Senss: 0.701638, VAL Specs: 0.919371
AUROCs: Melanoma:0.857849 Melanocytic nevus:0.933205 Basal cell carcinoma:0.927825 Actinic keratosis:0.877754 Benign keratosis:0.881344 Dermatofibroma:0.558371 Vascular lesion:0.867073
Accus: Melanoma:0.487395 Melanocytic nevus:0.852187 Basal cell carcinoma:0.722222 Actinic keratosis:0.606061 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.917044 Basal cell carcinoma:0.796296 Actinic keratosis:0.696970 Benign keratosis:0.750000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.885358 Melanocytic nevus:0.783383 Basal cell carcinoma:0.932347 Actinic keratosis:0.956567 Benign keratosis:0.903333 Dermatofibroma:0.993902 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [130.0, 1152.0, 90.0, 33.0, 137.0, 7.0, 28.0]

TEST Student: Epoch: 35, iteration: 86

TEST AUROC: 0.899166, TEST Accus: 0.666497, TEST Senss: 0.821218, TEST Specs: 0.861699
AUROCs: Melanoma:0.877065 Melanocytic nevus:0.932455 Basal cell carcinoma:0.974612 Actinic keratosis:0.907203 Benign keratosis:0.897090 Dermatofibroma:0.707020 Vascular lesion:0.998716
Accus: Melanoma:0.562771 Melanocytic nevus:0.853966 Basal cell carcinoma:0.818182 Actinic keratosis:0.568966 Benign keratosis:0.640187 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.839827 Melanocytic nevus:0.952557 Basal cell carcinoma:0.936364 Actinic keratosis:0.810345 Benign keratosis:0.845794 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.777466 Melanocytic nevus:0.702703 Basal cell carcinoma:0.878740 Actinic keratosis:0.933061 Benign keratosis:0.796780 Dermatofibroma:0.978926 Vascular lesion:0.964214
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_36.pth

Epoch: 36, iteration: 0/87, ==> train <===, loss: 1.799222, classification loss: 1.787188,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012664,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024699,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.2528399544939195e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 595.0, 35.0, 25.0, 49.0, 5.0, 11.0]

VAL Student: Epoch: 36, iteration: 86

VAL AUROC: 0.862047, VAL Accus: 0.620456, VAL Senss: 0.705807, VAL Specs: 0.915782
AUROCs: Melanoma:0.868904 Melanocytic nevus:0.938348 Basal cell carcinoma:0.916001 Actinic keratosis:0.966501 Benign keratosis:0.863856 Dermatofibroma:0.603023 Vascular lesion:0.877699
Accus: Melanoma:0.504202 Melanocytic nevus:0.897436 Basal cell carcinoma:0.648148 Actinic keratosis:0.757576 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.731092 Melanocytic nevus:0.936652 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.870602 Melanocytic nevus:0.732938 Basal cell carcinoma:0.951374 Actinic keratosis:0.948294 Benign keratosis:0.925556 Dermatofibroma:0.987805 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1183.0, 89.0, 45.0, 120.0, 7.0, 27.0]

TEST Student: Epoch: 36, iteration: 86

TEST AUROC: 0.908630, TEST Accus: 0.687028, TEST Senss: 0.833365, TEST Specs: 0.864426
AUROCs: Melanoma:0.888383 Melanocytic nevus:0.936978 Basal cell carcinoma:0.974670 Actinic keratosis:0.935246 Benign keratosis:0.900266 Dermatofibroma:0.726269 Vascular lesion:0.998602
Accus: Melanoma:0.597403 Melanocytic nevus:0.876946 Basal cell carcinoma:0.809091 Actinic keratosis:0.775862 Benign keratosis:0.560748 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.874459 Melanocytic nevus:0.965901 Basal cell carcinoma:0.890909 Actinic keratosis:0.844828 Benign keratosis:0.789720 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.751121 Melanocytic nevus:0.657658 Basal cell carcinoma:0.912861 Actinic keratosis:0.910577 Benign keratosis:0.853415 Dermatofibroma:0.972403 Vascular lesion:0.992944
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_37.pth

Epoch: 37, iteration: 0/87, ==> train <===, loss: 1.806533, classification loss: 1.786950,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013094,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032678,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.0275559590445276e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 608.0, 33.0, 25.0, 50.0, 6.0, 12.0]

VAL Student: Epoch: 37, iteration: 86

VAL AUROC: 0.866791, VAL Accus: 0.631845, VAL Senss: 0.692763, VAL Specs: 0.918860
AUROCs: Melanoma:0.868551 Melanocytic nevus:0.936786 Basal cell carcinoma:0.902161 Actinic keratosis:0.972486 Benign keratosis:0.847033 Dermatofibroma:0.663364 Vascular lesion:0.877157
Accus: Melanoma:0.462185 Melanocytic nevus:0.917044 Basal cell carcinoma:0.611111 Actinic keratosis:0.757576 Benign keratosis:0.500000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.588235 Melanocytic nevus:0.945701 Basal cell carcinoma:0.722222 Actinic keratosis:0.818182 Benign keratosis:0.600000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.923950 Melanocytic nevus:0.685460 Basal cell carcinoma:0.958774 Actinic keratosis:0.949328 Benign keratosis:0.938889 Dermatofibroma:0.987805 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [115.0, 1224.0, 80.0, 37.0, 121.0, 8.0, 30.0]

TEST Student: Epoch: 37, iteration: 86

TEST AUROC: 0.908182, TEST Accus: 0.666740, TEST Senss: 0.817976, TEST Specs: 0.873794
AUROCs: Melanoma:0.885029 Melanocytic nevus:0.934682 Basal cell carcinoma:0.972527 Actinic keratosis:0.936136 Benign keratosis:0.904508 Dermatofibroma:0.725448 Vascular lesion:0.998943
Accus: Melanoma:0.497835 Melanocytic nevus:0.907339 Basal cell carcinoma:0.727273 Actinic keratosis:0.637931 Benign keratosis:0.565421 Dermatofibroma:0.363636 Vascular lesion:0.967742
Senss: Melanoma:0.787879 Melanocytic nevus:0.973314 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.789720 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.832960 Melanocytic nevus:0.617117 Basal cell carcinoma:0.918635 Actinic keratosis:0.931528 Benign keratosis:0.870627 Dermatofibroma:0.971902 Vascular lesion:0.973790
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_38.pth

Epoch: 38, iteration: 0/87, ==> train <===, loss: 1.820740, classification loss: 1.811443,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013087,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022384,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.824800363140075e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 557.0, 33.0, 26.0, 59.0, 5.0, 12.0]

VAL Student: Epoch: 38, iteration: 86

VAL AUROC: 0.869716, VAL Accus: 0.632715, VAL Senss: 0.699340, VAL Specs: 0.920194
AUROCs: Melanoma:0.847528 Melanocytic nevus:0.937730 Basal cell carcinoma:0.914220 Actinic keratosis:0.968506 Benign keratosis:0.874533 Dermatofibroma:0.697917 Vascular lesion:0.847580
Accus: Melanoma:0.487395 Melanocytic nevus:0.840121 Basal cell carcinoma:0.611111 Actinic keratosis:0.787879 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.655462 Melanocytic nevus:0.915535 Basal cell carcinoma:0.703704 Actinic keratosis:0.818182 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.868331 Melanocytic nevus:0.827893 Basal cell carcinoma:0.947146 Actinic keratosis:0.918304 Benign keratosis:0.900000 Dermatofibroma:0.986789 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [131.0, 1114.0, 86.0, 45.0, 129.0, 7.0, 27.0]

TEST Student: Epoch: 38, iteration: 86

TEST AUROC: 0.904966, TEST Accus: 0.677504, TEST Senss: 0.834973, TEST Specs: 0.863706
AUROCs: Melanoma:0.872629 Melanocytic nevus:0.936251 Basal cell carcinoma:0.964462 Actinic keratosis:0.935607 Benign keratosis:0.892422 Dermatofibroma:0.735278 Vascular lesion:0.998114
Accus: Melanoma:0.567100 Melanocytic nevus:0.825797 Basal cell carcinoma:0.781818 Actinic keratosis:0.775862 Benign keratosis:0.602804 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.844156 Melanocytic nevus:0.940697 Basal cell carcinoma:0.900000 Actinic keratosis:0.896552 Benign keratosis:0.841121 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.759529 Melanocytic nevus:0.752252 Basal cell carcinoma:0.903937 Actinic keratosis:0.881962 Benign keratosis:0.799001 Dermatofibroma:0.962368 Vascular lesion:0.986895
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_39.pth

Epoch: 39, iteration: 0/87, ==> train <===, loss: 1.791251, classification loss: 1.784178,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012923,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019996,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.6423203268260674e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 600.0, 30.0, 27.0, 40.0, 5.0, 12.0]

VAL Student: Epoch: 39, iteration: 86

VAL AUROC: 0.888125, VAL Accus: 0.622034, VAL Senss: 0.683786, VAL Specs: 0.915200
AUROCs: Melanoma:0.872137 Melanocytic nevus:0.941107 Basal cell carcinoma:0.898735 Actinic keratosis:0.970136 Benign keratosis:0.816000 Dermatofibroma:0.839367 Vascular lesion:0.879391
Accus: Melanoma:0.563025 Melanocytic nevus:0.904977 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.400000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.739496 Melanocytic nevus:0.944193 Basal cell carcinoma:0.629630 Actinic keratosis:0.818182 Benign keratosis:0.480000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.866061 Melanocytic nevus:0.700297 Basal cell carcinoma:0.958774 Actinic keratosis:0.944157 Benign keratosis:0.965556 Dermatofibroma:0.980691 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [145.0, 1201.0, 81.0, 39.0, 97.0, 9.0, 28.0]

TEST Student: Epoch: 39, iteration: 86

TEST AUROC: 0.909257, TEST Accus: 0.670337, TEST Senss: 0.823914, TEST Specs: 0.862981
AUROCs: Melanoma:0.889938 Melanocytic nevus:0.938210 Basal cell carcinoma:0.962801 Actinic keratosis:0.941774 Benign keratosis:0.888899 Dermatofibroma:0.744446 Vascular lesion:0.998732
Accus: Melanoma:0.627706 Melanocytic nevus:0.890289 Basal cell carcinoma:0.736364 Actinic keratosis:0.672414 Benign keratosis:0.453271 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.878788 Melanocytic nevus:0.974796 Basal cell carcinoma:0.872727 Actinic keratosis:0.844828 Benign keratosis:0.696262 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.738229 Melanocytic nevus:0.605105 Basal cell carcinoma:0.923360 Actinic keratosis:0.913643 Benign keratosis:0.912271 Dermatofibroma:0.960863 Vascular lesion:0.987399
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_40.pth

Epoch: 40, iteration: 0/87, ==> train <===, loss: 1.802769, classification loss: 1.800707,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013799,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015861,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.4780882941434607e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 611.0, 33.0, 18.0, 47.0, 5.0, 11.0]

VAL Student: Epoch: 40, iteration: 86

VAL AUROC: 0.849510, VAL Accus: 0.590255, VAL Senss: 0.665101, VAL Specs: 0.915422
AUROCs: Melanoma:0.878843 Melanocytic nevus:0.939131 Basal cell carcinoma:0.909110 Actinic keratosis:0.888659 Benign keratosis:0.858256 Dermatofibroma:0.605564 Vascular lesion:0.867005
Accus: Melanoma:0.537815 Melanocytic nevus:0.921569 Basal cell carcinoma:0.611111 Actinic keratosis:0.545455 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.663866 Melanocytic nevus:0.959276 Basal cell carcinoma:0.703704 Actinic keratosis:0.636364 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.886493 Melanocytic nevus:0.667656 Basal cell carcinoma:0.960888 Actinic keratosis:0.963806 Benign keratosis:0.943333 Dermatofibroma:0.991870 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1225.0, 79.0, 37.0, 117.0, 6.0, 24.0]

TEST Student: Epoch: 40, iteration: 86

TEST AUROC: 0.907631, TEST Accus: 0.633990, TEST Senss: 0.806189, TEST Specs: 0.860051
AUROCs: Melanoma:0.896752 Melanocytic nevus:0.933340 Basal cell carcinoma:0.971744 Actinic keratosis:0.925643 Benign keratosis:0.903960 Dermatofibroma:0.724171 Vascular lesion:0.997805
Accus: Melanoma:0.580087 Melanocytic nevus:0.908080 Basal cell carcinoma:0.718182 Actinic keratosis:0.637931 Benign keratosis:0.546729 Dermatofibroma:0.272727 Vascular lesion:0.774194
Senss: Melanoma:0.848485 Melanocytic nevus:0.976279 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.799065 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.776906 Melanocytic nevus:0.543544 Basal cell carcinoma:0.927559 Actinic keratosis:0.943281 Benign keratosis:0.856191 Dermatofibroma:0.978926 Vascular lesion:0.993952
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_41.pth

Epoch: 41, iteration: 0/87, ==> train <===, loss: 1.796108, classification loss: 1.784554,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013508,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025062,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.3302794647291146e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [79.0, 557.0, 32.0, 18.0, 56.0, 5.0, 12.0]

VAL Student: Epoch: 41, iteration: 86

VAL AUROC: 0.854708, VAL Accus: 0.616362, VAL Senss: 0.690778, VAL Specs: 0.917513
AUROCs: Melanoma:0.885195 Melanocytic nevus:0.943240 Basal cell carcinoma:0.906840 Actinic keratosis:0.901131 Benign keratosis:0.867289 Dermatofibroma:0.612868 Vascular lesion:0.866396
Accus: Melanoma:0.663866 Melanocytic nevus:0.840121 Basal cell carcinoma:0.592593 Actinic keratosis:0.545455 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.798319 Melanocytic nevus:0.923077 Basal cell carcinoma:0.685185 Actinic keratosis:0.636364 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.802497 Melanocytic nevus:0.774481 Basal cell carcinoma:0.968288 Actinic keratosis:0.966908 Benign keratosis:0.926667 Dermatofibroma:0.992886 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [170.0, 1132.0, 81.0, 32.0, 117.0, 7.0, 27.0]

TEST Student: Epoch: 41, iteration: 86

TEST AUROC: 0.902453, TEST Accus: 0.657005, TEST Senss: 0.816168, TEST Specs: 0.871648
AUROCs: Melanoma:0.891663 Melanocytic nevus:0.938996 Basal cell carcinoma:0.970976 Actinic keratosis:0.916551 Benign keratosis:0.889682 Dermatofibroma:0.710897 Vascular lesion:0.998407
Accus: Melanoma:0.735931 Melanocytic nevus:0.839140 Basal cell carcinoma:0.736364 Actinic keratosis:0.551724 Benign keratosis:0.546729 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.917749 Melanocytic nevus:0.948851 Basal cell carcinoma:0.872727 Actinic keratosis:0.775862 Benign keratosis:0.775701 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.681054 Melanocytic nevus:0.717718 Basal cell carcinoma:0.941207 Actinic keratosis:0.947368 Benign keratosis:0.853415 Dermatofibroma:0.980933 Vascular lesion:0.979839
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_42.pth

Epoch: 42, iteration: 0/87, ==> train <===, loss: 1.791759, classification loss: 1.793152,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012491,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.011098,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.1972515182562032e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 559.0, 40.0, 23.0, 62.0, 5.0, 12.0]

VAL Student: Epoch: 42, iteration: 86

VAL AUROC: 0.856334, VAL Accus: 0.642963, VAL Senss: 0.709060, VAL Specs: 0.920741
AUROCs: Melanoma:0.848663 Melanocytic nevus:0.940138 Basal cell carcinoma:0.926787 Actinic keratosis:0.938736 Benign keratosis:0.882289 Dermatofibroma:0.596608 Vascular lesion:0.861117
Accus: Melanoma:0.487395 Melanocytic nevus:0.843137 Basal cell carcinoma:0.740741 Actinic keratosis:0.696970 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.920060 Basal cell carcinoma:0.814815 Actinic keratosis:0.696970 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.870602 Melanocytic nevus:0.798220 Basal cell carcinoma:0.937632 Actinic keratosis:0.944157 Benign keratosis:0.907778 Dermatofibroma:0.993902 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1132.0, 89.0, 36.0, 131.0, 7.0, 27.0]

TEST Student: Epoch: 42, iteration: 86

TEST AUROC: 0.904124, TEST Accus: 0.663093, TEST Senss: 0.816023, TEST Specs: 0.869423
AUROCs: Melanoma:0.875400 Melanocytic nevus:0.936507 Basal cell carcinoma:0.970007 Actinic keratosis:0.927836 Benign keratosis:0.896018 Dermatofibroma:0.724696 Vascular lesion:0.998407
Accus: Melanoma:0.571429 Melanocytic nevus:0.839140 Basal cell carcinoma:0.809091 Actinic keratosis:0.620690 Benign keratosis:0.612150 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.835498 Melanocytic nevus:0.945145 Basal cell carcinoma:0.945455 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.363636 Vascular lesion:0.967742
Specs: Melanoma:0.769058 Melanocytic nevus:0.744745 Basal cell carcinoma:0.885039 Actinic keratosis:0.913643 Benign keratosis:0.816213 Dermatofibroma:0.976417 Vascular lesion:0.980847
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_43.pth

Epoch: 43, iteration: 0/87, ==> train <===, loss: 1.798459, classification loss: 1.786296,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012691,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024854,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0775263664305828e-06
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 563.0, 32.0, 23.0, 64.0, 5.0, 10.0]

VAL Student: Epoch: 43, iteration: 86

VAL AUROC: 0.863286, VAL Accus: 0.608872, VAL Senss: 0.693504, VAL Specs: 0.918535
AUROCs: Melanoma:0.846584 Melanocytic nevus:0.941687 Basal cell carcinoma:0.921287 Actinic keratosis:0.964119 Benign keratosis:0.875956 Dermatofibroma:0.630971 Vascular lesion:0.862403
Accus: Melanoma:0.504202 Melanocytic nevus:0.849170 Basal cell carcinoma:0.592593 Actinic keratosis:0.696970 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.680672 Melanocytic nevus:0.924585 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Specs: Melanoma:0.868331 Melanocytic nevus:0.801187 Basal cell carcinoma:0.949260 Actinic keratosis:0.937952 Benign keratosis:0.893333 Dermatofibroma:0.984756 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [132.0, 1138.0, 85.0, 44.0, 140.0, 7.0, 22.0]

TEST Student: Epoch: 43, iteration: 86

TEST AUROC: 0.906814, TEST Accus: 0.661204, TEST Senss: 0.813246, TEST Specs: 0.863769
AUROCs: Melanoma:0.878402 Melanocytic nevus:0.937634 Basal cell carcinoma:0.965082 Actinic keratosis:0.931440 Benign keratosis:0.902492 Dermatofibroma:0.741801 Vascular lesion:0.990846
Accus: Melanoma:0.571429 Melanocytic nevus:0.843588 Basal cell carcinoma:0.772727 Actinic keratosis:0.758621 Benign keratosis:0.654206 Dermatofibroma:0.318182 Vascular lesion:0.709677
Senss: Melanoma:0.844156 Melanocytic nevus:0.946627 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.859813 Dermatofibroma:0.409091 Vascular lesion:0.870968
Specs: Melanoma:0.756726 Melanocytic nevus:0.732733 Basal cell carcinoma:0.907612 Actinic keratosis:0.901891 Benign keratosis:0.784564 Dermatofibroma:0.966382 Vascular lesion:0.996472
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_44.pth

Epoch: 44, iteration: 0/87, ==> train <===, loss: 1.846043, classification loss: 1.843817,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013348,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015573,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.697737297875246e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 602.0, 35.0, 23.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 44, iteration: 86

VAL AUROC: 0.864985, VAL Accus: 0.634259, VAL Senss: 0.697807, VAL Specs: 0.919635
AUROCs: Melanoma:0.872290 Melanocytic nevus:0.942837 Basal cell carcinoma:0.917117 Actinic keratosis:0.954561 Benign keratosis:0.878378 Dermatofibroma:0.627922 Vascular lesion:0.861794
Accus: Melanoma:0.504202 Melanocytic nevus:0.907994 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.948718 Basal cell carcinoma:0.685185 Actinic keratosis:0.757576 Benign keratosis:0.700000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.888763 Melanocytic nevus:0.718101 Basal cell carcinoma:0.964059 Actinic keratosis:0.957601 Benign keratosis:0.921111 Dermatofibroma:0.994919 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1193.0, 82.0, 39.0, 128.0, 7.0, 27.0]

TEST Student: Epoch: 44, iteration: 86

TEST AUROC: 0.911833, TEST Accus: 0.666466, TEST Senss: 0.835472, TEST Specs: 0.863244
AUROCs: Melanoma:0.891030 Melanocytic nevus:0.938584 Basal cell carcinoma:0.972408 Actinic keratosis:0.933070 Benign keratosis:0.909731 Dermatofibroma:0.739520 Vascular lesion:0.998488
Accus: Melanoma:0.575758 Melanocytic nevus:0.884359 Basal cell carcinoma:0.745455 Actinic keratosis:0.672414 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.844156 Melanocytic nevus:0.973314 Basal cell carcinoma:0.881818 Actinic keratosis:0.844828 Benign keratosis:0.836449 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.775785 Melanocytic nevus:0.609610 Basal cell carcinoma:0.923885 Actinic keratosis:0.934594 Benign keratosis:0.828984 Dermatofibroma:0.979930 Vascular lesion:0.989919
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_45.pth

Epoch: 45, iteration: 0/87, ==> train <===, loss: 1.788758, classification loss: 1.786869,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013288,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015177,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.727963568087721e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 569.0, 44.0, 21.0, 47.0, 5.0, 12.0]

VAL Student: Epoch: 45, iteration: 86

VAL AUROC: 0.876299, VAL Accus: 0.628014, VAL Senss: 0.696644, VAL Specs: 0.917183
AUROCs: Melanoma:0.850709 Melanocytic nevus:0.931500 Basal cell carcinoma:0.942037 Actinic keratosis:0.944596 Benign keratosis:0.867633 Dermatofibroma:0.700902 Vascular lesion:0.896717
Accus: Melanoma:0.504202 Melanocytic nevus:0.858220 Basal cell carcinoma:0.814815 Actinic keratosis:0.636364 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.904977 Basal cell carcinoma:0.888889 Actinic keratosis:0.696970 Benign keratosis:0.530000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.878547 Melanocytic nevus:0.786350 Basal cell carcinoma:0.887949 Actinic keratosis:0.953464 Benign keratosis:0.944444 Dermatofibroma:0.980691 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [128.0, 1147.0, 97.0, 31.0, 103.0, 8.0, 29.0]

TEST Student: Epoch: 45, iteration: 86

TEST AUROC: 0.899376, TEST Accus: 0.657300, TEST Senss: 0.812972, TEST Specs: 0.869946
AUROCs: Melanoma:0.872209 Melanocytic nevus:0.933787 Basal cell carcinoma:0.972503 Actinic keratosis:0.905009 Benign keratosis:0.887767 Dermatofibroma:0.725608 Vascular lesion:0.998748
Accus: Melanoma:0.554113 Melanocytic nevus:0.850259 Basal cell carcinoma:0.881818 Actinic keratosis:0.534483 Benign keratosis:0.481308 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.796537 Melanocytic nevus:0.946627 Basal cell carcinoma:0.981818 Actinic keratosis:0.810345 Benign keratosis:0.700935 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.788677 Melanocytic nevus:0.726727 Basal cell carcinoma:0.801575 Actinic keratosis:0.933572 Benign keratosis:0.903387 Dermatofibroma:0.956347 Vascular lesion:0.979335
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_46.pth

Epoch: 46, iteration: 0/87, ==> train <===, loss: 1.821316, classification loss: 1.814497,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013705,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020524,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.855167211278949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 554.0, 36.0, 25.0, 42.0, 5.0, 12.0]

VAL Student: Epoch: 46, iteration: 86

VAL AUROC: 0.888836, VAL Accus: 0.619794, VAL Senss: 0.704741, VAL Specs: 0.918791
AUROCs: Melanoma:0.856418 Melanocytic nevus:0.935269 Basal cell carcinoma:0.927746 Actinic keratosis:0.953120 Benign keratosis:0.851456 Dermatofibroma:0.815612 Vascular lesion:0.882234
Accus: Melanoma:0.546218 Melanocytic nevus:0.835596 Basal cell carcinoma:0.666667 Actinic keratosis:0.757576 Benign keratosis:0.420000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.895928 Basal cell carcinoma:0.777778 Actinic keratosis:0.818182 Benign keratosis:0.510000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.863791 Melanocytic nevus:0.810089 Basal cell carcinoma:0.919662 Actinic keratosis:0.922441 Benign keratosis:0.951111 Dermatofibroma:0.974593 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1116.0, 94.0, 42.0, 100.0, 8.0, 28.0]

TEST Student: Epoch: 46, iteration: 86

TEST AUROC: 0.904258, TEST Accus: 0.678025, TEST Senss: 0.817220, TEST Specs: 0.872142
AUROCs: Melanoma:0.873983 Melanocytic nevus:0.936231 Basal cell carcinoma:0.968518 Actinic keratosis:0.934206 Benign keratosis:0.884856 Dermatofibroma:0.733590 Vascular lesion:0.998423
Accus: Melanoma:0.606061 Melanocytic nevus:0.827279 Basal cell carcinoma:0.854545 Actinic keratosis:0.724138 Benign keratosis:0.467290 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.818182 Melanocytic nevus:0.937732 Basal cell carcinoma:0.945455 Actinic keratosis:0.827586 Benign keratosis:0.691589 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.766256 Melanocytic nevus:0.759760 Basal cell carcinoma:0.858793 Actinic keratosis:0.889116 Benign keratosis:0.898390 Dermatofibroma:0.950828 Vascular lesion:0.981855
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_47.pth

Epoch: 47, iteration: 0/87, ==> train <===, loss: 1.807074, classification loss: 1.801546,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013621,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019149,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.069650490151055e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [60.0, 558.0, 35.0, 26.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 47, iteration: 86

VAL AUROC: 0.877265, VAL Accus: 0.629194, VAL Senss: 0.701841, VAL Specs: 0.925929
AUROCs: Melanoma:0.850418 Melanocytic nevus:0.935859 Basal cell carcinoma:0.921717 Actinic keratosis:0.961581 Benign keratosis:0.873133 Dermatofibroma:0.735137 Vascular lesion:0.863012
Accus: Melanoma:0.504202 Melanocytic nevus:0.841629 Basal cell carcinoma:0.648148 Actinic keratosis:0.787879 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.904977 Basal cell carcinoma:0.740741 Actinic keratosis:0.878788 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.870602 Melanocytic nevus:0.830861 Basal cell carcinoma:0.931290 Actinic keratosis:0.930714 Benign keratosis:0.944444 Dermatofibroma:0.987805 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1118.0, 93.0, 43.0, 110.0, 8.0, 29.0]

TEST Student: Epoch: 47, iteration: 86

TEST AUROC: 0.905056, TEST Accus: 0.691922, TEST Senss: 0.821049, TEST Specs: 0.877537
AUROCs: Melanoma:0.872855 Melanocytic nevus:0.937929 Basal cell carcinoma:0.968356 Actinic keratosis:0.934435 Benign keratosis:0.890533 Dermatofibroma:0.732404 Vascular lesion:0.998878
Accus: Melanoma:0.614719 Melanocytic nevus:0.828762 Basal cell carcinoma:0.845455 Actinic keratosis:0.741379 Benign keratosis:0.514019 Dermatofibroma:0.363636 Vascular lesion:0.935484
Senss: Melanoma:0.822511 Melanocytic nevus:0.933284 Basal cell carcinoma:0.927273 Actinic keratosis:0.862069 Benign keratosis:0.747664 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.772982 Melanocytic nevus:0.774775 Basal cell carcinoma:0.877165 Actinic keratosis:0.895248 Benign keratosis:0.878401 Dermatofibroma:0.969895 Vascular lesion:0.974294
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_48.pth

Epoch: 48, iteration: 0/87, ==> train <===, loss: 1.816982, classification loss: 1.798927,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.014143,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.032199,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.362685441135949e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 565.0, 37.0, 26.0, 54.0, 5.0, 12.0]

VAL Student: Epoch: 48, iteration: 86

VAL AUROC: 0.875752, VAL Accus: 0.639078, VAL Senss: 0.703149, VAL Specs: 0.922235
AUROCs: Melanoma:0.852288 Melanocytic nevus:0.935676 Basal cell carcinoma:0.935733 Actinic keratosis:0.965623 Benign keratosis:0.862644 Dermatofibroma:0.724022 Vascular lesion:0.854281
Accus: Melanoma:0.495798 Melanocytic nevus:0.852187 Basal cell carcinoma:0.685185 Actinic keratosis:0.787879 Benign keratosis:0.540000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.672269 Melanocytic nevus:0.911011 Basal cell carcinoma:0.777778 Actinic keratosis:0.848485 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.876277 Melanocytic nevus:0.807122 Basal cell carcinoma:0.930233 Actinic keratosis:0.926577 Benign keratosis:0.937778 Dermatofibroma:0.990854 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [131.0, 1132.0, 92.0, 42.0, 115.0, 7.0, 28.0]

TEST Student: Epoch: 48, iteration: 86

TEST AUROC: 0.902923, TEST Accus: 0.675076, TEST Senss: 0.819350, TEST Specs: 0.871399
AUROCs: Melanoma:0.873661 Melanocytic nevus:0.935974 Basal cell carcinoma:0.966948 Actinic keratosis:0.933642 Benign keratosis:0.889283 Dermatofibroma:0.722255 Vascular lesion:0.998699
Accus: Melanoma:0.567100 Melanocytic nevus:0.839140 Basal cell carcinoma:0.836364 Actinic keratosis:0.724138 Benign keratosis:0.537383 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.792208 Melanocytic nevus:0.939956 Basal cell carcinoma:0.945455 Actinic keratosis:0.827586 Benign keratosis:0.775701 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.781951 Melanocytic nevus:0.753754 Basal cell carcinoma:0.860892 Actinic keratosis:0.897292 Benign keratosis:0.856191 Dermatofibroma:0.974410 Vascular lesion:0.975302
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_49.pth

Epoch: 49, iteration: 0/87, ==> train <===, loss: 1.818158, classification loss: 1.804264,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.011865,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025759,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.726416897022355e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 567.0, 37.0, 28.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 49, iteration: 86

VAL AUROC: 0.875482, VAL Accus: 0.645250, VAL Senss: 0.709306, VAL Specs: 0.922102
AUROCs: Melanoma:0.841481 Melanocytic nevus:0.937802 Basal cell carcinoma:0.935205 Actinic keratosis:0.964746 Benign keratosis:0.866156 Dermatofibroma:0.722815 Vascular lesion:0.860169
Accus: Melanoma:0.445378 Melanocytic nevus:0.855204 Basal cell carcinoma:0.685185 Actinic keratosis:0.848485 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.605042 Melanocytic nevus:0.912519 Basal cell carcinoma:0.796296 Actinic keratosis:0.878788 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.893303 Melanocytic nevus:0.813056 Basal cell carcinoma:0.926004 Actinic keratosis:0.924509 Benign keratosis:0.922222 Dermatofibroma:0.981707 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [119.0, 1131.0, 92.0, 43.0, 122.0, 7.0, 27.0]

TEST Student: Epoch: 49, iteration: 86

TEST AUROC: 0.903245, TEST Accus: 0.670077, TEST Senss: 0.814101, TEST Specs: 0.864692
AUROCs: Melanoma:0.866570 Melanocytic nevus:0.934957 Basal cell carcinoma:0.966991 Actinic keratosis:0.939096 Benign keratosis:0.888455 Dermatofibroma:0.729325 Vascular lesion:0.997317
Accus: Melanoma:0.515152 Melanocytic nevus:0.838399 Basal cell carcinoma:0.836364 Actinic keratosis:0.741379 Benign keratosis:0.570093 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.774892 Melanocytic nevus:0.945886 Basal cell carcinoma:0.945455 Actinic keratosis:0.862069 Benign keratosis:0.780374 Dermatofibroma:0.454545 Vascular lesion:0.935484
Specs: Melanoma:0.802691 Melanocytic nevus:0.741742 Basal cell carcinoma:0.858793 Actinic keratosis:0.876341 Benign keratosis:0.829539 Dermatofibroma:0.957852 Vascular lesion:0.985887
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_50.pth

Epoch: 50, iteration: 0/87, ==> train <===, loss: 1.804149, classification loss: 1.801631,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013274,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015792,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.15377520732012e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [67.0, 587.0, 36.0, 20.0, 58.0, 6.0, 12.0]

VAL Student: Epoch: 50, iteration: 86

VAL AUROC: 0.881421, VAL Accus: 0.639446, VAL Senss: 0.703188, VAL Specs: 0.921823
AUROCs: Melanoma:0.868045 Melanocytic nevus:0.942698 Basal cell carcinoma:0.919525 Actinic keratosis:0.950268 Benign keratosis:0.861300 Dermatofibroma:0.749936 Vascular lesion:0.878173
Accus: Melanoma:0.563025 Melanocytic nevus:0.885370 Basal cell carcinoma:0.666667 Actinic keratosis:0.606061 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.932127 Basal cell carcinoma:0.740741 Actinic keratosis:0.696970 Benign keratosis:0.680000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.874007 Melanocytic nevus:0.765579 Basal cell carcinoma:0.952431 Actinic keratosis:0.964840 Benign keratosis:0.923333 Dermatofibroma:0.984756 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1160.0, 88.0, 32.0, 122.0, 10.0, 28.0]

TEST Student: Epoch: 50, iteration: 86

TEST AUROC: 0.908679, TEST Accus: 0.679172, TEST Senss: 0.826101, TEST Specs: 0.873253
AUROCs: Melanoma:0.884609 Melanocytic nevus:0.938825 Basal cell carcinoma:0.971324 Actinic keratosis:0.923370 Benign keratosis:0.903868 Dermatofibroma:0.739931 Vascular lesion:0.998829
Accus: Melanoma:0.614719 Melanocytic nevus:0.859896 Basal cell carcinoma:0.800000 Actinic keratosis:0.551724 Benign keratosis:0.570093 Dermatofibroma:0.454545 Vascular lesion:0.903226
Senss: Melanoma:0.835498 Melanocytic nevus:0.962936 Basal cell carcinoma:0.900000 Actinic keratosis:0.775862 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.774664 Melanocytic nevus:0.695195 Basal cell carcinoma:0.907612 Actinic keratosis:0.946857 Benign keratosis:0.846752 Dermatofibroma:0.964375 Vascular lesion:0.977319
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_51.pth

Epoch: 51, iteration: 0/87, ==> train <===, loss: 1.854116, classification loss: 1.843306,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013805,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024615,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.638397686588108e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [68.0, 595.0, 32.0, 26.0, 41.0, 5.0, 12.0]

VAL Student: Epoch: 51, iteration: 86

VAL AUROC: 0.871425, VAL Accus: 0.624548, VAL Senss: 0.685873, VAL Specs: 0.916977
AUROCs: Melanoma:0.889383 Melanocytic nevus:0.940980 Basal cell carcinoma:0.913143 Actinic keratosis:0.972643 Benign keratosis:0.841322 Dermatofibroma:0.677528 Vascular lesion:0.864975
Accus: Melanoma:0.571429 Melanocytic nevus:0.897436 Basal cell carcinoma:0.592593 Actinic keratosis:0.787879 Benign keratosis:0.410000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.756303 Melanocytic nevus:0.944193 Basal cell carcinoma:0.629630 Actinic keratosis:0.848485 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.856981 Melanocytic nevus:0.715134 Basal cell carcinoma:0.961945 Actinic keratosis:0.945191 Benign keratosis:0.958889 Dermatofibroma:0.991870 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 1195.0, 83.0, 43.0, 105.0, 9.0, 28.0]

TEST Student: Epoch: 51, iteration: 86

TEST AUROC: 0.910192, TEST Accus: 0.688729, TEST Senss: 0.824361, TEST Specs: 0.866650
AUROCs: Melanoma:0.889227 Melanocytic nevus:0.937785 Basal cell carcinoma:0.967612 Actinic keratosis:0.942532 Benign keratosis:0.893538 Dermatofibroma:0.741938 Vascular lesion:0.998716
Accus: Melanoma:0.636364 Melanocytic nevus:0.885841 Basal cell carcinoma:0.754545 Actinic keratosis:0.741379 Benign keratosis:0.490654 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.891775 Melanocytic nevus:0.969607 Basal cell carcinoma:0.872727 Actinic keratosis:0.844828 Benign keratosis:0.691589 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.726457 Melanocytic nevus:0.641141 Basal cell carcinoma:0.927034 Actinic keratosis:0.912110 Benign keratosis:0.910605 Dermatofibroma:0.975414 Vascular lesion:0.973790
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_52.pth

Epoch: 52, iteration: 0/87, ==> train <===, loss: 1.808233, classification loss: 1.793603,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012784,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027414,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.1745579179292974e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 605.0, 34.0, 27.0, 48.0, 5.0, 12.0]

VAL Student: Epoch: 52, iteration: 86

VAL AUROC: 0.896981, VAL Accus: 0.630716, VAL Senss: 0.685986, VAL Specs: 0.918133
AUROCs: Melanoma:0.854262 Melanocytic nevus:0.939507 Basal cell carcinoma:0.923459 Actinic keratosis:0.968726 Benign keratosis:0.843400 Dermatofibroma:0.864774 Vascular lesion:0.884738
Accus: Melanoma:0.462185 Melanocytic nevus:0.912519 Basal cell carcinoma:0.629630 Actinic keratosis:0.818182 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.605042 Melanocytic nevus:0.939668 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.530000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.913734 Melanocytic nevus:0.721068 Basal cell carcinoma:0.939746 Actinic keratosis:0.936918 Benign keratosis:0.950000 Dermatofibroma:0.978659 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [116.0, 1211.0, 88.0, 43.0, 113.0, 9.0, 28.0]

TEST Student: Epoch: 52, iteration: 86

TEST AUROC: 0.908477, TEST Accus: 0.683086, TEST Senss: 0.825321, TEST Specs: 0.869942
AUROCs: Melanoma:0.874716 Melanocytic nevus:0.937212 Basal cell carcinoma:0.964514 Actinic keratosis:0.936558 Benign keratosis:0.898509 Dermatofibroma:0.749099 Vascular lesion:0.998732
Accus: Melanoma:0.502165 Melanocytic nevus:0.897702 Basal cell carcinoma:0.800000 Actinic keratosis:0.741379 Benign keratosis:0.528037 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.744589 Melanocytic nevus:0.968125 Basal cell carcinoma:0.900000 Actinic keratosis:0.862069 Benign keratosis:0.757009 Dermatofibroma:0.545455 Vascular lesion:1.000000
Specs: Melanoma:0.826794 Melanocytic nevus:0.650150 Basal cell carcinoma:0.892913 Actinic keratosis:0.905468 Benign keratosis:0.891172 Dermatofibroma:0.952835 Vascular lesion:0.970262
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_53.pth

Epoch: 53, iteration: 0/87, ==> train <===, loss: 1.820390, classification loss: 1.805789,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013037,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027638,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.7571021261363677e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 590.0, 36.0, 22.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 53, iteration: 86

VAL AUROC: 0.879158, VAL Accus: 0.628789, VAL Senss: 0.702700, VAL Specs: 0.920669
AUROCs: Melanoma:0.855044 Melanocytic nevus:0.937681 Basal cell carcinoma:0.915727 Actinic keratosis:0.965498 Benign keratosis:0.870667 Dermatofibroma:0.733549 Vascular lesion:0.875939
Accus: Melanoma:0.495798 Melanocytic nevus:0.889894 Basal cell carcinoma:0.666667 Actinic keratosis:0.666667 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.935143 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.660000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.904654 Melanocytic nevus:0.750742 Basal cell carcinoma:0.945032 Actinic keratosis:0.951396 Benign keratosis:0.923333 Dermatofibroma:0.980691 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 1179.0, 85.0, 39.0, 126.0, 8.0, 27.0]

TEST Student: Epoch: 53, iteration: 86

TEST AUROC: 0.908355, TEST Accus: 0.665999, TEST Senss: 0.829464, TEST Specs: 0.866731
AUROCs: Melanoma:0.881576 Melanocytic nevus:0.935009 Basal cell carcinoma:0.966509 Actinic keratosis:0.929202 Benign keratosis:0.904285 Dermatofibroma:0.743397 Vascular lesion:0.998504
Accus: Melanoma:0.519481 Melanocytic nevus:0.873981 Basal cell carcinoma:0.772727 Actinic keratosis:0.672414 Benign keratosis:0.588785 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.787879 Melanocytic nevus:0.963677 Basal cell carcinoma:0.900000 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.809417 Melanocytic nevus:0.663664 Basal cell carcinoma:0.904462 Actinic keratosis:0.915687 Benign keratosis:0.836202 Dermatofibroma:0.958856 Vascular lesion:0.978831
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_54.pth

Epoch: 54, iteration: 0/87, ==> train <===, loss: 1.791735, classification loss: 1.782074,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012433,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022094,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.3813919135227313e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [81.0, 538.0, 35.0, 19.0, 44.0, 5.0, 12.0]

VAL Student: Epoch: 54, iteration: 86

VAL AUROC: 0.850800, VAL Accus: 0.609792, VAL Senss: 0.684224, VAL Specs: 0.919140
AUROCs: Melanoma:0.876325 Melanocytic nevus:0.938115 Basal cell carcinoma:0.926376 Actinic keratosis:0.906866 Benign keratosis:0.857811 Dermatofibroma:0.602388 Vascular lesion:0.847716
Accus: Melanoma:0.680672 Melanocytic nevus:0.811463 Basal cell carcinoma:0.648148 Actinic keratosis:0.575758 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.806723 Melanocytic nevus:0.894419 Basal cell carcinoma:0.759259 Actinic keratosis:0.666667 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.788876 Melanocytic nevus:0.813056 Basal cell carcinoma:0.948203 Actinic keratosis:0.951396 Benign keratosis:0.946667 Dermatofibroma:0.991870 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [171.0, 1102.0, 90.0, 37.0, 105.0, 7.0, 28.0]

TEST Student: Epoch: 54, iteration: 86

TEST AUROC: 0.900738, TEST Accus: 0.675048, TEST Senss: 0.791571, TEST Specs: 0.872329
AUROCs: Melanoma:0.885553 Melanocytic nevus:0.936875 Basal cell carcinoma:0.968227 Actinic keratosis:0.920674 Benign keratosis:0.882729 Dermatofibroma:0.713566 Vascular lesion:0.997545
Accus: Melanoma:0.740260 Melanocytic nevus:0.816901 Basal cell carcinoma:0.818182 Actinic keratosis:0.637931 Benign keratosis:0.490654 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.917749 Melanocytic nevus:0.929577 Basal cell carcinoma:0.881818 Actinic keratosis:0.793103 Benign keratosis:0.719626 Dermatofibroma:0.363636 Vascular lesion:0.935484
Specs: Melanoma:0.656390 Melanocytic nevus:0.768769 Basal cell carcinoma:0.899213 Actinic keratosis:0.926418 Benign keratosis:0.886174 Dermatofibroma:0.981435 Vascular lesion:0.987903
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_55.pth

Epoch: 55, iteration: 0/87, ==> train <===, loss: 1.784536, classification loss: 1.782391,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012623,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.014768,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.043252722170458e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 584.0, 34.0, 29.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 55, iteration: 86

VAL AUROC: 0.866283, VAL Accus: 0.646050, VAL Senss: 0.700081, VAL Specs: 0.918566
AUROCs: Melanoma:0.839792 Melanocytic nevus:0.939870 Basal cell carcinoma:0.920836 Actinic keratosis:0.967347 Benign keratosis:0.870533 Dermatofibroma:0.671049 Vascular lesion:0.854552
Accus: Melanoma:0.470588 Melanocytic nevus:0.880845 Basal cell carcinoma:0.629630 Actinic keratosis:0.878788 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.613445 Melanocytic nevus:0.932127 Basal cell carcinoma:0.703704 Actinic keratosis:0.878788 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.895573 Melanocytic nevus:0.744807 Basal cell carcinoma:0.950317 Actinic keratosis:0.929679 Benign keratosis:0.928889 Dermatofibroma:0.988821 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [120.0, 1170.0, 86.0, 44.0, 127.0, 7.0, 27.0]

TEST Student: Epoch: 55, iteration: 86

TEST AUROC: 0.903552, TEST Accus: 0.672834, TEST Senss: 0.825105, TEST Specs: 0.871775
AUROCs: Melanoma:0.864874 Melanocytic nevus:0.936687 Basal cell carcinoma:0.961155 Actinic keratosis:0.937210 Benign keratosis:0.898582 Dermatofibroma:0.728162 Vascular lesion:0.998195
Accus: Melanoma:0.519481 Melanocytic nevus:0.867309 Basal cell carcinoma:0.781818 Actinic keratosis:0.758621 Benign keratosis:0.593458 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.779221 Melanocytic nevus:0.959229 Basal cell carcinoma:0.881818 Actinic keratosis:0.879310 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.813901 Melanocytic nevus:0.690691 Basal cell carcinoma:0.908136 Actinic keratosis:0.890138 Benign keratosis:0.847307 Dermatofibroma:0.970396 Vascular lesion:0.981855
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_56.pth

Epoch: 56, iteration: 0/87, ==> train <===, loss: 1.800230, classification loss: 1.788472,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013619,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025377,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.7389274499534124e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [73.0, 570.0, 35.0, 20.0, 45.0, 5.0, 12.0]

VAL Student: Epoch: 56, iteration: 86

VAL AUROC: 0.874877, VAL Accus: 0.612840, VAL Senss: 0.691196, VAL Specs: 0.921349
AUROCs: Melanoma:0.884385 Melanocytic nevus:0.942855 Basal cell carcinoma:0.925300 Actinic keratosis:0.950801 Benign keratosis:0.864667 Dermatofibroma:0.687500 Vascular lesion:0.868629
Accus: Melanoma:0.613445 Melanocytic nevus:0.859729 Basal cell carcinoma:0.648148 Actinic keratosis:0.606061 Benign keratosis:0.450000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.789916 Melanocytic nevus:0.918552 Basal cell carcinoma:0.740741 Actinic keratosis:0.666667 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.833144 Melanocytic nevus:0.798220 Basal cell carcinoma:0.942918 Actinic keratosis:0.952430 Benign keratosis:0.940000 Dermatofibroma:0.987805 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [152.0, 1136.0, 91.0, 37.0, 117.0, 7.0, 26.0]

TEST Student: Epoch: 56, iteration: 86

TEST AUROC: 0.910274, TEST Accus: 0.666991, TEST Senss: 0.827313, TEST Specs: 0.873760
AUROCs: Melanoma:0.890331 Melanocytic nevus:0.939742 Basal cell carcinoma:0.971086 Actinic keratosis:0.925114 Benign keratosis:0.903457 Dermatofibroma:0.744743 Vascular lesion:0.997447
Accus: Melanoma:0.658009 Melanocytic nevus:0.842105 Basal cell carcinoma:0.827273 Actinic keratosis:0.637931 Benign keratosis:0.546729 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.900433 Melanocytic nevus:0.946627 Basal cell carcinoma:0.927273 Actinic keratosis:0.810345 Benign keratosis:0.771028 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.713565 Melanocytic nevus:0.747748 Basal cell carcinoma:0.900787 Actinic keratosis:0.932550 Benign keratosis:0.862854 Dermatofibroma:0.967888 Vascular lesion:0.990927
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_57.pth

Epoch: 57, iteration: 0/87, ==> train <===, loss: 1.809521, classification loss: 1.783098,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013215,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.039639,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.465034704958071e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 618.0, 36.0, 21.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 57, iteration: 86

VAL AUROC: 0.882329, VAL Accus: 0.614719, VAL Senss: 0.672401, VAL Specs: 0.917481
AUROCs: Melanoma:0.853938 Melanocytic nevus:0.939610 Basal cell carcinoma:0.926572 Actinic keratosis:0.950895 Benign keratosis:0.864956 Dermatofibroma:0.771024 Vascular lesion:0.869306
Accus: Melanoma:0.445378 Melanocytic nevus:0.932127 Basal cell carcinoma:0.666667 Actinic keratosis:0.636364 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.579832 Melanocytic nevus:0.963801 Basal cell carcinoma:0.703704 Actinic keratosis:0.696970 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.920545 Melanocytic nevus:0.655786 Basal cell carcinoma:0.964059 Actinic keratosis:0.962771 Benign keratosis:0.934444 Dermatofibroma:0.990854 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [111.0, 1240.0, 77.0, 32.0, 135.0, 8.0, 27.0]

TEST Student: Epoch: 57, iteration: 86

TEST AUROC: 0.910958, TEST Accus: 0.645270, TEST Senss: 0.826694, TEST Specs: 0.870073
AUROCs: Melanoma:0.885878 Melanocytic nevus:0.933322 Basal cell carcinoma:0.971487 Actinic keratosis:0.931942 Benign keratosis:0.914074 Dermatofibroma:0.741025 Vascular lesion:0.998976
Accus: Melanoma:0.480519 Melanocytic nevus:0.919199 Basal cell carcinoma:0.700000 Actinic keratosis:0.551724 Benign keratosis:0.630841 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.766234 Melanocytic nevus:0.978503 Basal cell carcinoma:0.900000 Actinic keratosis:0.810345 Benign keratosis:0.831776 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.836883 Melanocytic nevus:0.555556 Basal cell carcinoma:0.929659 Actinic keratosis:0.948901 Benign keratosis:0.856191 Dermatofibroma:0.974912 Vascular lesion:0.988407
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_58.pth

Epoch: 58, iteration: 0/87, ==> train <===, loss: 1.807113, classification loss: 1.797006,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013147,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023254,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.218531234462264e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [54.0, 580.0, 39.0, 24.0, 60.0, 5.0, 12.0]

VAL Student: Epoch: 58, iteration: 86

VAL AUROC: 0.864956, VAL Accus: 0.641513, VAL Senss: 0.710504, VAL Specs: 0.922370
AUROCs: Melanoma:0.845401 Melanocytic nevus:0.938102 Basal cell carcinoma:0.932151 Actinic keratosis:0.964589 Benign keratosis:0.876811 Dermatofibroma:0.634019 Vascular lesion:0.863621
Accus: Melanoma:0.453782 Melanocytic nevus:0.874811 Basal cell carcinoma:0.722222 Actinic keratosis:0.727273 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.613445 Melanocytic nevus:0.924585 Basal cell carcinoma:0.814815 Actinic keratosis:0.818182 Benign keratosis:0.690000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.893303 Melanocytic nevus:0.783383 Basal cell carcinoma:0.932347 Actinic keratosis:0.951396 Benign keratosis:0.914444 Dermatofibroma:0.989837 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [121.0, 1161.0, 92.0, 40.0, 128.0, 7.0, 27.0]

TEST Student: Epoch: 58, iteration: 86

TEST AUROC: 0.904606, TEST Accus: 0.671107, TEST Senss: 0.834139, TEST Specs: 0.876416
AUROCs: Melanoma:0.869550 Melanocytic nevus:0.936269 Basal cell carcinoma:0.971162 Actinic keratosis:0.930374 Benign keratosis:0.901057 Dermatofibroma:0.725129 Vascular lesion:0.998699
Accus: Melanoma:0.523810 Melanocytic nevus:0.860638 Basal cell carcinoma:0.836364 Actinic keratosis:0.689655 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.805195 Melanocytic nevus:0.951816 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.806614 Melanocytic nevus:0.725225 Basal cell carcinoma:0.881365 Actinic keratosis:0.928462 Benign keratosis:0.838978 Dermatofibroma:0.970898 Vascular lesion:0.983367
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_59.pth

Epoch: 59, iteration: 0/87, ==> train <===, loss: 1.829529, classification loss: 1.810484,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012125,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.031171,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.9966781110160376e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 537.0, 37.0, 22.0, 65.0, 5.0, 12.0]

VAL Student: Epoch: 59, iteration: 86

VAL AUROC: 0.849000, VAL Accus: 0.626642, VAL Senss: 0.698297, VAL Specs: 0.923413
AUROCs: Melanoma:0.850142 Melanocytic nevus:0.930180 Basal cell carcinoma:0.913476 Actinic keratosis:0.917207 Benign keratosis:0.878044 Dermatofibroma:0.599466 Vascular lesion:0.854484
Accus: Melanoma:0.462185 Melanocytic nevus:0.809955 Basal cell carcinoma:0.685185 Actinic keratosis:0.666667 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.655462 Melanocytic nevus:0.885370 Basal cell carcinoma:0.777778 Actinic keratosis:0.696970 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.889898 Melanocytic nevus:0.836795 Basal cell carcinoma:0.934461 Actinic keratosis:0.938987 Benign keratosis:0.880000 Dermatofibroma:0.990854 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [123.0, 1103.0, 93.0, 39.0, 146.0, 7.0, 27.0]

TEST Student: Epoch: 59, iteration: 86

TEST AUROC: 0.899751, TEST Accus: 0.677053, TEST Senss: 0.815889, TEST Specs: 0.874141
AUROCs: Melanoma:0.871401 Melanocytic nevus:0.936289 Basal cell carcinoma:0.967597 Actinic keratosis:0.917458 Benign keratosis:0.904440 Dermatofibroma:0.702618 Vascular lesion:0.998455
Accus: Melanoma:0.532468 Melanocytic nevus:0.817643 Basal cell carcinoma:0.845455 Actinic keratosis:0.672414 Benign keratosis:0.682243 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.809524 Melanocytic nevus:0.924388 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.873832 Dermatofibroma:0.363636 Vascular lesion:0.967742
Specs: Melanoma:0.795404 Melanocytic nevus:0.791291 Basal cell carcinoma:0.883990 Actinic keratosis:0.906490 Benign keratosis:0.779012 Dermatofibroma:0.977421 Vascular lesion:0.985383
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_60.pth

Epoch: 60, iteration: 0/87, ==> train <===, loss: 1.791568, classification loss: 1.787620,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013209,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017157,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.7970102999144338e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [82.0, 565.0, 38.0, 17.0, 43.0, 5.0, 12.0]

VAL Student: Epoch: 60, iteration: 86

VAL AUROC: 0.851153, VAL Accus: 0.614660, VAL Senss: 0.681771, VAL Specs: 0.914296
AUROCs: Melanoma:0.889879 Melanocytic nevus:0.942309 Basal cell carcinoma:0.929058 Actinic keratosis:0.825515 Benign keratosis:0.865567 Dermatofibroma:0.631161 Vascular lesion:0.874585
Accus: Melanoma:0.689076 Melanocytic nevus:0.852187 Basal cell carcinoma:0.703704 Actinic keratosis:0.515152 Benign keratosis:0.430000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.806723 Melanocytic nevus:0.938160 Basal cell carcinoma:0.759259 Actinic keratosis:0.575758 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.784336 Melanocytic nevus:0.753709 Basal cell carcinoma:0.951374 Actinic keratosis:0.979317 Benign keratosis:0.945556 Dermatofibroma:0.993902 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [173.0, 1140.0, 89.0, 25.0, 109.0, 7.0, 27.0]

TEST Student: Epoch: 60, iteration: 86

TEST AUROC: 0.904654, TEST Accus: 0.647516, TEST Senss: 0.805115, TEST Specs: 0.865124
AUROCs: Melanoma:0.896504 Melanocytic nevus:0.939017 Basal cell carcinoma:0.976955 Actinic keratosis:0.893274 Benign keratosis:0.899505 Dermatofibroma:0.729303 Vascular lesion:0.998016
Accus: Melanoma:0.748918 Melanocytic nevus:0.845070 Basal cell carcinoma:0.809091 Actinic keratosis:0.431034 Benign keratosis:0.509346 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.930736 Melanocytic nevus:0.962194 Basal cell carcinoma:0.927273 Actinic keratosis:0.672414 Benign keratosis:0.766355 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.656951 Melanocytic nevus:0.681682 Basal cell carcinoma:0.906037 Actinic keratosis:0.963720 Benign keratosis:0.875625 Dermatofibroma:0.982940 Vascular lesion:0.988911
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_61.pth

Epoch: 61, iteration: 0/87, ==> train <===, loss: 1.848091, classification loss: 1.836247,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012672,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024515,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.6173092699229905e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [59.0, 596.0, 35.0, 21.0, 61.0, 5.0, 10.0]

VAL Student: Epoch: 61, iteration: 86

VAL AUROC: 0.860849, VAL Accus: 0.609774, VAL Senss: 0.693481, VAL Specs: 0.920001
AUROCs: Melanoma:0.858574 Melanocytic nevus:0.941561 Basal cell carcinoma:0.919662 Actinic keratosis:0.924164 Benign keratosis:0.885011 Dermatofibroma:0.630843 Vascular lesion:0.866125
Accus: Melanoma:0.495798 Melanocytic nevus:0.898944 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.655462 Melanocytic nevus:0.947210 Basal cell carcinoma:0.722222 Actinic keratosis:0.696970 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.894438 Melanocytic nevus:0.735905 Basal cell carcinoma:0.954545 Actinic keratosis:0.962771 Benign keratosis:0.905556 Dermatofibroma:0.991870 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 1188.0, 81.0, 34.0, 137.0, 7.0, 26.0]

TEST Student: Epoch: 61, iteration: 86

TEST AUROC: 0.909815, TEST Accus: 0.651249, TEST Senss: 0.825967, TEST Specs: 0.868980
AUROCs: Melanoma:0.887376 Melanocytic nevus:0.937426 Basal cell carcinoma:0.970608 Actinic keratosis:0.924163 Benign keratosis:0.911417 Dermatofibroma:0.739908 Vascular lesion:0.997805
Accus: Melanoma:0.558442 Melanocytic nevus:0.880652 Basal cell carcinoma:0.736364 Actinic keratosis:0.586207 Benign keratosis:0.640187 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.822511 Melanocytic nevus:0.967383 Basal cell carcinoma:0.890909 Actinic keratosis:0.810345 Benign keratosis:0.855140 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.795964 Melanocytic nevus:0.650150 Basal cell carcinoma:0.918110 Actinic keratosis:0.941237 Benign keratosis:0.809550 Dermatofibroma:0.976417 Vascular lesion:0.991431
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_62.pth

Epoch: 62, iteration: 0/87, ==> train <===, loss: 1.823842, classification loss: 1.811868,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013362,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025336,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.4555783429306916e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [57.0, 593.0, 37.0, 21.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 62, iteration: 86

VAL AUROC: 0.869991, VAL Accus: 0.622494, VAL Senss: 0.698796, VAL Specs: 0.918824
AUROCs: Melanoma:0.857343 Melanocytic nevus:0.939892 Basal cell carcinoma:0.928510 Actinic keratosis:0.939143 Benign keratosis:0.868311 Dermatofibroma:0.683371 Vascular lesion:0.873367
Accus: Melanoma:0.478992 Melanocytic nevus:0.894419 Basal cell carcinoma:0.685185 Actinic keratosis:0.636364 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.939668 Basal cell carcinoma:0.759259 Actinic keratosis:0.696970 Benign keratosis:0.640000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.896708 Melanocytic nevus:0.729970 Basal cell carcinoma:0.946089 Actinic keratosis:0.959669 Benign keratosis:0.927778 Dermatofibroma:0.983740 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [130.0, 1191.0, 87.0, 33.0, 126.0, 7.0, 28.0]

TEST Student: Epoch: 62, iteration: 86

TEST AUROC: 0.907488, TEST Accus: 0.659388, TEST Senss: 0.831656, TEST Specs: 0.866959
AUROCs: Melanoma:0.883090 Melanocytic nevus:0.934533 Basal cell carcinoma:0.969907 Actinic keratosis:0.926947 Benign keratosis:0.907782 Dermatofibroma:0.731264 Vascular lesion:0.998894
Accus: Melanoma:0.562771 Melanocytic nevus:0.882876 Basal cell carcinoma:0.790909 Actinic keratosis:0.568966 Benign keratosis:0.588785 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.805195 Melanocytic nevus:0.969607 Basal cell carcinoma:0.900000 Actinic keratosis:0.810345 Benign keratosis:0.836449 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.804933 Melanocytic nevus:0.642643 Basal cell carcinoma:0.897638 Actinic keratosis:0.939704 Benign keratosis:0.845641 Dermatofibroma:0.966382 Vascular lesion:0.971774
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_63.pth

Epoch: 63, iteration: 0/87, ==> train <===, loss: 1.793960, classification loss: 1.788105,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013526,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019382,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.3100205086376224e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 603.0, 35.0, 21.0, 52.0, 5.0, 12.0]

VAL Student: Epoch: 63, iteration: 86

VAL AUROC: 0.872538, VAL Accus: 0.613872, VAL Senss: 0.693307, VAL Specs: 0.920651
AUROCs: Melanoma:0.860567 Melanocytic nevus:0.938872 Basal cell carcinoma:0.925495 Actinic keratosis:0.952054 Benign keratosis:0.861033 Dermatofibroma:0.695630 Vascular lesion:0.874112
Accus: Melanoma:0.470588 Melanocytic nevus:0.909502 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.941176 Basal cell carcinoma:0.740741 Actinic keratosis:0.757576 Benign keratosis:0.600000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.906924 Melanocytic nevus:0.724036 Basal cell carcinoma:0.945032 Actinic keratosis:0.961737 Benign keratosis:0.932222 Dermatofibroma:0.989837 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [122.0, 1205.0, 87.0, 35.0, 127.0, 8.0, 28.0]

TEST Student: Epoch: 63, iteration: 86

TEST AUROC: 0.910289, TEST Accus: 0.668010, TEST Senss: 0.835850, TEST Specs: 0.869501
AUROCs: Melanoma:0.885162 Melanocytic nevus:0.936914 Basal cell carcinoma:0.973395 Actinic keratosis:0.927167 Benign keratosis:0.910878 Dermatofibroma:0.739680 Vascular lesion:0.998829
Accus: Melanoma:0.528139 Melanocytic nevus:0.893254 Basal cell carcinoma:0.790909 Actinic keratosis:0.603448 Benign keratosis:0.593458 Dermatofibroma:0.363636 Vascular lesion:0.903226
Senss: Melanoma:0.800866 Melanocytic nevus:0.968125 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.827103 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.808296 Melanocytic nevus:0.645646 Basal cell carcinoma:0.894488 Actinic keratosis:0.936127 Benign keratosis:0.851749 Dermatofibroma:0.978424 Vascular lesion:0.971774
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_64.pth

Epoch: 64, iteration: 0/87, ==> train <===, loss: 1.785373, classification loss: 1.782749,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013104,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015728,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.1790184577738602e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 598.0, 35.0, 22.0, 44.0, 5.0, 12.0]

VAL Student: Epoch: 64, iteration: 86

VAL AUROC: 0.866283, VAL Accus: 0.621301, VAL Senss: 0.692284, VAL Specs: 0.917648
AUROCs: Melanoma:0.880760 Melanocytic nevus:0.940492 Basal cell carcinoma:0.925808 Actinic keratosis:0.949861 Benign keratosis:0.862422 Dermatofibroma:0.627414 Vascular lesion:0.877225
Accus: Melanoma:0.579832 Melanocytic nevus:0.901961 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.739496 Melanocytic nevus:0.944193 Basal cell carcinoma:0.722222 Actinic keratosis:0.757576 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.864926 Melanocytic nevus:0.715134 Basal cell carcinoma:0.953488 Actinic keratosis:0.959669 Benign keratosis:0.945556 Dermatofibroma:0.990854 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1196.0, 86.0, 35.0, 109.0, 6.0, 27.0]

TEST Student: Epoch: 64, iteration: 86

TEST AUROC: 0.911763, TEST Accus: 0.649752, TEST Senss: 0.822557, TEST Specs: 0.869867
AUROCs: Melanoma:0.893585 Melanocytic nevus:0.939649 Basal cell carcinoma:0.974331 Actinic keratosis:0.933369 Benign keratosis:0.903021 Dermatofibroma:0.739589 Vascular lesion:0.998797
Accus: Melanoma:0.623377 Melanocytic nevus:0.886583 Basal cell carcinoma:0.781818 Actinic keratosis:0.603448 Benign keratosis:0.509346 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.878788 Melanocytic nevus:0.970348 Basal cell carcinoma:0.890909 Actinic keratosis:0.793103 Benign keratosis:0.757009 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.747758 Melanocytic nevus:0.636637 Basal cell carcinoma:0.916010 Actinic keratosis:0.939193 Benign keratosis:0.880622 Dermatofibroma:0.978424 Vascular lesion:0.990423
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_65.pth

Epoch: 65, iteration: 0/87, ==> train <===, loss: 1.820057, classification loss: 1.811435,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013558,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022179,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0611166119964742e-07
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 585.0, 33.0, 23.0, 47.0, 5.0, 12.0]

VAL Student: Epoch: 65, iteration: 86

VAL AUROC: 0.878051, VAL Accus: 0.615821, VAL Senss: 0.701832, VAL Specs: 0.919769
AUROCs: Melanoma:0.855817 Melanocytic nevus:0.940152 Basal cell carcinoma:0.922716 Actinic keratosis:0.968412 Benign keratosis:0.853311 Dermatofibroma:0.734883 Vascular lesion:0.871066
Accus: Melanoma:0.537815 Melanocytic nevus:0.882353 Basal cell carcinoma:0.611111 Actinic keratosis:0.696970 Benign keratosis:0.470000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.938160 Basal cell carcinoma:0.703704 Actinic keratosis:0.848485 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.872872 Melanocytic nevus:0.750742 Basal cell carcinoma:0.956660 Actinic keratosis:0.943123 Benign keratosis:0.944444 Dermatofibroma:0.982724 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [139.0, 1165.0, 81.0, 41.0, 110.0, 9.0, 28.0]

TEST Student: Epoch: 65, iteration: 86

TEST AUROC: 0.908345, TEST Accus: 0.676419, TEST Senss: 0.825744, TEST Specs: 0.871755
AUROCs: Melanoma:0.879683 Melanocytic nevus:0.936523 Basal cell carcinoma:0.968666 Actinic keratosis:0.939228 Benign keratosis:0.893618 Dermatofibroma:0.742029 Vascular lesion:0.998667
Accus: Melanoma:0.601732 Melanocytic nevus:0.863603 Basal cell carcinoma:0.736364 Actinic keratosis:0.706897 Benign keratosis:0.514019 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.831169 Melanocytic nevus:0.960712 Basal cell carcinoma:0.881818 Actinic keratosis:0.844828 Benign keratosis:0.761682 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.769058 Melanocytic nevus:0.696697 Basal cell carcinoma:0.911811 Actinic keratosis:0.912110 Benign keratosis:0.878956 Dermatofibroma:0.958856 Vascular lesion:0.974798
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_66.pth

Epoch: 66, iteration: 0/87, ==> train <===, loss: 1.799850, classification loss: 1.789205,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013486,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024130,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.550049507968268e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [70.0, 577.0, 39.0, 20.0, 52.0, 5.0, 11.0]

VAL Student: Epoch: 66, iteration: 86

VAL AUROC: 0.865908, VAL Accus: 0.621805, VAL Senss: 0.695432, VAL Specs: 0.914352
AUROCs: Melanoma:0.871508 Melanocytic nevus:0.942054 Basal cell carcinoma:0.942115 Actinic keratosis:0.936856 Benign keratosis:0.871622 Dermatofibroma:0.616933 Vascular lesion:0.880271
Accus: Melanoma:0.588235 Melanocytic nevus:0.870287 Basal cell carcinoma:0.722222 Actinic keratosis:0.606061 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Senss: Melanoma:0.764706 Melanocytic nevus:0.938160 Basal cell carcinoma:0.796296 Actinic keratosis:0.636364 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.838820 Melanocytic nevus:0.747774 Basal cell carcinoma:0.932347 Actinic keratosis:0.963806 Benign keratosis:0.928889 Dermatofibroma:0.993902 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [147.0, 1159.0, 93.0, 31.0, 118.0, 7.0, 24.0]

TEST Student: Epoch: 66, iteration: 86

TEST AUROC: 0.911586, TEST Accus: 0.645605, TEST Senss: 0.808798, TEST Specs: 0.861756
AUROCs: Melanoma:0.889288 Melanocytic nevus:0.938891 Basal cell carcinoma:0.974956 Actinic keratosis:0.932867 Benign keratosis:0.902759 Dermatofibroma:0.745541 Vascular lesion:0.996797
Accus: Melanoma:0.636364 Melanocytic nevus:0.859155 Basal cell carcinoma:0.845455 Actinic keratosis:0.534483 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:0.774194
Senss: Melanoma:0.896104 Melanocytic nevus:0.964418 Basal cell carcinoma:0.936364 Actinic keratosis:0.775862 Benign keratosis:0.789720 Dermatofibroma:0.363636 Vascular lesion:0.935484
Specs: Melanoma:0.714686 Melanocytic nevus:0.666667 Basal cell carcinoma:0.876115 Actinic keratosis:0.944303 Benign keratosis:0.855636 Dermatofibroma:0.980432 Vascular lesion:0.994456
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_67.pth

Epoch: 67, iteration: 0/87, ==> train <===, loss: 1.800873, classification loss: 1.785502,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013753,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029124,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.595044557171442e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 588.0, 33.0, 21.0, 52.0, 5.0, 12.0]

VAL Student: Epoch: 67, iteration: 86

VAL AUROC: 0.857630, VAL Accus: 0.617353, VAL Senss: 0.687339, VAL Specs: 0.917855
AUROCs: Melanoma:0.870697 Melanocytic nevus:0.940715 Basal cell carcinoma:0.919583 Actinic keratosis:0.870264 Benign keratosis:0.868878 Dermatofibroma:0.658346 Vascular lesion:0.874924
Accus: Melanoma:0.554622 Melanocytic nevus:0.886878 Basal cell carcinoma:0.611111 Actinic keratosis:0.636364 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.714286 Melanocytic nevus:0.945701 Basal cell carcinoma:0.722222 Actinic keratosis:0.666667 Benign keratosis:0.650000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.851305 Melanocytic nevus:0.724036 Basal cell carcinoma:0.959831 Actinic keratosis:0.965874 Benign keratosis:0.942222 Dermatofibroma:0.991870 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [146.0, 1189.0, 81.0, 31.0, 125.0, 7.0, 28.0]

TEST Student: Epoch: 67, iteration: 86

TEST AUROC: 0.905850, TEST Accus: 0.655685, TEST Senss: 0.826253, TEST Specs: 0.870029
AUROCs: Melanoma:0.887555 Melanocytic nevus:0.935573 Basal cell carcinoma:0.974021 Actinic keratosis:0.919987 Benign keratosis:0.902834 Dermatofibroma:0.721890 Vascular lesion:0.999089
Accus: Melanoma:0.632035 Melanocytic nevus:0.881394 Basal cell carcinoma:0.736364 Actinic keratosis:0.534483 Benign keratosis:0.584112 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.878788 Melanocytic nevus:0.971090 Basal cell carcinoma:0.909091 Actinic keratosis:0.775862 Benign keratosis:0.794393 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.741592 Melanocytic nevus:0.641141 Basal cell carcinoma:0.925459 Actinic keratosis:0.954011 Benign keratosis:0.871738 Dermatofibroma:0.975916 Vascular lesion:0.980343
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_68.pth

Epoch: 68, iteration: 0/87, ==> train <===, loss: 1.797062, classification loss: 1.787411,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013225,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022876,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.735540101454298e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 573.0, 37.0, 20.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 68, iteration: 86

VAL AUROC: 0.860295, VAL Accus: 0.630771, VAL Senss: 0.699798, VAL Specs: 0.918009
AUROCs: Melanoma:0.848873 Melanocytic nevus:0.939874 Basal cell carcinoma:0.922226 Actinic keratosis:0.904892 Benign keratosis:0.889356 Dermatofibroma:0.643610 Vascular lesion:0.873232
Accus: Melanoma:0.487395 Melanocytic nevus:0.864253 Basal cell carcinoma:0.685185 Actinic keratosis:0.606061 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.647059 Melanocytic nevus:0.924585 Basal cell carcinoma:0.777778 Actinic keratosis:0.666667 Benign keratosis:0.770000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.880817 Melanocytic nevus:0.771513 Basal cell carcinoma:0.943975 Actinic keratosis:0.960703 Benign keratosis:0.894444 Dermatofibroma:0.988821 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [125.0, 1156.0, 88.0, 32.0, 139.0, 7.0, 27.0]

TEST Student: Epoch: 68, iteration: 86

TEST AUROC: 0.904959, TEST Accus: 0.655495, TEST Senss: 0.831645, TEST Specs: 0.865471
AUROCs: Melanoma:0.878091 Melanocytic nevus:0.935103 Basal cell carcinoma:0.970136 Actinic keratosis:0.918269 Benign keratosis:0.908672 Dermatofibroma:0.725745 Vascular lesion:0.998699
Accus: Melanoma:0.541126 Melanocytic nevus:0.856931 Basal cell carcinoma:0.800000 Actinic keratosis:0.551724 Benign keratosis:0.649533 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.826840 Melanocytic nevus:0.955523 Basal cell carcinoma:0.936364 Actinic keratosis:0.793103 Benign keratosis:0.855140 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.783632 Melanocytic nevus:0.699700 Basal cell carcinoma:0.895538 Actinic keratosis:0.940726 Benign keratosis:0.794003 Dermatofibroma:0.968891 Vascular lesion:0.975806
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_69.pth

Epoch: 69, iteration: 0/87, ==> train <===, loss: 1.789653, classification loss: 1.781960,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012813,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.020506,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.961986091308869e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 578.0, 35.0, 22.0, 57.0, 5.0, 12.0]

VAL Student: Epoch: 69, iteration: 86

VAL AUROC: 0.857843, VAL Accus: 0.625959, VAL Senss: 0.693765, VAL Specs: 0.922275
AUROCs: Melanoma:0.849426 Melanocytic nevus:0.937113 Basal cell carcinoma:0.925789 Actinic keratosis:0.921250 Benign keratosis:0.867522 Dermatofibroma:0.636052 Vascular lesion:0.867750
Accus: Melanoma:0.512605 Melanocytic nevus:0.871795 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.570000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.918552 Basal cell carcinoma:0.759259 Actinic keratosis:0.696970 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.878547 Melanocytic nevus:0.783383 Basal cell carcinoma:0.949260 Actinic keratosis:0.946225 Benign keratosis:0.930000 Dermatofibroma:0.982724 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [134.0, 1155.0, 86.0, 42.0, 125.0, 7.0, 29.0]

TEST Student: Epoch: 69, iteration: 86

TEST AUROC: 0.904003, TEST Accus: 0.682859, TEST Senss: 0.829530, TEST Specs: 0.872368
AUROCs: Melanoma:0.875942 Melanocytic nevus:0.933835 Basal cell carcinoma:0.966552 Actinic keratosis:0.928673 Benign keratosis:0.898395 Dermatofibroma:0.726087 Vascular lesion:0.998537
Accus: Melanoma:0.580087 Melanocytic nevus:0.856190 Basal cell carcinoma:0.781818 Actinic keratosis:0.724138 Benign keratosis:0.584112 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.818182 Melanocytic nevus:0.948110 Basal cell carcinoma:0.909091 Actinic keratosis:0.827586 Benign keratosis:0.803738 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.785314 Melanocytic nevus:0.716216 Basal cell carcinoma:0.903412 Actinic keratosis:0.917220 Benign keratosis:0.846752 Dermatofibroma:0.963874 Vascular lesion:0.973790
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_70.pth

Epoch: 70, iteration: 0/87, ==> train <===, loss: 1.789846, classification loss: 1.785373,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012955,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017428,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.265787482177982e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [52.0, 594.0, 35.0, 23.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 70, iteration: 86

VAL AUROC: 0.886391, VAL Accus: 0.620074, VAL Senss: 0.679853, VAL Specs: 0.921939
AUROCs: Melanoma:0.853738 Melanocytic nevus:0.939758 Basal cell carcinoma:0.919583 Actinic keratosis:0.966939 Benign keratosis:0.867267 Dermatofibroma:0.781314 Vascular lesion:0.876142
Accus: Melanoma:0.436975 Melanocytic nevus:0.895928 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.588235 Melanocytic nevus:0.936652 Basal cell carcinoma:0.703704 Actinic keratosis:0.787879 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.910329 Melanocytic nevus:0.759644 Basal cell carcinoma:0.951374 Actinic keratosis:0.944157 Benign keratosis:0.926667 Dermatofibroma:0.980691 Vascular lesion:0.980711
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [114.0, 1184.0, 87.0, 40.0, 127.0, 9.0, 31.0]

TEST Student: Epoch: 70, iteration: 86

TEST AUROC: 0.908192, TEST Accus: 0.693472, TEST Senss: 0.832894, TEST Specs: 0.872434
AUROCs: Melanoma:0.876682 Melanocytic nevus:0.936749 Basal cell carcinoma:0.966080 Actinic keratosis:0.937025 Benign keratosis:0.903610 Dermatofibroma:0.738289 Vascular lesion:0.998911
Accus: Melanoma:0.493506 Melanocytic nevus:0.877687 Basal cell carcinoma:0.790909 Actinic keratosis:0.689655 Benign keratosis:0.593458 Dermatofibroma:0.409091 Vascular lesion:1.000000
Senss: Melanoma:0.761905 Melanocytic nevus:0.962194 Basal cell carcinoma:0.909091 Actinic keratosis:0.879310 Benign keratosis:0.817757 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.826794 Melanocytic nevus:0.681682 Basal cell carcinoma:0.903937 Actinic keratosis:0.914665 Benign keratosis:0.852860 Dermatofibroma:0.958354 Vascular lesion:0.968750
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_71.pth

Epoch: 71, iteration: 0/87, ==> train <===, loss: 1.851761, classification loss: 1.843220,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013788,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022330,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.6392087339601844e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 610.0, 34.0, 21.0, 50.0, 5.0, 12.0]

VAL Student: Epoch: 71, iteration: 86

VAL AUROC: 0.863261, VAL Accus: 0.617080, VAL Senss: 0.696394, VAL Specs: 0.912286
AUROCs: Melanoma:0.875571 Melanocytic nevus:0.942457 Basal cell carcinoma:0.910931 Actinic keratosis:0.957726 Benign keratosis:0.864644 Dermatofibroma:0.626588 Vascular lesion:0.864907
Accus: Melanoma:0.521008 Melanocytic nevus:0.920060 Basal cell carcinoma:0.629630 Actinic keratosis:0.636364 Benign keratosis:0.500000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.963801 Basal cell carcinoma:0.703704 Actinic keratosis:0.727273 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.869467 Melanocytic nevus:0.664688 Basal cell carcinoma:0.964059 Actinic keratosis:0.967942 Benign keratosis:0.930000 Dermatofibroma:0.994919 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [136.0, 1226.0, 79.0, 33.0, 125.0, 6.0, 26.0]

TEST Student: Epoch: 71, iteration: 86

TEST AUROC: 0.912083, TEST Accus: 0.640037, TEST Senss: 0.817390, TEST Specs: 0.854121
AUROCs: Melanoma:0.896118 Melanocytic nevus:0.936828 Basal cell carcinoma:0.975395 Actinic keratosis:0.935951 Benign keratosis:0.911612 Dermatofibroma:0.730625 Vascular lesion:0.998049
Accus: Melanoma:0.588745 Melanocytic nevus:0.908821 Basal cell carcinoma:0.718182 Actinic keratosis:0.568966 Benign keratosis:0.584112 Dermatofibroma:0.272727 Vascular lesion:0.838710
Senss: Melanoma:0.883117 Melanocytic nevus:0.978503 Basal cell carcinoma:0.900000 Actinic keratosis:0.793103 Benign keratosis:0.822430 Dermatofibroma:0.409091 Vascular lesion:0.935484
Specs: Melanoma:0.733744 Melanocytic nevus:0.528529 Basal cell carcinoma:0.932808 Actinic keratosis:0.952478 Benign keratosis:0.853415 Dermatofibroma:0.988460 Vascular lesion:0.989415
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_72.pth

Epoch: 72, iteration: 0/87, ==> train <===, loss: 1.794840, classification loss: 1.784027,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013512,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024325,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.075287860564166e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 573.0, 36.0, 22.0, 49.0, 5.0, 10.0]

VAL Student: Epoch: 72, iteration: 86

VAL AUROC: 0.875746, VAL Accus: 0.597051, VAL Senss: 0.709306, VAL Specs: 0.915201
AUROCs: Melanoma:0.857877 Melanocytic nevus:0.941275 Basal cell carcinoma:0.924360 Actinic keratosis:0.953245 Benign keratosis:0.866722 Dermatofibroma:0.700584 Vascular lesion:0.886159
Accus: Melanoma:0.512605 Melanocytic nevus:0.864253 Basal cell carcinoma:0.666667 Actinic keratosis:0.666667 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.747899 Melanocytic nevus:0.927602 Basal cell carcinoma:0.759259 Actinic keratosis:0.787879 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.853575 Melanocytic nevus:0.759644 Basal cell carcinoma:0.936575 Actinic keratosis:0.950362 Benign keratosis:0.925556 Dermatofibroma:0.985772 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [141.0, 1152.0, 90.0, 36.0, 120.0, 7.0, 26.0]

TEST Student: Epoch: 72, iteration: 86

TEST AUROC: 0.910228, TEST Accus: 0.660124, TEST Senss: 0.828525, TEST Specs: 0.867687
AUROCs: Melanoma:0.883037 Melanocytic nevus:0.939250 Basal cell carcinoma:0.975123 Actinic keratosis:0.925722 Benign keratosis:0.899796 Dermatofibroma:0.750832 Vascular lesion:0.997838
Accus: Melanoma:0.610390 Melanocytic nevus:0.853966 Basal cell carcinoma:0.818182 Actinic keratosis:0.620690 Benign keratosis:0.560748 Dermatofibroma:0.318182 Vascular lesion:0.838710
Senss: Melanoma:0.865801 Melanocytic nevus:0.961453 Basal cell carcinoma:0.918182 Actinic keratosis:0.810345 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:0.935484
Specs: Melanoma:0.743834 Melanocytic nevus:0.705706 Basal cell carcinoma:0.891339 Actinic keratosis:0.928462 Benign keratosis:0.845641 Dermatofibroma:0.964877 Vascular lesion:0.993952
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_73.pth

Epoch: 73, iteration: 0/87, ==> train <===, loss: 1.811106, classification loss: 1.807676,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013421,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.016851,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.567759074507749e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 597.0, 34.0, 23.0, 44.0, 5.0, 12.0]

VAL Student: Epoch: 73, iteration: 86

VAL AUROC: 0.868000, VAL Accus: 0.619168, VAL Senss: 0.685660, VAL Specs: 0.919470
AUROCs: Melanoma:0.876229 Melanocytic nevus:0.942922 Basal cell carcinoma:0.920993 Actinic keratosis:0.948983 Benign keratosis:0.854511 Dermatofibroma:0.665015 Vascular lesion:0.867343
Accus: Melanoma:0.554622 Melanocytic nevus:0.900452 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.440000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.941176 Basal cell carcinoma:0.666667 Actinic keratosis:0.818182 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.856981 Melanocytic nevus:0.741840 Basal cell carcinoma:0.959831 Actinic keratosis:0.945191 Benign keratosis:0.946667 Dermatofibroma:0.993902 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [144.0, 1179.0, 83.0, 42.0, 114.0, 7.0, 27.0]

TEST Student: Epoch: 73, iteration: 86

TEST AUROC: 0.911381, TEST Accus: 0.671129, TEST Senss: 0.825651, TEST Specs: 0.871762
AUROCs: Melanoma:0.890302 Melanocytic nevus:0.939720 Basal cell carcinoma:0.969592 Actinic keratosis:0.941307 Benign keratosis:0.905320 Dermatofibroma:0.734480 Vascular lesion:0.998943
Accus: Melanoma:0.623377 Melanocytic nevus:0.873981 Basal cell carcinoma:0.754545 Actinic keratosis:0.724138 Benign keratosis:0.532710 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.874459 Melanocytic nevus:0.966642 Basal cell carcinoma:0.872727 Actinic keratosis:0.844828 Benign keratosis:0.766355 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.747758 Melanocytic nevus:0.665165 Basal cell carcinoma:0.926509 Actinic keratosis:0.917220 Benign keratosis:0.877846 Dermatofibroma:0.979930 Vascular lesion:0.987903
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_74.pth

Epoch: 74, iteration: 0/87, ==> train <===, loss: 1.836271, classification loss: 1.824059,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013315,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025527,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.1109831670569744e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [57.0, 567.0, 36.0, 22.0, 67.0, 5.0, 12.0]

VAL Student: Epoch: 74, iteration: 86

VAL AUROC: 0.866269, VAL Accus: 0.635718, VAL Senss: 0.698820, VAL Specs: 0.921136
AUROCs: Melanoma:0.845182 Melanocytic nevus:0.941454 Basal cell carcinoma:0.930487 Actinic keratosis:0.958854 Benign keratosis:0.889244 Dermatofibroma:0.629764 Vascular lesion:0.868900
Accus: Melanoma:0.478992 Melanocytic nevus:0.855204 Basal cell carcinoma:0.666667 Actinic keratosis:0.666667 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.655462 Melanocytic nevus:0.924585 Basal cell carcinoma:0.722222 Actinic keratosis:0.696970 Benign keratosis:0.780000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.875142 Melanocytic nevus:0.807122 Basal cell carcinoma:0.951374 Actinic keratosis:0.951396 Benign keratosis:0.882222 Dermatofibroma:0.987805 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 1133.0, 84.0, 38.0, 143.0, 7.0, 27.0]

TEST Student: Epoch: 74, iteration: 86

TEST AUROC: 0.903188, TEST Accus: 0.667787, TEST Senss: 0.828175, TEST Specs: 0.869370
AUROCs: Melanoma:0.872338 Melanocytic nevus:0.937025 Basal cell carcinoma:0.969649 Actinic keratosis:0.928004 Benign keratosis:0.907471 Dermatofibroma:0.708936 Vascular lesion:0.998894
Accus: Melanoma:0.558442 Melanocytic nevus:0.839881 Basal cell carcinoma:0.763636 Actinic keratosis:0.655172 Benign keratosis:0.668224 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.839827 Melanocytic nevus:0.951816 Basal cell carcinoma:0.909091 Actinic keratosis:0.827586 Benign keratosis:0.859813 Dermatofibroma:0.409091 Vascular lesion:1.000000
Specs: Melanoma:0.771300 Melanocytic nevus:0.735736 Basal cell carcinoma:0.905512 Actinic keratosis:0.928462 Benign keratosis:0.786785 Dermatofibroma:0.970898 Vascular lesion:0.986895
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_75.pth

Epoch: 75, iteration: 0/87, ==> train <===, loss: 1.786371, classification loss: 1.782354,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013431,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017448,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.699884850351277e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 560.0, 38.0, 23.0, 64.0, 5.0, 12.0]

VAL Student: Epoch: 75, iteration: 86

VAL AUROC: 0.859165, VAL Accus: 0.645547, VAL Senss: 0.702248, VAL Specs: 0.921987
AUROCs: Melanoma:0.849588 Melanocytic nevus:0.939516 Basal cell carcinoma:0.924301 Actinic keratosis:0.905268 Benign keratosis:0.886111 Dermatofibroma:0.635734 Vascular lesion:0.873638
Accus: Melanoma:0.521008 Melanocytic nevus:0.844646 Basal cell carcinoma:0.703704 Actinic keratosis:0.696970 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.911011 Basal cell carcinoma:0.777778 Actinic keratosis:0.696970 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.863791 Melanocytic nevus:0.807122 Basal cell carcinoma:0.941860 Actinic keratosis:0.949328 Benign keratosis:0.911111 Dermatofibroma:0.986789 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [138.0, 1134.0, 87.0, 38.0, 130.0, 7.0, 27.0]

TEST Student: Epoch: 75, iteration: 86

TEST AUROC: 0.903437, TEST Accus: 0.668676, TEST Senss: 0.828545, TEST Specs: 0.871054
AUROCs: Melanoma:0.877657 Melanocytic nevus:0.935453 Basal cell carcinoma:0.967702 Actinic keratosis:0.917846 Benign keratosis:0.900961 Dermatofibroma:0.726360 Vascular lesion:0.998081
Accus: Melanoma:0.597403 Melanocytic nevus:0.840623 Basal cell carcinoma:0.790909 Actinic keratosis:0.655172 Benign keratosis:0.607477 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.848485 Melanocytic nevus:0.945886 Basal cell carcinoma:0.936364 Actinic keratosis:0.810345 Benign keratosis:0.836449 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.758969 Melanocytic nevus:0.747748 Basal cell carcinoma:0.897638 Actinic keratosis:0.924885 Benign keratosis:0.817879 Dermatofibroma:0.964375 Vascular lesion:0.985887
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_76.pth

Epoch: 76, iteration: 0/87, ==> train <===, loss: 1.810904, classification loss: 1.801797,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012874,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.021981,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.3298963653161496e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 599.0, 36.0, 21.0, 59.0, 5.0, 12.0]

VAL Student: Epoch: 76, iteration: 86

VAL AUROC: 0.866898, VAL Accus: 0.628056, VAL Senss: 0.702170, VAL Specs: 0.917712
AUROCs: Melanoma:0.865107 Melanocytic nevus:0.941257 Basal cell carcinoma:0.916393 Actinic keratosis:0.933565 Benign keratosis:0.874489 Dermatofibroma:0.667492 Vascular lesion:0.869983
Accus: Melanoma:0.487395 Melanocytic nevus:0.903469 Basal cell carcinoma:0.666667 Actinic keratosis:0.636364 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.672269 Melanocytic nevus:0.944193 Basal cell carcinoma:0.759259 Actinic keratosis:0.696970 Benign keratosis:0.730000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.895573 Melanocytic nevus:0.721068 Basal cell carcinoma:0.953488 Actinic keratosis:0.962771 Benign keratosis:0.914444 Dermatofibroma:0.986789 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [127.0, 1190.0, 84.0, 32.0, 135.0, 8.0, 27.0]

TEST Student: Epoch: 76, iteration: 86

TEST AUROC: 0.909519, TEST Accus: 0.658961, TEST Senss: 0.841240, TEST Specs: 0.864801
AUROCs: Melanoma:0.886167 Melanocytic nevus:0.937911 Basal cell carcinoma:0.969392 Actinic keratosis:0.928911 Benign keratosis:0.909344 Dermatofibroma:0.736076 Vascular lesion:0.998829
Accus: Melanoma:0.549784 Melanocytic nevus:0.882135 Basal cell carcinoma:0.763636 Actinic keratosis:0.551724 Benign keratosis:0.630841 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.839827 Melanocytic nevus:0.969607 Basal cell carcinoma:0.909091 Actinic keratosis:0.810345 Benign keratosis:0.859813 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.792601 Melanocytic nevus:0.642643 Basal cell carcinoma:0.910761 Actinic keratosis:0.946857 Benign keratosis:0.808995 Dermatofibroma:0.969393 Vascular lesion:0.982359
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_77.pth

Epoch: 77, iteration: 0/87, ==> train <===, loss: 1.799364, classification loss: 1.789699,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012805,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022470,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.996906728784535e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 535.0, 37.0, 23.0, 58.0, 5.0, 10.0]

VAL Student: Epoch: 77, iteration: 86

VAL AUROC: 0.856673, VAL Accus: 0.608695, VAL Senss: 0.698384, VAL Specs: 0.917521
AUROCs: Melanoma:0.844810 Melanocytic nevus:0.937162 Basal cell carcinoma:0.927061 Actinic keratosis:0.954686 Benign keratosis:0.873422 Dermatofibroma:0.602515 Vascular lesion:0.857056
Accus: Melanoma:0.512605 Melanocytic nevus:0.806938 Basal cell carcinoma:0.685185 Actinic keratosis:0.696970 Benign keratosis:0.580000 Dermatofibroma:0.312500 Vascular lesion:0.666667
Senss: Melanoma:0.714286 Melanocytic nevus:0.892911 Basal cell carcinoma:0.777778 Actinic keratosis:0.787879 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.733333
Specs: Melanoma:0.843360 Melanocytic nevus:0.830861 Basal cell carcinoma:0.922833 Actinic keratosis:0.926577 Benign keratosis:0.912222 Dermatofibroma:0.991870 Vascular lesion:0.994924
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1093.0, 93.0, 44.0, 126.0, 7.0, 23.0]

TEST Student: Epoch: 77, iteration: 86

TEST AUROC: 0.897695, TEST Accus: 0.667038, TEST Senss: 0.802527, TEST Specs: 0.864019
AUROCs: Melanoma:0.864922 Melanocytic nevus:0.936306 Basal cell carcinoma:0.966996 Actinic keratosis:0.927325 Benign keratosis:0.888494 Dermatofibroma:0.702550 Vascular lesion:0.997268
Accus: Melanoma:0.606061 Melanocytic nevus:0.810230 Basal cell carcinoma:0.845455 Actinic keratosis:0.758621 Benign keratosis:0.588785 Dermatofibroma:0.318182 Vascular lesion:0.741935
Senss: Melanoma:0.844156 Melanocytic nevus:0.935508 Basal cell carcinoma:0.927273 Actinic keratosis:0.844828 Benign keratosis:0.799065 Dermatofibroma:0.363636 Vascular lesion:0.903226
Specs: Melanoma:0.719170 Melanocytic nevus:0.776276 Basal cell carcinoma:0.858793 Actinic keratosis:0.892182 Benign keratosis:0.827318 Dermatofibroma:0.978424 Vascular lesion:0.995968
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_78.pth

Epoch: 78, iteration: 0/87, ==> train <===, loss: 1.820118, classification loss: 1.807468,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012660,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025310,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.6972160559060813e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [65.0, 582.0, 36.0, 23.0, 53.0, 5.0, 12.0]

VAL Student: Epoch: 78, iteration: 86

VAL AUROC: 0.882627, VAL Accus: 0.632883, VAL Senss: 0.698031, VAL Specs: 0.923048
AUROCs: Melanoma:0.877441 Melanocytic nevus:0.941136 Basal cell carcinoma:0.925378 Actinic keratosis:0.967691 Benign keratosis:0.875411 Dermatofibroma:0.715193 Vascular lesion:0.876142
Accus: Melanoma:0.546218 Melanocytic nevus:0.877828 Basal cell carcinoma:0.666667 Actinic keratosis:0.696970 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.926094 Basal cell carcinoma:0.759259 Actinic keratosis:0.727273 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.870602 Melanocytic nevus:0.780415 Basal cell carcinoma:0.945032 Actinic keratosis:0.959669 Benign keratosis:0.930000 Dermatofibroma:0.986789 Vascular lesion:0.988832
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [140.0, 1156.0, 91.0, 37.0, 123.0, 7.0, 28.0]

TEST Student: Epoch: 78, iteration: 86

TEST AUROC: 0.909653, TEST Accus: 0.674910, TEST Senss: 0.837621, TEST Specs: 0.873635
AUROCs: Melanoma:0.883522 Melanocytic nevus:0.938887 Basal cell carcinoma:0.970322 Actinic keratosis:0.931246 Benign keratosis:0.905860 Dermatofibroma:0.739064 Vascular lesion:0.998667
Accus: Melanoma:0.606061 Melanocytic nevus:0.856931 Basal cell carcinoma:0.827273 Actinic keratosis:0.637931 Benign keratosis:0.574766 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.848485 Melanocytic nevus:0.956264 Basal cell carcinoma:0.927273 Actinic keratosis:0.827586 Benign keratosis:0.803738 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.767377 Melanocytic nevus:0.717718 Basal cell carcinoma:0.899213 Actinic keratosis:0.933061 Benign keratosis:0.858412 Dermatofibroma:0.966382 Vascular lesion:0.973286
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_79.pth

Epoch: 79, iteration: 0/87, ==> train <===, loss: 1.794141, classification loss: 1.798005,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013826,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.009962,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.4274944503154732e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 581.0, 35.0, 23.0, 60.0, 5.0, 12.0]

VAL Student: Epoch: 79, iteration: 86

VAL AUROC: 0.872921, VAL Accus: 0.629218, VAL Senss: 0.695499, VAL Specs: 0.921169
AUROCs: Melanoma:0.840355 Melanocytic nevus:0.935774 Basal cell carcinoma:0.923968 Actinic keratosis:0.960797 Benign keratosis:0.871178 Dermatofibroma:0.711573 Vascular lesion:0.866802
Accus: Melanoma:0.470588 Melanocytic nevus:0.876320 Basal cell carcinoma:0.648148 Actinic keratosis:0.696970 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.647059 Melanocytic nevus:0.930618 Basal cell carcinoma:0.740741 Actinic keratosis:0.757576 Benign keratosis:0.680000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.900114 Melanocytic nevus:0.762611 Basal cell carcinoma:0.949260 Actinic keratosis:0.938987 Benign keratosis:0.926667 Dermatofibroma:0.988821 Vascular lesion:0.981726
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [118.0, 1168.0, 86.0, 44.0, 128.0, 7.0, 28.0]

TEST Student: Epoch: 79, iteration: 86

TEST AUROC: 0.904484, TEST Accus: 0.676661, TEST Senss: 0.825357, TEST Specs: 0.872849
AUROCs: Melanoma:0.867288 Melanocytic nevus:0.934283 Basal cell carcinoma:0.965359 Actinic keratosis:0.938224 Benign keratosis:0.899718 Dermatofibroma:0.727866 Vascular lesion:0.998650
Accus: Melanoma:0.510823 Melanocytic nevus:0.865827 Basal cell carcinoma:0.781818 Actinic keratosis:0.758621 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.766234 Melanocytic nevus:0.954040 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.822430 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.808857 Melanocytic nevus:0.701201 Basal cell carcinoma:0.906037 Actinic keratosis:0.903935 Benign keratosis:0.841199 Dermatofibroma:0.972403 Vascular lesion:0.976310
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_80.pth

Epoch: 80, iteration: 0/87, ==> train <===, loss: 1.828102, classification loss: 1.815693,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013590,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.025999,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.184745005283926e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [50.0, 593.0, 36.0, 26.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 80, iteration: 86

VAL AUROC: 0.889671, VAL Accus: 0.627376, VAL Senss: 0.695897, VAL Specs: 0.920741
AUROCs: Melanoma:0.846612 Melanocytic nevus:0.937556 Basal cell carcinoma:0.922461 Actinic keratosis:0.966657 Benign keratosis:0.861000 Dermatofibroma:0.820249 Vascular lesion:0.873164
Accus: Melanoma:0.420168 Melanocytic nevus:0.894419 Basal cell carcinoma:0.666667 Actinic keratosis:0.787879 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.613445 Melanocytic nevus:0.932127 Basal cell carcinoma:0.722222 Actinic keratosis:0.848485 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.912599 Melanocytic nevus:0.750742 Basal cell carcinoma:0.935518 Actinic keratosis:0.930714 Benign keratosis:0.940000 Dermatofibroma:0.981707 Vascular lesion:0.993909
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [110.0, 1189.0, 91.0, 44.0, 119.0, 9.0, 27.0]

TEST Student: Epoch: 80, iteration: 86

TEST AUROC: 0.908241, TEST Accus: 0.682802, TEST Senss: 0.822741, TEST Specs: 0.869989
AUROCs: Melanoma:0.871496 Melanocytic nevus:0.934179 Basal cell carcinoma:0.968618 Actinic keratosis:0.935995 Benign keratosis:0.899459 Dermatofibroma:0.749190 Vascular lesion:0.998748
Accus: Melanoma:0.476190 Melanocytic nevus:0.881394 Basal cell carcinoma:0.827273 Actinic keratosis:0.758621 Benign keratosis:0.556075 Dermatofibroma:0.409091 Vascular lesion:0.870968
Senss: Melanoma:0.757576 Melanocytic nevus:0.959229 Basal cell carcinoma:0.918182 Actinic keratosis:0.862069 Benign keratosis:0.794393 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.820067 Melanocytic nevus:0.681682 Basal cell carcinoma:0.890814 Actinic keratosis:0.889116 Benign keratosis:0.858967 Dermatofibroma:0.958856 Vascular lesion:0.990423
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_81.pth

Epoch: 81, iteration: 0/87, ==> train <===, loss: 1.802070, classification loss: 1.806292,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013337,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.009115,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.9662705047555335e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [78.0, 568.0, 32.0, 20.0, 49.0, 5.0, 12.0]

VAL Student: Epoch: 81, iteration: 86

VAL AUROC: 0.854676, VAL Accus: 0.616190, VAL Senss: 0.687660, VAL Specs: 0.914877
AUROCs: Melanoma:0.877212 Melanocytic nevus:0.942730 Basal cell carcinoma:0.901417 Actinic keratosis:0.913980 Benign keratosis:0.857167 Dermatofibroma:0.625254 Vascular lesion:0.864975
Accus: Melanoma:0.655462 Melanocytic nevus:0.856712 Basal cell carcinoma:0.592593 Actinic keratosis:0.606061 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.815126 Melanocytic nevus:0.941176 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.799092 Melanocytic nevus:0.762611 Basal cell carcinoma:0.969345 Actinic keratosis:0.962771 Benign keratosis:0.925556 Dermatofibroma:0.993902 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [165.0, 1137.0, 78.0, 35.0, 118.0, 7.0, 27.0]

TEST Student: Epoch: 81, iteration: 86

TEST AUROC: 0.906380, TEST Accus: 0.658603, TEST Senss: 0.819128, TEST Specs: 0.863820
AUROCs: Melanoma:0.891265 Melanocytic nevus:0.939718 Basal cell carcinoma:0.967163 Actinic keratosis:0.927149 Benign keratosis:0.895798 Dermatofibroma:0.724946 Vascular lesion:0.998618
Accus: Melanoma:0.714286 Melanocytic nevus:0.842847 Basal cell carcinoma:0.709091 Actinic keratosis:0.603448 Benign keratosis:0.551402 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.930736 Melanocytic nevus:0.962194 Basal cell carcinoma:0.854545 Actinic keratosis:0.793103 Benign keratosis:0.771028 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.649664 Melanocytic nevus:0.681682 Basal cell carcinoma:0.945407 Actinic keratosis:0.948901 Benign keratosis:0.851749 Dermatofibroma:0.981937 Vascular lesion:0.987399
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_82.pth

Epoch: 82, iteration: 0/87, ==> train <===, loss: 1.803607, classification loss: 1.799905,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013661,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.017364,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.7696434542799804e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 604.0, 27.0, 26.0, 48.0, 5.0, 12.0]

VAL Student: Epoch: 82, iteration: 86

VAL AUROC: 0.866959, VAL Accus: 0.616057, VAL Senss: 0.679904, VAL Specs: 0.916073
AUROCs: Melanoma:0.870163 Melanocytic nevus:0.941105 Basal cell carcinoma:0.860465 Actinic keratosis:0.974711 Benign keratosis:0.859989 Dermatofibroma:0.694868 Vascular lesion:0.867411
Accus: Melanoma:0.521008 Melanocytic nevus:0.911011 Basal cell carcinoma:0.500000 Actinic keratosis:0.787879 Benign keratosis:0.480000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.947210 Basal cell carcinoma:0.555556 Actinic keratosis:0.818182 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.871737 Melanocytic nevus:0.697329 Basal cell carcinoma:0.979915 Actinic keratosis:0.953464 Benign keratosis:0.934444 Dermatofibroma:0.988821 Vascular lesion:0.986802
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1207.0, 73.0, 41.0, 120.0, 9.0, 28.0]

TEST Student: Epoch: 82, iteration: 86

TEST AUROC: 0.908221, TEST Accus: 0.673442, TEST Senss: 0.831388, TEST Specs: 0.866170
AUROCs: Melanoma:0.887194 Melanocytic nevus:0.935448 Basal cell carcinoma:0.960377 Actinic keratosis:0.940928 Benign keratosis:0.902391 Dermatofibroma:0.732313 Vascular lesion:0.998894
Accus: Melanoma:0.575758 Melanocytic nevus:0.894737 Basal cell carcinoma:0.663636 Actinic keratosis:0.706897 Benign keratosis:0.560748 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.861472 Melanocytic nevus:0.973314 Basal cell carcinoma:0.836364 Actinic keratosis:0.844828 Benign keratosis:0.803738 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.765135 Melanocytic nevus:0.597598 Basal cell carcinoma:0.959580 Actinic keratosis:0.933572 Benign keratosis:0.865630 Dermatofibroma:0.968891 Vascular lesion:0.972782
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_83.pth

Epoch: 83, iteration: 0/87, ==> train <===, loss: 1.795144, classification loss: 1.784391,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013947,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.024700,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.5926791088519824e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 585.0, 36.0, 20.0, 59.0, 5.0, 12.0]

VAL Student: Epoch: 83, iteration: 86

VAL AUROC: 0.857418, VAL Accus: 0.625513, VAL Senss: 0.691448, VAL Specs: 0.919783
AUROCs: Melanoma:0.867711 Melanocytic nevus:0.940935 Basal cell carcinoma:0.918350 Actinic keratosis:0.927987 Benign keratosis:0.874222 Dermatofibroma:0.612551 Vascular lesion:0.860169
Accus: Melanoma:0.521008 Melanocytic nevus:0.882353 Basal cell carcinoma:0.666667 Actinic keratosis:0.606061 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.689076 Melanocytic nevus:0.939668 Basal cell carcinoma:0.722222 Actinic keratosis:0.666667 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.876277 Melanocytic nevus:0.744807 Basal cell carcinoma:0.956660 Actinic keratosis:0.960703 Benign keratosis:0.912222 Dermatofibroma:0.994919 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1177.0, 84.0, 37.0, 128.0, 7.0, 27.0]

TEST Student: Epoch: 83, iteration: 86

TEST AUROC: 0.906115, TEST Accus: 0.662443, TEST Senss: 0.817114, TEST Specs: 0.875139
AUROCs: Melanoma:0.888339 Melanocytic nevus:0.939184 Basal cell carcinoma:0.970628 Actinic keratosis:0.918260 Benign keratosis:0.907629 Dermatofibroma:0.719792 Vascular lesion:0.998976
Accus: Melanoma:0.575758 Melanocytic nevus:0.872498 Basal cell carcinoma:0.763636 Actinic keratosis:0.637931 Benign keratosis:0.598131 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.852814 Melanocytic nevus:0.965901 Basal cell carcinoma:0.900000 Actinic keratosis:0.810345 Benign keratosis:0.827103 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.771300 Melanocytic nevus:0.692192 Basal cell carcinoma:0.920210 Actinic keratosis:0.945835 Benign keratosis:0.825097 Dermatofibroma:0.984947 Vascular lesion:0.986391
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_84.pth

Epoch: 84, iteration: 0/87, ==> train <===, loss: 1.799584, classification loss: 1.783598,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013427,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029412,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.4334111979667841e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [57.0, 619.0, 28.0, 24.0, 45.0, 5.0, 12.0]

VAL Student: Epoch: 84, iteration: 86

VAL AUROC: 0.866209, VAL Accus: 0.602988, VAL Senss: 0.671289, VAL Specs: 0.911844
AUROCs: Melanoma:0.869133 Melanocytic nevus:0.940532 Basal cell carcinoma:0.868413 Actinic keratosis:0.973927 Benign keratosis:0.839933 Dermatofibroma:0.700457 Vascular lesion:0.871066
Accus: Melanoma:0.478992 Melanocytic nevus:0.933635 Basal cell carcinoma:0.518519 Actinic keratosis:0.727273 Benign keratosis:0.450000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.965309 Basal cell carcinoma:0.574074 Actinic keratosis:0.848485 Benign keratosis:0.560000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.904654 Melanocytic nevus:0.626113 Basal cell carcinoma:0.972516 Actinic keratosis:0.953464 Benign keratosis:0.944444 Dermatofibroma:0.993902 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [116.0, 1246.0, 73.0, 41.0, 121.0, 6.0, 29.0]

TEST Student: Epoch: 84, iteration: 86

TEST AUROC: 0.910195, TEST Accus: 0.652854, TEST Senss: 0.822113, TEST Specs: 0.866122
AUROCs: Melanoma:0.889479 Melanocytic nevus:0.935732 Basal cell carcinoma:0.962873 Actinic keratosis:0.941281 Benign keratosis:0.911513 Dermatofibroma:0.731629 Vascular lesion:0.998862
Accus: Melanoma:0.502165 Melanocytic nevus:0.923647 Basal cell carcinoma:0.663636 Actinic keratosis:0.706897 Benign keratosis:0.565421 Dermatofibroma:0.272727 Vascular lesion:0.935484
Senss: Melanoma:0.831169 Melanocytic nevus:0.979985 Basal cell carcinoma:0.854545 Actinic keratosis:0.844828 Benign keratosis:0.789720 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.803812 Melanocytic nevus:0.545045 Basal cell carcinoma:0.945407 Actinic keratosis:0.936127 Benign keratosis:0.876735 Dermatofibroma:0.981937 Vascular lesion:0.973790
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_85.pth

Epoch: 85, iteration: 0/87, ==> train <===, loss: 1.811871, classification loss: 1.796275,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013723,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.029320,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.2900700781701057e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 582.0, 38.0, 22.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 85, iteration: 86

VAL AUROC: 0.849566, VAL Accus: 0.644013, VAL Senss: 0.700394, VAL Specs: 0.917862
AUROCs: Melanoma:0.848959 Melanocytic nevus:0.941360 Basal cell carcinoma:0.931505 Actinic keratosis:0.908151 Benign keratosis:0.879578 Dermatofibroma:0.582317 Vascular lesion:0.855093
Accus: Melanoma:0.487395 Melanocytic nevus:0.877828 Basal cell carcinoma:0.703704 Actinic keratosis:0.666667 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.621849 Melanocytic nevus:0.935143 Basal cell carcinoma:0.796296 Actinic keratosis:0.696970 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.887628 Melanocytic nevus:0.747774 Basal cell carcinoma:0.936575 Actinic keratosis:0.960703 Benign keratosis:0.905556 Dermatofibroma:0.994919 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [125.0, 1169.0, 85.0, 32.0, 135.0, 7.0, 27.0]

TEST Student: Epoch: 85, iteration: 86

TEST AUROC: 0.902795, TEST Accus: 0.650305, TEST Senss: 0.823052, TEST Specs: 0.866195
AUROCs: Melanoma:0.877812 Melanocytic nevus:0.936534 Basal cell carcinoma:0.968556 Actinic keratosis:0.922788 Benign keratosis:0.907064 Dermatofibroma:0.708160 Vascular lesion:0.998650
Accus: Melanoma:0.541126 Melanocytic nevus:0.866568 Basal cell carcinoma:0.772727 Actinic keratosis:0.551724 Benign keratosis:0.630841 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.818182 Melanocytic nevus:0.960712 Basal cell carcinoma:0.945455 Actinic keratosis:0.827586 Benign keratosis:0.845794 Dermatofibroma:0.363636 Vascular lesion:1.000000
Specs: Melanoma:0.793161 Melanocytic nevus:0.681682 Basal cell carcinoma:0.884514 Actinic keratosis:0.935616 Benign keratosis:0.805108 Dermatofibroma:0.983442 Vascular lesion:0.979839
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_86.pth

Epoch: 86, iteration: 0/87, ==> train <===, loss: 1.793342, classification loss: 1.790291,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012634,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.015685,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.1610630703530951e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [56.0, 609.0, 36.0, 20.0, 50.0, 6.0, 12.0]

VAL Student: Epoch: 86, iteration: 86

VAL AUROC: 0.890396, VAL Accus: 0.619553, VAL Senss: 0.672557, VAL Specs: 0.916006
AUROCs: Melanoma:0.864049 Melanocytic nevus:0.938348 Basal cell carcinoma:0.937006 Actinic keratosis:0.931058 Benign keratosis:0.865778 Dermatofibroma:0.817073 Vascular lesion:0.879459
Accus: Melanoma:0.470588 Melanocytic nevus:0.918552 Basal cell carcinoma:0.666667 Actinic keratosis:0.606061 Benign keratosis:0.500000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.621849 Melanocytic nevus:0.947210 Basal cell carcinoma:0.777778 Actinic keratosis:0.606061 Benign keratosis:0.580000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.912599 Melanocytic nevus:0.688427 Basal cell carcinoma:0.930233 Actinic keratosis:0.977249 Benign keratosis:0.941111 Dermatofibroma:0.986789 Vascular lesion:0.975635
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [117.0, 1223.0, 92.0, 23.0, 121.0, 7.0, 31.0]

TEST Student: Epoch: 86, iteration: 86

TEST AUROC: 0.911056, TEST Accus: 0.647087, TEST Senss: 0.820248, TEST Specs: 0.871707
AUROCs: Melanoma:0.888021 Melanocytic nevus:0.935119 Basal cell carcinoma:0.974145 Actinic keratosis:0.921449 Benign keratosis:0.913062 Dermatofibroma:0.746636 Vascular lesion:0.998959
Accus: Melanoma:0.506494 Melanocytic nevus:0.906597 Basal cell carcinoma:0.836364 Actinic keratosis:0.396552 Benign keratosis:0.565421 Dermatofibroma:0.318182 Vascular lesion:1.000000
Senss: Melanoma:0.783550 Melanocytic nevus:0.971090 Basal cell carcinoma:0.954545 Actinic keratosis:0.724138 Benign keratosis:0.808411 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.825112 Melanocytic nevus:0.626126 Basal cell carcinoma:0.882940 Actinic keratosis:0.958099 Benign keratosis:0.875069 Dermatofibroma:0.971400 Vascular lesion:0.963206
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_87.pth

Epoch: 87, iteration: 0/87, ==> train <===, loss: 1.820435, classification loss: 1.823245,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013388,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.010578,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 1.0449567633177856e-08
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [69.0, 556.0, 39.0, 20.0, 61.0, 5.0, 12.0]

VAL Student: Epoch: 87, iteration: 86

VAL AUROC: 0.851004, VAL Accus: 0.638461, VAL Senss: 0.705921, VAL Specs: 0.919915
AUROCs: Melanoma:0.863247 Melanocytic nevus:0.937036 Basal cell carcinoma:0.928941 Actinic keratosis:0.874463 Benign keratosis:0.883744 Dermatofibroma:0.625064 Vascular lesion:0.844535
Accus: Melanoma:0.579832 Melanocytic nevus:0.838612 Basal cell carcinoma:0.722222 Actinic keratosis:0.606061 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.739496 Melanocytic nevus:0.906486 Basal cell carcinoma:0.796296 Actinic keratosis:0.666667 Benign keratosis:0.720000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.843360 Melanocytic nevus:0.801187 Basal cell carcinoma:0.941860 Actinic keratosis:0.955533 Benign keratosis:0.917778 Dermatofibroma:0.991870 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1126.0, 90.0, 32.0, 132.0, 7.0, 27.0]

TEST Student: Epoch: 87, iteration: 86

TEST AUROC: 0.901239, TEST Accus: 0.661374, TEST Senss: 0.811008, TEST Specs: 0.864126
AUROCs: Melanoma:0.882132 Melanocytic nevus:0.933019 Basal cell carcinoma:0.968199 Actinic keratosis:0.908771 Benign keratosis:0.901366 Dermatofibroma:0.716941 Vascular lesion:0.998244
Accus: Melanoma:0.619048 Melanocytic nevus:0.834692 Basal cell carcinoma:0.818182 Actinic keratosis:0.551724 Benign keratosis:0.616822 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.883117 Melanocytic nevus:0.945145 Basal cell carcinoma:0.936364 Actinic keratosis:0.758621 Benign keratosis:0.822430 Dermatofibroma:0.363636 Vascular lesion:0.967742
Specs: Melanoma:0.713004 Melanocytic nevus:0.738739 Basal cell carcinoma:0.885564 Actinic keratosis:0.933061 Benign keratosis:0.821766 Dermatofibroma:0.978424 Vascular lesion:0.978327
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_88.pth

Epoch: 88, iteration: 0/87, ==> train <===, loss: 1.794908, classification loss: 1.793715,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013292,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.014485,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 9.40461086986007e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 579.0, 28.0, 23.0, 60.0, 5.0, 12.0]

VAL Student: Epoch: 88, iteration: 86

VAL AUROC: 0.873279, VAL Accus: 0.617471, VAL Senss: 0.690705, VAL Specs: 0.922610
AUROCs: Melanoma:0.861588 Melanocytic nevus:0.938173 Basal cell carcinoma:0.913045 Actinic keratosis:0.968412 Benign keratosis:0.875789 Dermatofibroma:0.687182 Vascular lesion:0.868765
Accus: Melanoma:0.521008 Melanocytic nevus:0.873303 Basal cell carcinoma:0.518519 Actinic keratosis:0.696970 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.680672 Melanocytic nevus:0.923077 Basal cell carcinoma:0.611111 Actinic keratosis:0.757576 Benign keratosis:0.750000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.884222 Melanocytic nevus:0.786350 Basal cell carcinoma:0.960888 Actinic keratosis:0.943123 Benign keratosis:0.911111 Dermatofibroma:0.984756 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [129.0, 1156.0, 79.0, 43.0, 136.0, 8.0, 27.0]

TEST Student: Epoch: 88, iteration: 86

TEST AUROC: 0.906585, TEST Accus: 0.677865, TEST Senss: 0.833434, TEST Specs: 0.869653
AUROCs: Melanoma:0.881091 Melanocytic nevus:0.936566 Basal cell carcinoma:0.965092 Actinic keratosis:0.929475 Benign keratosis:0.903070 Dermatofibroma:0.731971 Vascular lesion:0.998829
Accus: Melanoma:0.558442 Melanocytic nevus:0.856931 Basal cell carcinoma:0.718182 Actinic keratosis:0.741379 Benign keratosis:0.635514 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.809524 Melanocytic nevus:0.951816 Basal cell carcinoma:0.872727 Actinic keratosis:0.844828 Benign keratosis:0.855140 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.776906 Melanocytic nevus:0.723724 Basal cell carcinoma:0.932283 Actinic keratosis:0.907001 Benign keratosis:0.803443 Dermatofibroma:0.963874 Vascular lesion:0.980343
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_89.pth

Epoch: 89, iteration: 0/87, ==> train <===, loss: 1.790086, classification loss: 1.784763,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.014420,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019742,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 8.464149782874063e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [62.0, 574.0, 35.0, 21.0, 53.0, 5.0, 12.0]

VAL Student: Epoch: 89, iteration: 86

VAL AUROC: 0.868595, VAL Accus: 0.616255, VAL Senss: 0.691902, VAL Specs: 0.921481
AUROCs: Melanoma:0.868360 Melanocytic nevus:0.940854 Basal cell carcinoma:0.928686 Actinic keratosis:0.948638 Benign keratosis:0.863600 Dermatofibroma:0.653138 Vascular lesion:0.876887
Accus: Melanoma:0.521008 Melanocytic nevus:0.865762 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.530000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.739496 Melanocytic nevus:0.932127 Basal cell carcinoma:0.722222 Actinic keratosis:0.696970 Benign keratosis:0.640000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.858116 Melanocytic nevus:0.771513 Basal cell carcinoma:0.941860 Actinic keratosis:0.959669 Benign keratosis:0.934444 Dermatofibroma:0.992886 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [143.0, 1155.0, 88.0, 38.0, 121.0, 7.0, 27.0]

TEST Student: Epoch: 89, iteration: 86

TEST AUROC: 0.908519, TEST Accus: 0.669283, TEST Senss: 0.829387, TEST Specs: 0.870795
AUROCs: Melanoma:0.886525 Melanocytic nevus:0.938937 Basal cell carcinoma:0.971234 Actinic keratosis:0.930312 Benign keratosis:0.902300 Dermatofibroma:0.731834 Vascular lesion:0.998488
Accus: Melanoma:0.619048 Melanocytic nevus:0.856190 Basal cell carcinoma:0.800000 Actinic keratosis:0.655172 Benign keratosis:0.565421 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.874459 Melanocytic nevus:0.954781 Basal cell carcinoma:0.918182 Actinic keratosis:0.827586 Benign keratosis:0.808411 Dermatofibroma:0.454545 Vascular lesion:0.967742
Specs: Melanoma:0.737668 Melanocytic nevus:0.707207 Basal cell carcinoma:0.893438 Actinic keratosis:0.936638 Benign keratosis:0.857301 Dermatofibroma:0.975916 Vascular lesion:0.987399
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_90.pth

Epoch: 90, iteration: 0/87, ==> train <===, loss: 1.810334, classification loss: 1.787816,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012926,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.035444,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 7.617734804586658e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [74.0, 581.0, 33.0, 19.0, 43.0, 6.0, 12.0]

VAL Student: Epoch: 90, iteration: 86

VAL AUROC: 0.882141, VAL Accus: 0.612862, VAL Senss: 0.705231, VAL Specs: 0.917125
AUROCs: Melanoma:0.884184 Melanocytic nevus:0.941320 Basal cell carcinoma:0.921052 Actinic keratosis:0.940867 Benign keratosis:0.859500 Dermatofibroma:0.747523 Vascular lesion:0.880541
Accus: Melanoma:0.621849 Melanocytic nevus:0.876320 Basal cell carcinoma:0.611111 Actinic keratosis:0.575758 Benign keratosis:0.430000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.781513 Melanocytic nevus:0.935143 Basal cell carcinoma:0.685185 Actinic keratosis:0.727273 Benign keratosis:0.570000 Dermatofibroma:0.437500 Vascular lesion:0.800000
Specs: Melanoma:0.836549 Melanocytic nevus:0.747774 Basal cell carcinoma:0.958774 Actinic keratosis:0.964840 Benign keratosis:0.944444 Dermatofibroma:0.977642 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [154.0, 1164.0, 82.0, 35.0, 109.0, 9.0, 28.0]

TEST Student: Epoch: 90, iteration: 86

TEST AUROC: 0.909611, TEST Accus: 0.671442, TEST Senss: 0.823141, TEST Specs: 0.870894
AUROCs: Melanoma:0.891792 Melanocytic nevus:0.939243 Basal cell carcinoma:0.971677 Actinic keratosis:0.924136 Benign keratosis:0.896667 Dermatofibroma:0.744880 Vascular lesion:0.998878
Accus: Melanoma:0.666667 Melanocytic nevus:0.862861 Basal cell carcinoma:0.745455 Actinic keratosis:0.603448 Benign keratosis:0.509346 Dermatofibroma:0.409091 Vascular lesion:0.903226
Senss: Melanoma:0.904762 Melanocytic nevus:0.965901 Basal cell carcinoma:0.881818 Actinic keratosis:0.775862 Benign keratosis:0.733645 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.718049 Melanocytic nevus:0.683183 Basal cell carcinoma:0.928084 Actinic keratosis:0.945324 Benign keratosis:0.878401 Dermatofibroma:0.961867 Vascular lesion:0.981351
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_91.pth

Epoch: 91, iteration: 0/87, ==> train <===, loss: 1.804939, classification loss: 1.798985,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013130,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.019084,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.855961324127992e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [53.0, 613.0, 34.0, 21.0, 46.0, 6.0, 12.0]

VAL Student: Epoch: 91, iteration: 86

VAL AUROC: 0.881617, VAL Accus: 0.610137, VAL Senss: 0.691447, VAL Specs: 0.914328
AUROCs: Melanoma:0.865842 Melanocytic nevus:0.935501 Basal cell carcinoma:0.918703 Actinic keratosis:0.969446 Benign keratosis:0.835689 Dermatofibroma:0.768166 Vascular lesion:0.877970
Accus: Melanoma:0.445378 Melanocytic nevus:0.924585 Basal cell carcinoma:0.629630 Actinic keratosis:0.636364 Benign keratosis:0.460000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Senss: Melanoma:0.630252 Melanocytic nevus:0.956259 Basal cell carcinoma:0.740741 Actinic keratosis:0.787879 Benign keratosis:0.550000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.918275 Melanocytic nevus:0.646884 Basal cell carcinoma:0.954545 Actinic keratosis:0.959669 Benign keratosis:0.954444 Dermatofibroma:0.980691 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [111.0, 1237.0, 83.0, 35.0, 114.0, 9.0, 30.0]

TEST Student: Epoch: 91, iteration: 86

TEST AUROC: 0.909333, TEST Accus: 0.666433, TEST Senss: 0.813488, TEST Specs: 0.867459
AUROCs: Melanoma:0.883219 Melanocytic nevus:0.930905 Basal cell carcinoma:0.973018 Actinic keratosis:0.931440 Benign keratosis:0.903934 Dermatofibroma:0.743853 Vascular lesion:0.998959
Accus: Melanoma:0.480519 Melanocytic nevus:0.916976 Basal cell carcinoma:0.754545 Actinic keratosis:0.603448 Benign keratosis:0.532710 Dermatofibroma:0.409091 Vascular lesion:0.967742
Senss: Melanoma:0.774892 Melanocytic nevus:0.978503 Basal cell carcinoma:0.890909 Actinic keratosis:0.793103 Benign keratosis:0.757009 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.825673 Melanocytic nevus:0.570571 Basal cell carcinoma:0.914436 Actinic keratosis:0.938682 Benign keratosis:0.891727 Dermatofibroma:0.960863 Vascular lesion:0.970262
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_92.pth

Epoch: 92, iteration: 0/87, ==> train <===, loss: 1.798893, classification loss: 1.784928,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013910,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.027876,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 6.170365191715193e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [76.0, 572.0, 29.0, 18.0, 60.0, 5.0, 12.0]

VAL Student: Epoch: 92, iteration: 86

VAL AUROC: 0.846616, VAL Accus: 0.613770, VAL Senss: 0.684306, VAL Specs: 0.916789
AUROCs: Melanoma:0.887380 Melanocytic nevus:0.942175 Basal cell carcinoma:0.887871 Actinic keratosis:0.848328 Benign keratosis:0.880667 Dermatofibroma:0.601181 Vascular lesion:0.878714
Accus: Melanoma:0.638655 Melanocytic nevus:0.862745 Basal cell carcinoma:0.537037 Actinic keratosis:0.545455 Benign keratosis:0.600000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.798319 Melanocytic nevus:0.933635 Basal cell carcinoma:0.629630 Actinic keratosis:0.606061 Benign keratosis:0.710000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.813848 Melanocytic nevus:0.765579 Basal cell carcinoma:0.972516 Actinic keratosis:0.974147 Benign keratosis:0.906667 Dermatofibroma:0.993902 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [163.0, 1141.0, 73.0, 29.0, 130.0, 6.0, 27.0]

TEST Student: Epoch: 92, iteration: 86

TEST AUROC: 0.900542, TEST Accus: 0.638035, TEST Senss: 0.813363, TEST Specs: 0.870845
AUROCs: Melanoma:0.892282 Melanocytic nevus:0.938554 Basal cell carcinoma:0.965956 Actinic keratosis:0.904886 Benign keratosis:0.899474 Dermatofibroma:0.704055 Vascular lesion:0.998585
Accus: Melanoma:0.705628 Melanocytic nevus:0.845812 Basal cell carcinoma:0.663636 Actinic keratosis:0.500000 Benign keratosis:0.607477 Dermatofibroma:0.272727 Vascular lesion:0.870968
Senss: Melanoma:0.913420 Melanocytic nevus:0.954781 Basal cell carcinoma:0.872727 Actinic keratosis:0.689655 Benign keratosis:0.808411 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.683296 Melanocytic nevus:0.714715 Basal cell carcinoma:0.950656 Actinic keratosis:0.963720 Benign keratosis:0.821766 Dermatofibroma:0.984446 Vascular lesion:0.977319
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_93.pth

Epoch: 93, iteration: 0/87, ==> train <===, loss: 1.806821, classification loss: 1.791649,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013041,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.028214,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 5.553328672543673e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [61.0, 592.0, 30.0, 23.0, 63.0, 5.0, 12.0]

VAL Student: Epoch: 93, iteration: 86

VAL AUROC: 0.866132, VAL Accus: 0.628649, VAL Senss: 0.688805, VAL Specs: 0.918678
AUROCs: Melanoma:0.862046 Melanocytic nevus:0.943916 Basal cell carcinoma:0.898285 Actinic keratosis:0.942935 Benign keratosis:0.879833 Dermatofibroma:0.663491 Vascular lesion:0.872420
Accus: Melanoma:0.512605 Melanocytic nevus:0.892911 Basal cell carcinoma:0.555556 Actinic keratosis:0.696970 Benign keratosis:0.630000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.705882 Melanocytic nevus:0.936652 Basal cell carcinoma:0.629630 Actinic keratosis:0.696970 Benign keratosis:0.740000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.868331 Melanocytic nevus:0.756677 Basal cell carcinoma:0.971459 Actinic keratosis:0.954498 Benign keratosis:0.901111 Dermatofibroma:0.987805 Vascular lesion:0.990863
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [133.0, 1172.0, 74.0, 40.0, 140.0, 7.0, 27.0]

TEST Student: Epoch: 93, iteration: 86

TEST AUROC: 0.909076, TEST Accus: 0.664327, TEST Senss: 0.834097, TEST Specs: 0.868309
AUROCs: Melanoma:0.884704 Melanocytic nevus:0.937919 Basal cell carcinoma:0.965001 Actinic keratosis:0.930418 Benign keratosis:0.908493 Dermatofibroma:0.738083 Vascular lesion:0.998911
Accus: Melanoma:0.575758 Melanocytic nevus:0.868792 Basal cell carcinoma:0.672727 Actinic keratosis:0.689655 Benign keratosis:0.654206 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.865801 Melanocytic nevus:0.962194 Basal cell carcinoma:0.854545 Actinic keratosis:0.810345 Benign keratosis:0.845794 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.758969 Melanocytic nevus:0.674174 Basal cell carcinoma:0.953281 Actinic keratosis:0.933061 Benign keratosis:0.808440 Dermatofibroma:0.969393 Vascular lesion:0.980847
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_94.pth

Epoch: 94, iteration: 0/87, ==> train <===, loss: 1.807546, classification loss: 1.797737,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013292,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023101,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.997995805289306e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [75.0, 562.0, 35.0, 18.0, 49.0, 5.0, 12.0]

VAL Student: Epoch: 94, iteration: 86

VAL AUROC: 0.857280, VAL Accus: 0.610574, VAL Senss: 0.698691, VAL Specs: 0.919825
AUROCs: Melanoma:0.885424 Melanocytic nevus:0.941812 Basal cell carcinoma:0.917352 Actinic keratosis:0.907054 Benign keratosis:0.863967 Dermatofibroma:0.610899 Vascular lesion:0.874450
Accus: Melanoma:0.630252 Melanocytic nevus:0.847662 Basal cell carcinoma:0.648148 Actinic keratosis:0.545455 Benign keratosis:0.490000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.789916 Melanocytic nevus:0.911011 Basal cell carcinoma:0.740741 Actinic keratosis:0.666667 Benign keratosis:0.670000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.813848 Melanocytic nevus:0.801187 Basal cell carcinoma:0.953488 Actinic keratosis:0.963806 Benign keratosis:0.927778 Dermatofibroma:0.986789 Vascular lesion:0.991878
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [162.0, 1125.0, 86.0, 32.0, 119.0, 8.0, 27.0]

TEST Student: Epoch: 94, iteration: 86

TEST AUROC: 0.905887, TEST Accus: 0.665639, TEST Senss: 0.825907, TEST Specs: 0.874327
AUROCs: Melanoma:0.888630 Melanocytic nevus:0.938566 Basal cell carcinoma:0.968261 Actinic keratosis:0.920612 Benign keratosis:0.897118 Dermatofibroma:0.729759 Vascular lesion:0.998260
Accus: Melanoma:0.701299 Melanocytic nevus:0.833951 Basal cell carcinoma:0.781818 Actinic keratosis:0.551724 Benign keratosis:0.556075 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.913420 Melanocytic nevus:0.945145 Basal cell carcinoma:0.890909 Actinic keratosis:0.793103 Benign keratosis:0.771028 Dermatofibroma:0.500000 Vascular lesion:0.967742
Specs: Melanoma:0.699552 Melanocytic nevus:0.744745 Basal cell carcinoma:0.918635 Actinic keratosis:0.942770 Benign keratosis:0.857301 Dermatofibroma:0.970898 Vascular lesion:0.986391
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_95.pth

Epoch: 95, iteration: 0/87, ==> train <===, loss: 1.802883, classification loss: 1.794450,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013664,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.022097,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.498196224760376e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [58.0, 588.0, 39.0, 20.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 95, iteration: 86

VAL AUROC: 0.869417, VAL Accus: 0.617865, VAL Senss: 0.684224, VAL Specs: 0.917030
AUROCs: Melanoma:0.849264 Melanocytic nevus:0.937153 Basal cell carcinoma:0.942409 Actinic keratosis:0.936354 Benign keratosis:0.868261 Dermatofibroma:0.680196 Vascular lesion:0.872284
Accus: Melanoma:0.487395 Melanocytic nevus:0.886878 Basal cell carcinoma:0.722222 Actinic keratosis:0.606061 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.638655 Melanocytic nevus:0.935143 Basal cell carcinoma:0.796296 Actinic keratosis:0.696970 Benign keratosis:0.610000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.886493 Melanocytic nevus:0.724036 Basal cell carcinoma:0.935518 Actinic keratosis:0.959669 Benign keratosis:0.938889 Dermatofibroma:0.988821 Vascular lesion:0.985787
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [122.0, 1196.0, 90.0, 28.0, 117.0, 7.0, 29.0]

TEST Student: Epoch: 95, iteration: 86

TEST AUROC: 0.904366, TEST Accus: 0.645151, TEST Senss: 0.825367, TEST Specs: 0.868180
AUROCs: Melanoma:0.875248 Melanocytic nevus:0.933249 Basal cell carcinoma:0.974350 Actinic keratosis:0.917960 Benign keratosis:0.901086 Dermatofibroma:0.729645 Vascular lesion:0.999024
Accus: Melanoma:0.528139 Melanocytic nevus:0.886583 Basal cell carcinoma:0.818182 Actinic keratosis:0.482759 Benign keratosis:0.546729 Dermatofibroma:0.318182 Vascular lesion:0.935484
Senss: Melanoma:0.805195 Melanocytic nevus:0.967383 Basal cell carcinoma:0.936364 Actinic keratosis:0.810345 Benign keratosis:0.803738 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.795964 Melanocytic nevus:0.642643 Basal cell carcinoma:0.885564 Actinic keratosis:0.941237 Benign keratosis:0.871183 Dermatofibroma:0.967386 Vascular lesion:0.973286
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_96.pth

Epoch: 96, iteration: 0/87, ==> train <===, loss: 1.787505, classification loss: 1.788444,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013677,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012737,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 4.048376602284338e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [66.0, 573.0, 35.0, 22.0, 51.0, 5.0, 12.0]

VAL Student: Epoch: 96, iteration: 86

VAL AUROC: 0.852207, VAL Accus: 0.622313, VAL Senss: 0.692894, VAL Specs: 0.920207
AUROCs: Melanoma:0.863982 Melanocytic nevus:0.937157 Basal cell carcinoma:0.923694 Actinic keratosis:0.922378 Benign keratosis:0.859167 Dermatofibroma:0.604929 Vascular lesion:0.854146
Accus: Melanoma:0.554622 Melanocytic nevus:0.864253 Basal cell carcinoma:0.648148 Actinic keratosis:0.666667 Benign keratosis:0.510000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.747899 Melanocytic nevus:0.920060 Basal cell carcinoma:0.722222 Actinic keratosis:0.757576 Benign keratosis:0.590000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.860386 Melanocytic nevus:0.774481 Basal cell carcinoma:0.947146 Actinic keratosis:0.941055 Benign keratosis:0.936667 Dermatofibroma:0.988821 Vascular lesion:0.992893
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [142.0, 1162.0, 86.0, 45.0, 120.0, 7.0, 27.0]

TEST Student: Epoch: 96, iteration: 86

TEST AUROC: 0.904884, TEST Accus: 0.683382, TEST Senss: 0.813417, TEST Specs: 0.870212
AUROCs: Melanoma:0.883025 Melanocytic nevus:0.935750 Basal cell carcinoma:0.967029 Actinic keratosis:0.927008 Benign keratosis:0.895370 Dermatofibroma:0.727797 Vascular lesion:0.998211
Accus: Melanoma:0.614719 Melanocytic nevus:0.861379 Basal cell carcinoma:0.781818 Actinic keratosis:0.775862 Benign keratosis:0.560748 Dermatofibroma:0.318182 Vascular lesion:0.870968
Senss: Melanoma:0.861472 Melanocytic nevus:0.951816 Basal cell carcinoma:0.881818 Actinic keratosis:0.827586 Benign keratosis:0.794393 Dermatofibroma:0.409091 Vascular lesion:0.967742
Specs: Melanoma:0.743274 Melanocytic nevus:0.710210 Basal cell carcinoma:0.910761 Actinic keratosis:0.901380 Benign keratosis:0.859522 Dermatofibroma:0.975916 Vascular lesion:0.990423
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_97.pth

Epoch: 97, iteration: 0/87, ==> train <===, loss: 1.785316, classification loss: 1.785936,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012675,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.012055,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.6435389420559043e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 571.0, 32.0, 21.0, 66.0, 5.0, 12.0]

VAL Student: Epoch: 97, iteration: 86

VAL AUROC: 0.863753, VAL Accus: 0.628644, VAL Senss: 0.697421, VAL Specs: 0.922671
AUROCs: Melanoma:0.861197 Melanocytic nevus:0.940442 Basal cell carcinoma:0.915355 Actinic keratosis:0.919244 Benign keratosis:0.886678 Dermatofibroma:0.656822 Vascular lesion:0.866531
Accus: Melanoma:0.537815 Melanocytic nevus:0.861237 Basal cell carcinoma:0.592593 Actinic keratosis:0.636364 Benign keratosis:0.660000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.697479 Melanocytic nevus:0.923077 Basal cell carcinoma:0.722222 Actinic keratosis:0.666667 Benign keratosis:0.760000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.867196 Melanocytic nevus:0.798220 Basal cell carcinoma:0.957717 Actinic keratosis:0.958635 Benign keratosis:0.903333 Dermatofibroma:0.988821 Vascular lesion:0.984772
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [137.0, 1144.0, 85.0, 34.0, 138.0, 7.0, 28.0]

TEST Student: Epoch: 97, iteration: 86

TEST AUROC: 0.903406, TEST Accus: 0.666616, TEST Senss: 0.831435, TEST Specs: 0.871369
AUROCs: Melanoma:0.883799 Melanocytic nevus:0.935612 Basal cell carcinoma:0.964806 Actinic keratosis:0.917925 Benign keratosis:0.904220 Dermatofibroma:0.718720 Vascular lesion:0.998764
Accus: Melanoma:0.593074 Melanocytic nevus:0.848036 Basal cell carcinoma:0.772727 Actinic keratosis:0.586207 Benign keratosis:0.644860 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.857143 Melanocytic nevus:0.950334 Basal cell carcinoma:0.890909 Actinic keratosis:0.775862 Benign keratosis:0.845794 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.766816 Melanocytic nevus:0.726727 Basal cell carcinoma:0.923885 Actinic keratosis:0.939704 Benign keratosis:0.807329 Dermatofibroma:0.967888 Vascular lesion:0.967238
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_98.pth

Epoch: 98, iteration: 0/87, ==> train <===, loss: 1.790074, classification loss: 1.784027,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.012758,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.018805,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 3.279185047850314e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [55.0, 610.0, 35.0, 21.0, 52.0, 5.0, 12.0]

VAL Student: Epoch: 98, iteration: 86

VAL AUROC: 0.868262, VAL Accus: 0.614180, VAL Senss: 0.687380, VAL Specs: 0.918675
AUROCs: Melanoma:0.864669 Melanocytic nevus:0.939829 Basal cell carcinoma:0.920856 Actinic keratosis:0.964119 Benign keratosis:0.861011 Dermatofibroma:0.654726 Vascular lesion:0.872623
Accus: Melanoma:0.462185 Melanocytic nevus:0.920060 Basal cell carcinoma:0.648148 Actinic keratosis:0.636364 Benign keratosis:0.520000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.621849 Melanocytic nevus:0.947210 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.620000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Specs: Melanoma:0.906924 Melanocytic nevus:0.694362 Basal cell carcinoma:0.955603 Actinic keratosis:0.956567 Benign keratosis:0.935556 Dermatofibroma:0.991870 Vascular lesion:0.989848
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [117.0, 1215.0, 84.0, 40.0, 125.0, 8.0, 27.0]

TEST Student: Epoch: 98, iteration: 86

TEST AUROC: 0.911232, TEST Accus: 0.668453, TEST Senss: 0.836838, TEST Specs: 0.872396
AUROCs: Melanoma:0.887771 Melanocytic nevus:0.936101 Basal cell carcinoma:0.972594 Actinic keratosis:0.934523 Benign keratosis:0.911464 Dermatofibroma:0.737194 Vascular lesion:0.998976
Accus: Melanoma:0.506494 Melanocytic nevus:0.900667 Basal cell carcinoma:0.763636 Actinic keratosis:0.689655 Benign keratosis:0.584112 Dermatofibroma:0.363636 Vascular lesion:0.870968
Senss: Melanoma:0.822511 Melanocytic nevus:0.971831 Basal cell carcinoma:0.918182 Actinic keratosis:0.827586 Benign keratosis:0.817757 Dermatofibroma:0.500000 Vascular lesion:1.000000
Specs: Melanoma:0.804372 Melanocytic nevus:0.627628 Basal cell carcinoma:0.917060 Actinic keratosis:0.933061 Benign keratosis:0.862854 Dermatofibroma:0.977421 Vascular lesion:0.984375
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_99.pth

Epoch: 99, iteration: 0/87, ==> train <===, loss: 1.799644, classification loss: 1.789683,                     consistency loss: 0.000000, consistency relation loss: 0.000000, bnm loss: -0.013275,bnm loss improve: 0.000000,                         supCon loss: 0.000000,vat loss: 0.023236,wcp loss: 0.000000,entropy loss: 0.000000,consistency weight: 1.000000, lr: 2.951266543065283e-09
total: [119.0, 663.0, 54.0, 33.0, 100.0, 16.0, 15.0]
correct: [64.0, 574.0, 34.0, 22.0, 55.0, 5.0, 12.0]

VAL Student: Epoch: 99, iteration: 86

VAL AUROC: 0.866956, VAL Accus: 0.623196, VAL Senss: 0.712968, VAL Specs: 0.922220
AUROCs: Melanoma:0.874112 Melanocytic nevus:0.939655 Basal cell carcinoma:0.917939 Actinic keratosis:0.970762 Benign keratosis:0.863700 Dermatofibroma:0.625572 Vascular lesion:0.876954
Accus: Melanoma:0.537815 Melanocytic nevus:0.865762 Basal cell carcinoma:0.629630 Actinic keratosis:0.666667 Benign keratosis:0.550000 Dermatofibroma:0.312500 Vascular lesion:0.800000
Senss: Melanoma:0.731092 Melanocytic nevus:0.924585 Basal cell carcinoma:0.722222 Actinic keratosis:0.787879 Benign keratosis:0.650000 Dermatofibroma:0.375000 Vascular lesion:0.800000
Specs: Melanoma:0.860386 Melanocytic nevus:0.786350 Basal cell carcinoma:0.953488 Actinic keratosis:0.955533 Benign keratosis:0.921111 Dermatofibroma:0.990854 Vascular lesion:0.987817
/media/luckie/vol4/semi_supervised_cls/code/validation.py:125: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  input_var = torch.autograd.Variable(inp.view(-1, c, h, w).cuda(), volatile=True)
total: [231.0, 1349.0, 110.0, 58.0, 214.0, 22.0, 31.0]
correct: [145.0, 1156.0, 86.0, 37.0, 123.0, 7.0, 28.0]

TEST Student: Epoch: 99, iteration: 86

TEST AUROC: 0.907449, TEST Accus: 0.671509, TEST Senss: 0.820942, TEST Specs: 0.877942
AUROCs: Melanoma:0.886017 Melanocytic nevus:0.938987 Basal cell carcinoma:0.971735 Actinic keratosis:0.930982 Benign keratosis:0.900925 Dermatofibroma:0.724718 Vascular lesion:0.998781
Accus: Melanoma:0.627706 Melanocytic nevus:0.856931 Basal cell carcinoma:0.781818 Actinic keratosis:0.637931 Benign keratosis:0.574766 Dermatofibroma:0.318182 Vascular lesion:0.903226
Senss: Melanoma:0.848485 Melanocytic nevus:0.957005 Basal cell carcinoma:0.881818 Actinic keratosis:0.810345 Benign keratosis:0.794393 Dermatofibroma:0.454545 Vascular lesion:1.000000
Specs: Melanoma:0.756726 Melanocytic nevus:0.726727 Basal cell carcinoma:0.921260 Actinic keratosis:0.934594 Benign keratosis:0.849528 Dermatofibroma:0.975916 Vascular lesion:0.980847
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/checkpoint/epoch_100.pth
save model to ../model/skin_0722_frac01_BNM_w01_vat_batch32_densenet121/iter_8701.pth
